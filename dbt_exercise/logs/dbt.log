[0m10:52:35.419624 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1931c92a50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f193150f1a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f19319e7fb0>]}


============================== 10:52:35.439714 | 88c81db3-8490-4cd0-8283-b510d03c0877 ==============================
[0m10:52:35.439714 [info ] [MainThread]: Running with dbt=1.10.2
[0m10:52:35.441626 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/mnt/c/Users/Damodara Barbosa/Desktop/Projetos/dbt/dbt_exercise/dbt_exercise', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/mnt/c/Users/Damodara Barbosa/Desktop/Projetos/dbt/dbt_exercise/dbt_exercise/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt debug', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m10:52:35.755748 [info ] [MainThread]: dbt version: 1.10.2
[0m10:52:35.757326 [info ] [MainThread]: python version: 3.12.3
[0m10:52:35.758825 [info ] [MainThread]: python path: /mnt/c/Users/Damodara Barbosa/Desktop/Projetos/dbt/dbt_exercise/venv/bin/python3
[0m10:52:35.760453 [info ] [MainThread]: os info: Linux-6.6.87.2-microsoft-standard-WSL2-x86_64-with-glibc2.39
[0m10:53:19.101436 [info ] [MainThread]: Using profiles dir at /mnt/c/Users/Damodara Barbosa/Desktop/Projetos/dbt/dbt_exercise/dbt_exercise
[0m10:53:19.104128 [info ] [MainThread]: Using profiles.yml file at /mnt/c/Users/Damodara Barbosa/Desktop/Projetos/dbt/dbt_exercise/dbt_exercise/profiles.yml
[0m10:53:19.106820 [info ] [MainThread]: Using dbt_project.yml file at /mnt/c/Users/Damodara Barbosa/Desktop/Projetos/dbt/dbt_exercise/dbt_exercise/dbt_project.yml
[0m10:53:19.108956 [info ] [MainThread]: adapter type: bigquery
[0m10:53:19.111159 [info ] [MainThread]: adapter version: 1.9.2
[0m10:53:19.218418 [info ] [MainThread]: Configuration:
[0m10:53:19.221398 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m10:53:19.223737 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m10:53:19.226045 [info ] [MainThread]: Required dependencies:
[0m10:53:19.227929 [debug] [MainThread]: Executing "git --help"
[0m10:53:19.252689 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m10:53:19.254952 [debug] [MainThread]: STDERR: "b''"
[0m10:53:19.257637 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m10:53:19.259659 [info ] [MainThread]: Connection:
[0m10:53:19.261293 [info ] [MainThread]:   method: service-account
[0m10:53:19.262738 [info ] [MainThread]:   database: corded-sunlight-464012-e2
[0m10:53:19.264751 [info ] [MainThread]:   execution_project: corded-sunlight-464012-e2
[0m10:53:19.266781 [info ] [MainThread]:   schema: dbt_dw
[0m10:53:19.268083 [info ] [MainThread]:   location: None
[0m10:53:19.269687 [info ] [MainThread]:   priority: None
[0m10:53:19.271063 [info ] [MainThread]:   maximum_bytes_billed: None
[0m10:53:19.274326 [info ] [MainThread]:   impersonate_service_account: None
[0m10:53:19.275959 [info ] [MainThread]:   job_retry_deadline_seconds: None
[0m10:53:19.277507 [info ] [MainThread]:   job_retries: 1
[0m10:53:19.278939 [info ] [MainThread]:   job_creation_timeout_seconds: None
[0m10:53:19.280721 [info ] [MainThread]:   job_execution_timeout_seconds: None
[0m10:53:19.282202 [info ] [MainThread]:   timeout_seconds: None
[0m10:53:19.283715 [info ] [MainThread]:   client_id: None
[0m10:53:19.285170 [info ] [MainThread]:   token_uri: None
[0m10:53:19.286742 [info ] [MainThread]:   compute_region: None
[0m10:53:19.288580 [info ] [MainThread]:   dataproc_cluster_name: None
[0m10:53:19.291242 [info ] [MainThread]:   gcs_bucket: None
[0m10:53:19.292881 [info ] [MainThread]:   dataproc_batch: None
[0m10:53:19.297000 [info ] [MainThread]: Registered adapter: bigquery=1.9.2
[0m10:54:05.550265 [debug] [MainThread]: Acquiring new bigquery connection 'debug'
[0m10:54:05.552185 [debug] [MainThread]: On debug: select 1 as id
[0m10:54:05.553990 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:54:06.848900 [debug] [MainThread]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:76136355-84e1-40b5-9d61-924e1d50f293&page=queryresults
[0m10:54:11.509381 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m10:54:11.511938 [info ] [MainThread]: [32mAll checks passed![0m
[0m10:54:11.520229 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 96.188126, "process_in_blocks": "140472", "process_kernel_time": 12.303634, "process_mem_max_rss": "357400", "process_out_blocks": "0", "process_user_time": 9.68584}
[0m10:54:11.522844 [debug] [MainThread]: Command `dbt debug` succeeded at 10:54:11.522499 after 96.19 seconds
[0m10:54:11.524930 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m10:54:11.527569 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f193515f290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f18f394e450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f18f3fd4830>]}
[0m10:54:11.529871 [debug] [MainThread]: Flushing usage events
[0m10:54:11.993012 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:33:24.903898 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b6f31f6be00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b6f339d99d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b6f326404a0>]}


============================== 11:33:24.924991 | c36eb04d-f42f-4f28-9fd0-44d19d4aeb87 ==============================
[0m11:33:24.924991 [info ] [MainThread]: Running with dbt=1.10.2
[0m11:33:24.925967 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise', 'log_path': '/home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt debug', 'send_anonymous_usage_stats': 'True'}
[0m11:33:25.296488 [info ] [MainThread]: dbt version: 1.10.2
[0m11:33:25.297228 [info ] [MainThread]: python version: 3.12.3
[0m11:33:25.298004 [info ] [MainThread]: python path: /mnt/c/Users/Damodara Barbosa/Desktop/Projetos/dbt/dbt_exercise/venv/bin/python3
[0m11:33:25.298689 [info ] [MainThread]: os info: Linux-6.6.87.2-microsoft-standard-WSL2-x86_64-with-glibc2.39
[0m11:34:21.503426 [info ] [MainThread]: Using profiles dir at /home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise
[0m11:34:21.504200 [info ] [MainThread]: Using profiles.yml file at /home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/profiles.yml
[0m11:34:21.504939 [info ] [MainThread]: Using dbt_project.yml file at /home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/dbt_project.yml
[0m11:34:21.505915 [info ] [MainThread]: adapter type: bigquery
[0m11:34:21.506753 [info ] [MainThread]: adapter version: 1.9.2
[0m11:34:21.666933 [info ] [MainThread]: Configuration:
[0m11:34:21.667660 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m11:34:21.668168 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m11:34:21.668735 [info ] [MainThread]: Required dependencies:
[0m11:34:21.669519 [debug] [MainThread]: Executing "git --help"
[0m11:34:21.677015 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m11:34:21.677835 [debug] [MainThread]: STDERR: "b''"
[0m11:34:21.678267 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m11:34:21.678918 [info ] [MainThread]: Connection:
[0m11:34:21.680130 [info ] [MainThread]:   method: service-account
[0m11:34:21.680975 [info ] [MainThread]:   database: corded-sunlight-464012-e2
[0m11:34:21.681624 [info ] [MainThread]:   execution_project: corded-sunlight-464012-e2
[0m11:34:21.682372 [info ] [MainThread]:   schema: dbt_dw
[0m11:34:21.683356 [info ] [MainThread]:   location: None
[0m11:34:21.684268 [info ] [MainThread]:   priority: None
[0m11:34:21.685050 [info ] [MainThread]:   maximum_bytes_billed: None
[0m11:34:21.685706 [info ] [MainThread]:   impersonate_service_account: None
[0m11:34:21.686382 [info ] [MainThread]:   job_retry_deadline_seconds: None
[0m11:34:21.687217 [info ] [MainThread]:   job_retries: 1
[0m11:34:21.688002 [info ] [MainThread]:   job_creation_timeout_seconds: None
[0m11:34:21.688690 [info ] [MainThread]:   job_execution_timeout_seconds: None
[0m11:34:21.689382 [info ] [MainThread]:   timeout_seconds: None
[0m11:34:21.690082 [info ] [MainThread]:   client_id: None
[0m11:34:21.691497 [info ] [MainThread]:   token_uri: None
[0m11:34:21.692682 [info ] [MainThread]:   compute_region: None
[0m11:34:21.694435 [info ] [MainThread]:   dataproc_cluster_name: None
[0m11:34:21.695950 [info ] [MainThread]:   gcs_bucket: None
[0m11:34:21.696632 [info ] [MainThread]:   dataproc_batch: None
[0m11:34:21.701197 [info ] [MainThread]: Registered adapter: bigquery=1.9.2
[0m11:35:14.237298 [debug] [MainThread]: Acquiring new bigquery connection 'debug'
[0m11:35:14.237944 [debug] [MainThread]: On debug: select 1 as id
[0m11:35:14.238363 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:35:15.486630 [debug] [MainThread]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:931123fb-466c-4fd6-ade6-83357220d3de&page=queryresults
[0m11:35:21.210105 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m11:35:21.211298 [info ] [MainThread]: [32mAll checks passed![0m
[0m11:35:21.235521 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 116.42176, "process_in_blocks": "135272", "process_kernel_time": 14.832029, "process_mem_max_rss": "357756", "process_out_blocks": "40", "process_user_time": 11.299701}
[0m11:35:21.236459 [debug] [MainThread]: Command `dbt debug` succeeded at 11:35:21.236235 after 116.42 seconds
[0m11:35:21.237182 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m11:35:21.238264 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b6f31a54620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b6f31fea630>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b6ef489d8e0>]}
[0m11:35:21.239004 [debug] [MainThread]: Flushing usage events
[0m11:35:21.587919 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:48:57.547346 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78661b9db4d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78661b864fb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78661b63ede0>]}


============================== 16:48:57.573526 | 57deaada-bb15-48cd-b357-a20e903044c9 ==============================
[0m16:48:57.573526 [info ] [MainThread]: Running with dbt=1.10.2
[0m16:48:57.574655 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/logs', 'profiles_dir': '/home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt seed', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:50:08.228191 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '57deaada-bb15-48cd-b357-a20e903044c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7865de0b8e00>]}
[0m16:50:08.326043 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '57deaada-bb15-48cd-b357-a20e903044c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7865e0452240>]}
[0m16:50:08.330453 [info ] [MainThread]: Registered adapter: bigquery=1.9.2
[0m16:51:13.154425 [debug] [MainThread]: checksum: 1adc40777973ef30f45f80b3b6d04d5013c1edd53d96363881b3b199e612468b, vars: {}, profile: , target: , version: 1.10.2
[0m16:51:13.226932 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m16:51:13.228808 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '57deaada-bb15-48cd-b357-a20e903044c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7865dda36d50>]}
[0m16:51:21.565049 [error] [MainThread]: Encountered an error:
Parsing Error
  at path ['packages'][0]: {'package': 'dbt-labs/dbt_utils', 'version': '0.7.0'} is not of type 'string'
[0m16:51:21.573685 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": false, "command_wall_clock_time": 141.89519, "process_in_blocks": "132336", "process_kernel_time": 18.824837, "process_mem_max_rss": "355300", "process_out_blocks": "40", "process_user_time": 14.132183}
[0m16:51:21.575133 [debug] [MainThread]: Command `dbt seed` failed at 16:51:21.574869 after 141.90 seconds
[0m16:51:21.575893 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78661b864fb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7865ddae7290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78661ab1e0c0>]}
[0m16:51:21.576484 [debug] [MainThread]: Flushing usage events
[0m16:51:21.944633 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:52:11.868171 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7988de98b950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7988def7cef0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7988dea845f0>]}


============================== 16:52:11.897449 | 39aed30e-6ce0-438c-bd8d-e07d635a4f18 ==============================
[0m16:52:11.897449 [info ] [MainThread]: Running with dbt=1.10.2
[0m16:52:11.898354 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt seed', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:53:20.419409 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '39aed30e-6ce0-438c-bd8d-e07d635a4f18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7988a16b8200>]}
[0m16:53:20.538934 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '39aed30e-6ce0-438c-bd8d-e07d635a4f18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7988def7cfe0>]}
[0m16:53:20.544612 [info ] [MainThread]: Registered adapter: bigquery=1.9.2
[0m16:54:30.903490 [debug] [MainThread]: checksum: 1adc40777973ef30f45f80b3b6d04d5013c1edd53d96363881b3b199e612468b, vars: {}, profile: , target: , version: 1.10.2
[0m16:54:30.919726 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m16:54:30.920517 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '39aed30e-6ce0-438c-bd8d-e07d635a4f18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7988a1101280>]}
[0m16:54:38.657533 [error] [MainThread]: Encountered an error:
Parsing Error
  at path ['packages'][0]: {'package': 'dbt-labs/dbt_utils', 'version': '0.7.0'} is not of type 'string'
[0m16:54:38.684995 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": false, "command_wall_clock_time": 146.91423, "process_in_blocks": "135032", "process_kernel_time": 17.900011, "process_mem_max_rss": "355084", "process_out_blocks": "40", "process_user_time": 13.967331}
[0m16:54:38.687273 [debug] [MainThread]: Command `dbt seed` failed at 16:54:38.686924 after 146.92 seconds
[0m16:54:38.688115 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7988ddfdc290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7988a0f647a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7988a31c0ce0>]}
[0m16:54:38.688949 [debug] [MainThread]: Flushing usage events
[0m16:54:39.051094 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:58:14.128318 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70b3c295cbc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70b3c254aab0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70b3c2549e20>]}


============================== 16:58:14.149167 | 4a98088c-7c76-4ab8-8e79-00c48bac3fe1 ==============================
[0m16:58:14.149167 [info ] [MainThread]: Running with dbt=1.10.2
[0m16:58:14.150172 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt deps', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:58:15.154493 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4a98088c-7c76-4ab8-8e79-00c48bac3fe1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70b3c1df33e0>]}
[0m16:58:15.800562 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-lsewjl6q'
[0m16:58:15.801663 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m16:58:16.069275 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m16:58:16.070348 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m16:58:16.099619 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m16:58:16.106922 [error] [MainThread]: Encountered an error:
Could not find a matching compatible version for package dbt-labs/dbt_utils
  Requested range: =0.7.0, =0.7.0
  Compatible versions: ['0.0.1', '0.1.0', '0.1.1', '0.1.2', '0.1.3', '0.1.4', '0.1.5', '0.1.6', '0.1.7', '0.1.8', '0.1.9', '0.1.10', '0.1.11', '0.1.12', '0.1.13', '0.1.14', '0.1.15', '0.1.16', '0.1.17', '0.1.18', '0.1.19', '0.1.20', '0.1.21', '0.1.22', '0.1.23', '0.1.24', '0.1.25', '0.2.0', '0.2.1', '0.2.2', '0.2.3', '0.2.4', '0.2.5', '0.3.0', '0.4.0', '0.4.1', '0.5.0', '0.8.0', '0.8.1', '0.8.2', '0.8.3', '0.8.4', '0.8.5', '0.8.6', '0.9.0', '0.9.1', '0.9.2', '0.9.5', '0.9.6', '1.0.0', '1.1.0', '1.1.1', '1.2.0', '1.3.0']

  Not shown: package versions incompatible with installed version of dbt-core
  To include them, run 'dbt --no-version-check deps'
[0m16:58:16.175758 [error] [MainThread]: Traceback (most recent call last):
  File "/mnt/c/Users/Damodara Barbosa/Desktop/Projetos/dbt/dbt_exercise/venv/lib/python3.12/site-packages/dbt/cli/requires.py", line 161, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/Damodara Barbosa/Desktop/Projetos/dbt/dbt_exercise/venv/lib/python3.12/site-packages/dbt/cli/requires.py", line 111, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/Damodara Barbosa/Desktop/Projetos/dbt/dbt_exercise/venv/lib/python3.12/site-packages/dbt/cli/requires.py", line 237, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/Damodara Barbosa/Desktop/Projetos/dbt/dbt_exercise/venv/lib/python3.12/site-packages/dbt/cli/requires.py", line 285, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/Damodara Barbosa/Desktop/Projetos/dbt/dbt_exercise/venv/lib/python3.12/site-packages/dbt/cli/main.py", line 461, in deps
    results = task.run()
              ^^^^^^^^^^
  File "/mnt/c/Users/Damodara Barbosa/Desktop/Projetos/dbt/dbt_exercise/venv/lib/python3.12/site-packages/dbt/task/deps.py", line 215, in run
    self.lock()
  File "/mnt/c/Users/Damodara Barbosa/Desktop/Projetos/dbt/dbt_exercise/venv/lib/python3.12/site-packages/dbt/task/deps.py", line 187, in lock
    resolved_deps = resolve_packages(packages, self.project, self.cli_vars)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/Damodara Barbosa/Desktop/Projetos/dbt/dbt_exercise/venv/lib/python3.12/site-packages/dbt/deps/resolver.py", line 131, in resolve_packages
    target = final[package].resolved().fetch_metadata(project, renderer)
             ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/mnt/c/Users/Damodara Barbosa/Desktop/Projetos/dbt/dbt_exercise/venv/lib/python3.12/site-packages/dbt/deps/registry.py", line 124, in resolved
    raise PackageVersionNotFoundError(
dbt.exceptions.PackageVersionNotFoundError: Could not find a matching compatible version for package dbt-labs/dbt_utils
  Requested range: =0.7.0, =0.7.0
  Compatible versions: ['0.0.1', '0.1.0', '0.1.1', '0.1.2', '0.1.3', '0.1.4', '0.1.5', '0.1.6', '0.1.7', '0.1.8', '0.1.9', '0.1.10', '0.1.11', '0.1.12', '0.1.13', '0.1.14', '0.1.15', '0.1.16', '0.1.17', '0.1.18', '0.1.19', '0.1.20', '0.1.21', '0.1.22', '0.1.23', '0.1.24', '0.1.25', '0.2.0', '0.2.1', '0.2.2', '0.2.3', '0.2.4', '0.2.5', '0.3.0', '0.4.0', '0.4.1', '0.5.0', '0.8.0', '0.8.1', '0.8.2', '0.8.3', '0.8.4', '0.8.5', '0.8.6', '0.9.0', '0.9.1', '0.9.2', '0.9.5', '0.9.6', '1.0.0', '1.1.0', '1.1.1', '1.2.0', '1.3.0']

  Not shown: package versions incompatible with installed version of dbt-core
  To include them, run 'dbt --no-version-check deps'

[0m16:58:16.199515 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": false, "command_wall_clock_time": 2.1827762, "process_in_blocks": "26744", "process_kernel_time": 3.03503, "process_mem_max_rss": "101020", "process_out_blocks": "40", "process_user_time": 3.467955}
[0m16:58:16.201009 [debug] [MainThread]: Command `dbt deps` failed at 16:58:16.200611 after 2.19 seconds
[0m16:58:16.202220 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70b3c631b200>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70b3c1d53680>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70b3c25e0aa0>]}
[0m16:58:16.203207 [debug] [MainThread]: Flushing usage events
[0m16:58:16.575309 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:59:48.060641 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78a5d62032f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78a5d76792e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78a5d609cfb0>]}


============================== 16:59:48.085129 | 7523e42e-ec88-441d-8dd7-f0f65f3f032b ==============================
[0m16:59:48.085129 [info ] [MainThread]: Running with dbt=1.10.2
[0m16:59:48.086057 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'invocation_command': 'dbt deps', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:59:49.085570 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7523e42e-ec88-441d-8dd7-f0f65f3f032b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78a5d690d370>]}
[0m16:59:49.815803 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-vqxyo9to'
[0m16:59:49.816642 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m16:59:49.855987 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m16:59:49.857176 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m16:59:49.887780 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m16:59:49.906313 [info ] [MainThread]: Updating lock file in file path: /home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/package-lock.yml
[0m16:59:49.911524 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-7qr3dd0_'
[0m16:59:49.916571 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m16:59:50.467310 [info ] [MainThread]: Installed from version 1.3.0
[0m16:59:50.468083 [info ] [MainThread]: Up to date!
[0m16:59:50.469218 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '7523e42e-ec88-441d-8dd7-f0f65f3f032b', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78a5d5946990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78a5d5946810>]}
[0m16:59:50.475611 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 2.5132644, "process_in_blocks": "29408", "process_kernel_time": 3.056072, "process_mem_max_rss": "101100", "process_out_blocks": "2312", "process_user_time": 3.281828}
[0m16:59:50.477025 [debug] [MainThread]: Command `dbt deps` succeeded at 16:59:50.476696 after 2.52 seconds
[0m16:59:50.478168 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78a5d62032f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78a5d58fde20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78a5d58fee40>]}
[0m16:59:50.478999 [debug] [MainThread]: Flushing usage events
[0m16:59:50.830903 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:00:22.803367 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa9c2111d00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa9c22d6540>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa9c354d9d0>]}


============================== 17:00:22.828472 | 4dd3e3c3-4811-4887-a273-b9c320225c30 ==============================
[0m17:00:22.828472 [info ] [MainThread]: Running with dbt=1.10.2
[0m17:00:22.847191 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/logs', 'profiles_dir': '/home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'invocation_command': 'dbt seed', 'send_anonymous_usage_stats': 'True'}
[0m17:01:17.415795 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4dd3e3c3-4811-4887-a273-b9c320225c30', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa985a0e4b0>]}
[0m17:01:17.528827 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4dd3e3c3-4811-4887-a273-b9c320225c30', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa9c1b2daf0>]}
[0m17:01:17.533426 [info ] [MainThread]: Registered adapter: bigquery=1.9.2
[0m17:02:10.306811 [debug] [MainThread]: checksum: 1adc40777973ef30f45f80b3b6d04d5013c1edd53d96363881b3b199e612468b, vars: {}, profile: , target: , version: 1.10.2
[0m17:02:10.320843 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m17:02:10.321624 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '4dd3e3c3-4811-4887-a273-b9c320225c30', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa9847af500>]}
[0m17:02:17.543202 [error] [MainThread]: Encountered an error:
Parsing Error
  at path []: A seed must have a materialized value of 'seed'
[0m17:02:17.567776 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": false, "command_wall_clock_time": 114.85119, "process_in_blocks": "126776", "process_kernel_time": 15.450491, "process_mem_max_rss": "359816", "process_out_blocks": "40", "process_user_time": 12.808721}
[0m17:02:17.568946 [debug] [MainThread]: Command `dbt seed` failed at 17:02:17.568747 after 114.85 seconds
[0m17:02:17.569917 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa9c354d9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa98425f050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa9842acc80>]}
[0m17:02:17.570977 [debug] [MainThread]: Flushing usage events
[0m17:02:17.948454 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:04:35.829456 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76a17ab37cb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76a17babf9b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76a17a7da180>]}


============================== 17:04:35.851337 | 2becd658-12b9-4c25-805b-51c4dbf00da0 ==============================
[0m17:04:35.851337 [info ] [MainThread]: Running with dbt=1.10.2
[0m17:04:35.854577 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise', 'log_path': '/home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt seed', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:05:33.489589 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2becd658-12b9-4c25-805b-51c4dbf00da0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76a13cebfcb0>]}
[0m17:05:33.597259 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2becd658-12b9-4c25-805b-51c4dbf00da0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76a13d0e2e70>]}
[0m17:05:33.601784 [info ] [MainThread]: Registered adapter: bigquery=1.9.2
[0m17:06:25.708752 [debug] [MainThread]: checksum: 1adc40777973ef30f45f80b3b6d04d5013c1edd53d96363881b3b199e612468b, vars: {}, profile: , target: , version: 1.10.2
[0m17:06:25.723225 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m17:06:25.723977 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '2becd658-12b9-4c25-805b-51c4dbf00da0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76a13cfded20>]}
[0m17:06:33.563521 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.dbt_exercise.marts
- models.dbt_exercise.intermediate
- models.dbt_exercise.staging
[0m17:06:33.571412 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2becd658-12b9-4c25-805b-51c4dbf00da0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76a13c10b3b0>]}
[0m17:06:33.706582 [debug] [MainThread]: Wrote artifact WritableManifest to /home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/target/manifest.json
[0m17:06:33.724263 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/target/semantic_manifest.json
[0m17:06:34.224171 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2becd658-12b9-4c25-805b-51c4dbf00da0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76a13c12a060>]}
[0m17:06:34.224830 [info ] [MainThread]: Found 2 models, 1 seed, 4 data tests, 609 macros
[0m17:06:34.225330 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2becd658-12b9-4c25-805b-51c4dbf00da0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76a13c196180>]}
[0m17:06:34.227932 [info ] [MainThread]: 
[0m17:06:34.228638 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m17:06:34.229242 [info ] [MainThread]: 
[0m17:06:34.230462 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m17:06:34.232391 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_corded-sunlight-464012-e2'
[0m17:06:34.233058 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:06:35.151521 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_corded-sunlight-464012-e2, now create_corded-sunlight-464012-e2_dbt_dw_raw)
[0m17:06:35.152421 [debug] [ThreadPool]: Creating schema "database: "corded-sunlight-464012-e2"
schema: "dbt_dw_raw"
"
[0m17:06:35.169834 [debug] [ThreadPool]: On create_corded-sunlight-464012-e2_dbt_dw_raw: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "connection_name": "create_corded-sunlight-464012-e2_dbt_dw_raw"} */
create schema if not exists `corded-sunlight-464012-e2`.`dbt_dw_raw`
  
[0m17:06:35.170691 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:06:36.471455 [debug] [ThreadPool]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:82d66229-76f0-41df-be0a-84a9bf00c771&page=queryresults
[0m17:06:42.696297 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_corded-sunlight-464012-e2_dbt_dw_raw, now list_corded-sunlight-464012-e2_dbt_dw)
[0m17:06:42.697667 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:06:42.698838 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_corded-sunlight-464012-e2_dbt_dw_raw'
[0m17:06:42.699939 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:06:43.655637 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2becd658-12b9-4c25-805b-51c4dbf00da0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76a17c59c290>]}
[0m17:06:43.656524 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:06:43.692725 [debug] [Thread-1 (]: Began running node seed.dbt_exercise.dados_financeiros
[0m17:06:43.693896 [info ] [Thread-1 (]: 1 of 1 START seed file dbt_dw_raw.dados_financeiros ............................ [RUN]
[0m17:06:43.695071 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_corded-sunlight-464012-e2_dbt_dw_raw, now seed.dbt_exercise.dados_financeiros)
[0m17:06:43.695968 [debug] [Thread-1 (]: Began compiling node seed.dbt_exercise.dados_financeiros
[0m17:06:43.696493 [debug] [Thread-1 (]: Began executing node seed.dbt_exercise.dados_financeiros
[0m17:06:43.766207 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:06:48.806012 [debug] [Thread-1 (]: On seed.dbt_exercise.dados_financeiros: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "seed.dbt_exercise.dados_financeiros"} */

    alter table `corded-sunlight-464012-e2`.`dbt_dw_raw`.`dados_financeiros` set OPTIONS()
  
[0m17:06:49.287387 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:d426741f-e14c-4001-ba3f-27df438a17cf&page=queryresults
[0m17:06:49.870225 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.dbt_exercise.dados_financeiros"
[0m17:06:49.925187 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2becd658-12b9-4c25-805b-51c4dbf00da0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76a17ad98aa0>]}
[0m17:06:49.926724 [info ] [Thread-1 (]: 1 of 1 OK loaded seed file dbt_dw_raw.dados_financeiros ........................ [[32mINSERT 190[0m in 6.21s]
[0m17:06:49.927956 [debug] [Thread-1 (]: Finished running node seed.dbt_exercise.dados_financeiros
[0m17:06:49.931984 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:06:49.941415 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:06:49.942588 [debug] [MainThread]: Connection 'list_corded-sunlight-464012-e2_dbt_dw' was properly closed.
[0m17:06:49.943436 [debug] [MainThread]: Connection 'seed.dbt_exercise.dados_financeiros' was properly closed.
[0m17:06:49.943952 [info ] [MainThread]: 
[0m17:06:49.944595 [info ] [MainThread]: Finished running 1 seed in 0 hours 0 minutes and 15.71 seconds (15.71s).
[0m17:06:49.947027 [debug] [MainThread]: Command end result
[0m17:06:50.021308 [debug] [MainThread]: Wrote artifact WritableManifest to /home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/target/manifest.json
[0m17:06:50.043826 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/target/semantic_manifest.json
[0m17:06:50.053168 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/target/run_results.json
[0m17:06:50.053812 [info ] [MainThread]: 
[0m17:06:50.054494 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:06:50.054986 [info ] [MainThread]: 
[0m17:06:50.055662 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m17:06:50.066897 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": true, "command_wall_clock_time": 134.33344, "process_in_blocks": "146064", "process_kernel_time": 16.922964, "process_mem_max_rss": "370436", "process_out_blocks": "3888", "process_user_time": 14.875904}
[0m17:06:50.067886 [debug] [MainThread]: Command `dbt seed` succeeded at 17:06:50.067694 after 134.34 seconds
[0m17:06:50.068412 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76a17a3f3770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76a13c80c320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76a17af3fd70>]}
[0m17:06:50.068947 [debug] [MainThread]: Flushing usage events
[0m17:06:50.439216 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:24:58.531345 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x774e8bd1b500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x774e8bcb7e30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x774e8bcb6a80>]}


============================== 18:24:58.556121 | 16611795-5c36-4c6f-bc0f-ef3ca53849ba ==============================
[0m18:24:58.556121 [info ] [MainThread]: Running with dbt=1.10.2
[0m18:24:58.557795 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/logs', 'profiles_dir': '/home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt seed', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m18:25:52.253180 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '16611795-5c36-4c6f-bc0f-ef3ca53849ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x774e8c2913d0>]}
[0m18:25:52.344285 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '16611795-5c36-4c6f-bc0f-ef3ca53849ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x774e8dc1fbf0>]}
[0m18:25:52.349337 [info ] [MainThread]: Registered adapter: bigquery=1.9.2
[0m18:26:54.457250 [debug] [MainThread]: checksum: 1adc40777973ef30f45f80b3b6d04d5013c1edd53d96363881b3b199e612468b, vars: {}, profile: , target: , version: 1.10.2
[0m18:27:01.454784 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 14 files added, 0 files changed.
[0m18:27:01.455696 [debug] [MainThread]: Partial parsing: added file: dbt_exercise://seeds/erp_northwind/products.csv
[0m18:27:01.456235 [debug] [MainThread]: Partial parsing: added file: dbt_exercise://seeds/country_codes.csv
[0m18:27:01.456666 [debug] [MainThread]: Partial parsing: added file: dbt_exercise://seeds/erp_northwind/suppliers.csv
[0m18:27:01.457050 [debug] [MainThread]: Partial parsing: added file: dbt_exercise://seeds/erp_northwind/territories.csv
[0m18:27:01.457406 [debug] [MainThread]: Partial parsing: added file: dbt_exercise://seeds/erp_northwind/region.csv
[0m18:27:01.457952 [debug] [MainThread]: Partial parsing: added file: dbt_exercise://seeds/erp_northwind/order_details.csv
[0m18:27:01.458498 [debug] [MainThread]: Partial parsing: added file: dbt_exercise://seeds/erp_northwind/orders.csv
[0m18:27:01.459163 [debug] [MainThread]: Partial parsing: added file: dbt_exercise://seeds/erp_northwind/categories.csv
[0m18:27:01.459782 [debug] [MainThread]: Partial parsing: added file: dbt_exercise://seeds/erp_northwind/employee_territories.csv
[0m18:27:01.460276 [debug] [MainThread]: Partial parsing: added file: dbt_exercise://seeds/erp_northwind/shippers.csv
[0m18:27:01.460819 [debug] [MainThread]: Partial parsing: added file: dbt_exercise://seeds/erp_northwind/us_states.csv
[0m18:27:01.461225 [debug] [MainThread]: Partial parsing: added file: dbt_exercise://seeds/erp_northwind/employees.csv
[0m18:27:01.461661 [debug] [MainThread]: Partial parsing: added file: dbt_exercise://seeds/erp_northwind/customers.csv
[0m18:27:01.462271 [debug] [MainThread]: Partial parsing: added file: dbt_exercise://models/example/staging/sources.yml
[0m18:27:02.559638 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.dbt_exercise.staging
- models.dbt_exercise.intermediate
- models.dbt_exercise.marts
[0m18:27:02.577072 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '16611795-5c36-4c6f-bc0f-ef3ca53849ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x774e4de78140>]}
[0m18:27:02.752437 [debug] [MainThread]: Wrote artifact WritableManifest to /home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/target/manifest.json
[0m18:27:02.770667 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/target/semantic_manifest.json
[0m18:27:03.449471 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '16611795-5c36-4c6f-bc0f-ef3ca53849ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x774e4deaf980>]}
[0m18:27:03.450362 [info ] [MainThread]: Found 2 models, 14 seeds, 5 data tests, 1 source, 609 macros
[0m18:27:03.450941 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '16611795-5c36-4c6f-bc0f-ef3ca53849ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x774e4dba9cd0>]}
[0m18:27:03.455805 [info ] [MainThread]: 
[0m18:27:03.456769 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m18:27:03.457763 [info ] [MainThread]: 
[0m18:27:03.459219 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m18:27:03.466860 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_corded-sunlight-464012-e2'
[0m18:27:03.469948 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_corded-sunlight-464012-e2'
[0m18:27:03.471210 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:27:03.472772 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:27:04.891992 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_corded-sunlight-464012-e2, now list_corded-sunlight-464012-e2_dbt_dw)
[0m18:27:04.894153 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_corded-sunlight-464012-e2, now list_corded-sunlight-464012-e2_dbt_dw_raw)
[0m18:27:04.894911 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:27:04.895900 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:27:05.842069 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '16611795-5c36-4c6f-bc0f-ef3ca53849ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x774e4e064d10>]}
[0m18:27:05.843068 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:27:05.880542 [debug] [Thread-1 (]: Began running node seed.dbt_exercise.categories
[0m18:27:05.881952 [debug] [Thread-2 (]: Began running node seed.dbt_exercise.country_codes
[0m18:27:05.883727 [debug] [Thread-3 (]: Began running node seed.dbt_exercise.customers
[0m18:27:05.885955 [debug] [Thread-4 (]: Began running node seed.dbt_exercise.dados_financeiros
[0m18:27:05.885118 [info ] [Thread-1 (]: 1 of 14 START seed file dbt_dw.categories ...................................... [RUN]
[0m18:27:05.887753 [info ] [Thread-2 (]: 2 of 14 START seed file dbt_dw.country_codes ................................... [RUN]
[0m18:27:05.889003 [info ] [Thread-3 (]: 3 of 14 START seed file dbt_dw.customers ....................................... [RUN]
[0m18:27:05.890194 [info ] [Thread-4 (]: 4 of 14 START seed file dbt_dw_raw.dados_financeiros ........................... [RUN]
[0m18:27:05.891235 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_corded-sunlight-464012-e2_dbt_dw, now seed.dbt_exercise.categories)
[0m18:27:05.892373 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_corded-sunlight-464012-e2_dbt_dw_raw, now seed.dbt_exercise.country_codes)
[0m18:27:05.893473 [debug] [Thread-3 (]: Acquiring new bigquery connection 'seed.dbt_exercise.customers'
[0m18:27:05.895185 [debug] [Thread-4 (]: Acquiring new bigquery connection 'seed.dbt_exercise.dados_financeiros'
[0m18:27:05.896701 [debug] [Thread-1 (]: Began compiling node seed.dbt_exercise.categories
[0m18:27:05.897692 [debug] [Thread-2 (]: Began compiling node seed.dbt_exercise.country_codes
[0m18:27:05.898610 [debug] [Thread-3 (]: Began compiling node seed.dbt_exercise.customers
[0m18:27:05.899647 [debug] [Thread-4 (]: Began compiling node seed.dbt_exercise.dados_financeiros
[0m18:27:05.900742 [debug] [Thread-1 (]: Began executing node seed.dbt_exercise.categories
[0m18:27:05.901627 [debug] [Thread-2 (]: Began executing node seed.dbt_exercise.country_codes
[0m18:27:05.902491 [debug] [Thread-3 (]: Began executing node seed.dbt_exercise.customers
[0m18:27:05.903477 [debug] [Thread-4 (]: Began executing node seed.dbt_exercise.dados_financeiros
[0m18:27:13.280497 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:27:13.282340 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:27:13.307289 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m18:27:13.311516 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m18:27:18.584317 [debug] [Thread-2 (]: On seed.dbt_exercise.country_codes: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "seed.dbt_exercise.country_codes"} */

    alter table `corded-sunlight-464012-e2`.`dbt_dw`.`country_codes` set OPTIONS()
  
[0m18:27:18.740610 [debug] [Thread-1 (]: On seed.dbt_exercise.categories: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "seed.dbt_exercise.categories"} */

    alter table `corded-sunlight-464012-e2`.`dbt_dw`.`categories` set OPTIONS()
  
[0m18:27:18.803420 [debug] [Thread-3 (]: On seed.dbt_exercise.customers: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "seed.dbt_exercise.customers"} */

    alter table `corded-sunlight-464012-e2`.`dbt_dw`.`customers` set OPTIONS()
  
[0m18:27:18.993527 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:ea38059f-661b-4923-a121-9d7262e56960&page=queryresults
[0m18:27:19.209771 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:a9dc6b98-c3f4-4691-9851-4fcd4c80f1d6&page=queryresults
[0m18:27:19.244499 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:ea492f2b-9f73-4014-9649-6c3894ad34b3&page=queryresults
[0m18:27:19.549701 [debug] [Thread-2 (]: Writing runtime SQL for node "seed.dbt_exercise.country_codes"
[0m18:27:19.629386 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '16611795-5c36-4c6f-bc0f-ef3ca53849ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x774e8db75700>]}
[0m18:27:19.630461 [info ] [Thread-2 (]: 2 of 14 OK loaded seed file dbt_dw.country_codes ............................... [[32mINSERT 3[0m in 13.71s]
[0m18:27:19.631438 [debug] [Thread-2 (]: Finished running node seed.dbt_exercise.country_codes
[0m18:27:19.632462 [debug] [Thread-2 (]: Began running node seed.dbt_exercise.employee_territories
[0m18:27:19.634687 [info ] [Thread-2 (]: 5 of 14 START seed file dbt_dw.employee_territories ............................ [RUN]
[0m18:27:19.637516 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly seed.dbt_exercise.country_codes, now seed.dbt_exercise.employee_territories)
[0m18:27:19.638996 [debug] [Thread-2 (]: Began compiling node seed.dbt_exercise.employee_territories
[0m18:27:19.639780 [debug] [Thread-2 (]: Began executing node seed.dbt_exercise.employee_territories
[0m18:27:19.648729 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:27:19.709539 [debug] [Thread-4 (]: On seed.dbt_exercise.dados_financeiros: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "seed.dbt_exercise.dados_financeiros"} */

    alter table `corded-sunlight-464012-e2`.`dbt_dw_raw`.`dados_financeiros` set OPTIONS()
  
[0m18:27:19.756307 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.dbt_exercise.categories"
[0m18:27:19.784454 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '16611795-5c36-4c6f-bc0f-ef3ca53849ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x774e3dec3fb0>]}
[0m18:27:19.786438 [info ] [Thread-1 (]: 1 of 14 OK loaded seed file dbt_dw.categories .................................. [[32mINSERT 8[0m in 13.89s]
[0m18:27:19.787884 [debug] [Thread-1 (]: Finished running node seed.dbt_exercise.categories
[0m18:27:19.788817 [debug] [Thread-1 (]: Began running node seed.dbt_exercise.employees
[0m18:27:19.789865 [info ] [Thread-1 (]: 6 of 14 START seed file dbt_dw.employees ....................................... [RUN]
[0m18:27:19.790692 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.dbt_exercise.categories, now seed.dbt_exercise.employees)
[0m18:27:19.792382 [debug] [Thread-1 (]: Began compiling node seed.dbt_exercise.employees
[0m18:27:19.793411 [debug] [Thread-1 (]: Began executing node seed.dbt_exercise.employees
[0m18:27:19.801704 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:27:19.808730 [debug] [Thread-3 (]: Writing runtime SQL for node "seed.dbt_exercise.customers"
[0m18:27:19.815099 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '16611795-5c36-4c6f-bc0f-ef3ca53849ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x774e3dec04a0>]}
[0m18:27:19.817097 [info ] [Thread-3 (]: 3 of 14 OK loaded seed file dbt_dw.customers ................................... [[32mINSERT 91[0m in 13.92s]
[0m18:27:19.821860 [debug] [Thread-3 (]: Finished running node seed.dbt_exercise.customers
[0m18:27:19.823002 [debug] [Thread-3 (]: Began running node seed.dbt_exercise.order_details
[0m18:27:19.824936 [info ] [Thread-3 (]: 7 of 14 START seed file dbt_dw.order_details ................................... [RUN]
[0m18:27:19.829138 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly seed.dbt_exercise.customers, now seed.dbt_exercise.order_details)
[0m18:27:19.873081 [debug] [Thread-3 (]: Began compiling node seed.dbt_exercise.order_details
[0m18:27:19.875507 [debug] [Thread-3 (]: Began executing node seed.dbt_exercise.order_details
[0m18:27:19.990879 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m18:27:20.148064 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:f7525b33-d618-4e03-a88a-5dd7b9826ced&page=queryresults
[0m18:27:20.716772 [debug] [Thread-4 (]: Writing runtime SQL for node "seed.dbt_exercise.dados_financeiros"
[0m18:27:20.722993 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '16611795-5c36-4c6f-bc0f-ef3ca53849ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x774e3dec16d0>]}
[0m18:27:20.724165 [info ] [Thread-4 (]: 4 of 14 OK loaded seed file dbt_dw_raw.dados_financeiros ....................... [[32mINSERT 190[0m in 14.83s]
[0m18:27:20.725177 [debug] [Thread-4 (]: Finished running node seed.dbt_exercise.dados_financeiros
[0m18:27:20.726049 [debug] [Thread-4 (]: Began running node seed.dbt_exercise.orders
[0m18:27:20.726997 [info ] [Thread-4 (]: 8 of 14 START seed file dbt_dw.orders .......................................... [RUN]
[0m18:27:20.728701 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly seed.dbt_exercise.dados_financeiros, now seed.dbt_exercise.orders)
[0m18:27:20.730104 [debug] [Thread-4 (]: Began compiling node seed.dbt_exercise.orders
[0m18:27:20.730654 [debug] [Thread-4 (]: Began executing node seed.dbt_exercise.orders
[0m18:27:20.838457 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m18:27:25.130815 [debug] [Thread-2 (]: On seed.dbt_exercise.employee_territories: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "seed.dbt_exercise.employee_territories"} */

    alter table `corded-sunlight-464012-e2`.`dbt_dw`.`employee_territories` set OPTIONS()
  
[0m18:27:25.546290 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:11d38277-6e56-474f-a4bd-fddd868f57fd&page=queryresults
[0m18:27:26.068134 [debug] [Thread-2 (]: Writing runtime SQL for node "seed.dbt_exercise.employee_territories"
[0m18:27:26.073052 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '16611795-5c36-4c6f-bc0f-ef3ca53849ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x774e3dfdc710>]}
[0m18:27:26.075141 [info ] [Thread-2 (]: 5 of 14 OK loaded seed file dbt_dw.employee_territories ........................ [[32mINSERT 49[0m in 6.44s]
[0m18:27:26.077269 [debug] [Thread-2 (]: Finished running node seed.dbt_exercise.employee_territories
[0m18:27:26.078082 [debug] [Thread-2 (]: Began running node seed.dbt_exercise.products
[0m18:27:26.079138 [info ] [Thread-2 (]: 9 of 14 START seed file dbt_dw.products ........................................ [RUN]
[0m18:27:26.080006 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly seed.dbt_exercise.employee_territories, now seed.dbt_exercise.products)
[0m18:27:26.080689 [debug] [Thread-2 (]: Began compiling node seed.dbt_exercise.products
[0m18:27:26.081207 [debug] [Thread-2 (]: Began executing node seed.dbt_exercise.products
[0m18:27:26.090217 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:27:26.412806 [debug] [Thread-1 (]: On seed.dbt_exercise.employees: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "seed.dbt_exercise.employees"} */

    alter table `corded-sunlight-464012-e2`.`dbt_dw`.`employees` set OPTIONS()
  
[0m18:27:26.418608 [debug] [Thread-4 (]: On seed.dbt_exercise.orders: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "seed.dbt_exercise.orders"} */

    alter table `corded-sunlight-464012-e2`.`dbt_dw`.`orders` set OPTIONS()
  
[0m18:27:26.486237 [debug] [Thread-3 (]: On seed.dbt_exercise.order_details: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "seed.dbt_exercise.order_details"} */

    alter table `corded-sunlight-464012-e2`.`dbt_dw`.`order_details` set OPTIONS()
  
[0m18:27:26.815773 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:f9bc918d-a2b4-4b67-be01-d430b1164a2b&page=queryresults
[0m18:27:26.834400 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:d07e84a5-07f6-4d2c-a952-5a10e36fff68&page=queryresults
[0m18:27:26.928857 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:89e24ab4-15eb-4815-93bc-5464033c1b30&page=queryresults
[0m18:27:27.358714 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.dbt_exercise.employees"
[0m18:27:27.364854 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '16611795-5c36-4c6f-bc0f-ef3ca53849ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x774e3dfdee70>]}
[0m18:27:27.366103 [info ] [Thread-1 (]: 6 of 14 OK loaded seed file dbt_dw.employees ................................... [[32mINSERT 9[0m in 7.57s]
[0m18:27:27.368576 [debug] [Thread-1 (]: Finished running node seed.dbt_exercise.employees
[0m18:27:27.370292 [debug] [Thread-1 (]: Began running node seed.dbt_exercise.region
[0m18:27:27.372261 [info ] [Thread-1 (]: 10 of 14 START seed file dbt_dw.region ......................................... [RUN]
[0m18:27:27.375016 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.dbt_exercise.employees, now seed.dbt_exercise.region)
[0m18:27:27.376132 [debug] [Thread-1 (]: Began compiling node seed.dbt_exercise.region
[0m18:27:27.378453 [debug] [Thread-1 (]: Began executing node seed.dbt_exercise.region
[0m18:27:27.384696 [debug] [Thread-4 (]: Writing runtime SQL for node "seed.dbt_exercise.orders"
[0m18:27:27.387738 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:27:27.396280 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '16611795-5c36-4c6f-bc0f-ef3ca53849ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x774e3dd67ce0>]}
[0m18:27:27.397686 [info ] [Thread-4 (]: 8 of 14 OK loaded seed file dbt_dw.orders ...................................... [[32mINSERT 830[0m in 6.67s]
[0m18:27:27.399002 [debug] [Thread-4 (]: Finished running node seed.dbt_exercise.orders
[0m18:27:27.400199 [debug] [Thread-4 (]: Began running node seed.dbt_exercise.shippers
[0m18:27:27.401620 [info ] [Thread-4 (]: 11 of 14 START seed file dbt_dw.shippers ....................................... [RUN]
[0m18:27:27.403485 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly seed.dbt_exercise.orders, now seed.dbt_exercise.shippers)
[0m18:27:27.404402 [debug] [Thread-4 (]: Began compiling node seed.dbt_exercise.shippers
[0m18:27:27.407777 [debug] [Thread-4 (]: Began executing node seed.dbt_exercise.shippers
[0m18:27:27.460223 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m18:27:27.462722 [debug] [Thread-3 (]: Writing runtime SQL for node "seed.dbt_exercise.order_details"
[0m18:27:27.467494 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '16611795-5c36-4c6f-bc0f-ef3ca53849ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x774e3ded1e80>]}
[0m18:27:27.469813 [info ] [Thread-3 (]: 7 of 14 OK loaded seed file dbt_dw.order_details ............................... [[32mINSERT 2155[0m in 7.64s]
[0m18:27:27.472309 [debug] [Thread-3 (]: Finished running node seed.dbt_exercise.order_details
[0m18:27:27.473423 [debug] [Thread-3 (]: Began running node seed.dbt_exercise.suppliers
[0m18:27:27.474813 [info ] [Thread-3 (]: 12 of 14 START seed file dbt_dw.suppliers ...................................... [RUN]
[0m18:27:27.476312 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly seed.dbt_exercise.order_details, now seed.dbt_exercise.suppliers)
[0m18:27:27.478547 [debug] [Thread-3 (]: Began compiling node seed.dbt_exercise.suppliers
[0m18:27:27.479276 [debug] [Thread-3 (]: Began executing node seed.dbt_exercise.suppliers
[0m18:27:27.527632 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m18:27:31.113197 [debug] [Thread-2 (]: On seed.dbt_exercise.products: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "seed.dbt_exercise.products"} */

    alter table `corded-sunlight-464012-e2`.`dbt_dw`.`products` set OPTIONS()
  
[0m18:27:31.557977 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:20acb110-9cef-474f-81a5-cec9882978cd&page=queryresults
[0m18:27:32.071805 [debug] [Thread-2 (]: Writing runtime SQL for node "seed.dbt_exercise.products"
[0m18:27:32.078206 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '16611795-5c36-4c6f-bc0f-ef3ca53849ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x774e3dd72e70>]}
[0m18:27:32.081611 [info ] [Thread-2 (]: 9 of 14 OK loaded seed file dbt_dw.products .................................... [[32mINSERT 77[0m in 6.00s]
[0m18:27:32.085260 [debug] [Thread-1 (]: On seed.dbt_exercise.region: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "seed.dbt_exercise.region"} */

    alter table `corded-sunlight-464012-e2`.`dbt_dw`.`region` set OPTIONS()
  
[0m18:27:32.086589 [debug] [Thread-2 (]: Finished running node seed.dbt_exercise.products
[0m18:27:32.090108 [debug] [Thread-2 (]: Began running node seed.dbt_exercise.territories
[0m18:27:32.092577 [info ] [Thread-2 (]: 13 of 14 START seed file dbt_dw.territories .................................... [RUN]
[0m18:27:32.094031 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly seed.dbt_exercise.products, now seed.dbt_exercise.territories)
[0m18:27:32.095505 [debug] [Thread-2 (]: Began compiling node seed.dbt_exercise.territories
[0m18:27:32.096767 [debug] [Thread-2 (]: Began executing node seed.dbt_exercise.territories
[0m18:27:32.110296 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:27:32.499792 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:86df23d4-5408-4290-8dc3-599d608ca77d&page=queryresults
[0m18:27:33.017152 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.dbt_exercise.region"
[0m18:27:33.023765 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '16611795-5c36-4c6f-bc0f-ef3ca53849ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x774e3da59250>]}
[0m18:27:33.025476 [info ] [Thread-1 (]: 10 of 14 OK loaded seed file dbt_dw.region ..................................... [[32mINSERT 4[0m in 5.65s]
[0m18:27:33.026592 [debug] [Thread-1 (]: Finished running node seed.dbt_exercise.region
[0m18:27:33.027606 [debug] [Thread-1 (]: Began running node seed.dbt_exercise.us_states
[0m18:27:33.029202 [info ] [Thread-1 (]: 14 of 14 START seed file dbt_dw.us_states ...................................... [RUN]
[0m18:27:33.030390 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.dbt_exercise.region, now seed.dbt_exercise.us_states)
[0m18:27:33.031135 [debug] [Thread-1 (]: Began compiling node seed.dbt_exercise.us_states
[0m18:27:33.031675 [debug] [Thread-1 (]: Began executing node seed.dbt_exercise.us_states
[0m18:27:33.042027 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:27:33.049800 [debug] [Thread-4 (]: On seed.dbt_exercise.shippers: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "seed.dbt_exercise.shippers"} */

    alter table `corded-sunlight-464012-e2`.`dbt_dw`.`shippers` set OPTIONS()
  
[0m18:27:33.140879 [debug] [Thread-3 (]: On seed.dbt_exercise.suppliers: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "seed.dbt_exercise.suppliers"} */

    alter table `corded-sunlight-464012-e2`.`dbt_dw`.`suppliers` set OPTIONS()
  
[0m18:27:33.505956 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:d11ba092-b4a5-4c97-b786-66e0e7204df6&page=queryresults
[0m18:27:33.510685 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:1367d608-f094-4797-80db-45dd8df020b1&page=queryresults
[0m18:27:34.049700 [debug] [Thread-4 (]: Writing runtime SQL for node "seed.dbt_exercise.shippers"
[0m18:27:34.056708 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '16611795-5c36-4c6f-bc0f-ef3ca53849ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x774e3dd90a70>]}
[0m18:27:34.058464 [info ] [Thread-4 (]: 11 of 14 OK loaded seed file dbt_dw.shippers ................................... [[32mINSERT 6[0m in 6.65s]
[0m18:27:34.059882 [debug] [Thread-4 (]: Finished running node seed.dbt_exercise.shippers
[0m18:27:34.106786 [debug] [Thread-3 (]: Writing runtime SQL for node "seed.dbt_exercise.suppliers"
[0m18:27:34.114334 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '16611795-5c36-4c6f-bc0f-ef3ca53849ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x774e3dd80050>]}
[0m18:27:34.115509 [info ] [Thread-3 (]: 12 of 14 OK loaded seed file dbt_dw.suppliers .................................. [[32mINSERT 29[0m in 6.64s]
[0m18:27:34.119796 [debug] [Thread-3 (]: Finished running node seed.dbt_exercise.suppliers
[0m18:27:37.030854 [debug] [Thread-2 (]: On seed.dbt_exercise.territories: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "seed.dbt_exercise.territories"} */

    alter table `corded-sunlight-464012-e2`.`dbt_dw`.`territories` set OPTIONS()
  
[0m18:27:37.409060 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:e76d2715-f2f2-4d9f-a072-3d672e930efc&page=queryresults
[0m18:27:37.957568 [debug] [Thread-2 (]: Writing runtime SQL for node "seed.dbt_exercise.territories"
[0m18:27:37.962492 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '16611795-5c36-4c6f-bc0f-ef3ca53849ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x774e3dd90440>]}
[0m18:27:37.964115 [info ] [Thread-2 (]: 13 of 14 OK loaded seed file dbt_dw.territories ................................ [[32mINSERT 53[0m in 5.87s]
[0m18:27:37.966030 [debug] [Thread-2 (]: Finished running node seed.dbt_exercise.territories
[0m18:27:37.971321 [debug] [Thread-1 (]: On seed.dbt_exercise.us_states: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "seed.dbt_exercise.us_states"} */

    alter table `corded-sunlight-464012-e2`.`dbt_dw`.`us_states` set OPTIONS()
  
[0m18:27:38.400751 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:de215a01-fe25-404a-89cc-5e7040d29b04&page=queryresults
[0m18:27:38.949640 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.dbt_exercise.us_states"
[0m18:27:38.956262 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '16611795-5c36-4c6f-bc0f-ef3ca53849ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x774e3da98050>]}
[0m18:27:38.957083 [info ] [Thread-1 (]: 14 of 14 OK loaded seed file dbt_dw.us_states .................................. [[32mINSERT 51[0m in 5.93s]
[0m18:27:38.958008 [debug] [Thread-1 (]: Finished running node seed.dbt_exercise.us_states
[0m18:27:38.964376 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:27:38.975632 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:27:38.976703 [debug] [MainThread]: Connection 'seed.dbt_exercise.us_states' was properly closed.
[0m18:27:38.977348 [debug] [MainThread]: Connection 'seed.dbt_exercise.territories' was properly closed.
[0m18:27:38.977858 [debug] [MainThread]: Connection 'seed.dbt_exercise.suppliers' was properly closed.
[0m18:27:38.978262 [debug] [MainThread]: Connection 'seed.dbt_exercise.shippers' was properly closed.
[0m18:27:38.978804 [info ] [MainThread]: 
[0m18:27:38.979444 [info ] [MainThread]: Finished running 14 seeds in 0 hours 0 minutes and 35.52 seconds (35.52s).
[0m18:27:38.983251 [debug] [MainThread]: Command end result
[0m18:27:39.055038 [debug] [MainThread]: Wrote artifact WritableManifest to /home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/target/manifest.json
[0m18:27:39.078093 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/target/semantic_manifest.json
[0m18:27:39.089908 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/target/run_results.json
[0m18:27:39.090891 [info ] [MainThread]: 
[0m18:27:39.092296 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:27:39.093132 [info ] [MainThread]: 
[0m18:27:39.094027 [info ] [MainThread]: Done. PASS=14 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=14
[0m18:27:39.104562 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": true, "command_wall_clock_time": 160.67813, "process_in_blocks": "146168", "process_kernel_time": 18.443094, "process_mem_max_rss": "374448", "process_out_blocks": "4272", "process_user_time": 17.825167}
[0m18:27:39.105920 [debug] [MainThread]: Command `dbt seed` succeeded at 18:27:39.105655 after 160.68 seconds
[0m18:27:39.106846 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x774e8f8ef200>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x774e8c200950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x774e5316b170>]}
[0m18:27:39.107462 [debug] [MainThread]: Flushing usage events
[0m18:27:39.830013 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:38:13.303596 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a3ebf92e180>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a3ebf1ec500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a3ebf1c48c0>]}


============================== 09:38:13.325149 | f07a744e-efc0-461f-b53b-f6d0cb7a1cf8 ==============================
[0m09:38:13.325149 [info ] [MainThread]: Running with dbt=1.10.2
[0m09:38:13.326207 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt seed', 'send_anonymous_usage_stats': 'True'}
[0m09:39:32.408804 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f07a744e-efc0-461f-b53b-f6d0cb7a1cf8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a3e81da2060>]}
[0m09:39:32.608331 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f07a744e-efc0-461f-b53b-f6d0cb7a1cf8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a3e87069850>]}
[0m09:39:32.616040 [info ] [MainThread]: Registered adapter: bigquery=1.9.2
[0m09:41:44.311744 [debug] [MainThread]: checksum: 1adc40777973ef30f45f80b3b6d04d5013c1edd53d96363881b3b199e612468b, vars: {}, profile: , target: , version: 1.10.2
[0m09:41:44.723021 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m09:41:44.724360 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'f07a744e-efc0-461f-b53b-f6d0cb7a1cf8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a3e817d4740>]}
[0m09:42:06.238617 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.dbt_exercise.staging
- models.dbt_exercise.marts
- models.dbt_exercise.intermediate
[0m09:42:06.264945 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f07a744e-efc0-461f-b53b-f6d0cb7a1cf8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a3e5b49c800>]}
[0m09:42:06.529232 [debug] [MainThread]: Wrote artifact WritableManifest to /home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/target/manifest.json
[0m09:42:06.607908 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/target/semantic_manifest.json
[0m09:42:07.753597 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f07a744e-efc0-461f-b53b-f6d0cb7a1cf8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a3e5b389a90>]}
[0m09:42:07.756170 [info ] [MainThread]: Found 2 models, 14 seeds, 5 data tests, 2 sources, 609 macros
[0m09:42:07.757554 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f07a744e-efc0-461f-b53b-f6d0cb7a1cf8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a3e5b4d8b30>]}
[0m09:42:07.763138 [info ] [MainThread]: 
[0m09:42:07.764406 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m09:42:07.765858 [info ] [MainThread]: 
[0m09:42:07.769049 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m09:42:07.781759 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_corded-sunlight-464012-e2'
[0m09:42:07.784051 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:42:07.786356 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_corded-sunlight-464012-e2'
[0m09:42:07.788260 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:42:09.122323 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_corded-sunlight-464012-e2, now create_corded-sunlight-464012-e2_dbt_dw_dbt_dw_raw)
[0m09:42:09.123739 [debug] [ThreadPool]: Creating schema "database: "corded-sunlight-464012-e2"
schema: "dbt_dw_dbt_dw_raw"
"
[0m09:42:09.149567 [debug] [ThreadPool]: On create_corded-sunlight-464012-e2_dbt_dw_dbt_dw_raw: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "connection_name": "create_corded-sunlight-464012-e2_dbt_dw_dbt_dw_raw"} */
create schema if not exists `corded-sunlight-464012-e2`.`dbt_dw_dbt_dw_raw`
  
[0m09:42:09.150869 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:42:10.483567 [debug] [ThreadPool]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:ae22527c-b2d6-4155-b34d-cfd971f1ea1d&page=queryresults
[0m09:42:23.822296 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_corded-sunlight-464012-e2_dbt_dw_dbt_dw_raw, now list_corded-sunlight-464012-e2_dbt_dw)
[0m09:42:23.824255 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_corded-sunlight-464012-e2, now list_corded-sunlight-464012-e2_dbt_dw_dbt_dw_raw)
[0m09:42:23.827056 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:42:23.828637 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:42:24.849789 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f07a744e-efc0-461f-b53b-f6d0cb7a1cf8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a3e8183eb40>]}
[0m09:42:24.851085 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:42:24.896585 [debug] [Thread-1 (]: Began running node seed.dbt_exercise.categories
[0m09:42:24.898035 [debug] [Thread-2 (]: Began running node seed.dbt_exercise.country_codes
[0m09:42:24.900895 [debug] [Thread-3 (]: Began running node seed.dbt_exercise.customers
[0m09:42:24.902634 [debug] [Thread-4 (]: Began running node seed.dbt_exercise.dados_financeiros
[0m09:42:24.899552 [info ] [Thread-1 (]: 1 of 14 START seed file dbt_dw.categories ...................................... [RUN]
[0m09:42:24.905983 [info ] [Thread-2 (]: 2 of 14 START seed file dbt_dw.country_codes ................................... [RUN]
[0m09:42:24.908462 [info ] [Thread-3 (]: 3 of 14 START seed file dbt_dw.customers ....................................... [RUN]
[0m09:42:24.911047 [info ] [Thread-4 (]: 4 of 14 START seed file dbt_dw_dbt_dw_raw.dados_financeiros .................... [RUN]
[0m09:42:24.913327 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_corded-sunlight-464012-e2_dbt_dw_dbt_dw_raw, now seed.dbt_exercise.categories)
[0m09:42:24.914980 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_corded-sunlight-464012-e2_dbt_dw, now seed.dbt_exercise.country_codes)
[0m09:42:24.916515 [debug] [Thread-3 (]: Acquiring new bigquery connection 'seed.dbt_exercise.customers'
[0m09:42:24.918374 [debug] [Thread-4 (]: Acquiring new bigquery connection 'seed.dbt_exercise.dados_financeiros'
[0m09:42:24.920428 [debug] [Thread-1 (]: Began compiling node seed.dbt_exercise.categories
[0m09:42:24.922612 [debug] [Thread-2 (]: Began compiling node seed.dbt_exercise.country_codes
[0m09:42:24.924367 [debug] [Thread-3 (]: Began compiling node seed.dbt_exercise.customers
[0m09:42:24.925536 [debug] [Thread-4 (]: Began compiling node seed.dbt_exercise.dados_financeiros
[0m09:42:24.926674 [debug] [Thread-1 (]: Began executing node seed.dbt_exercise.categories
[0m09:42:24.927790 [debug] [Thread-2 (]: Began executing node seed.dbt_exercise.country_codes
[0m09:42:24.929240 [debug] [Thread-3 (]: Began executing node seed.dbt_exercise.customers
[0m09:42:24.930367 [debug] [Thread-4 (]: Began executing node seed.dbt_exercise.dados_financeiros
[0m09:42:25.186430 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m09:42:25.194953 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:42:25.201592 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m09:42:25.229528 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m09:42:31.086884 [debug] [Thread-1 (]: On seed.dbt_exercise.categories: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "seed.dbt_exercise.categories"} */

    alter table `corded-sunlight-464012-e2`.`dbt_dw`.`categories` set OPTIONS()
  
[0m09:42:31.282363 [debug] [Thread-3 (]: On seed.dbt_exercise.customers: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "seed.dbt_exercise.customers"} */

    alter table `corded-sunlight-464012-e2`.`dbt_dw`.`customers` set OPTIONS()
  
[0m09:42:31.289423 [debug] [Thread-4 (]: On seed.dbt_exercise.dados_financeiros: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "seed.dbt_exercise.dados_financeiros"} */

    alter table `corded-sunlight-464012-e2`.`dbt_dw_dbt_dw_raw`.`dados_financeiros` set OPTIONS()
  
[0m09:42:31.322122 [debug] [Thread-2 (]: On seed.dbt_exercise.country_codes: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "seed.dbt_exercise.country_codes"} */

    alter table `corded-sunlight-464012-e2`.`dbt_dw`.`country_codes` set OPTIONS()
  
[0m09:42:31.477274 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:a3774c45-3473-4e81-8767-2bc05eb14c98&page=queryresults
[0m09:42:31.675225 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:3cd838d3-839b-4509-a2ec-12e92965e709&page=queryresults
[0m09:42:31.706020 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:014741e1-3222-4e5c-91c1-4e3d72d81630&page=queryresults
[0m09:42:31.740800 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:2d6121f8-9a80-42f3-8144-8de8fcd326ea&page=queryresults
[0m09:42:32.024018 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.dbt_exercise.categories"
[0m09:42:32.138000 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f07a744e-efc0-461f-b53b-f6d0cb7a1cf8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a3e59ec7350>]}
[0m09:42:32.139399 [info ] [Thread-1 (]: 1 of 14 OK loaded seed file dbt_dw.categories .................................. [[32mINSERT 8[0m in 7.17s]
[0m09:42:32.141824 [debug] [Thread-1 (]: Finished running node seed.dbt_exercise.categories
[0m09:42:32.143520 [debug] [Thread-1 (]: Began running node seed.dbt_exercise.employee_territories
[0m09:42:32.145446 [info ] [Thread-1 (]: 5 of 14 START seed file dbt_dw.employee_territories ............................ [RUN]
[0m09:42:32.146778 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.dbt_exercise.categories, now seed.dbt_exercise.employee_territories)
[0m09:42:32.147952 [debug] [Thread-1 (]: Began compiling node seed.dbt_exercise.employee_territories
[0m09:42:32.149291 [debug] [Thread-1 (]: Began executing node seed.dbt_exercise.employee_territories
[0m09:42:32.161086 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:42:32.258964 [debug] [Thread-4 (]: Writing runtime SQL for node "seed.dbt_exercise.dados_financeiros"
[0m09:42:32.278743 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f07a744e-efc0-461f-b53b-f6d0cb7a1cf8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a3e59e453d0>]}
[0m09:42:32.280483 [info ] [Thread-4 (]: 4 of 14 OK loaded seed file dbt_dw_dbt_dw_raw.dados_financeiros ................ [[32mINSERT 190[0m in 7.36s]
[0m09:42:32.283741 [debug] [Thread-4 (]: Finished running node seed.dbt_exercise.dados_financeiros
[0m09:42:32.286064 [debug] [Thread-4 (]: Began running node seed.dbt_exercise.employees
[0m09:42:32.292241 [debug] [Thread-2 (]: Writing runtime SQL for node "seed.dbt_exercise.country_codes"
[0m09:42:32.287840 [info ] [Thread-4 (]: 6 of 14 START seed file dbt_dw.employees ....................................... [RUN]
[0m09:42:32.294403 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly seed.dbt_exercise.dados_financeiros, now seed.dbt_exercise.employees)
[0m09:42:32.295428 [debug] [Thread-4 (]: Began compiling node seed.dbt_exercise.employees
[0m09:42:32.297030 [debug] [Thread-4 (]: Began executing node seed.dbt_exercise.employees
[0m09:42:32.308984 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f07a744e-efc0-461f-b53b-f6d0cb7a1cf8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a3e5851eab0>]}
[0m09:42:32.315648 [info ] [Thread-2 (]: 2 of 14 OK loaded seed file dbt_dw.country_codes ............................... [[32mINSERT 3[0m in 7.39s]
[0m09:42:32.318489 [debug] [Thread-2 (]: Finished running node seed.dbt_exercise.country_codes
[0m09:42:32.323456 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m09:42:32.324813 [debug] [Thread-2 (]: Began running node seed.dbt_exercise.order_details
[0m09:42:32.327600 [info ] [Thread-2 (]: 7 of 14 START seed file dbt_dw.order_details ................................... [RUN]
[0m09:42:32.329146 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly seed.dbt_exercise.country_codes, now seed.dbt_exercise.order_details)
[0m09:42:32.331020 [debug] [Thread-2 (]: Began compiling node seed.dbt_exercise.order_details
[0m09:42:32.332747 [debug] [Thread-2 (]: Began executing node seed.dbt_exercise.order_details
[0m09:42:32.550273 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m09:42:32.639437 [debug] [Thread-3 (]: Writing runtime SQL for node "seed.dbt_exercise.customers"
[0m09:42:32.648864 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f07a744e-efc0-461f-b53b-f6d0cb7a1cf8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a3e585b1640>]}
[0m09:42:32.651443 [info ] [Thread-3 (]: 3 of 14 OK loaded seed file dbt_dw.customers ................................... [[32mINSERT 91[0m in 7.73s]
[0m09:42:32.656946 [debug] [Thread-3 (]: Finished running node seed.dbt_exercise.customers
[0m09:42:32.659064 [debug] [Thread-3 (]: Began running node seed.dbt_exercise.orders
[0m09:42:32.661970 [info ] [Thread-3 (]: 8 of 14 START seed file dbt_dw.orders .......................................... [RUN]
[0m09:42:32.664988 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly seed.dbt_exercise.customers, now seed.dbt_exercise.orders)
[0m09:42:32.666392 [debug] [Thread-3 (]: Began compiling node seed.dbt_exercise.orders
[0m09:42:32.668314 [debug] [Thread-3 (]: Began executing node seed.dbt_exercise.orders
[0m09:42:32.836749 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m09:42:37.315684 [debug] [Thread-4 (]: On seed.dbt_exercise.employees: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "seed.dbt_exercise.employees"} */

    alter table `corded-sunlight-464012-e2`.`dbt_dw`.`employees` set OPTIONS()
  
[0m09:42:37.452957 [debug] [Thread-1 (]: On seed.dbt_exercise.employee_territories: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "seed.dbt_exercise.employee_territories"} */

    alter table `corded-sunlight-464012-e2`.`dbt_dw`.`employee_territories` set OPTIONS()
  
[0m09:42:37.698730 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:5c4990a2-adbd-421e-a852-b2e20f9e9a8b&page=queryresults
[0m09:42:37.798222 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:74916be8-9826-4413-9040-1756dfd58ce1&page=queryresults
[0m09:42:38.230714 [debug] [Thread-4 (]: Writing runtime SQL for node "seed.dbt_exercise.employees"
[0m09:42:38.241069 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f07a744e-efc0-461f-b53b-f6d0cb7a1cf8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a3e5856d100>]}
[0m09:42:38.246476 [info ] [Thread-4 (]: 6 of 14 OK loaded seed file dbt_dw.employees ................................... [[32mINSERT 9[0m in 5.95s]
[0m09:42:38.250141 [debug] [Thread-4 (]: Finished running node seed.dbt_exercise.employees
[0m09:42:38.252201 [debug] [Thread-4 (]: Began running node seed.dbt_exercise.products
[0m09:42:38.255700 [info ] [Thread-4 (]: 9 of 14 START seed file dbt_dw.products ........................................ [RUN]
[0m09:42:38.258902 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly seed.dbt_exercise.employees, now seed.dbt_exercise.products)
[0m09:42:38.261792 [debug] [Thread-4 (]: Began compiling node seed.dbt_exercise.products
[0m09:42:38.263737 [debug] [Thread-4 (]: Began executing node seed.dbt_exercise.products
[0m09:42:38.299321 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m09:42:38.394633 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.dbt_exercise.employee_territories"
[0m09:42:38.404763 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f07a744e-efc0-461f-b53b-f6d0cb7a1cf8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a3e5851c2c0>]}
[0m09:42:38.406627 [info ] [Thread-1 (]: 5 of 14 OK loaded seed file dbt_dw.employee_territories ........................ [[32mINSERT 49[0m in 6.26s]
[0m09:42:38.409031 [debug] [Thread-1 (]: Finished running node seed.dbt_exercise.employee_territories
[0m09:42:38.410124 [debug] [Thread-1 (]: Began running node seed.dbt_exercise.region
[0m09:42:38.412175 [info ] [Thread-1 (]: 10 of 14 START seed file dbt_dw.region ......................................... [RUN]
[0m09:42:38.414736 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.dbt_exercise.employee_territories, now seed.dbt_exercise.region)
[0m09:42:38.416676 [debug] [Thread-1 (]: Began compiling node seed.dbt_exercise.region
[0m09:42:38.417924 [debug] [Thread-1 (]: Began executing node seed.dbt_exercise.region
[0m09:42:38.431336 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:42:38.540809 [debug] [Thread-2 (]: On seed.dbt_exercise.order_details: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "seed.dbt_exercise.order_details"} */

    alter table `corded-sunlight-464012-e2`.`dbt_dw`.`order_details` set OPTIONS()
  
[0m09:42:39.146677 [debug] [Thread-3 (]: On seed.dbt_exercise.orders: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "seed.dbt_exercise.orders"} */

    alter table `corded-sunlight-464012-e2`.`dbt_dw`.`orders` set OPTIONS()
  
[0m09:42:39.527082 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:37dfdaec-c441-4bd1-8813-a1e3ecd7abe3&page=queryresults
[0m09:42:39.615512 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:b768f0db-fa0b-4bb5-97e5-ce539308fe4a&page=queryresults
[0m09:42:40.120434 [debug] [Thread-3 (]: Writing runtime SQL for node "seed.dbt_exercise.orders"
[0m09:42:40.134766 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f07a744e-efc0-461f-b53b-f6d0cb7a1cf8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a3e58235b20>]}
[0m09:42:40.136611 [info ] [Thread-3 (]: 8 of 14 OK loaded seed file dbt_dw.orders ...................................... [[32mINSERT 830[0m in 7.47s]
[0m09:42:40.138881 [debug] [Thread-3 (]: Finished running node seed.dbt_exercise.orders
[0m09:42:40.140836 [debug] [Thread-3 (]: Began running node seed.dbt_exercise.shippers
[0m09:42:40.143314 [info ] [Thread-3 (]: 11 of 14 START seed file dbt_dw.shippers ....................................... [RUN]
[0m09:42:40.146524 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly seed.dbt_exercise.orders, now seed.dbt_exercise.shippers)
[0m09:42:40.148624 [debug] [Thread-3 (]: Began compiling node seed.dbt_exercise.shippers
[0m09:42:40.150693 [debug] [Thread-3 (]: Began executing node seed.dbt_exercise.shippers
[0m09:42:40.162835 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m09:42:40.314280 [debug] [Thread-2 (]: Writing runtime SQL for node "seed.dbt_exercise.order_details"
[0m09:42:40.336278 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f07a744e-efc0-461f-b53b-f6d0cb7a1cf8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a3e5855d130>]}
[0m09:42:40.338584 [info ] [Thread-2 (]: 7 of 14 OK loaded seed file dbt_dw.order_details ............................... [[32mINSERT 2155[0m in 8.01s]
[0m09:42:40.341539 [debug] [Thread-2 (]: Finished running node seed.dbt_exercise.order_details
[0m09:42:40.344252 [debug] [Thread-2 (]: Began running node seed.dbt_exercise.suppliers
[0m09:42:40.346694 [info ] [Thread-2 (]: 12 of 14 START seed file dbt_dw.suppliers ...................................... [RUN]
[0m09:42:40.349427 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly seed.dbt_exercise.order_details, now seed.dbt_exercise.suppliers)
[0m09:42:40.351173 [debug] [Thread-2 (]: Began compiling node seed.dbt_exercise.suppliers
[0m09:42:40.353123 [debug] [Thread-2 (]: Began executing node seed.dbt_exercise.suppliers
[0m09:42:40.369348 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m09:42:43.318855 [debug] [Thread-1 (]: On seed.dbt_exercise.region: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "seed.dbt_exercise.region"} */

    alter table `corded-sunlight-464012-e2`.`dbt_dw`.`region` set OPTIONS()
  
[0m09:42:43.565967 [debug] [Thread-4 (]: On seed.dbt_exercise.products: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "seed.dbt_exercise.products"} */

    alter table `corded-sunlight-464012-e2`.`dbt_dw`.`products` set OPTIONS()
  
[0m09:42:43.731194 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:2e8537aa-ca95-4259-946e-ce1500ad19f6&page=queryresults
[0m09:42:43.973963 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:eff54812-764b-438f-8a05-59e080808394&page=queryresults
[0m09:42:44.220308 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.dbt_exercise.region"
[0m09:42:44.226985 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f07a744e-efc0-461f-b53b-f6d0cb7a1cf8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a3e58272330>]}
[0m09:42:44.228740 [info ] [Thread-1 (]: 10 of 14 OK loaded seed file dbt_dw.region ..................................... [[32mINSERT 4[0m in 5.81s]
[0m09:42:44.232175 [debug] [Thread-1 (]: Finished running node seed.dbt_exercise.region
[0m09:42:44.233630 [debug] [Thread-1 (]: Began running node seed.dbt_exercise.territories
[0m09:42:44.235262 [info ] [Thread-1 (]: 13 of 14 START seed file dbt_dw.territories .................................... [RUN]
[0m09:42:44.237417 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.dbt_exercise.region, now seed.dbt_exercise.territories)
[0m09:42:44.239601 [debug] [Thread-1 (]: Began compiling node seed.dbt_exercise.territories
[0m09:42:44.241486 [debug] [Thread-1 (]: Began executing node seed.dbt_exercise.territories
[0m09:42:44.254378 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:42:44.464003 [debug] [Thread-4 (]: Writing runtime SQL for node "seed.dbt_exercise.products"
[0m09:42:44.471481 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f07a744e-efc0-461f-b53b-f6d0cb7a1cf8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a3e58552d80>]}
[0m09:42:44.473059 [info ] [Thread-4 (]: 9 of 14 OK loaded seed file dbt_dw.products .................................... [[32mINSERT 77[0m in 6.21s]
[0m09:42:44.474580 [debug] [Thread-4 (]: Finished running node seed.dbt_exercise.products
[0m09:42:44.475809 [debug] [Thread-4 (]: Began running node seed.dbt_exercise.us_states
[0m09:42:44.477900 [info ] [Thread-4 (]: 14 of 14 START seed file dbt_dw.us_states ...................................... [RUN]
[0m09:42:44.479729 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly seed.dbt_exercise.products, now seed.dbt_exercise.us_states)
[0m09:42:44.481749 [debug] [Thread-4 (]: Began compiling node seed.dbt_exercise.us_states
[0m09:42:44.483107 [debug] [Thread-4 (]: Began executing node seed.dbt_exercise.us_states
[0m09:42:44.494538 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m09:42:45.422143 [debug] [Thread-3 (]: On seed.dbt_exercise.shippers: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "seed.dbt_exercise.shippers"} */

    alter table `corded-sunlight-464012-e2`.`dbt_dw`.`shippers` set OPTIONS()
  
[0m09:42:45.909026 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:f21be0c3-2025-463b-a974-74a1de7c9a6d&page=queryresults
[0m09:42:46.396870 [debug] [Thread-2 (]: On seed.dbt_exercise.suppliers: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "seed.dbt_exercise.suppliers"} */

    alter table `corded-sunlight-464012-e2`.`dbt_dw`.`suppliers` set OPTIONS()
  
[0m09:42:46.417416 [debug] [Thread-3 (]: Writing runtime SQL for node "seed.dbt_exercise.shippers"
[0m09:42:46.426751 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f07a744e-efc0-461f-b53b-f6d0cb7a1cf8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a3e58281370>]}
[0m09:42:46.429200 [info ] [Thread-3 (]: 11 of 14 OK loaded seed file dbt_dw.shippers ................................... [[32mINSERT 6[0m in 6.28s]
[0m09:42:46.431848 [debug] [Thread-3 (]: Finished running node seed.dbt_exercise.shippers
[0m09:42:46.796015 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:97e33a8e-a7eb-4579-b248-ba1810ed2f38&page=queryresults
[0m09:42:47.341200 [debug] [Thread-2 (]: Writing runtime SQL for node "seed.dbt_exercise.suppliers"
[0m09:42:47.346725 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f07a744e-efc0-461f-b53b-f6d0cb7a1cf8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a3e58271310>]}
[0m09:42:47.348094 [info ] [Thread-2 (]: 12 of 14 OK loaded seed file dbt_dw.suppliers .................................. [[32mINSERT 29[0m in 7.00s]
[0m09:42:47.350377 [debug] [Thread-2 (]: Finished running node seed.dbt_exercise.suppliers
[0m09:42:48.978338 [debug] [Thread-1 (]: On seed.dbt_exercise.territories: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "seed.dbt_exercise.territories"} */

    alter table `corded-sunlight-464012-e2`.`dbt_dw`.`territories` set OPTIONS()
  
[0m09:42:49.417699 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:8d251c54-037d-4e1f-b143-2ad18d48f198&page=queryresults
[0m09:42:51.338612 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.dbt_exercise.territories"
[0m09:42:51.348269 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f07a744e-efc0-461f-b53b-f6d0cb7a1cf8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a3e582a8ef0>]}
[0m09:42:51.349662 [info ] [Thread-1 (]: 13 of 14 OK loaded seed file dbt_dw.territories ................................ [[32mINSERT 53[0m in 7.11s]
[0m09:42:51.352389 [debug] [Thread-1 (]: Finished running node seed.dbt_exercise.territories
[0m09:42:51.435691 [debug] [Thread-4 (]: On seed.dbt_exercise.us_states: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "seed.dbt_exercise.us_states"} */

    alter table `corded-sunlight-464012-e2`.`dbt_dw`.`us_states` set OPTIONS()
  
[0m09:42:51.822842 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:a22121f2-3132-4370-a0b3-b07151b488dc&page=queryresults
[0m09:42:52.335847 [debug] [Thread-4 (]: Writing runtime SQL for node "seed.dbt_exercise.us_states"
[0m09:42:52.342034 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f07a744e-efc0-461f-b53b-f6d0cb7a1cf8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a3e582a9220>]}
[0m09:42:52.343656 [info ] [Thread-4 (]: 14 of 14 OK loaded seed file dbt_dw.us_states .................................. [[32mINSERT 51[0m in 7.86s]
[0m09:42:52.346062 [debug] [Thread-4 (]: Finished running node seed.dbt_exercise.us_states
[0m09:42:52.353460 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m09:42:52.367193 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:42:52.368929 [debug] [MainThread]: Connection 'seed.dbt_exercise.suppliers' was properly closed.
[0m09:42:52.370284 [debug] [MainThread]: Connection 'seed.dbt_exercise.territories' was properly closed.
[0m09:42:52.371715 [debug] [MainThread]: Connection 'seed.dbt_exercise.shippers' was properly closed.
[0m09:42:52.373086 [debug] [MainThread]: Connection 'seed.dbt_exercise.us_states' was properly closed.
[0m09:42:52.374070 [info ] [MainThread]: 
[0m09:42:52.375205 [info ] [MainThread]: Finished running 14 seeds in 0 hours 0 minutes and 44.61 seconds (44.61s).
[0m09:42:52.383838 [debug] [MainThread]: Command end result
[0m09:42:52.475191 [debug] [MainThread]: Wrote artifact WritableManifest to /home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/target/manifest.json
[0m09:42:52.500883 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/target/semantic_manifest.json
[0m09:42:52.519055 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/target/run_results.json
[0m09:42:52.520143 [info ] [MainThread]: 
[0m09:42:52.521437 [info ] [MainThread]: [32mCompleted successfully[0m
[0m09:42:52.522793 [info ] [MainThread]: 
[0m09:42:52.524479 [info ] [MainThread]: Done. PASS=14 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=14
[0m09:42:52.535041 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": true, "command_wall_clock_time": 266.87604, "process_in_blocks": "130016", "process_kernel_time": 27.968687, "process_mem_max_rss": "380528", "process_out_blocks": "4264", "process_user_time": 25.514032}
[0m09:42:52.536731 [debug] [MainThread]: Command `dbt seed` succeeded at 09:42:52.536342 after 266.88 seconds
[0m09:42:52.537823 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a3ebfd93e30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a3e582a7fb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a3ebfe1bf80>]}
[0m09:42:52.538802 [debug] [MainThread]: Flushing usage events
[0m09:42:52.956529 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:45:57.139960 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x704114d297f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x704115969760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7041154e78f0>]}


============================== 09:45:57.180789 | 936407fc-a6e4-40f5-b8e0-ab06b26cd2ae ==============================
[0m09:45:57.180789 [info ] [MainThread]: Running with dbt=1.10.2
[0m09:45:57.182322 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/logs', 'version_check': 'True', 'profiles_dir': '/home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt seed', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m09:47:54.762282 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '936407fc-a6e4-40f5-b8e0-ab06b26cd2ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7040d7b27800>]}
[0m09:47:54.942266 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '936407fc-a6e4-40f5-b8e0-ab06b26cd2ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x704114c57200>]}
[0m09:47:54.949840 [info ] [MainThread]: Registered adapter: bigquery=1.9.2
[0m09:50:07.649646 [debug] [MainThread]: checksum: 1adc40777973ef30f45f80b3b6d04d5013c1edd53d96363881b3b199e612468b, vars: {}, profile: , target: , version: 1.10.2
[0m09:50:08.098043 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m09:50:08.100592 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '936407fc-a6e4-40f5-b8e0-ab06b26cd2ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7040d7d45460>]}
[0m09:50:27.497994 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 3 unused configuration paths:
- models.dbt_exercise.staging
- models.dbt_exercise.intermediate
- models.dbt_exercise.marts
[0m09:50:27.526048 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '936407fc-a6e4-40f5-b8e0-ab06b26cd2ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7040d5644500>]}
[0m09:50:27.782164 [debug] [MainThread]: Wrote artifact WritableManifest to /home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/target/manifest.json
[0m09:50:27.810235 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/target/semantic_manifest.json
[0m09:50:28.803612 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '936407fc-a6e4-40f5-b8e0-ab06b26cd2ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7040d533a3f0>]}
[0m09:50:28.804776 [info ] [MainThread]: Found 2 models, 14 seeds, 5 data tests, 2 sources, 609 macros
[0m09:50:28.805775 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '936407fc-a6e4-40f5-b8e0-ab06b26cd2ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7040d549d8e0>]}
[0m09:50:28.813333 [info ] [MainThread]: 
[0m09:50:28.814432 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m09:50:28.815548 [info ] [MainThread]: 
[0m09:50:28.817679 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m09:50:28.831487 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_corded-sunlight-464012-e2'
[0m09:50:28.832985 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:50:30.029315 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_corded-sunlight-464012-e2, now list_corded-sunlight-464012-e2_dbt_dw)
[0m09:50:30.031841 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:50:30.033348 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_corded-sunlight-464012-e2_dbt_dw_raw'
[0m09:50:30.035330 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:50:31.135205 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '936407fc-a6e4-40f5-b8e0-ab06b26cd2ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7040d81884d0>]}
[0m09:50:31.139651 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:50:31.171246 [debug] [Thread-1 (]: Began running node seed.dbt_exercise.categories
[0m09:50:31.172729 [debug] [Thread-2 (]: Began running node seed.dbt_exercise.country_codes
[0m09:50:31.173997 [debug] [Thread-3 (]: Began running node seed.dbt_exercise.customers
[0m09:50:31.177513 [debug] [Thread-4 (]: Began running node seed.dbt_exercise.dados_financeiros
[0m09:50:31.175740 [info ] [Thread-1 (]: 1 of 14 START seed file dbt_dw_raw.categories .................................. [RUN]
[0m09:50:31.180518 [info ] [Thread-2 (]: 2 of 14 START seed file dbt_dw_raw.country_codes ............................... [RUN]
[0m09:50:31.183975 [info ] [Thread-3 (]: 3 of 14 START seed file dbt_dw_raw.customers ................................... [RUN]
[0m09:50:31.187576 [info ] [Thread-4 (]: 4 of 14 START seed file dbt_dw_raw.dados_financeiros ........................... [RUN]
[0m09:50:31.189407 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_corded-sunlight-464012-e2_dbt_dw_raw, now seed.dbt_exercise.categories)
[0m09:50:31.191210 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_corded-sunlight-464012-e2_dbt_dw, now seed.dbt_exercise.country_codes)
[0m09:50:31.193744 [debug] [Thread-3 (]: Acquiring new bigquery connection 'seed.dbt_exercise.customers'
[0m09:50:31.196137 [debug] [Thread-4 (]: Acquiring new bigquery connection 'seed.dbt_exercise.dados_financeiros'
[0m09:50:31.198169 [debug] [Thread-1 (]: Began compiling node seed.dbt_exercise.categories
[0m09:50:31.200978 [debug] [Thread-2 (]: Began compiling node seed.dbt_exercise.country_codes
[0m09:50:31.203005 [debug] [Thread-3 (]: Began compiling node seed.dbt_exercise.customers
[0m09:50:31.204809 [debug] [Thread-4 (]: Began compiling node seed.dbt_exercise.dados_financeiros
[0m09:50:31.206373 [debug] [Thread-1 (]: Began executing node seed.dbt_exercise.categories
[0m09:50:31.208374 [debug] [Thread-2 (]: Began executing node seed.dbt_exercise.country_codes
[0m09:50:31.209813 [debug] [Thread-3 (]: Began executing node seed.dbt_exercise.customers
[0m09:50:31.211138 [debug] [Thread-4 (]: Began executing node seed.dbt_exercise.dados_financeiros
[0m09:50:42.098064 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m09:50:42.104970 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:50:42.108163 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m09:50:42.143906 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m09:50:46.766243 [debug] [Thread-1 (]: On seed.dbt_exercise.categories: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "seed.dbt_exercise.categories"} */

    alter table `corded-sunlight-464012-e2`.`dbt_dw_raw`.`categories` set OPTIONS()
  
[0m09:50:47.141544 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:995a7acb-5b75-444e-9eb5-caf44013f891&page=queryresults
[0m09:50:47.576753 [debug] [Thread-2 (]: On seed.dbt_exercise.country_codes: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "seed.dbt_exercise.country_codes"} */

    alter table `corded-sunlight-464012-e2`.`dbt_dw_raw`.`country_codes` set OPTIONS()
  
[0m09:50:47.661681 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.dbt_exercise.categories"
[0m09:50:47.761120 [debug] [Thread-4 (]: On seed.dbt_exercise.dados_financeiros: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "seed.dbt_exercise.dados_financeiros"} */

    alter table `corded-sunlight-464012-e2`.`dbt_dw_raw`.`dados_financeiros` set OPTIONS()
  
[0m09:50:47.789699 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '936407fc-a6e4-40f5-b8e0-ab06b26cd2ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70411746d5e0>]}
[0m09:50:47.791343 [info ] [Thread-1 (]: 1 of 14 OK loaded seed file dbt_dw_raw.categories .............................. [[32mINSERT 8[0m in 16.57s]
[0m09:50:47.793791 [debug] [Thread-1 (]: Finished running node seed.dbt_exercise.categories
[0m09:50:47.795622 [debug] [Thread-1 (]: Began running node seed.dbt_exercise.employee_territories
[0m09:50:47.798034 [info ] [Thread-1 (]: 5 of 14 START seed file dbt_dw_raw.employee_territories ........................ [RUN]
[0m09:50:47.799913 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.dbt_exercise.categories, now seed.dbt_exercise.employee_territories)
[0m09:50:47.801406 [debug] [Thread-1 (]: Began compiling node seed.dbt_exercise.employee_territories
[0m09:50:47.802891 [debug] [Thread-1 (]: Began executing node seed.dbt_exercise.employee_territories
[0m09:50:47.814047 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:50:48.020045 [debug] [Thread-3 (]: On seed.dbt_exercise.customers: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "seed.dbt_exercise.customers"} */

    alter table `corded-sunlight-464012-e2`.`dbt_dw_raw`.`customers` set OPTIONS()
  
[0m09:50:48.026242 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:fda2a914-ed81-4b7e-994a-6241715c1f3a&page=queryresults
[0m09:50:48.173982 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:bdb80e1e-b7a0-4ebb-868f-775901e510bf&page=queryresults
[0m09:50:48.481283 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:c55e64fd-0f90-48b0-9388-894359804f60&page=queryresults
[0m09:50:48.546903 [debug] [Thread-2 (]: Writing runtime SQL for node "seed.dbt_exercise.country_codes"
[0m09:50:48.574314 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '936407fc-a6e4-40f5-b8e0-ab06b26cd2ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7040d5255e20>]}
[0m09:50:48.576607 [info ] [Thread-2 (]: 2 of 14 OK loaded seed file dbt_dw_raw.country_codes ........................... [[32mINSERT 3[0m in 17.38s]
[0m09:50:48.579372 [debug] [Thread-2 (]: Finished running node seed.dbt_exercise.country_codes
[0m09:50:48.580610 [debug] [Thread-2 (]: Began running node seed.dbt_exercise.employees
[0m09:50:48.582220 [info ] [Thread-2 (]: 6 of 14 START seed file dbt_dw_raw.employees ................................... [RUN]
[0m09:50:48.584683 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly seed.dbt_exercise.country_codes, now seed.dbt_exercise.employees)
[0m09:50:48.586488 [debug] [Thread-2 (]: Began compiling node seed.dbt_exercise.employees
[0m09:50:48.588281 [debug] [Thread-2 (]: Began executing node seed.dbt_exercise.employees
[0m09:50:48.601663 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m09:50:48.725635 [debug] [Thread-4 (]: Writing runtime SQL for node "seed.dbt_exercise.dados_financeiros"
[0m09:50:48.731969 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '936407fc-a6e4-40f5-b8e0-ab06b26cd2ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7040b552de50>]}
[0m09:50:48.733403 [info ] [Thread-4 (]: 4 of 14 OK loaded seed file dbt_dw_raw.dados_financeiros ....................... [[32mINSERT 190[0m in 17.54s]
[0m09:50:48.735103 [debug] [Thread-4 (]: Finished running node seed.dbt_exercise.dados_financeiros
[0m09:50:48.736813 [debug] [Thread-4 (]: Began running node seed.dbt_exercise.order_details
[0m09:50:48.739236 [info ] [Thread-4 (]: 7 of 14 START seed file dbt_dw_raw.order_details ............................... [RUN]
[0m09:50:48.741299 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly seed.dbt_exercise.dados_financeiros, now seed.dbt_exercise.order_details)
[0m09:50:48.742405 [debug] [Thread-4 (]: Began compiling node seed.dbt_exercise.order_details
[0m09:50:48.743495 [debug] [Thread-4 (]: Began executing node seed.dbt_exercise.order_details
[0m09:50:48.872533 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m09:50:49.002116 [debug] [Thread-3 (]: Writing runtime SQL for node "seed.dbt_exercise.customers"
[0m09:50:49.015737 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '936407fc-a6e4-40f5-b8e0-ab06b26cd2ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7040b565bef0>]}
[0m09:50:49.017515 [info ] [Thread-3 (]: 3 of 14 OK loaded seed file dbt_dw_raw.customers ............................... [[32mINSERT 91[0m in 17.82s]
[0m09:50:49.019920 [debug] [Thread-3 (]: Finished running node seed.dbt_exercise.customers
[0m09:50:49.021434 [debug] [Thread-3 (]: Began running node seed.dbt_exercise.orders
[0m09:50:49.023881 [info ] [Thread-3 (]: 8 of 14 START seed file dbt_dw_raw.orders ...................................... [RUN]
[0m09:50:49.025996 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly seed.dbt_exercise.customers, now seed.dbt_exercise.orders)
[0m09:50:49.027452 [debug] [Thread-3 (]: Began compiling node seed.dbt_exercise.orders
[0m09:50:49.028527 [debug] [Thread-3 (]: Began executing node seed.dbt_exercise.orders
[0m09:50:49.200307 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m09:50:53.874540 [debug] [Thread-2 (]: On seed.dbt_exercise.employees: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "seed.dbt_exercise.employees"} */

    alter table `corded-sunlight-464012-e2`.`dbt_dw_raw`.`employees` set OPTIONS()
  
[0m09:50:54.288410 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:e7b1b020-2112-42a2-9f93-256f6cc7025e&page=queryresults
[0m09:50:54.811394 [debug] [Thread-2 (]: Writing runtime SQL for node "seed.dbt_exercise.employees"
[0m09:50:54.819188 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '936407fc-a6e4-40f5-b8e0-ab06b26cd2ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7040b55b6180>]}
[0m09:50:54.820689 [info ] [Thread-2 (]: 6 of 14 OK loaded seed file dbt_dw_raw.employees ............................... [[32mINSERT 9[0m in 6.23s]
[0m09:50:54.822567 [debug] [Thread-2 (]: Finished running node seed.dbt_exercise.employees
[0m09:50:54.824288 [debug] [Thread-2 (]: Began running node seed.dbt_exercise.products
[0m09:50:54.826526 [info ] [Thread-2 (]: 9 of 14 START seed file dbt_dw_raw.products .................................... [RUN]
[0m09:50:54.828963 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly seed.dbt_exercise.employees, now seed.dbt_exercise.products)
[0m09:50:54.830364 [debug] [Thread-2 (]: Began compiling node seed.dbt_exercise.products
[0m09:50:54.831781 [debug] [Thread-2 (]: Began executing node seed.dbt_exercise.products
[0m09:50:54.849401 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m09:50:54.946145 [debug] [Thread-4 (]: On seed.dbt_exercise.order_details: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "seed.dbt_exercise.order_details"} */

    alter table `corded-sunlight-464012-e2`.`dbt_dw_raw`.`order_details` set OPTIONS()
  
[0m09:50:55.357430 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:dec7fe1e-a1a3-4fce-ab27-7d70f38f7745&page=queryresults
[0m09:50:55.867808 [debug] [Thread-4 (]: Writing runtime SQL for node "seed.dbt_exercise.order_details"
[0m09:50:55.871766 [debug] [Thread-1 (]: On seed.dbt_exercise.employee_territories: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "seed.dbt_exercise.employee_territories"} */

    alter table `corded-sunlight-464012-e2`.`dbt_dw_raw`.`employee_territories` set OPTIONS()
  
[0m09:50:55.882943 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '936407fc-a6e4-40f5-b8e0-ab06b26cd2ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7040b55b5a30>]}
[0m09:50:55.885219 [info ] [Thread-4 (]: 7 of 14 OK loaded seed file dbt_dw_raw.order_details ........................... [[32mINSERT 2155[0m in 7.14s]
[0m09:50:55.887587 [debug] [Thread-4 (]: Finished running node seed.dbt_exercise.order_details
[0m09:50:55.891191 [debug] [Thread-4 (]: Began running node seed.dbt_exercise.region
[0m09:50:55.892994 [info ] [Thread-4 (]: 10 of 14 START seed file dbt_dw_raw.region ..................................... [RUN]
[0m09:50:55.895952 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly seed.dbt_exercise.order_details, now seed.dbt_exercise.region)
[0m09:50:55.898598 [debug] [Thread-4 (]: Began compiling node seed.dbt_exercise.region
[0m09:50:55.900846 [debug] [Thread-4 (]: Began executing node seed.dbt_exercise.region
[0m09:50:55.917055 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m09:50:56.267009 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:6218499f-f527-4aea-9bc1-e11880e8acff&page=queryresults
[0m09:50:56.767128 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.dbt_exercise.employee_territories"
[0m09:50:56.775626 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '936407fc-a6e4-40f5-b8e0-ab06b26cd2ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7040b552f8c0>]}
[0m09:50:56.777716 [info ] [Thread-1 (]: 5 of 14 OK loaded seed file dbt_dw_raw.employee_territories .................... [[32mINSERT 49[0m in 8.98s]
[0m09:50:56.779860 [debug] [Thread-1 (]: Finished running node seed.dbt_exercise.employee_territories
[0m09:50:56.781205 [debug] [Thread-1 (]: Began running node seed.dbt_exercise.shippers
[0m09:50:56.783208 [info ] [Thread-1 (]: 11 of 14 START seed file dbt_dw_raw.shippers ................................... [RUN]
[0m09:50:56.785125 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.dbt_exercise.employee_territories, now seed.dbt_exercise.shippers)
[0m09:50:56.786198 [debug] [Thread-1 (]: Began compiling node seed.dbt_exercise.shippers
[0m09:50:56.787407 [debug] [Thread-1 (]: Began executing node seed.dbt_exercise.shippers
[0m09:50:56.797666 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:50:58.287798 [debug] [Thread-3 (]: On seed.dbt_exercise.orders: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "seed.dbt_exercise.orders"} */

    alter table `corded-sunlight-464012-e2`.`dbt_dw_raw`.`orders` set OPTIONS()
  
[0m09:50:58.741738 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:b791f86b-b313-4503-8b0e-48dddbdfed0b&page=queryresults
[0m09:50:59.292536 [debug] [Thread-3 (]: Writing runtime SQL for node "seed.dbt_exercise.orders"
[0m09:50:59.322971 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '936407fc-a6e4-40f5-b8e0-ab06b26cd2ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7040b5100050>]}
[0m09:50:59.326324 [info ] [Thread-3 (]: 8 of 14 OK loaded seed file dbt_dw_raw.orders .................................. [[32mINSERT 830[0m in 10.30s]
[0m09:50:59.332481 [debug] [Thread-3 (]: Finished running node seed.dbt_exercise.orders
[0m09:50:59.334611 [debug] [Thread-3 (]: Began running node seed.dbt_exercise.suppliers
[0m09:50:59.337238 [info ] [Thread-3 (]: 12 of 14 START seed file dbt_dw_raw.suppliers .................................. [RUN]
[0m09:50:59.339357 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly seed.dbt_exercise.orders, now seed.dbt_exercise.suppliers)
[0m09:50:59.340776 [debug] [Thread-3 (]: Began compiling node seed.dbt_exercise.suppliers
[0m09:50:59.342219 [debug] [Thread-3 (]: Began executing node seed.dbt_exercise.suppliers
[0m09:50:59.356068 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m09:51:02.163764 [debug] [Thread-2 (]: On seed.dbt_exercise.products: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "seed.dbt_exercise.products"} */

    alter table `corded-sunlight-464012-e2`.`dbt_dw_raw`.`products` set OPTIONS()
  
[0m09:51:02.572129 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:c8ed21db-45f2-48d7-8301-3e439bc611e1&page=queryresults
[0m09:51:03.182474 [debug] [Thread-2 (]: Writing runtime SQL for node "seed.dbt_exercise.products"
[0m09:51:03.193045 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '936407fc-a6e4-40f5-b8e0-ab06b26cd2ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7040b520d010>]}
[0m09:51:03.195351 [info ] [Thread-2 (]: 9 of 14 OK loaded seed file dbt_dw_raw.products ................................ [[32mINSERT 77[0m in 8.36s]
[0m09:51:03.197999 [debug] [Thread-2 (]: Finished running node seed.dbt_exercise.products
[0m09:51:03.199287 [debug] [Thread-2 (]: Began running node seed.dbt_exercise.territories
[0m09:51:03.200861 [info ] [Thread-2 (]: 13 of 14 START seed file dbt_dw_raw.territories ................................ [RUN]
[0m09:51:03.202255 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly seed.dbt_exercise.products, now seed.dbt_exercise.territories)
[0m09:51:03.204626 [debug] [Thread-2 (]: Began compiling node seed.dbt_exercise.territories
[0m09:51:03.205811 [debug] [Thread-2 (]: Began executing node seed.dbt_exercise.territories
[0m09:51:03.219796 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m09:51:04.197424 [debug] [Thread-4 (]: On seed.dbt_exercise.region: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "seed.dbt_exercise.region"} */

    alter table `corded-sunlight-464012-e2`.`dbt_dw_raw`.`region` set OPTIONS()
  
[0m09:51:04.303389 [debug] [Thread-1 (]: On seed.dbt_exercise.shippers: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "seed.dbt_exercise.shippers"} */

    alter table `corded-sunlight-464012-e2`.`dbt_dw_raw`.`shippers` set OPTIONS()
  
[0m09:51:04.631511 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:279e6956-c57e-4427-b1fb-a6fc7bddebc7&page=queryresults
[0m09:51:04.677268 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:b25ee32e-25e0-4107-a822-78a9541d0ca9&page=queryresults
[0m09:51:05.134097 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.dbt_exercise.shippers"
[0m09:51:05.145579 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '936407fc-a6e4-40f5-b8e0-ab06b26cd2ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7040b52f28a0>]}
[0m09:51:05.148431 [info ] [Thread-1 (]: 11 of 14 OK loaded seed file dbt_dw_raw.shippers ............................... [[32mINSERT 6[0m in 8.36s]
[0m09:51:05.150419 [debug] [Thread-1 (]: Finished running node seed.dbt_exercise.shippers
[0m09:51:05.152015 [debug] [Thread-1 (]: Began running node seed.dbt_exercise.us_states
[0m09:51:05.154108 [info ] [Thread-1 (]: 14 of 14 START seed file dbt_dw_raw.us_states .................................. [RUN]
[0m09:51:05.155670 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.dbt_exercise.shippers, now seed.dbt_exercise.us_states)
[0m09:51:05.156744 [debug] [Thread-1 (]: Began compiling node seed.dbt_exercise.us_states
[0m09:51:05.157724 [debug] [Thread-1 (]: Began executing node seed.dbt_exercise.us_states
[0m09:51:05.169221 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:51:05.255778 [debug] [Thread-4 (]: Writing runtime SQL for node "seed.dbt_exercise.region"
[0m09:51:05.266115 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '936407fc-a6e4-40f5-b8e0-ab06b26cd2ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7040b55dbad0>]}
[0m09:51:05.267796 [info ] [Thread-4 (]: 10 of 14 OK loaded seed file dbt_dw_raw.region ................................. [[32mINSERT 4[0m in 9.37s]
[0m09:51:05.269557 [debug] [Thread-4 (]: Finished running node seed.dbt_exercise.region
[0m09:51:06.542713 [debug] [Thread-3 (]: On seed.dbt_exercise.suppliers: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "seed.dbt_exercise.suppliers"} */

    alter table `corded-sunlight-464012-e2`.`dbt_dw_raw`.`suppliers` set OPTIONS()
  
[0m09:51:06.896685 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:e6e2d5b7-f3d5-41aa-821c-4576ca2b0aca&page=queryresults
[0m09:51:07.364720 [debug] [Thread-3 (]: Writing runtime SQL for node "seed.dbt_exercise.suppliers"
[0m09:51:07.374047 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '936407fc-a6e4-40f5-b8e0-ab06b26cd2ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7040b515a4e0>]}
[0m09:51:07.375615 [info ] [Thread-3 (]: 12 of 14 OK loaded seed file dbt_dw_raw.suppliers .............................. [[32mINSERT 29[0m in 8.03s]
[0m09:51:07.377976 [debug] [Thread-3 (]: Finished running node seed.dbt_exercise.suppliers
[0m09:51:08.326850 [debug] [Thread-2 (]: On seed.dbt_exercise.territories: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "seed.dbt_exercise.territories"} */

    alter table `corded-sunlight-464012-e2`.`dbt_dw_raw`.`territories` set OPTIONS()
  
[0m09:51:08.711071 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:82a307a6-1e4e-43a3-b9f1-dd9c2b5d0597&page=queryresults
[0m09:51:09.154365 [debug] [Thread-2 (]: Writing runtime SQL for node "seed.dbt_exercise.territories"
[0m09:51:09.161446 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '936407fc-a6e4-40f5-b8e0-ab06b26cd2ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7040b51570b0>]}
[0m09:51:09.162976 [info ] [Thread-2 (]: 13 of 14 OK loaded seed file dbt_dw_raw.territories ............................ [[32mINSERT 53[0m in 5.96s]
[0m09:51:09.165778 [debug] [Thread-2 (]: Finished running node seed.dbt_exercise.territories
[0m09:51:10.301762 [debug] [Thread-1 (]: On seed.dbt_exercise.us_states: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "seed.dbt_exercise.us_states"} */

    alter table `corded-sunlight-464012-e2`.`dbt_dw_raw`.`us_states` set OPTIONS()
  
[0m09:51:10.765517 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:c093202c-2d6c-4247-8252-c07095719a5c&page=queryresults
[0m09:51:11.288598 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.dbt_exercise.us_states"
[0m09:51:11.316082 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '936407fc-a6e4-40f5-b8e0-ab06b26cd2ae', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7040b55daea0>]}
[0m09:51:11.318271 [info ] [Thread-1 (]: 14 of 14 OK loaded seed file dbt_dw_raw.us_states .............................. [[32mINSERT 51[0m in 6.16s]
[0m09:51:11.319972 [debug] [Thread-1 (]: Finished running node seed.dbt_exercise.us_states
[0m09:51:11.326186 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m09:51:11.340630 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:51:11.341547 [debug] [MainThread]: Connection 'seed.dbt_exercise.territories' was properly closed.
[0m09:51:11.342206 [debug] [MainThread]: Connection 'seed.dbt_exercise.us_states' was properly closed.
[0m09:51:11.342729 [debug] [MainThread]: Connection 'seed.dbt_exercise.suppliers' was properly closed.
[0m09:51:11.343817 [debug] [MainThread]: Connection 'seed.dbt_exercise.region' was properly closed.
[0m09:51:11.345291 [info ] [MainThread]: 
[0m09:51:11.346683 [info ] [MainThread]: Finished running 14 seeds in 0 hours 0 minutes and 42.53 seconds (42.53s).
[0m09:51:11.353193 [debug] [MainThread]: Command end result
[0m09:51:11.428427 [debug] [MainThread]: Wrote artifact WritableManifest to /home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/target/manifest.json
[0m09:51:11.457117 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/target/semantic_manifest.json
[0m09:51:11.474928 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/target/run_results.json
[0m09:51:11.475774 [info ] [MainThread]: 
[0m09:51:11.476884 [info ] [MainThread]: [32mCompleted successfully[0m
[0m09:51:11.477940 [info ] [MainThread]: 
[0m09:51:11.479829 [info ] [MainThread]: Done. PASS=14 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=14
[0m09:51:11.490630 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": true, "command_wall_clock_time": 298.14484, "process_in_blocks": "148088", "process_kernel_time": 33.030067, "process_mem_max_rss": "378760", "process_out_blocks": "4280", "process_user_time": 30.601187}
[0m09:51:11.491876 [debug] [MainThread]: Command `dbt seed` succeeded at 09:51:11.491618 after 298.15 seconds
[0m09:51:11.493151 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x704114c0c770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7040d5489d00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7040d5644f20>]}
[0m09:51:11.494654 [debug] [MainThread]: Flushing usage events
[0m09:51:11.897746 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:21:09.592093 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71ffdc676cf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71ffdbe00290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71ffdc243bc0>]}


============================== 11:21:09.610382 | dbc14a13-a678-4092-b1da-55f22e1c88e7 ==============================
[0m11:21:09.610382 [info ] [MainThread]: Running with dbt=1.10.2
[0m11:21:09.611020 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise', 'debug': 'False', 'warn_error': 'None', 'log_path': '/home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt debug', 'send_anonymous_usage_stats': 'True'}
[0m11:21:09.911536 [info ] [MainThread]: dbt version: 1.10.2
[0m11:21:09.912045 [info ] [MainThread]: python version: 3.12.3
[0m11:21:09.912382 [info ] [MainThread]: python path: /mnt/c/Users/Damodara Barbosa/Desktop/Projetos/dbt/dbt_exercise/venv/bin/python3
[0m11:21:09.912692 [info ] [MainThread]: os info: Linux-6.6.87.2-microsoft-standard-WSL2-x86_64-with-glibc2.39
[0m11:21:50.649672 [info ] [MainThread]: Using profiles dir at /home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise
[0m11:21:50.650125 [info ] [MainThread]: Using profiles.yml file at /home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/profiles.yml
[0m11:21:50.650387 [info ] [MainThread]: Using dbt_project.yml file at /home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/dbt_project.yml
[0m11:21:50.650633 [info ] [MainThread]: adapter type: bigquery
[0m11:21:50.650883 [info ] [MainThread]: adapter version: 1.9.2
[0m11:21:50.709303 [info ] [MainThread]: Configuration:
[0m11:21:50.709764 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m11:21:50.710025 [info ] [MainThread]:   dbt_project.yml file [[31mERROR invalid[0m]
[0m11:21:50.710235 [info ] [MainThread]: Required dependencies:
[0m11:21:50.710594 [debug] [MainThread]: Executing "git --help"
[0m11:21:50.715603 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m11:21:50.716170 [debug] [MainThread]: STDERR: "b''"
[0m11:21:50.716396 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m11:21:50.716662 [info ] [MainThread]: Connection:
[0m11:21:50.716959 [info ] [MainThread]:   method: service-account
[0m11:21:50.717259 [info ] [MainThread]:   database: corded-sunlight-464012-e2
[0m11:21:50.717630 [info ] [MainThread]:   execution_project: corded-sunlight-464012-e2
[0m11:21:50.718159 [info ] [MainThread]:   schema: dbt_dw
[0m11:21:50.718546 [info ] [MainThread]:   location: None
[0m11:21:50.718960 [info ] [MainThread]:   priority: None
[0m11:21:50.719404 [info ] [MainThread]:   maximum_bytes_billed: None
[0m11:21:50.719868 [info ] [MainThread]:   impersonate_service_account: None
[0m11:21:50.720157 [info ] [MainThread]:   job_retry_deadline_seconds: None
[0m11:21:50.720514 [info ] [MainThread]:   job_retries: 1
[0m11:21:50.720850 [info ] [MainThread]:   job_creation_timeout_seconds: None
[0m11:21:50.721146 [info ] [MainThread]:   job_execution_timeout_seconds: None
[0m11:21:50.721564 [info ] [MainThread]:   timeout_seconds: None
[0m11:21:50.721920 [info ] [MainThread]:   client_id: None
[0m11:21:50.722323 [info ] [MainThread]:   token_uri: None
[0m11:21:50.722739 [info ] [MainThread]:   compute_region: None
[0m11:21:50.723045 [info ] [MainThread]:   dataproc_cluster_name: None
[0m11:21:50.723384 [info ] [MainThread]:   gcs_bucket: None
[0m11:21:50.723841 [info ] [MainThread]:   dataproc_batch: None
[0m11:21:50.730019 [info ] [MainThread]: Registered adapter: bigquery=1.9.2
[0m11:22:34.241325 [debug] [MainThread]: Acquiring new bigquery connection 'debug'
[0m11:22:34.241729 [debug] [MainThread]: On debug: select 1 as id
[0m11:22:34.241972 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:22:36.441374 [debug] [MainThread]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:e9a3d896-d701-4e62-9b46-f63076e445fd&page=queryresults
[0m11:22:40.763334 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m11:22:40.763949 [info ] [MainThread]: [31m1 check failed:[0m
[0m11:22:40.764304 [info ] [MainThread]: Project loading failed for the following reason:
Runtime Error
  at path []: Additional properties are not allowed ('debug' was unexpected)

Error encountered in /home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/dbt_project.yml


[0m11:22:40.770056 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": false, "command_wall_clock_time": 87.37389, "process_in_blocks": "135192", "process_kernel_time": 11.069111, "process_mem_max_rss": "357280", "process_out_blocks": "40", "process_user_time": 9.107903}
[0m11:22:40.770926 [debug] [MainThread]: Command `dbt debug` failed at 11:22:40.770848 after 87.38 seconds
[0m11:22:40.771226 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m11:22:40.771490 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71ffdbe00290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71ffdb78e630>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71ff9e741c70>]}
[0m11:22:40.771769 [debug] [MainThread]: Flushing usage events
[0m11:22:41.109806 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:25:03.669440 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78fa73571d00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78fa735e67e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78fa72ae3800>]}


============================== 11:25:03.684129 | a6216092-15e5-41b6-949e-afef11175155 ==============================
[0m11:25:03.684129 [info ] [MainThread]: Running with dbt=1.10.2
[0m11:25:03.684591 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/logs', 'fail_fast': 'False', 'profiles_dir': '/home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'invocation_command': 'dbt debug', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m11:25:03.978922 [info ] [MainThread]: dbt version: 1.10.2
[0m11:25:03.979292 [info ] [MainThread]: python version: 3.12.3
[0m11:25:03.979542 [info ] [MainThread]: python path: /mnt/c/Users/Damodara Barbosa/Desktop/Projetos/dbt/dbt_exercise/venv/bin/python3
[0m11:25:03.979803 [info ] [MainThread]: os info: Linux-6.6.87.2-microsoft-standard-WSL2-x86_64-with-glibc2.39
[0m11:25:43.359629 [info ] [MainThread]: Using profiles dir at /home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise
[0m11:25:43.377434 [info ] [MainThread]: Using profiles.yml file at /home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/profiles.yml
[0m11:25:43.378052 [info ] [MainThread]: Using dbt_project.yml file at /home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/dbt_project.yml
[0m11:25:43.378399 [info ] [MainThread]: adapter type: bigquery
[0m11:25:43.378730 [info ] [MainThread]: adapter version: 1.9.2
[0m11:25:43.489246 [info ] [MainThread]: Configuration:
[0m11:25:43.489753 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m11:25:43.490084 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m11:25:43.490379 [info ] [MainThread]: Required dependencies:
[0m11:25:43.490695 [debug] [MainThread]: Executing "git --help"
[0m11:25:43.510926 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m11:25:43.511455 [debug] [MainThread]: STDERR: "b''"
[0m11:25:43.511714 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m11:25:43.512065 [info ] [MainThread]: Connection:
[0m11:25:43.512374 [info ] [MainThread]:   method: service-account
[0m11:25:43.512666 [info ] [MainThread]:   database: corded-sunlight-464012-e2
[0m11:25:43.513065 [info ] [MainThread]:   execution_project: corded-sunlight-464012-e2
[0m11:25:43.513445 [info ] [MainThread]:   schema: dbt_dw
[0m11:25:43.513991 [info ] [MainThread]:   location: None
[0m11:25:43.514458 [info ] [MainThread]:   priority: None
[0m11:25:43.514766 [info ] [MainThread]:   maximum_bytes_billed: None
[0m11:25:43.515042 [info ] [MainThread]:   impersonate_service_account: None
[0m11:25:43.515378 [info ] [MainThread]:   job_retry_deadline_seconds: None
[0m11:25:43.515861 [info ] [MainThread]:   job_retries: 1
[0m11:25:43.516306 [info ] [MainThread]:   job_creation_timeout_seconds: None
[0m11:25:43.516684 [info ] [MainThread]:   job_execution_timeout_seconds: None
[0m11:25:43.516951 [info ] [MainThread]:   timeout_seconds: None
[0m11:25:43.517291 [info ] [MainThread]:   client_id: None
[0m11:25:43.517622 [info ] [MainThread]:   token_uri: None
[0m11:25:43.518007 [info ] [MainThread]:   compute_region: None
[0m11:25:43.518262 [info ] [MainThread]:   dataproc_cluster_name: None
[0m11:25:43.518502 [info ] [MainThread]:   gcs_bucket: None
[0m11:25:43.518826 [info ] [MainThread]:   dataproc_batch: None
[0m11:25:43.522864 [info ] [MainThread]: Registered adapter: bigquery=1.9.2
[0m11:26:26.368789 [debug] [MainThread]: Acquiring new bigquery connection 'debug'
[0m11:26:26.369176 [debug] [MainThread]: On debug: select 1 as id
[0m11:26:26.369444 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:26:27.509382 [debug] [MainThread]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:24ed1a6f-d898-42c3-8d19-be04426b346f&page=queryresults
[0m11:26:33.136628 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m11:26:33.137231 [info ] [MainThread]: [32mAll checks passed![0m
[0m11:26:33.142931 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 85.23161, "process_in_blocks": "139528", "process_kernel_time": 11.23569, "process_mem_max_rss": "357856", "process_out_blocks": "40", "process_user_time": 8.877415}
[0m11:26:33.143474 [debug] [MainThread]: Command `dbt debug` succeeded at 11:26:33.143379 after 85.23 seconds
[0m11:26:33.143757 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m11:26:33.144068 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78fa730546b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78fa74d2b320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78fa3592c140>]}
[0m11:26:33.144392 [debug] [MainThread]: Flushing usage events
[0m11:26:33.479103 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:48:07.859300 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ad5d4251c40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ad5d486f410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ad5d3dd0c20>]}


============================== 13:48:07.866267 | c9c96bc0-d1f9-4647-bd13-05cd207b484a ==============================
[0m13:48:07.866267 [info ] [MainThread]: Running with dbt=1.10.2
[0m13:48:07.867071 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise', 'log_path': '/home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt ', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:48:07.971839 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c9c96bc0-d1f9-4647-bd13-05cd207b484a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ad5d4250230>]}
[0m13:48:08.035073 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-iueyu4wf'
[0m13:48:08.035481 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m13:48:08.318720 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m13:48:08.319710 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m13:48:08.345636 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m13:48:08.349276 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m13:48:08.803747 [info ] [MainThread]: Installed from version 1.3.0
[0m13:48:08.804244 [info ] [MainThread]: Up to date!
[0m13:48:08.804585 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'c9c96bc0-d1f9-4647-bd13-05cd207b484a', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ad5d38e10a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ad5d39ef680>]}
[0m13:48:08.807361 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 1.0024595, "process_in_blocks": "2816", "process_kernel_time": 0.431624, "process_mem_max_rss": "103044", "process_out_blocks": "2480", "process_user_time": 1.546654}
[0m13:48:08.808008 [debug] [MainThread]: Command `cli deps` succeeded at 13:48:08.807853 after 1.00 seconds
[0m13:48:08.808386 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ad5d6033e90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ad5d42e7170>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ad5d46d7ec0>]}
[0m13:48:08.808715 [debug] [MainThread]: Flushing usage events
[0m13:48:09.283128 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:53:10.919978 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70bbb3cf3230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70bbb4b281d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70bbb42075c0>]}


============================== 13:53:10.936255 | 03e8ba8a-ed53-4a5f-bc51-0d5489156ff2 ==============================
[0m13:53:10.936255 [info ] [MainThread]: Running with dbt=1.10.2
[0m13:53:10.936768 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt debug', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:53:11.256598 [info ] [MainThread]: dbt version: 1.10.2
[0m13:53:11.257066 [info ] [MainThread]: python version: 3.12.3
[0m13:53:11.257428 [info ] [MainThread]: python path: /mnt/c/Users/Damodara Barbosa/Desktop/Projetos/dbt/dbt_exercise/venv/bin/python3
[0m13:53:11.257802 [info ] [MainThread]: os info: Linux-6.6.87.2-microsoft-standard-WSL2-x86_64-with-glibc2.39
[0m13:53:51.409459 [info ] [MainThread]: Using profiles dir at /home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise
[0m13:53:51.410107 [info ] [MainThread]: Using profiles.yml file at /home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/profiles.yml
[0m13:53:51.410434 [info ] [MainThread]: Using dbt_project.yml file at /home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/dbt_project.yml
[0m13:53:51.410849 [info ] [MainThread]: adapter type: bigquery
[0m13:53:51.411263 [info ] [MainThread]: adapter version: 1.9.2
[0m13:53:51.510147 [info ] [MainThread]: Configuration:
[0m13:53:51.510722 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m13:53:51.511246 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m13:53:51.511643 [info ] [MainThread]: Required dependencies:
[0m13:53:51.512094 [debug] [MainThread]: Executing "git --help"
[0m13:53:51.516717 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m13:53:51.517350 [debug] [MainThread]: STDERR: "b''"
[0m13:53:51.517624 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m13:53:51.517985 [info ] [MainThread]: Connection:
[0m13:53:51.518490 [info ] [MainThread]:   method: service-account
[0m13:53:51.518952 [info ] [MainThread]:   database: corded-sunlight-464012-e2
[0m13:53:51.519391 [info ] [MainThread]:   execution_project: corded-sunlight-464012-e2
[0m13:53:51.519826 [info ] [MainThread]:   schema: dbt_dw
[0m13:53:51.520315 [info ] [MainThread]:   location: None
[0m13:53:51.520704 [info ] [MainThread]:   priority: None
[0m13:53:51.521105 [info ] [MainThread]:   maximum_bytes_billed: None
[0m13:53:51.521495 [info ] [MainThread]:   impersonate_service_account: None
[0m13:53:51.521826 [info ] [MainThread]:   job_retry_deadline_seconds: None
[0m13:53:51.522208 [info ] [MainThread]:   job_retries: 1
[0m13:53:51.522550 [info ] [MainThread]:   job_creation_timeout_seconds: None
[0m13:53:51.522945 [info ] [MainThread]:   job_execution_timeout_seconds: None
[0m13:53:51.523340 [info ] [MainThread]:   timeout_seconds: None
[0m13:53:51.523683 [info ] [MainThread]:   client_id: None
[0m13:53:51.524016 [info ] [MainThread]:   token_uri: None
[0m13:53:51.524360 [info ] [MainThread]:   compute_region: None
[0m13:53:51.524728 [info ] [MainThread]:   dataproc_cluster_name: None
[0m13:53:51.525133 [info ] [MainThread]:   gcs_bucket: None
[0m13:53:51.525598 [info ] [MainThread]:   dataproc_batch: None
[0m13:53:51.529360 [info ] [MainThread]: Registered adapter: bigquery=1.9.2
[0m13:54:36.361352 [debug] [MainThread]: Acquiring new bigquery connection 'debug'
[0m13:54:36.361865 [debug] [MainThread]: On debug: select 1 as id
[0m13:54:36.362293 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:54:37.305861 [debug] [MainThread]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:9e17c226-76c5-45a9-ad19-55586f89240e&page=queryresults
[0m13:54:41.816425 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m13:54:41.817117 [info ] [MainThread]: [32mAll checks passed![0m
[0m13:54:41.821909 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 90.9521, "process_in_blocks": "122824", "process_kernel_time": 10.995067, "process_mem_max_rss": "357396", "process_out_blocks": "40", "process_user_time": 9.081916}
[0m13:54:41.822502 [debug] [MainThread]: Command `dbt debug` succeeded at 13:54:41.822408 after 90.95 seconds
[0m13:54:41.822863 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m13:54:41.823264 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70bbb42075c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70bb7679daf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70bb76ac4b30>]}
[0m13:54:41.823749 [debug] [MainThread]: Flushing usage events
[0m13:54:42.172554 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:07:20.399101 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7078044bb140>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70780467da30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x707805e1db80>]}


============================== 14:07:20.418345 | 7fde2de1-eaf8-43dd-b6ca-9e16682a5a26 ==============================
[0m14:07:20.418345 [info ] [MainThread]: Running with dbt=1.10.2
[0m14:07:20.419272 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise', 'log_path': '/home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt run -s stg_orders_northwind', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:08:10.626373 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7fde2de1-eaf8-43dd-b6ca-9e16682a5a26', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7077c69da180>]}
[0m14:08:10.681130 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7fde2de1-eaf8-43dd-b6ca-9e16682a5a26', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7077cb7a8c20>]}
[0m14:08:10.685707 [info ] [MainThread]: Registered adapter: bigquery=1.9.2
[0m14:08:58.016411 [debug] [MainThread]: checksum: 1adc40777973ef30f45f80b3b6d04d5013c1edd53d96363881b3b199e612468b, vars: {}, profile: , target: , version: 1.10.2
[0m14:08:58.145979 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m14:08:58.146540 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '7fde2de1-eaf8-43dd-b6ca-9e16682a5a26', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7078043e37d0>]}
[0m14:09:06.016312 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.dbt_exercise.stg_orders_northwind' (models/staging/stg_orders_northwind.sql) depends on a source named 'ñorthwind.orders' which was not found
[0m14:09:06.025473 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 105.68334, "process_in_blocks": "143224", "process_kernel_time": 13.282541, "process_mem_max_rss": "364080", "process_out_blocks": "24", "process_user_time": 12.56095}
[0m14:09:06.026397 [debug] [MainThread]: Command `dbt run` failed at 14:09:06.026151 after 105.68 seconds
[0m14:09:06.027237 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x707803c27b00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x707787f84080>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x707787f85a00>]}
[0m14:09:06.027948 [debug] [MainThread]: Flushing usage events
[0m14:09:06.389548 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:09:43.643207 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7232a0d17770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7232a206aba0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7232a0cea090>]}


============================== 14:09:43.659783 | 3ce445cf-3017-440d-b3e6-95c730f3aeea ==============================
[0m14:09:43.659783 [info ] [MainThread]: Running with dbt=1.10.2
[0m14:09:43.660379 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise', 'log_path': '/home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt run -s stg_orders_northwind', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:10:29.974434 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3ce445cf-3017-440d-b3e6-95c730f3aeea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72326334c5f0>]}
[0m14:10:30.028331 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3ce445cf-3017-440d-b3e6-95c730f3aeea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x723267e08fe0>]}
[0m14:10:30.033103 [info ] [MainThread]: Registered adapter: bigquery=1.9.2
[0m14:11:13.584171 [debug] [MainThread]: checksum: 1adc40777973ef30f45f80b3b6d04d5013c1edd53d96363881b3b199e612468b, vars: {}, profile: , target: , version: 1.10.2
[0m14:11:13.704326 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m14:11:13.704959 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '3ce445cf-3017-440d-b3e6-95c730f3aeea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72326339da60>]}
[0m14:11:20.051221 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.dbt_exercise.intermediate
- models.dbt_exercise.marts
[0m14:11:20.060906 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3ce445cf-3017-440d-b3e6-95c730f3aeea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x723260fc6b70>]}
[0m14:11:20.155454 [debug] [MainThread]: Wrote artifact WritableManifest to /home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/target/manifest.json
[0m14:11:20.169958 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/target/semantic_manifest.json
[0m14:11:20.581255 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3ce445cf-3017-440d-b3e6-95c730f3aeea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x723260cd2900>]}
[0m14:11:20.581863 [info ] [MainThread]: Found 3 models, 14 seeds, 35 data tests, 14 sources, 609 macros
[0m14:11:20.582256 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3ce445cf-3017-440d-b3e6-95c730f3aeea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x723262ed6840>]}
[0m14:11:20.584082 [info ] [MainThread]: 
[0m14:11:20.584734 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:11:20.585250 [info ] [MainThread]: 
[0m14:11:20.585896 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m14:11:20.587301 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_corded-sunlight-464012-e2'
[0m14:11:20.588267 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:11:21.475377 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_corded-sunlight-464012-e2, now create_corded-sunlight-464012-e2_dbt_dw_staging)
[0m14:11:21.476069 [debug] [ThreadPool]: Creating schema "database: "corded-sunlight-464012-e2"
schema: "dbt_dw_staging"
"
[0m14:11:21.486185 [debug] [ThreadPool]: On create_corded-sunlight-464012-e2_dbt_dw_staging: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "connection_name": "create_corded-sunlight-464012-e2_dbt_dw_staging"} */
create schema if not exists `corded-sunlight-464012-e2`.`dbt_dw_staging`
  
[0m14:11:21.486724 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:11:22.620736 [debug] [ThreadPool]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:42646acd-f734-4ce5-ad51-dcc808151fde&page=queryresults
[0m14:11:27.510383 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_corded-sunlight-464012-e2_dbt_dw_staging, now list_corded-sunlight-464012-e2_dbt_dw_raw)
[0m14:11:27.511699 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_corded-sunlight-464012-e2_dbt_dw'
[0m14:11:27.512153 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:11:27.513029 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_corded-sunlight-464012-e2_dbt_dw_staging'
[0m14:11:27.513717 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:11:27.514978 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:11:28.469945 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3ce445cf-3017-440d-b3e6-95c730f3aeea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x723260eeeba0>]}
[0m14:11:28.470560 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:11:28.484579 [debug] [Thread-1 (]: Began running node model.dbt_exercise.stg_orders_northwind
[0m14:11:28.485524 [info ] [Thread-1 (]: 1 of 1 START sql view model dbt_dw_staging.stg_orders_northwind ................ [RUN]
[0m14:11:28.486219 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_corded-sunlight-464012-e2_dbt_dw_raw, now model.dbt_exercise.stg_orders_northwind)
[0m14:11:28.486653 [debug] [Thread-1 (]: Began compiling node model.dbt_exercise.stg_orders_northwind
[0m14:11:28.493694 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_exercise.stg_orders_northwind"
[0m14:11:28.499986 [debug] [Thread-1 (]: Began executing node model.dbt_exercise.stg_orders_northwind
[0m14:11:28.528655 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_exercise.stg_orders_northwind"
[0m14:11:28.531930 [debug] [Thread-1 (]: On model.dbt_exercise.stg_orders_northwind: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "model.dbt_exercise.stg_orders_northwind"} */


  create or replace view `corded-sunlight-464012-e2`.`dbt_dw_staging`.`stg_orders_northwind`
  OPTIONS()
  as with orders as (
    select *
    from `corded-sunlight-464012-e2`.`dbt_dw_raw`.`orders`
)

select
    cast(order_id, string) as order_id
    , cast(customer_id, string) as customer_id
    , cast(employee_id, string) as employee_id
    , cast(order_date, date) as order_date
    , cast(required_date, date) as required_date
    , cast(shipped_date, date) as shipped_date
    , cast(ship_via, string) as ship_via
    , cast(freight, decimal(10, 2)) as freight
    , cast(ship_name, string) as ship_name
    , cast(ship_address, string) as ship_address
    , cast(ship_city, string) as ship_city
    , cast(ship_region, string) as ship_region
    , cast(ship_postal_code, string) as ship_postal_code
    , cast(ship_country, string) as ship_country
from orders;


[0m14:11:28.532504 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:11:29.366969 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:6b67d0b2-5394-465d-a04b-53501d7ed156&page=queryresults
[0m14:11:29.367615 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:6b67d0b2-5394-465d-a04b-53501d7ed156&page=queryresults
[0m14:11:29.620581 [debug] [Thread-1 (]: Database Error in model stg_orders_northwind (models/staging/stg_orders_northwind.sql)
  Syntax error: Expected keyword AS but got "," at [12:18]
  compiled code at target/run/dbt_exercise/models/staging/stg_orders_northwind.sql
[0m14:11:29.644023 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3ce445cf-3017-440d-b3e6-95c730f3aeea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x723260dd97c0>]}
[0m14:11:29.644855 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model dbt_dw_staging.stg_orders_northwind ....... [[31mERROR[0m in 1.14s]
[0m14:11:29.645465 [debug] [Thread-1 (]: Finished running node model.dbt_exercise.stg_orders_northwind
[0m14:11:29.646373 [debug] [Thread-7 (]: Marking all children of 'model.dbt_exercise.stg_orders_northwind' to be skipped because of status 'error'.  Reason: Database Error in model stg_orders_northwind (models/staging/stg_orders_northwind.sql)
  Syntax error: Expected keyword AS but got "," at [12:18]
  compiled code at target/run/dbt_exercise/models/staging/stg_orders_northwind.sql.
[0m14:11:29.650259 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:11:29.657880 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:11:29.658414 [debug] [MainThread]: Connection 'model.dbt_exercise.stg_orders_northwind' was properly closed.
[0m14:11:29.658667 [debug] [MainThread]: Connection 'list_corded-sunlight-464012-e2_dbt_dw' was properly closed.
[0m14:11:29.659091 [debug] [MainThread]: Connection 'list_corded-sunlight-464012-e2_dbt_dw_staging' was properly closed.
[0m14:11:29.659523 [info ] [MainThread]: 
[0m14:11:29.660046 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 9.07 seconds (9.07s).
[0m14:11:29.661001 [debug] [MainThread]: Command end result
[0m14:11:29.701749 [debug] [MainThread]: Wrote artifact WritableManifest to /home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/target/manifest.json
[0m14:11:29.715018 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/target/semantic_manifest.json
[0m14:11:29.719826 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/target/run_results.json
[0m14:11:29.720256 [info ] [MainThread]: 
[0m14:11:29.720713 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m14:11:29.721148 [info ] [MainThread]: 
[0m14:11:29.721646 [error] [MainThread]: [31mFailure in model stg_orders_northwind (models/staging/stg_orders_northwind.sql)[0m
[0m14:11:29.722081 [error] [MainThread]:   Database Error in model stg_orders_northwind (models/staging/stg_orders_northwind.sql)
  Syntax error: Expected keyword AS but got "," at [12:18]
  compiled code at target/run/dbt_exercise/models/staging/stg_orders_northwind.sql
[0m14:11:29.722460 [info ] [MainThread]: 
[0m14:11:29.722917 [info ] [MainThread]:   compiled code at target/compiled/dbt_exercise/models/staging/stg_orders_northwind.sql
[0m14:11:29.723297 [info ] [MainThread]: 
[0m14:11:29.723677 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m14:11:29.730004 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 106.14726, "process_in_blocks": "144504", "process_kernel_time": 12.530225, "process_mem_max_rss": "375608", "process_out_blocks": "4744", "process_user_time": 12.486429}
[0m14:11:29.730684 [debug] [MainThread]: Command `dbt run` failed at 14:11:29.730536 after 106.15 seconds
[0m14:11:29.731263 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7232a0fd3b60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x723260ec7d40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x723262eb11c0>]}
[0m14:11:29.731637 [debug] [MainThread]: Flushing usage events
[0m14:11:30.074012 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:15:43.506053 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x738bdd986720>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x738bdf1b4380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x738bdddc00b0>]}


============================== 14:15:43.526865 | 2e1382f4-90e1-4baa-89dc-4f71de8e181a ==============================
[0m14:15:43.526865 [info ] [MainThread]: Running with dbt=1.10.2
[0m14:15:43.527548 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/logs', 'version_check': 'True', 'profiles_dir': '/home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run -s stg_orders_northwind', 'send_anonymous_usage_stats': 'True'}
[0m14:16:29.798239 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2e1382f4-90e1-4baa-89dc-4f71de8e181a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x738b9ffcb4d0>]}
[0m14:16:29.873912 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2e1382f4-90e1-4baa-89dc-4f71de8e181a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x738ba0063da0>]}
[0m14:16:29.879022 [info ] [MainThread]: Registered adapter: bigquery=1.9.2
[0m14:17:14.875090 [debug] [MainThread]: checksum: 1adc40777973ef30f45f80b3b6d04d5013c1edd53d96363881b3b199e612468b, vars: {}, profile: , target: , version: 1.10.2
[0m14:17:19.822875 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:17:19.823627 [debug] [MainThread]: Partial parsing: updated file: dbt_exercise://models/staging/stg_orders_northwind.sql
[0m14:17:20.259517 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.dbt_exercise.intermediate
- models.dbt_exercise.marts
[0m14:17:20.272069 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2e1382f4-90e1-4baa-89dc-4f71de8e181a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x738b9f9f9a90>]}
[0m14:17:20.368549 [debug] [MainThread]: Wrote artifact WritableManifest to /home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/target/manifest.json
[0m14:17:20.382513 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/target/semantic_manifest.json
[0m14:17:20.769387 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2e1382f4-90e1-4baa-89dc-4f71de8e181a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x738ba8af10d0>]}
[0m14:17:20.769971 [info ] [MainThread]: Found 3 models, 14 seeds, 35 data tests, 14 sources, 609 macros
[0m14:17:20.770357 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2e1382f4-90e1-4baa-89dc-4f71de8e181a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x738b9ff86ea0>]}
[0m14:17:20.772172 [info ] [MainThread]: 
[0m14:17:20.772672 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:17:20.772994 [info ] [MainThread]: 
[0m14:17:20.773513 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m14:17:20.775143 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_corded-sunlight-464012-e2'
[0m14:17:20.776283 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:17:21.688001 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_corded-sunlight-464012-e2, now list_corded-sunlight-464012-e2_dbt_dw_staging)
[0m14:17:21.688782 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:17:21.689923 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_corded-sunlight-464012-e2_dbt_dw'
[0m14:17:21.690869 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:17:21.691753 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_corded-sunlight-464012-e2_dbt_dw_raw'
[0m14:17:21.693089 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:17:22.593737 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2e1382f4-90e1-4baa-89dc-4f71de8e181a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x738ba00acf50>]}
[0m14:17:22.594529 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:17:22.611686 [debug] [Thread-1 (]: Began running node model.dbt_exercise.stg_orders_northwind
[0m14:17:22.612886 [info ] [Thread-1 (]: 1 of 1 START sql view model dbt_dw_staging.stg_orders_northwind ................ [RUN]
[0m14:17:22.613515 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_corded-sunlight-464012-e2_dbt_dw_raw, now model.dbt_exercise.stg_orders_northwind)
[0m14:17:22.613959 [debug] [Thread-1 (]: Began compiling node model.dbt_exercise.stg_orders_northwind
[0m14:17:22.622407 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_exercise.stg_orders_northwind"
[0m14:17:22.623394 [debug] [Thread-1 (]: Began executing node model.dbt_exercise.stg_orders_northwind
[0m14:17:22.655477 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_exercise.stg_orders_northwind"
[0m14:17:22.656324 [debug] [Thread-1 (]: On model.dbt_exercise.stg_orders_northwind: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "model.dbt_exercise.stg_orders_northwind"} */


  create or replace view `corded-sunlight-464012-e2`.`dbt_dw_staging`.`stg_orders_northwind`
  OPTIONS()
  as with orders as (
    select *
    from `corded-sunlight-464012-e2`.`dbt_dw_raw`.`orders`
)

select
    cast(order_id as string) as order_id
    , cast(customer_id as string) as customer_id
    , cast(employee_id as string) as employee_id
    , cast(order_date as date) as order_date
    , cast(required_date as date) as required_date
    , cast(shipped_date as date) as shipped_date
    , cast(ship_via as string) as ship_via
    , cast(freight as decimal(10, 2)) as freight
    , cast(ship_name as string) as ship_name
    , cast(ship_address as string) as ship_address
    , cast(ship_city as string) as ship_city
    , cast(ship_region as string) as ship_region
    , cast(ship_postal_code as string) as ship_postal_code
    , cast(ship_country as string) as ship_country
from orders;


[0m14:17:22.656827 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:17:23.725036 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:5c0d0726-ea89-4fe1-8b90-dfb3a3096802&page=queryresults
[0m14:17:28.543795 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2e1382f4-90e1-4baa-89dc-4f71de8e181a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x738ba8af1c70>]}
[0m14:17:28.544702 [info ] [Thread-1 (]: 1 of 1 OK created sql view model dbt_dw_staging.stg_orders_northwind ........... [[32mCREATE VIEW (0 processed)[0m in 5.91s]
[0m14:17:28.545270 [debug] [Thread-1 (]: Finished running node model.dbt_exercise.stg_orders_northwind
[0m14:17:28.548390 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:17:28.556083 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:17:28.556658 [debug] [MainThread]: Connection 'list_corded-sunlight-464012-e2_dbt_dw_staging' was properly closed.
[0m14:17:28.556922 [debug] [MainThread]: Connection 'list_corded-sunlight-464012-e2_dbt_dw' was properly closed.
[0m14:17:28.557183 [debug] [MainThread]: Connection 'model.dbt_exercise.stg_orders_northwind' was properly closed.
[0m14:17:28.557530 [info ] [MainThread]: 
[0m14:17:28.557905 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 7.78 seconds (7.78s).
[0m14:17:28.558676 [debug] [MainThread]: Command end result
[0m14:17:28.602255 [debug] [MainThread]: Wrote artifact WritableManifest to /home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/target/manifest.json
[0m14:17:28.616071 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/target/semantic_manifest.json
[0m14:17:28.621787 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/target/run_results.json
[0m14:17:28.622281 [info ] [MainThread]: 
[0m14:17:28.622773 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:17:28.623375 [info ] [MainThread]: 
[0m14:17:28.623936 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m14:17:28.630983 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 105.17888, "process_in_blocks": "144320", "process_kernel_time": 12.712389, "process_mem_max_rss": "368492", "process_out_blocks": "4784", "process_user_time": 10.782909}
[0m14:17:28.631608 [debug] [MainThread]: Command `dbt run` succeeded at 14:17:28.631482 after 105.18 seconds
[0m14:17:28.631990 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x738bddec7830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x738b9facbef0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x738b9c427e30>]}
[0m14:17:28.632333 [debug] [MainThread]: Flushing usage events
[0m14:17:28.974104 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:37:20.322053 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7be081ed2ff0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7be081dbaba0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7be081ed3410>]}


============================== 14:37:20.341279 | 3c893019-ee29-436d-8cb1-0551dec9c449 ==============================
[0m14:37:20.341279 [info ] [MainThread]: Running with dbt=1.10.2
[0m14:37:20.341864 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt run -s stg_categories_northwind', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:38:16.468356 [warn ] [MainThread]: [[33mWARNING[0m][DuplicateYAMLKeysDeprecation]: Deprecated functionality
Duplicate key 'version' in "<unicode string>", line 4, column 1 in file
`/home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/dbt_project.yml`
[0m14:38:16.469189 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '3c893019-ee29-436d-8cb1-0551dec9c449', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7be08157f2f0>]}
[0m14:38:17.399196 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3c893019-ee29-436d-8cb1-0551dec9c449', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7be0827049e0>]}
[0m14:38:17.521414 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3c893019-ee29-436d-8cb1-0551dec9c449', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7be0822675c0>]}
[0m14:38:17.526182 [info ] [MainThread]: Registered adapter: bigquery=1.9.2
[0m14:39:13.724486 [debug] [MainThread]: checksum: 1adc40777973ef30f45f80b3b6d04d5013c1edd53d96363881b3b199e612468b, vars: {}, profile: , target: , version: 1.10.2
[0m14:39:20.851536 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:39:20.852680 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:39:20.863248 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.dbt_exercise.intermediate
- models.dbt_exercise.marts
[0m14:39:20.952985 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3c893019-ee29-436d-8cb1-0551dec9c449', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7be0444d4710>]}
[0m14:39:21.374238 [debug] [MainThread]: Wrote artifact WritableManifest to /home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/target/manifest.json
[0m14:39:21.396313 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/target/semantic_manifest.json
[0m14:39:22.027689 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3c893019-ee29-436d-8cb1-0551dec9c449', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7be043e34170>]}
[0m14:39:22.028598 [info ] [MainThread]: Found 4 models, 14 seeds, 35 data tests, 14 sources, 609 macros
[0m14:39:22.029290 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3c893019-ee29-436d-8cb1-0551dec9c449', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7be044107dd0>]}
[0m14:39:22.032836 [info ] [MainThread]: 
[0m14:39:22.033681 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:39:22.034288 [info ] [MainThread]: 
[0m14:39:22.035333 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m14:39:22.037219 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_corded-sunlight-464012-e2'
[0m14:39:22.038383 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:39:22.962046 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_corded-sunlight-464012-e2, now list_corded-sunlight-464012-e2_dbt_dw)
[0m14:39:22.964064 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_corded-sunlight-464012-e2_dbt_dw_staging'
[0m14:39:22.965135 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:39:22.966638 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_corded-sunlight-464012-e2_dbt_dw_raw'
[0m14:39:22.968238 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:39:22.970137 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:39:23.979491 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3c893019-ee29-436d-8cb1-0551dec9c449', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7be083aac3b0>]}
[0m14:39:23.980637 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:39:23.997308 [debug] [Thread-1 (]: Began running node model.dbt_exercise.stg_categories_northwind
[0m14:39:23.998532 [info ] [Thread-1 (]: 1 of 1 START sql view model dbt_dw_staging.stg_categories_northwind ............ [RUN]
[0m14:39:23.999607 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_corded-sunlight-464012-e2_dbt_dw, now model.dbt_exercise.stg_categories_northwind)
[0m14:39:24.000380 [debug] [Thread-1 (]: Began compiling node model.dbt_exercise.stg_categories_northwind
[0m14:39:24.017289 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_exercise.stg_categories_northwind"
[0m14:39:24.023547 [debug] [Thread-1 (]: Began executing node model.dbt_exercise.stg_categories_northwind
[0m14:39:24.096502 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_exercise.stg_categories_northwind"
[0m14:39:24.098796 [debug] [Thread-1 (]: On model.dbt_exercise.stg_categories_northwind: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "model.dbt_exercise.stg_categories_northwind"} */


  create or replace view `corded-sunlight-464012-e2`.`dbt_dw_staging`.`stg_categories_northwind`
  OPTIONS()
  as with categories as (
    select *
    from `corded-sunlight-464012-e2`.`dbt_dw_raw`.`categories`
)

/* Ao construir a staging não vamos trazer a coluna picture, pois ela não traz informação relevante */
select
    cast(category_id as string) as category_id
    , cast(category_name as string) as category_name
    , cast(description as string) as description
from categories;


[0m14:39:24.100167 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:39:25.176479 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:35b81223-d4ef-4fe0-a425-8611fad4b18e&page=queryresults
[0m14:39:32.129206 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3c893019-ee29-436d-8cb1-0551dec9c449', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7be082435d30>]}
[0m14:39:32.130476 [info ] [Thread-1 (]: 1 of 1 OK created sql view model dbt_dw_staging.stg_categories_northwind ....... [[32mCREATE VIEW (0 processed)[0m in 8.11s]
[0m14:39:32.131926 [debug] [Thread-1 (]: Finished running node model.dbt_exercise.stg_categories_northwind
[0m14:39:32.136118 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:39:32.146930 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:39:32.147823 [debug] [MainThread]: Connection 'model.dbt_exercise.stg_categories_northwind' was properly closed.
[0m14:39:32.148488 [debug] [MainThread]: Connection 'list_corded-sunlight-464012-e2_dbt_dw_staging' was properly closed.
[0m14:39:32.149140 [debug] [MainThread]: Connection 'list_corded-sunlight-464012-e2_dbt_dw_raw' was properly closed.
[0m14:39:32.149882 [info ] [MainThread]: 
[0m14:39:32.151356 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 10.11 seconds (10.11s).
[0m14:39:32.155403 [debug] [MainThread]: Command end result
[0m14:39:32.244882 [debug] [MainThread]: Wrote artifact WritableManifest to /home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/target/manifest.json
[0m14:39:32.264377 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/target/semantic_manifest.json
[0m14:39:32.277493 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/target/run_results.json
[0m14:39:32.278573 [info ] [MainThread]: 
[0m14:39:32.279906 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:39:32.280884 [info ] [MainThread]: 
[0m14:39:32.281801 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m14:39:32.283121 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- DuplicateYAMLKeysDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m14:39:32.290754 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 132.02147, "process_in_blocks": "142128", "process_kernel_time": 14.983031, "process_mem_max_rss": "365928", "process_out_blocks": "3272", "process_user_time": 12.502278}
[0m14:39:32.291751 [debug] [MainThread]: Command `dbt run` succeeded at 14:39:32.291561 after 132.02 seconds
[0m14:39:32.292385 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7be083e32240>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7be043e34320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7be0492db4d0>]}
[0m14:39:32.293123 [debug] [MainThread]: Flushing usage events
[0m14:39:32.642014 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:40:09.400988 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a04c7f6d8b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a04c7f13800>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a04c856fc20>]}


============================== 14:40:09.421912 | b5fd728f-b7c6-4644-9cd9-2658ca8fca9e ==============================
[0m14:40:09.421912 [info ] [MainThread]: Running with dbt=1.10.2
[0m14:40:09.423110 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/logs', 'profiles_dir': '/home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'invocation_command': 'dbt test', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:41:02.421642 [warn ] [MainThread]: [[33mWARNING[0m][DuplicateYAMLKeysDeprecation]: Deprecated functionality
Duplicate key 'version' in "<unicode string>", line 4, column 1 in file
`/home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/dbt_project.yml`
[0m14:41:02.422615 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'b5fd728f-b7c6-4644-9cd9-2658ca8fca9e', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a048a940d70>]}
[0m14:41:03.203463 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b5fd728f-b7c6-4644-9cd9-2658ca8fca9e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a048aa4f080>]}
[0m14:41:03.312427 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b5fd728f-b7c6-4644-9cd9-2658ca8fca9e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a048aa80890>]}
[0m14:41:03.317090 [info ] [MainThread]: Registered adapter: bigquery=1.9.2
[0m14:41:56.738238 [debug] [MainThread]: checksum: 1adc40777973ef30f45f80b3b6d04d5013c1edd53d96363881b3b199e612468b, vars: {}, profile: , target: , version: 1.10.2
[0m14:42:02.281775 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:42:02.282389 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:42:02.291088 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.dbt_exercise.marts
- models.dbt_exercise.intermediate
[0m14:42:02.376331 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b5fd728f-b7c6-4644-9cd9-2658ca8fca9e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a048a6f76b0>]}
[0m14:42:02.750066 [debug] [MainThread]: Wrote artifact WritableManifest to /home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/target/manifest.json
[0m14:42:02.766608 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/target/semantic_manifest.json
[0m14:42:03.403569 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b5fd728f-b7c6-4644-9cd9-2658ca8fca9e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a048a6f75f0>]}
[0m14:42:03.404704 [info ] [MainThread]: Found 4 models, 14 seeds, 35 data tests, 14 sources, 609 macros
[0m14:42:03.405434 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b5fd728f-b7c6-4644-9cd9-2658ca8fca9e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a048a864d40>]}
[0m14:42:03.410695 [info ] [MainThread]: 
[0m14:42:03.412217 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:42:03.414077 [info ] [MainThread]: 
[0m14:42:03.415868 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m14:42:03.425081 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_corded-sunlight-464012-e2_dbt_dw_raw'
[0m14:42:03.427067 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_corded-sunlight-464012-e2_dbt_dw_staging'
[0m14:42:03.428016 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:42:03.429571 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_corded-sunlight-464012-e2_dbt_dw'
[0m14:42:03.430918 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:42:03.432281 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:42:04.418570 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b5fd728f-b7c6-4644-9cd9-2658ca8fca9e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a048aacf6b0>]}
[0m14:42:04.420186 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:42:04.454453 [debug] [Thread-1 (]: Began running node test.dbt_exercise.not_null_my_first_dbt_model_id.5fb22c2710
[0m14:42:04.455604 [debug] [Thread-2 (]: Began running node test.dbt_exercise.not_null_my_second_dbt_model_id.151b76d778
[0m14:42:04.456488 [debug] [Thread-3 (]: Began running node test.dbt_exercise.source_accepted_values_northwind_categories_category_name__Beverages__Condiments__Confections__Dairy_Products__Grains_Cereals__Meat_Poultry__Produce__Seafood.ea6d0ab2ae
[0m14:42:04.457854 [debug] [Thread-4 (]: Began running node test.dbt_exercise.source_not_null_northwind_categories_category_id.9a6df29828
[0m14:42:04.457256 [info ] [Thread-1 (]: 1 of 35 START test not_null_my_first_dbt_model_id .............................. [RUN]
[0m14:42:04.459560 [info ] [Thread-2 (]: 2 of 35 START test not_null_my_second_dbt_model_id ............................. [RUN]
[0m14:42:04.461755 [info ] [Thread-3 (]: 3 of 35 START test source_accepted_values_northwind_categories_category_name__Beverages__Condiments__Confections__Dairy_Products__Grains_Cereals__Meat_Poultry__Produce__Seafood  [RUN]
[0m14:42:04.464022 [info ] [Thread-4 (]: 4 of 35 START test source_not_null_northwind_categories_category_id ............ [RUN]
[0m14:42:04.465988 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_corded-sunlight-464012-e2_dbt_dw_raw, now test.dbt_exercise.not_null_my_first_dbt_model_id.5fb22c2710)
[0m14:42:04.467733 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_corded-sunlight-464012-e2_dbt_dw_staging, now test.dbt_exercise.not_null_my_second_dbt_model_id.151b76d778)
[0m14:42:04.469416 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_corded-sunlight-464012-e2_dbt_dw, now test.dbt_exercise.source_accepted_values_northwind_categories_category_name__Beverages__Condiments__Confections__Dairy_Products__Grains_Cereals__Meat_Poultry__Produce__Seafood.ea6d0ab2ae)
[0m14:42:04.471222 [debug] [Thread-4 (]: Acquiring new bigquery connection 'test.dbt_exercise.source_not_null_northwind_categories_category_id.9a6df29828'
[0m14:42:04.472440 [debug] [Thread-1 (]: Began compiling node test.dbt_exercise.not_null_my_first_dbt_model_id.5fb22c2710
[0m14:42:04.473780 [debug] [Thread-2 (]: Began compiling node test.dbt_exercise.not_null_my_second_dbt_model_id.151b76d778
[0m14:42:04.475404 [debug] [Thread-3 (]: Began compiling node test.dbt_exercise.source_accepted_values_northwind_categories_category_name__Beverages__Condiments__Confections__Dairy_Products__Grains_Cereals__Meat_Poultry__Produce__Seafood.ea6d0ab2ae
[0m14:42:04.477124 [debug] [Thread-4 (]: Began compiling node test.dbt_exercise.source_not_null_northwind_categories_category_id.9a6df29828
[0m14:42:04.539496 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_exercise.not_null_my_second_dbt_model_id.151b76d778"
[0m14:42:04.541301 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_exercise.not_null_my_first_dbt_model_id.5fb22c2710"
[0m14:42:04.574325 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_exercise.source_not_null_northwind_categories_category_id.9a6df29828"
[0m14:42:04.569528 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_exercise.source_accepted_values_northwind_categories_category_name__Beverages__Condiments__Confections__Dairy_Products__Grains_Cereals__Meat_Poultry__Produce__Seafood.ea6d0ab2ae"
[0m14:42:04.595027 [debug] [Thread-1 (]: Began executing node test.dbt_exercise.not_null_my_first_dbt_model_id.5fb22c2710
[0m14:42:04.596678 [debug] [Thread-4 (]: Began executing node test.dbt_exercise.source_not_null_northwind_categories_category_id.9a6df29828
[0m14:42:04.603802 [debug] [Thread-2 (]: Began executing node test.dbt_exercise.not_null_my_second_dbt_model_id.151b76d778
[0m14:42:04.605163 [debug] [Thread-3 (]: Began executing node test.dbt_exercise.source_accepted_values_northwind_categories_category_name__Beverages__Condiments__Confections__Dairy_Products__Grains_Cereals__Meat_Poultry__Produce__Seafood.ea6d0ab2ae
[0m14:42:04.680230 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_exercise.not_null_my_first_dbt_model_id.5fb22c2710"
[0m14:42:04.681675 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_exercise.source_not_null_northwind_categories_category_id.9a6df29828"
[0m14:42:04.686131 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_exercise.not_null_my_second_dbt_model_id.151b76d778"
[0m14:42:04.690999 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_exercise.source_accepted_values_northwind_categories_category_name__Beverages__Condiments__Confections__Dairy_Products__Grains_Cereals__Meat_Poultry__Produce__Seafood.ea6d0ab2ae"
[0m14:42:04.696635 [debug] [Thread-4 (]: On test.dbt_exercise.source_not_null_northwind_categories_category_id.9a6df29828: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "test.dbt_exercise.source_not_null_northwind_categories_category_id.9a6df29828"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select category_id
from `corded-sunlight-464012-e2`.`dbt_dw_raw`.`categories`
where category_id is null



  
  
      
    ) dbt_internal_test
[0m14:42:04.698989 [debug] [Thread-2 (]: On test.dbt_exercise.not_null_my_second_dbt_model_id.151b76d778: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "test.dbt_exercise.not_null_my_second_dbt_model_id.151b76d778"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select id
from `corded-sunlight-464012-e2`.`dbt_dw`.`my_second_dbt_model`
where id is null



  
  
      
    ) dbt_internal_test
[0m14:42:04.700234 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m14:42:04.701342 [debug] [Thread-1 (]: On test.dbt_exercise.not_null_my_first_dbt_model_id.5fb22c2710: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "test.dbt_exercise.not_null_my_first_dbt_model_id.5fb22c2710"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select id
from `corded-sunlight-464012-e2`.`dbt_dw`.`my_first_dbt_model`
where id is null



  
  
      
    ) dbt_internal_test
[0m14:42:04.702335 [debug] [Thread-3 (]: On test.dbt_exercise.source_accepted_values_northwind_categories_category_name__Beverages__Condiments__Confections__Dairy_Products__Grains_Cereals__Meat_Poultry__Produce__Seafood.ea6d0ab2ae: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "test.dbt_exercise.source_accepted_values_northwind_categories_category_name__Beverages__Condiments__Confections__Dairy_Products__Grains_Cereals__Meat_Poultry__Produce__Seafood.ea6d0ab2ae"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        category_name as value_field,
        count(*) as n_records

    from `corded-sunlight-464012-e2`.`dbt_dw_raw`.`categories`
    group by category_name

)

select *
from all_values
where value_field not in (
    'Beverages','Condiments','Confections','Dairy Products','Grains/Cereals','Meat/Poultry','Produce','Seafood'
)



  
  
      
    ) dbt_internal_test
[0m14:42:04.703403 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:42:04.704919 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:42:04.706162 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:42:05.966493 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:9c212a11-b223-4579-8b72-f2408cc78d27&page=queryresults
[0m14:42:05.968820 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:696fc3de-bda7-46e6-99c1-487c1b25814f&page=queryresults
[0m14:42:05.970012 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:9c212a11-b223-4579-8b72-f2408cc78d27&page=queryresults
[0m14:42:05.971978 [error] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:696fc3de-bda7-46e6-99c1-487c1b25814f&page=queryresults
[0m14:42:06.047741 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:844b258c-142b-4d8b-ad08-eb5f54af7bd0&page=queryresults
[0m14:42:06.155269 [debug] [Thread-2 (]: Database Error in test not_null_my_second_dbt_model_id (models/schema.yml)
  Not found: Table corded-sunlight-464012-e2:dbt_dw.my_second_dbt_model was not found in location US
  compiled code at target/run/dbt_exercise/models/schema.yml/not_null_my_second_dbt_model_id.sql
[0m14:42:06.157406 [debug] [Thread-1 (]: Database Error in test not_null_my_first_dbt_model_id (models/schema.yml)
  Not found: Table corded-sunlight-464012-e2:dbt_dw.my_first_dbt_model was not found in location US
  compiled code at target/run/dbt_exercise/models/schema.yml/not_null_my_first_dbt_model_id.sql
[0m14:42:06.159008 [error] [Thread-2 (]: 2 of 35 ERROR not_null_my_second_dbt_model_id .................................. [[31mERROR[0m in 1.69s]
[0m14:42:06.160370 [error] [Thread-1 (]: 1 of 35 ERROR not_null_my_first_dbt_model_id ................................... [[31mERROR[0m in 1.69s]
[0m14:42:06.161741 [debug] [Thread-2 (]: Finished running node test.dbt_exercise.not_null_my_second_dbt_model_id.151b76d778
[0m14:42:06.163214 [debug] [Thread-1 (]: Finished running node test.dbt_exercise.not_null_my_first_dbt_model_id.5fb22c2710
[0m14:42:06.164472 [debug] [Thread-2 (]: Began running node test.dbt_exercise.source_not_null_northwind_country_codes_country_code.c623b5676c
[0m14:42:06.166087 [debug] [Thread-7 (]: Marking all children of 'test.dbt_exercise.not_null_my_second_dbt_model_id.151b76d778' to be skipped because of status 'error'.  Reason: Database Error in test not_null_my_second_dbt_model_id (models/schema.yml)
  Not found: Table corded-sunlight-464012-e2:dbt_dw.my_second_dbt_model was not found in location US
  compiled code at target/run/dbt_exercise/models/schema.yml/not_null_my_second_dbt_model_id.sql.
[0m14:42:06.168388 [debug] [Thread-1 (]: Began running node test.dbt_exercise.source_not_null_northwind_customers_customer_id.dba99593d2
[0m14:42:06.171559 [info ] [Thread-2 (]: 5 of 35 START test source_not_null_northwind_country_codes_country_code ........ [RUN]
[0m14:42:06.175830 [debug] [Thread-7 (]: Marking all children of 'test.dbt_exercise.not_null_my_first_dbt_model_id.5fb22c2710' to be skipped because of status 'error'.  Reason: Database Error in test not_null_my_first_dbt_model_id (models/schema.yml)
  Not found: Table corded-sunlight-464012-e2:dbt_dw.my_first_dbt_model was not found in location US
  compiled code at target/run/dbt_exercise/models/schema.yml/not_null_my_first_dbt_model_id.sql.
[0m14:42:06.178339 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:4003a991-419c-4157-a362-880bb680770c&page=queryresults
[0m14:42:06.181031 [info ] [Thread-1 (]: 6 of 35 START test source_not_null_northwind_customers_customer_id ............. [RUN]
[0m14:42:06.184451 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_exercise.not_null_my_second_dbt_model_id.151b76d778, now test.dbt_exercise.source_not_null_northwind_country_codes_country_code.c623b5676c)
[0m14:42:06.191156 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_exercise.not_null_my_first_dbt_model_id.5fb22c2710, now test.dbt_exercise.source_not_null_northwind_customers_customer_id.dba99593d2)
[0m14:42:06.192948 [debug] [Thread-2 (]: Began compiling node test.dbt_exercise.source_not_null_northwind_country_codes_country_code.c623b5676c
[0m14:42:06.194991 [debug] [Thread-1 (]: Began compiling node test.dbt_exercise.source_not_null_northwind_customers_customer_id.dba99593d2
[0m14:42:06.210704 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_exercise.source_not_null_northwind_country_codes_country_code.c623b5676c"
[0m14:42:06.221450 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_exercise.source_not_null_northwind_customers_customer_id.dba99593d2"
[0m14:42:06.223591 [debug] [Thread-2 (]: Began executing node test.dbt_exercise.source_not_null_northwind_country_codes_country_code.c623b5676c
[0m14:42:06.228845 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_exercise.source_not_null_northwind_country_codes_country_code.c623b5676c"
[0m14:42:06.230551 [debug] [Thread-1 (]: Began executing node test.dbt_exercise.source_not_null_northwind_customers_customer_id.dba99593d2
[0m14:42:06.236231 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_exercise.source_not_null_northwind_customers_customer_id.dba99593d2"
[0m14:42:06.237392 [debug] [Thread-2 (]: On test.dbt_exercise.source_not_null_northwind_country_codes_country_code.c623b5676c: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "test.dbt_exercise.source_not_null_northwind_country_codes_country_code.c623b5676c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select country_code
from `corded-sunlight-464012-e2`.`dbt_dw_raw`.`country_codes`
where country_code is null



  
  
      
    ) dbt_internal_test
[0m14:42:06.239476 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:42:06.240761 [debug] [Thread-1 (]: On test.dbt_exercise.source_not_null_northwind_customers_customer_id.dba99593d2: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "test.dbt_exercise.source_not_null_northwind_customers_customer_id.dba99593d2"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select customer_id
from `corded-sunlight-464012-e2`.`dbt_dw_raw`.`customers`
where customer_id is null



  
  
      
    ) dbt_internal_test
[0m14:42:06.241852 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:42:07.500701 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:ed08aaba-c3e9-4eec-b5cb-b87fab80b383&page=queryresults
[0m14:42:07.631641 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:9810edee-767e-4a47-b9c5-b8ee0ad7e317&page=queryresults
[0m14:42:11.810188 [info ] [Thread-4 (]: 4 of 35 PASS source_not_null_northwind_categories_category_id .................. [[32mPASS[0m in 7.34s]
[0m14:42:11.812247 [debug] [Thread-4 (]: Finished running node test.dbt_exercise.source_not_null_northwind_categories_category_id.9a6df29828
[0m14:42:11.813316 [debug] [Thread-4 (]: Began running node test.dbt_exercise.source_not_null_northwind_dados_financeiros_data.cdd6b46fe7
[0m14:42:11.814381 [info ] [Thread-4 (]: 7 of 35 START test source_not_null_northwind_dados_financeiros_data ............ [RUN]
[0m14:42:11.815613 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_exercise.source_not_null_northwind_categories_category_id.9a6df29828, now test.dbt_exercise.source_not_null_northwind_dados_financeiros_data.cdd6b46fe7)
[0m14:42:11.817414 [debug] [Thread-4 (]: Began compiling node test.dbt_exercise.source_not_null_northwind_dados_financeiros_data.cdd6b46fe7
[0m14:42:11.829089 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_exercise.source_not_null_northwind_dados_financeiros_data.cdd6b46fe7"
[0m14:42:11.832610 [info ] [Thread-2 (]: 5 of 35 PASS source_not_null_northwind_country_codes_country_code .............. [[32mPASS[0m in 5.65s]
[0m14:42:11.839760 [info ] [Thread-3 (]: 3 of 35 PASS source_accepted_values_northwind_categories_category_name__Beverages__Condiments__Confections__Dairy_Products__Grains_Cereals__Meat_Poultry__Produce__Seafood  [[32mPASS[0m in 7.37s]
[0m14:42:11.844431 [debug] [Thread-2 (]: Finished running node test.dbt_exercise.source_not_null_northwind_country_codes_country_code.c623b5676c
[0m14:42:11.846553 [info ] [Thread-1 (]: 6 of 35 PASS source_not_null_northwind_customers_customer_id ................... [[32mPASS[0m in 5.66s]
[0m14:42:11.848767 [debug] [Thread-4 (]: Began executing node test.dbt_exercise.source_not_null_northwind_dados_financeiros_data.cdd6b46fe7
[0m14:42:11.851223 [debug] [Thread-3 (]: Finished running node test.dbt_exercise.source_accepted_values_northwind_categories_category_name__Beverages__Condiments__Confections__Dairy_Products__Grains_Cereals__Meat_Poultry__Produce__Seafood.ea6d0ab2ae
[0m14:42:11.853032 [debug] [Thread-2 (]: Began running node test.dbt_exercise.source_not_null_northwind_employee_territories_employee_id.d7372217ec
[0m14:42:11.855563 [debug] [Thread-1 (]: Finished running node test.dbt_exercise.source_not_null_northwind_customers_customer_id.dba99593d2
[0m14:42:11.863586 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_exercise.source_not_null_northwind_dados_financeiros_data.cdd6b46fe7"
[0m14:42:11.865301 [debug] [Thread-3 (]: Began running node test.dbt_exercise.source_not_null_northwind_employee_territories_territory_id.ae648a0b88
[0m14:42:11.867002 [info ] [Thread-2 (]: 8 of 35 START test source_not_null_northwind_employee_territories_employee_id .. [RUN]
[0m14:42:11.869345 [debug] [Thread-1 (]: Began running node test.dbt_exercise.source_not_null_northwind_employees_employee_id.829479a08c
[0m14:42:11.876883 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_exercise.source_not_null_northwind_country_codes_country_code.c623b5676c, now test.dbt_exercise.source_not_null_northwind_employee_territories_employee_id.d7372217ec)
[0m14:42:11.878625 [debug] [Thread-4 (]: On test.dbt_exercise.source_not_null_northwind_dados_financeiros_data.cdd6b46fe7: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "test.dbt_exercise.source_not_null_northwind_dados_financeiros_data.cdd6b46fe7"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select data
from `corded-sunlight-464012-e2`.`dbt_dw_raw`.`dados_financeiros`
where data is null



  
  
      
    ) dbt_internal_test
[0m14:42:11.872150 [info ] [Thread-3 (]: 9 of 35 START test source_not_null_northwind_employee_territories_territory_id . [RUN]
[0m14:42:11.880696 [info ] [Thread-1 (]: 10 of 35 START test source_not_null_northwind_employees_employee_id ............ [RUN]
[0m14:42:11.883875 [debug] [Thread-2 (]: Began compiling node test.dbt_exercise.source_not_null_northwind_employee_territories_employee_id.d7372217ec
[0m14:42:11.885699 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m14:42:11.887767 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_exercise.source_accepted_values_northwind_categories_category_name__Beverages__Condiments__Confections__Dairy_Products__Grains_Cereals__Meat_Poultry__Produce__Seafood.ea6d0ab2ae, now test.dbt_exercise.source_not_null_northwind_employee_territories_territory_id.ae648a0b88)
[0m14:42:11.889776 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_exercise.source_not_null_northwind_customers_customer_id.dba99593d2, now test.dbt_exercise.source_not_null_northwind_employees_employee_id.829479a08c)
[0m14:42:11.901403 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_exercise.source_not_null_northwind_employee_territories_employee_id.d7372217ec"
[0m14:42:11.903594 [debug] [Thread-3 (]: Began compiling node test.dbt_exercise.source_not_null_northwind_employee_territories_territory_id.ae648a0b88
[0m14:42:11.904854 [debug] [Thread-1 (]: Began compiling node test.dbt_exercise.source_not_null_northwind_employees_employee_id.829479a08c
[0m14:42:11.913266 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_exercise.source_not_null_northwind_employee_territories_territory_id.ae648a0b88"
[0m14:42:11.914704 [debug] [Thread-2 (]: Began executing node test.dbt_exercise.source_not_null_northwind_employee_territories_employee_id.d7372217ec
[0m14:42:11.923516 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_exercise.source_not_null_northwind_employees_employee_id.829479a08c"
[0m14:42:11.930888 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_exercise.source_not_null_northwind_employee_territories_employee_id.d7372217ec"
[0m14:42:11.972630 [debug] [Thread-3 (]: Began executing node test.dbt_exercise.source_not_null_northwind_employee_territories_territory_id.ae648a0b88
[0m14:42:11.974554 [debug] [Thread-1 (]: Began executing node test.dbt_exercise.source_not_null_northwind_employees_employee_id.829479a08c
[0m14:42:11.979408 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_exercise.source_not_null_northwind_employee_territories_territory_id.ae648a0b88"
[0m14:42:11.980348 [debug] [Thread-2 (]: On test.dbt_exercise.source_not_null_northwind_employee_territories_employee_id.d7372217ec: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "test.dbt_exercise.source_not_null_northwind_employee_territories_employee_id.d7372217ec"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select employee_id
from `corded-sunlight-464012-e2`.`dbt_dw_raw`.`employee_territories`
where employee_id is null



  
  
      
    ) dbt_internal_test
[0m14:42:11.984779 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_exercise.source_not_null_northwind_employees_employee_id.829479a08c"
[0m14:42:11.986314 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:42:11.987758 [debug] [Thread-3 (]: On test.dbt_exercise.source_not_null_northwind_employee_territories_territory_id.ae648a0b88: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "test.dbt_exercise.source_not_null_northwind_employee_territories_territory_id.ae648a0b88"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select territory_id
from `corded-sunlight-464012-e2`.`dbt_dw_raw`.`employee_territories`
where territory_id is null



  
  
      
    ) dbt_internal_test
[0m14:42:11.988837 [debug] [Thread-1 (]: On test.dbt_exercise.source_not_null_northwind_employees_employee_id.829479a08c: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "test.dbt_exercise.source_not_null_northwind_employees_employee_id.829479a08c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select employee_id
from `corded-sunlight-464012-e2`.`dbt_dw_raw`.`employees`
where employee_id is null



  
  
      
    ) dbt_internal_test
[0m14:42:11.989895 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:42:11.990992 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:42:13.171172 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:fe936f63-bd39-4622-974b-514f4c477c4f&page=queryresults
[0m14:42:13.213819 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:f340381f-652e-4ecb-b3cf-b6e903bc0fe0&page=queryresults
[0m14:42:13.245458 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:415ad0f2-e14c-492e-9ea0-014d0ed645f5&page=queryresults
[0m14:42:13.273786 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:18f0c74f-d497-4eab-bc26-18f2709b639f&page=queryresults
[0m14:42:14.021148 [info ] [Thread-4 (]: 7 of 35 PASS source_not_null_northwind_dados_financeiros_data .................. [[32mPASS[0m in 2.21s]
[0m14:42:14.022630 [debug] [Thread-4 (]: Finished running node test.dbt_exercise.source_not_null_northwind_dados_financeiros_data.cdd6b46fe7
[0m14:42:14.023971 [debug] [Thread-4 (]: Began running node test.dbt_exercise.source_not_null_northwind_order_details_order_id.8acd43693e
[0m14:42:14.024889 [info ] [Thread-4 (]: 11 of 35 START test source_not_null_northwind_order_details_order_id ........... [RUN]
[0m14:42:14.025845 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_exercise.source_not_null_northwind_dados_financeiros_data.cdd6b46fe7, now test.dbt_exercise.source_not_null_northwind_order_details_order_id.8acd43693e)
[0m14:42:14.026597 [debug] [Thread-4 (]: Began compiling node test.dbt_exercise.source_not_null_northwind_order_details_order_id.8acd43693e
[0m14:42:14.037253 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_exercise.source_not_null_northwind_order_details_order_id.8acd43693e"
[0m14:42:14.039104 [debug] [Thread-4 (]: Began executing node test.dbt_exercise.source_not_null_northwind_order_details_order_id.8acd43693e
[0m14:42:14.045579 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_exercise.source_not_null_northwind_order_details_order_id.8acd43693e"
[0m14:42:14.049471 [debug] [Thread-4 (]: On test.dbt_exercise.source_not_null_northwind_order_details_order_id.8acd43693e: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "test.dbt_exercise.source_not_null_northwind_order_details_order_id.8acd43693e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select order_id
from `corded-sunlight-464012-e2`.`dbt_dw_raw`.`order_details`
where order_id is null



  
  
      
    ) dbt_internal_test
[0m14:42:14.051822 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m14:42:14.124809 [info ] [Thread-2 (]: 8 of 35 PASS source_not_null_northwind_employee_territories_employee_id ........ [[32mPASS[0m in 2.25s]
[0m14:42:14.126112 [debug] [Thread-2 (]: Finished running node test.dbt_exercise.source_not_null_northwind_employee_territories_employee_id.d7372217ec
[0m14:42:14.126907 [debug] [Thread-2 (]: Began running node test.dbt_exercise.source_not_null_northwind_order_details_product_id.c084f7ad12
[0m14:42:14.128262 [info ] [Thread-2 (]: 12 of 35 START test source_not_null_northwind_order_details_product_id ......... [RUN]
[0m14:42:14.130240 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_exercise.source_not_null_northwind_employee_territories_employee_id.d7372217ec, now test.dbt_exercise.source_not_null_northwind_order_details_product_id.c084f7ad12)
[0m14:42:14.131704 [debug] [Thread-2 (]: Began compiling node test.dbt_exercise.source_not_null_northwind_order_details_product_id.c084f7ad12
[0m14:42:14.139971 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_exercise.source_not_null_northwind_order_details_product_id.c084f7ad12"
[0m14:42:14.141129 [debug] [Thread-2 (]: Began executing node test.dbt_exercise.source_not_null_northwind_order_details_product_id.c084f7ad12
[0m14:42:14.145559 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_exercise.source_not_null_northwind_order_details_product_id.c084f7ad12"
[0m14:42:14.148189 [debug] [Thread-2 (]: On test.dbt_exercise.source_not_null_northwind_order_details_product_id.c084f7ad12: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "test.dbt_exercise.source_not_null_northwind_order_details_product_id.c084f7ad12"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select product_id
from `corded-sunlight-464012-e2`.`dbt_dw_raw`.`order_details`
where product_id is null



  
  
      
    ) dbt_internal_test
[0m14:42:14.149628 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:42:14.203698 [info ] [Thread-3 (]: 9 of 35 PASS source_not_null_northwind_employee_territories_territory_id ....... [[32mPASS[0m in 2.32s]
[0m14:42:14.206432 [debug] [Thread-3 (]: Finished running node test.dbt_exercise.source_not_null_northwind_employee_territories_territory_id.ae648a0b88
[0m14:42:14.207963 [debug] [Thread-3 (]: Began running node test.dbt_exercise.source_not_null_northwind_orders_customer_id.3e09955b24
[0m14:42:14.208950 [info ] [Thread-3 (]: 13 of 35 START test source_not_null_northwind_orders_customer_id ............... [RUN]
[0m14:42:14.209971 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_exercise.source_not_null_northwind_employee_territories_territory_id.ae648a0b88, now test.dbt_exercise.source_not_null_northwind_orders_customer_id.3e09955b24)
[0m14:42:14.211248 [debug] [Thread-3 (]: Began compiling node test.dbt_exercise.source_not_null_northwind_orders_customer_id.3e09955b24
[0m14:42:14.221099 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_exercise.source_not_null_northwind_orders_customer_id.3e09955b24"
[0m14:42:14.223356 [debug] [Thread-3 (]: Began executing node test.dbt_exercise.source_not_null_northwind_orders_customer_id.3e09955b24
[0m14:42:14.227941 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_exercise.source_not_null_northwind_orders_customer_id.3e09955b24"
[0m14:42:14.229361 [debug] [Thread-3 (]: On test.dbt_exercise.source_not_null_northwind_orders_customer_id.3e09955b24: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "test.dbt_exercise.source_not_null_northwind_orders_customer_id.3e09955b24"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select customer_id
from `corded-sunlight-464012-e2`.`dbt_dw_raw`.`orders`
where customer_id is null



  
  
      
    ) dbt_internal_test
[0m14:42:14.230576 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:42:14.287980 [info ] [Thread-1 (]: 10 of 35 PASS source_not_null_northwind_employees_employee_id .................. [[32mPASS[0m in 2.40s]
[0m14:42:14.289637 [debug] [Thread-1 (]: Finished running node test.dbt_exercise.source_not_null_northwind_employees_employee_id.829479a08c
[0m14:42:14.291273 [debug] [Thread-1 (]: Began running node test.dbt_exercise.source_not_null_northwind_orders_employee_id.a8f4bf5ca3
[0m14:42:14.293349 [info ] [Thread-1 (]: 14 of 35 START test source_not_null_northwind_orders_employee_id ............... [RUN]
[0m14:42:14.295803 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_exercise.source_not_null_northwind_employees_employee_id.829479a08c, now test.dbt_exercise.source_not_null_northwind_orders_employee_id.a8f4bf5ca3)
[0m14:42:14.297019 [debug] [Thread-1 (]: Began compiling node test.dbt_exercise.source_not_null_northwind_orders_employee_id.a8f4bf5ca3
[0m14:42:14.305516 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_exercise.source_not_null_northwind_orders_employee_id.a8f4bf5ca3"
[0m14:42:14.307004 [debug] [Thread-1 (]: Began executing node test.dbt_exercise.source_not_null_northwind_orders_employee_id.a8f4bf5ca3
[0m14:42:14.311467 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_exercise.source_not_null_northwind_orders_employee_id.a8f4bf5ca3"
[0m14:42:14.312833 [debug] [Thread-1 (]: On test.dbt_exercise.source_not_null_northwind_orders_employee_id.a8f4bf5ca3: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "test.dbt_exercise.source_not_null_northwind_orders_employee_id.a8f4bf5ca3"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select employee_id
from `corded-sunlight-464012-e2`.`dbt_dw_raw`.`orders`
where employee_id is null



  
  
      
    ) dbt_internal_test
[0m14:42:14.313972 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:42:15.285685 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:2d1d109e-4071-4c75-9f26-78e6ba16a6f9&page=queryresults
[0m14:42:15.289295 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:e975c34e-3e14-4272-98a3-7b9fd1dca644&page=queryresults
[0m14:42:15.347972 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:bcdfc89b-d14f-4d16-9467-506584040c26&page=queryresults
[0m14:42:15.668622 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:5b3dd689-5e51-4849-a9f4-ce44763204d2&page=queryresults
[0m14:42:16.146628 [info ] [Thread-4 (]: 11 of 35 PASS source_not_null_northwind_order_details_order_id ................. [[32mPASS[0m in 2.12s]
[0m14:42:16.148381 [debug] [Thread-4 (]: Finished running node test.dbt_exercise.source_not_null_northwind_order_details_order_id.8acd43693e
[0m14:42:16.149269 [debug] [Thread-4 (]: Began running node test.dbt_exercise.source_not_null_northwind_orders_order_id.5a7c008c6e
[0m14:42:16.150292 [info ] [Thread-4 (]: 15 of 35 START test source_not_null_northwind_orders_order_id .................. [RUN]
[0m14:42:16.151621 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_exercise.source_not_null_northwind_order_details_order_id.8acd43693e, now test.dbt_exercise.source_not_null_northwind_orders_order_id.5a7c008c6e)
[0m14:42:16.152371 [debug] [Thread-4 (]: Began compiling node test.dbt_exercise.source_not_null_northwind_orders_order_id.5a7c008c6e
[0m14:42:16.168072 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_exercise.source_not_null_northwind_orders_order_id.5a7c008c6e"
[0m14:42:16.170057 [debug] [Thread-4 (]: Began executing node test.dbt_exercise.source_not_null_northwind_orders_order_id.5a7c008c6e
[0m14:42:16.176706 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_exercise.source_not_null_northwind_orders_order_id.5a7c008c6e"
[0m14:42:16.179844 [debug] [Thread-4 (]: On test.dbt_exercise.source_not_null_northwind_orders_order_id.5a7c008c6e: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "test.dbt_exercise.source_not_null_northwind_orders_order_id.5a7c008c6e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select order_id
from `corded-sunlight-464012-e2`.`dbt_dw_raw`.`orders`
where order_id is null



  
  
      
    ) dbt_internal_test
[0m14:42:16.183678 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m14:42:16.187897 [info ] [Thread-2 (]: 12 of 35 PASS source_not_null_northwind_order_details_product_id ............... [[32mPASS[0m in 2.06s]
[0m14:42:16.189701 [debug] [Thread-2 (]: Finished running node test.dbt_exercise.source_not_null_northwind_order_details_product_id.c084f7ad12
[0m14:42:16.190933 [debug] [Thread-2 (]: Began running node test.dbt_exercise.source_not_null_northwind_products_product_id.1bc1aa1d1c
[0m14:42:16.192297 [info ] [Thread-2 (]: 16 of 35 START test source_not_null_northwind_products_product_id .............. [RUN]
[0m14:42:16.193999 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_exercise.source_not_null_northwind_order_details_product_id.c084f7ad12, now test.dbt_exercise.source_not_null_northwind_products_product_id.1bc1aa1d1c)
[0m14:42:16.198630 [debug] [Thread-2 (]: Began compiling node test.dbt_exercise.source_not_null_northwind_products_product_id.1bc1aa1d1c
[0m14:42:16.250632 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_exercise.source_not_null_northwind_products_product_id.1bc1aa1d1c"
[0m14:42:16.252975 [debug] [Thread-2 (]: Began executing node test.dbt_exercise.source_not_null_northwind_products_product_id.1bc1aa1d1c
[0m14:42:16.257001 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_exercise.source_not_null_northwind_products_product_id.1bc1aa1d1c"
[0m14:42:16.259470 [debug] [Thread-2 (]: On test.dbt_exercise.source_not_null_northwind_products_product_id.1bc1aa1d1c: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "test.dbt_exercise.source_not_null_northwind_products_product_id.1bc1aa1d1c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select product_id
from `corded-sunlight-464012-e2`.`dbt_dw_raw`.`products`
where product_id is null



  
  
      
    ) dbt_internal_test
[0m14:42:16.261648 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:42:16.362967 [info ] [Thread-3 (]: 13 of 35 PASS source_not_null_northwind_orders_customer_id ..................... [[32mPASS[0m in 2.15s]
[0m14:42:16.365541 [debug] [Thread-3 (]: Finished running node test.dbt_exercise.source_not_null_northwind_orders_customer_id.3e09955b24
[0m14:42:16.366764 [debug] [Thread-3 (]: Began running node test.dbt_exercise.source_not_null_northwind_region_region_id.c95367d9e3
[0m14:42:16.368591 [info ] [Thread-3 (]: 17 of 35 START test source_not_null_northwind_region_region_id ................. [RUN]
[0m14:42:16.370125 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_exercise.source_not_null_northwind_orders_customer_id.3e09955b24, now test.dbt_exercise.source_not_null_northwind_region_region_id.c95367d9e3)
[0m14:42:16.371398 [debug] [Thread-3 (]: Began compiling node test.dbt_exercise.source_not_null_northwind_region_region_id.c95367d9e3
[0m14:42:16.382495 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_exercise.source_not_null_northwind_region_region_id.c95367d9e3"
[0m14:42:16.385128 [debug] [Thread-3 (]: Began executing node test.dbt_exercise.source_not_null_northwind_region_region_id.c95367d9e3
[0m14:42:16.390517 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_exercise.source_not_null_northwind_region_region_id.c95367d9e3"
[0m14:42:16.392646 [debug] [Thread-3 (]: On test.dbt_exercise.source_not_null_northwind_region_region_id.c95367d9e3: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "test.dbt_exercise.source_not_null_northwind_region_region_id.c95367d9e3"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select region_id
from `corded-sunlight-464012-e2`.`dbt_dw_raw`.`region`
where region_id is null



  
  
      
    ) dbt_internal_test
[0m14:42:16.393964 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:42:16.625158 [info ] [Thread-1 (]: 14 of 35 PASS source_not_null_northwind_orders_employee_id ..................... [[32mPASS[0m in 2.33s]
[0m14:42:16.626530 [debug] [Thread-1 (]: Finished running node test.dbt_exercise.source_not_null_northwind_orders_employee_id.a8f4bf5ca3
[0m14:42:16.627671 [debug] [Thread-1 (]: Began running node test.dbt_exercise.source_not_null_northwind_shippers_shipper_id.45221752ca
[0m14:42:16.628651 [info ] [Thread-1 (]: 18 of 35 START test source_not_null_northwind_shippers_shipper_id .............. [RUN]
[0m14:42:16.629758 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_exercise.source_not_null_northwind_orders_employee_id.a8f4bf5ca3, now test.dbt_exercise.source_not_null_northwind_shippers_shipper_id.45221752ca)
[0m14:42:16.630577 [debug] [Thread-1 (]: Began compiling node test.dbt_exercise.source_not_null_northwind_shippers_shipper_id.45221752ca
[0m14:42:16.639855 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_exercise.source_not_null_northwind_shippers_shipper_id.45221752ca"
[0m14:42:16.647467 [debug] [Thread-1 (]: Began executing node test.dbt_exercise.source_not_null_northwind_shippers_shipper_id.45221752ca
[0m14:42:16.660032 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_exercise.source_not_null_northwind_shippers_shipper_id.45221752ca"
[0m14:42:16.663979 [debug] [Thread-1 (]: On test.dbt_exercise.source_not_null_northwind_shippers_shipper_id.45221752ca: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "test.dbt_exercise.source_not_null_northwind_shippers_shipper_id.45221752ca"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select shipper_id
from `corded-sunlight-464012-e2`.`dbt_dw_raw`.`shippers`
where shipper_id is null



  
  
      
    ) dbt_internal_test
[0m14:42:16.665915 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:42:17.305044 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:ac4cdc2f-9ba6-4c8d-8c56-dfc314f215ad&page=queryresults
[0m14:42:17.413705 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:8d69f3c9-b859-4989-8e4c-d4f94605bf4f&page=queryresults
[0m14:42:17.557662 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:9a0ec59c-5111-40eb-a4b6-45382650e0da&page=queryresults
[0m14:42:17.896197 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:cf60e41f-8294-445c-9c0d-161d9c614084&page=queryresults
[0m14:42:18.263056 [info ] [Thread-4 (]: 15 of 35 PASS source_not_null_northwind_orders_order_id ........................ [[32mPASS[0m in 2.11s]
[0m14:42:18.264700 [debug] [Thread-4 (]: Finished running node test.dbt_exercise.source_not_null_northwind_orders_order_id.5a7c008c6e
[0m14:42:18.265745 [debug] [Thread-4 (]: Began running node test.dbt_exercise.source_not_null_northwind_suppliers_supplier_id.de5c4d0062
[0m14:42:18.267068 [info ] [Thread-4 (]: 19 of 35 START test source_not_null_northwind_suppliers_supplier_id ............ [RUN]
[0m14:42:18.268468 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_exercise.source_not_null_northwind_orders_order_id.5a7c008c6e, now test.dbt_exercise.source_not_null_northwind_suppliers_supplier_id.de5c4d0062)
[0m14:42:18.269600 [debug] [Thread-4 (]: Began compiling node test.dbt_exercise.source_not_null_northwind_suppliers_supplier_id.de5c4d0062
[0m14:42:18.290522 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_exercise.source_not_null_northwind_suppliers_supplier_id.de5c4d0062"
[0m14:42:18.293630 [debug] [Thread-4 (]: Began executing node test.dbt_exercise.source_not_null_northwind_suppliers_supplier_id.de5c4d0062
[0m14:42:18.301464 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_exercise.source_not_null_northwind_suppliers_supplier_id.de5c4d0062"
[0m14:42:18.303495 [debug] [Thread-4 (]: On test.dbt_exercise.source_not_null_northwind_suppliers_supplier_id.de5c4d0062: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "test.dbt_exercise.source_not_null_northwind_suppliers_supplier_id.de5c4d0062"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select supplier_id
from `corded-sunlight-464012-e2`.`dbt_dw_raw`.`suppliers`
where supplier_id is null



  
  
      
    ) dbt_internal_test
[0m14:42:18.305001 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m14:42:18.311406 [info ] [Thread-2 (]: 16 of 35 PASS source_not_null_northwind_products_product_id .................... [[32mPASS[0m in 2.12s]
[0m14:42:18.314435 [debug] [Thread-2 (]: Finished running node test.dbt_exercise.source_not_null_northwind_products_product_id.1bc1aa1d1c
[0m14:42:18.316373 [debug] [Thread-2 (]: Began running node test.dbt_exercise.source_not_null_northwind_territories_region_id.5df71bcf81
[0m14:42:18.318653 [info ] [Thread-2 (]: 20 of 35 START test source_not_null_northwind_territories_region_id ............ [RUN]
[0m14:42:18.323295 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_exercise.source_not_null_northwind_products_product_id.1bc1aa1d1c, now test.dbt_exercise.source_not_null_northwind_territories_region_id.5df71bcf81)
[0m14:42:18.368503 [debug] [Thread-2 (]: Began compiling node test.dbt_exercise.source_not_null_northwind_territories_region_id.5df71bcf81
[0m14:42:18.381093 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_exercise.source_not_null_northwind_territories_region_id.5df71bcf81"
[0m14:42:18.383304 [debug] [Thread-2 (]: Began executing node test.dbt_exercise.source_not_null_northwind_territories_region_id.5df71bcf81
[0m14:42:18.387791 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_exercise.source_not_null_northwind_territories_region_id.5df71bcf81"
[0m14:42:18.389180 [debug] [Thread-2 (]: On test.dbt_exercise.source_not_null_northwind_territories_region_id.5df71bcf81: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "test.dbt_exercise.source_not_null_northwind_territories_region_id.5df71bcf81"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select region_id
from `corded-sunlight-464012-e2`.`dbt_dw_raw`.`territories`
where region_id is null



  
  
      
    ) dbt_internal_test
[0m14:42:18.389975 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:42:18.441571 [info ] [Thread-3 (]: 17 of 35 PASS source_not_null_northwind_region_region_id ....................... [[32mPASS[0m in 2.07s]
[0m14:42:18.444798 [debug] [Thread-3 (]: Finished running node test.dbt_exercise.source_not_null_northwind_region_region_id.c95367d9e3
[0m14:42:18.446331 [debug] [Thread-3 (]: Began running node test.dbt_exercise.source_not_null_northwind_territories_territory_id.9b9655b8a9
[0m14:42:18.447542 [info ] [Thread-3 (]: 21 of 35 START test source_not_null_northwind_territories_territory_id ......... [RUN]
[0m14:42:18.448832 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_exercise.source_not_null_northwind_region_region_id.c95367d9e3, now test.dbt_exercise.source_not_null_northwind_territories_territory_id.9b9655b8a9)
[0m14:42:18.450983 [debug] [Thread-3 (]: Began compiling node test.dbt_exercise.source_not_null_northwind_territories_territory_id.9b9655b8a9
[0m14:42:18.460750 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_exercise.source_not_null_northwind_territories_territory_id.9b9655b8a9"
[0m14:42:18.463104 [debug] [Thread-3 (]: Began executing node test.dbt_exercise.source_not_null_northwind_territories_territory_id.9b9655b8a9
[0m14:42:18.469645 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_exercise.source_not_null_northwind_territories_territory_id.9b9655b8a9"
[0m14:42:18.471581 [debug] [Thread-3 (]: On test.dbt_exercise.source_not_null_northwind_territories_territory_id.9b9655b8a9: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "test.dbt_exercise.source_not_null_northwind_territories_territory_id.9b9655b8a9"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select territory_id
from `corded-sunlight-464012-e2`.`dbt_dw_raw`.`territories`
where territory_id is null



  
  
      
    ) dbt_internal_test
[0m14:42:18.473154 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:42:18.842271 [info ] [Thread-1 (]: 18 of 35 PASS source_not_null_northwind_shippers_shipper_id .................... [[32mPASS[0m in 2.21s]
[0m14:42:18.844018 [debug] [Thread-1 (]: Finished running node test.dbt_exercise.source_not_null_northwind_shippers_shipper_id.45221752ca
[0m14:42:18.845022 [debug] [Thread-1 (]: Began running node test.dbt_exercise.source_not_null_northwind_us_states_state_id.2e33a23d78
[0m14:42:18.847769 [info ] [Thread-1 (]: 22 of 35 START test source_not_null_northwind_us_states_state_id ............... [RUN]
[0m14:42:18.863228 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_exercise.source_not_null_northwind_shippers_shipper_id.45221752ca, now test.dbt_exercise.source_not_null_northwind_us_states_state_id.2e33a23d78)
[0m14:42:18.864834 [debug] [Thread-1 (]: Began compiling node test.dbt_exercise.source_not_null_northwind_us_states_state_id.2e33a23d78
[0m14:42:18.877000 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_exercise.source_not_null_northwind_us_states_state_id.2e33a23d78"
[0m14:42:18.879082 [debug] [Thread-1 (]: Began executing node test.dbt_exercise.source_not_null_northwind_us_states_state_id.2e33a23d78
[0m14:42:18.883683 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_exercise.source_not_null_northwind_us_states_state_id.2e33a23d78"
[0m14:42:18.884897 [debug] [Thread-1 (]: On test.dbt_exercise.source_not_null_northwind_us_states_state_id.2e33a23d78: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "test.dbt_exercise.source_not_null_northwind_us_states_state_id.2e33a23d78"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select state_id
from `corded-sunlight-464012-e2`.`dbt_dw_raw`.`us_states`
where state_id is null



  
  
      
    ) dbt_internal_test
[0m14:42:18.885600 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:42:19.428206 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:dae0f5bd-6b79-42d8-ad00-e56f71db0f51&page=queryresults
[0m14:42:19.589480 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:fc5686a2-7d55-4c7e-9b0f-782300ae31bb&page=queryresults
[0m14:42:19.617302 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:1cd9b8b4-bb54-4fb1-a8c8-7764b9f09189&page=queryresults
[0m14:42:20.065220 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:6e2e19fb-913e-42d9-acce-a83b95c7e0be&page=queryresults
[0m14:42:20.299403 [info ] [Thread-4 (]: 19 of 35 PASS source_not_null_northwind_suppliers_supplier_id .................. [[32mPASS[0m in 2.03s]
[0m14:42:20.301118 [debug] [Thread-4 (]: Finished running node test.dbt_exercise.source_not_null_northwind_suppliers_supplier_id.de5c4d0062
[0m14:42:20.302361 [debug] [Thread-4 (]: Began running node test.dbt_exercise.source_unique_northwind_categories_category_id.17d9baa2e0
[0m14:42:20.303792 [info ] [Thread-4 (]: 23 of 35 START test source_unique_northwind_categories_category_id ............. [RUN]
[0m14:42:20.305197 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_exercise.source_not_null_northwind_suppliers_supplier_id.de5c4d0062, now test.dbt_exercise.source_unique_northwind_categories_category_id.17d9baa2e0)
[0m14:42:20.306275 [debug] [Thread-4 (]: Began compiling node test.dbt_exercise.source_unique_northwind_categories_category_id.17d9baa2e0
[0m14:42:20.324930 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_exercise.source_unique_northwind_categories_category_id.17d9baa2e0"
[0m14:42:20.327686 [debug] [Thread-4 (]: Began executing node test.dbt_exercise.source_unique_northwind_categories_category_id.17d9baa2e0
[0m14:42:20.341221 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_exercise.source_unique_northwind_categories_category_id.17d9baa2e0"
[0m14:42:20.342586 [debug] [Thread-4 (]: On test.dbt_exercise.source_unique_northwind_categories_category_id.17d9baa2e0: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "test.dbt_exercise.source_unique_northwind_categories_category_id.17d9baa2e0"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with dbt_test__target as (

  select category_id as unique_field
  from `corded-sunlight-464012-e2`.`dbt_dw_raw`.`categories`
  where category_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m14:42:20.343948 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m14:42:20.432313 [info ] [Thread-3 (]: 21 of 35 PASS source_not_null_northwind_territories_territory_id ............... [[32mPASS[0m in 1.98s]
[0m14:42:20.434078 [debug] [Thread-3 (]: Finished running node test.dbt_exercise.source_not_null_northwind_territories_territory_id.9b9655b8a9
[0m14:42:20.435336 [debug] [Thread-3 (]: Began running node test.dbt_exercise.source_unique_northwind_country_codes_country_code.cf83d0431e
[0m14:42:20.437037 [info ] [Thread-3 (]: 24 of 35 START test source_unique_northwind_country_codes_country_code ......... [RUN]
[0m14:42:20.438326 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_exercise.source_not_null_northwind_territories_territory_id.9b9655b8a9, now test.dbt_exercise.source_unique_northwind_country_codes_country_code.cf83d0431e)
[0m14:42:20.439626 [debug] [Thread-3 (]: Began compiling node test.dbt_exercise.source_unique_northwind_country_codes_country_code.cf83d0431e
[0m14:42:20.449452 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_exercise.source_unique_northwind_country_codes_country_code.cf83d0431e"
[0m14:42:20.456787 [info ] [Thread-2 (]: 20 of 35 PASS source_not_null_northwind_territories_region_id .................. [[32mPASS[0m in 2.13s]
[0m14:42:20.458181 [debug] [Thread-3 (]: Began executing node test.dbt_exercise.source_unique_northwind_country_codes_country_code.cf83d0431e
[0m14:42:20.459359 [debug] [Thread-2 (]: Finished running node test.dbt_exercise.source_not_null_northwind_territories_region_id.5df71bcf81
[0m14:42:20.465109 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_exercise.source_unique_northwind_country_codes_country_code.cf83d0431e"
[0m14:42:20.467568 [debug] [Thread-2 (]: Began running node test.dbt_exercise.source_unique_northwind_customers_customer_id.ff818c137b
[0m14:42:20.469866 [info ] [Thread-2 (]: 25 of 35 START test source_unique_northwind_customers_customer_id .............. [RUN]
[0m14:42:20.471313 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_exercise.source_not_null_northwind_territories_region_id.5df71bcf81, now test.dbt_exercise.source_unique_northwind_customers_customer_id.ff818c137b)
[0m14:42:20.472416 [debug] [Thread-3 (]: On test.dbt_exercise.source_unique_northwind_country_codes_country_code.cf83d0431e: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "test.dbt_exercise.source_unique_northwind_country_codes_country_code.cf83d0431e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with dbt_test__target as (

  select country_code as unique_field
  from `corded-sunlight-464012-e2`.`dbt_dw_raw`.`country_codes`
  where country_code is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m14:42:20.473369 [debug] [Thread-2 (]: Began compiling node test.dbt_exercise.source_unique_northwind_customers_customer_id.ff818c137b
[0m14:42:20.474518 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:42:20.489336 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_exercise.source_unique_northwind_customers_customer_id.ff818c137b"
[0m14:42:20.492037 [debug] [Thread-2 (]: Began executing node test.dbt_exercise.source_unique_northwind_customers_customer_id.ff818c137b
[0m14:42:20.497487 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_exercise.source_unique_northwind_customers_customer_id.ff818c137b"
[0m14:42:20.499907 [debug] [Thread-2 (]: On test.dbt_exercise.source_unique_northwind_customers_customer_id.ff818c137b: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "test.dbt_exercise.source_unique_northwind_customers_customer_id.ff818c137b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with dbt_test__target as (

  select customer_id as unique_field
  from `corded-sunlight-464012-e2`.`dbt_dw_raw`.`customers`
  where customer_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m14:42:20.501951 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:42:21.116299 [info ] [Thread-1 (]: 22 of 35 PASS source_not_null_northwind_us_states_state_id ..................... [[32mPASS[0m in 2.25s]
[0m14:42:21.118508 [debug] [Thread-1 (]: Finished running node test.dbt_exercise.source_not_null_northwind_us_states_state_id.2e33a23d78
[0m14:42:21.119842 [debug] [Thread-1 (]: Began running node test.dbt_exercise.source_unique_northwind_employees_employee_id.e63c624594
[0m14:42:21.121239 [info ] [Thread-1 (]: 26 of 35 START test source_unique_northwind_employees_employee_id .............. [RUN]
[0m14:42:21.123235 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_exercise.source_not_null_northwind_us_states_state_id.2e33a23d78, now test.dbt_exercise.source_unique_northwind_employees_employee_id.e63c624594)
[0m14:42:21.124760 [debug] [Thread-1 (]: Began compiling node test.dbt_exercise.source_unique_northwind_employees_employee_id.e63c624594
[0m14:42:21.135067 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_exercise.source_unique_northwind_employees_employee_id.e63c624594"
[0m14:42:21.136345 [debug] [Thread-1 (]: Began executing node test.dbt_exercise.source_unique_northwind_employees_employee_id.e63c624594
[0m14:42:21.153654 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_exercise.source_unique_northwind_employees_employee_id.e63c624594"
[0m14:42:21.156444 [debug] [Thread-1 (]: On test.dbt_exercise.source_unique_northwind_employees_employee_id.e63c624594: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "test.dbt_exercise.source_unique_northwind_employees_employee_id.e63c624594"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with dbt_test__target as (

  select employee_id as unique_field
  from `corded-sunlight-464012-e2`.`dbt_dw_raw`.`employees`
  where employee_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m14:42:21.157618 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:42:21.511749 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:6cb42d7d-45ee-450c-b5df-cc8048b3ea9d&page=queryresults
[0m14:42:21.856076 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:15f008ce-1fd0-420f-aebd-8e7c2f482c28&page=queryresults
[0m14:42:21.952658 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:e217f9ae-3e54-4456-aeea-959465e010fb&page=queryresults
[0m14:42:22.358377 [info ] [Thread-4 (]: 23 of 35 PASS source_unique_northwind_categories_category_id ................... [[32mPASS[0m in 2.05s]
[0m14:42:22.360046 [debug] [Thread-4 (]: Finished running node test.dbt_exercise.source_unique_northwind_categories_category_id.17d9baa2e0
[0m14:42:22.360877 [debug] [Thread-4 (]: Began running node test.dbt_exercise.source_unique_northwind_orders_order_id.4a8a4df128
[0m14:42:22.362441 [info ] [Thread-4 (]: 27 of 35 START test source_unique_northwind_orders_order_id .................... [RUN]
[0m14:42:22.364468 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_exercise.source_unique_northwind_categories_category_id.17d9baa2e0, now test.dbt_exercise.source_unique_northwind_orders_order_id.4a8a4df128)
[0m14:42:22.365705 [debug] [Thread-4 (]: Began compiling node test.dbt_exercise.source_unique_northwind_orders_order_id.4a8a4df128
[0m14:42:22.377456 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_exercise.source_unique_northwind_orders_order_id.4a8a4df128"
[0m14:42:22.379643 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:31bd3fdd-18f0-4813-92bf-0cc8d7c9100b&page=queryresults
[0m14:42:22.385838 [debug] [Thread-4 (]: Began executing node test.dbt_exercise.source_unique_northwind_orders_order_id.4a8a4df128
[0m14:42:22.399914 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_exercise.source_unique_northwind_orders_order_id.4a8a4df128"
[0m14:42:22.401827 [debug] [Thread-4 (]: On test.dbt_exercise.source_unique_northwind_orders_order_id.4a8a4df128: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "test.dbt_exercise.source_unique_northwind_orders_order_id.4a8a4df128"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with dbt_test__target as (

  select order_id as unique_field
  from `corded-sunlight-464012-e2`.`dbt_dw_raw`.`orders`
  where order_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m14:42:22.402761 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m14:42:22.678599 [info ] [Thread-3 (]: 24 of 35 PASS source_unique_northwind_country_codes_country_code ............... [[32mPASS[0m in 2.24s]
[0m14:42:22.680521 [debug] [Thread-3 (]: Finished running node test.dbt_exercise.source_unique_northwind_country_codes_country_code.cf83d0431e
[0m14:42:22.681285 [debug] [Thread-3 (]: Began running node test.dbt_exercise.source_unique_northwind_products_product_id.740bf6f9a5
[0m14:42:22.682157 [info ] [Thread-3 (]: 28 of 35 START test source_unique_northwind_products_product_id ................ [RUN]
[0m14:42:22.683229 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_exercise.source_unique_northwind_country_codes_country_code.cf83d0431e, now test.dbt_exercise.source_unique_northwind_products_product_id.740bf6f9a5)
[0m14:42:22.684072 [debug] [Thread-3 (]: Began compiling node test.dbt_exercise.source_unique_northwind_products_product_id.740bf6f9a5
[0m14:42:22.692808 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_exercise.source_unique_northwind_products_product_id.740bf6f9a5"
[0m14:42:22.695334 [debug] [Thread-3 (]: Began executing node test.dbt_exercise.source_unique_northwind_products_product_id.740bf6f9a5
[0m14:42:22.703310 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_exercise.source_unique_northwind_products_product_id.740bf6f9a5"
[0m14:42:22.704709 [debug] [Thread-3 (]: On test.dbt_exercise.source_unique_northwind_products_product_id.740bf6f9a5: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "test.dbt_exercise.source_unique_northwind_products_product_id.740bf6f9a5"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with dbt_test__target as (

  select product_id as unique_field
  from `corded-sunlight-464012-e2`.`dbt_dw_raw`.`products`
  where product_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m14:42:22.705407 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:42:22.801470 [info ] [Thread-2 (]: 25 of 35 PASS source_unique_northwind_customers_customer_id .................... [[32mPASS[0m in 2.33s]
[0m14:42:22.803109 [debug] [Thread-2 (]: Finished running node test.dbt_exercise.source_unique_northwind_customers_customer_id.ff818c137b
[0m14:42:22.804134 [debug] [Thread-2 (]: Began running node test.dbt_exercise.source_unique_northwind_region_region_id.9688f1f5fd
[0m14:42:22.805063 [info ] [Thread-2 (]: 29 of 35 START test source_unique_northwind_region_region_id ................... [RUN]
[0m14:42:22.806001 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_exercise.source_unique_northwind_customers_customer_id.ff818c137b, now test.dbt_exercise.source_unique_northwind_region_region_id.9688f1f5fd)
[0m14:42:22.806752 [debug] [Thread-2 (]: Began compiling node test.dbt_exercise.source_unique_northwind_region_region_id.9688f1f5fd
[0m14:42:22.819134 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_exercise.source_unique_northwind_region_region_id.9688f1f5fd"
[0m14:42:22.821048 [debug] [Thread-2 (]: Began executing node test.dbt_exercise.source_unique_northwind_region_region_id.9688f1f5fd
[0m14:42:22.826778 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_exercise.source_unique_northwind_region_region_id.9688f1f5fd"
[0m14:42:22.828689 [debug] [Thread-2 (]: On test.dbt_exercise.source_unique_northwind_region_region_id.9688f1f5fd: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "test.dbt_exercise.source_unique_northwind_region_region_id.9688f1f5fd"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with dbt_test__target as (

  select region_id as unique_field
  from `corded-sunlight-464012-e2`.`dbt_dw_raw`.`region`
  where region_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m14:42:22.829926 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:42:23.267402 [info ] [Thread-1 (]: 26 of 35 PASS source_unique_northwind_employees_employee_id .................... [[32mPASS[0m in 2.14s]
[0m14:42:23.269140 [debug] [Thread-1 (]: Finished running node test.dbt_exercise.source_unique_northwind_employees_employee_id.e63c624594
[0m14:42:23.270480 [debug] [Thread-1 (]: Began running node test.dbt_exercise.source_unique_northwind_shippers_shipper_id.61edb3f736
[0m14:42:23.271912 [info ] [Thread-1 (]: 30 of 35 START test source_unique_northwind_shippers_shipper_id ................ [RUN]
[0m14:42:23.273347 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_exercise.source_unique_northwind_employees_employee_id.e63c624594, now test.dbt_exercise.source_unique_northwind_shippers_shipper_id.61edb3f736)
[0m14:42:23.274292 [debug] [Thread-1 (]: Began compiling node test.dbt_exercise.source_unique_northwind_shippers_shipper_id.61edb3f736
[0m14:42:23.282523 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_exercise.source_unique_northwind_shippers_shipper_id.61edb3f736"
[0m14:42:23.283793 [debug] [Thread-1 (]: Began executing node test.dbt_exercise.source_unique_northwind_shippers_shipper_id.61edb3f736
[0m14:42:23.289744 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_exercise.source_unique_northwind_shippers_shipper_id.61edb3f736"
[0m14:42:23.291559 [debug] [Thread-1 (]: On test.dbt_exercise.source_unique_northwind_shippers_shipper_id.61edb3f736: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "test.dbt_exercise.source_unique_northwind_shippers_shipper_id.61edb3f736"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with dbt_test__target as (

  select shipper_id as unique_field
  from `corded-sunlight-464012-e2`.`dbt_dw_raw`.`shippers`
  where shipper_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m14:42:23.292698 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:42:23.633871 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:ef60460c-58bd-427e-b6ce-67d0d8d77535&page=queryresults
[0m14:42:24.095424 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:34cf27fb-ec39-4556-9201-2258fa031eb2&page=queryresults
[0m14:42:24.467940 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:4e4f4808-cfd4-4283-a084-2a2da6b23d68&page=queryresults
[0m14:42:24.481588 [info ] [Thread-4 (]: 27 of 35 PASS source_unique_northwind_orders_order_id .......................... [[32mPASS[0m in 2.12s]
[0m14:42:24.483223 [debug] [Thread-4 (]: Finished running node test.dbt_exercise.source_unique_northwind_orders_order_id.4a8a4df128
[0m14:42:24.484307 [debug] [Thread-4 (]: Began running node test.dbt_exercise.source_unique_northwind_suppliers_supplier_id.aa7461739b
[0m14:42:24.485268 [info ] [Thread-4 (]: 31 of 35 START test source_unique_northwind_suppliers_supplier_id .............. [RUN]
[0m14:42:24.486336 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_exercise.source_unique_northwind_orders_order_id.4a8a4df128, now test.dbt_exercise.source_unique_northwind_suppliers_supplier_id.aa7461739b)
[0m14:42:24.487189 [debug] [Thread-4 (]: Began compiling node test.dbt_exercise.source_unique_northwind_suppliers_supplier_id.aa7461739b
[0m14:42:24.495092 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_exercise.source_unique_northwind_suppliers_supplier_id.aa7461739b"
[0m14:42:24.496760 [debug] [Thread-4 (]: Began executing node test.dbt_exercise.source_unique_northwind_suppliers_supplier_id.aa7461739b
[0m14:42:24.501494 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_exercise.source_unique_northwind_suppliers_supplier_id.aa7461739b"
[0m14:42:24.503466 [debug] [Thread-4 (]: On test.dbt_exercise.source_unique_northwind_suppliers_supplier_id.aa7461739b: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "test.dbt_exercise.source_unique_northwind_suppliers_supplier_id.aa7461739b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with dbt_test__target as (

  select supplier_id as unique_field
  from `corded-sunlight-464012-e2`.`dbt_dw_raw`.`suppliers`
  where supplier_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m14:42:24.505239 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m14:42:24.702291 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:2fb7275a-bd0f-47be-a5f8-51db858566a3&page=queryresults
[0m14:42:24.976787 [info ] [Thread-2 (]: 29 of 35 PASS source_unique_northwind_region_region_id ......................... [[32mPASS[0m in 2.17s]
[0m14:42:24.978408 [debug] [Thread-2 (]: Finished running node test.dbt_exercise.source_unique_northwind_region_region_id.9688f1f5fd
[0m14:42:24.979376 [debug] [Thread-2 (]: Began running node test.dbt_exercise.source_unique_northwind_territories_territory_id.08bc548860
[0m14:42:24.980208 [info ] [Thread-2 (]: 32 of 35 START test source_unique_northwind_territories_territory_id ........... [RUN]
[0m14:42:24.981284 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_exercise.source_unique_northwind_region_region_id.9688f1f5fd, now test.dbt_exercise.source_unique_northwind_territories_territory_id.08bc548860)
[0m14:42:24.982320 [debug] [Thread-2 (]: Began compiling node test.dbt_exercise.source_unique_northwind_territories_territory_id.08bc548860
[0m14:42:24.999035 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_exercise.source_unique_northwind_territories_territory_id.08bc548860"
[0m14:42:25.001268 [debug] [Thread-2 (]: Began executing node test.dbt_exercise.source_unique_northwind_territories_territory_id.08bc548860
[0m14:42:25.006704 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_exercise.source_unique_northwind_territories_territory_id.08bc548860"
[0m14:42:25.008143 [debug] [Thread-2 (]: On test.dbt_exercise.source_unique_northwind_territories_territory_id.08bc548860: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "test.dbt_exercise.source_unique_northwind_territories_territory_id.08bc548860"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with dbt_test__target as (

  select territory_id as unique_field
  from `corded-sunlight-464012-e2`.`dbt_dw_raw`.`territories`
  where territory_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m14:42:25.008946 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:42:25.329728 [info ] [Thread-3 (]: 28 of 35 PASS source_unique_northwind_products_product_id ...................... [[32mPASS[0m in 2.65s]
[0m14:42:25.335073 [debug] [Thread-3 (]: Finished running node test.dbt_exercise.source_unique_northwind_products_product_id.740bf6f9a5
[0m14:42:25.336529 [debug] [Thread-3 (]: Began running node test.dbt_exercise.source_unique_northwind_us_states_state_id.c374c85cda
[0m14:42:25.338321 [info ] [Thread-3 (]: 33 of 35 START test source_unique_northwind_us_states_state_id ................. [RUN]
[0m14:42:25.340218 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_exercise.source_unique_northwind_products_product_id.740bf6f9a5, now test.dbt_exercise.source_unique_northwind_us_states_state_id.c374c85cda)
[0m14:42:25.341440 [debug] [Thread-3 (]: Began compiling node test.dbt_exercise.source_unique_northwind_us_states_state_id.c374c85cda
[0m14:42:25.352945 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_exercise.source_unique_northwind_us_states_state_id.c374c85cda"
[0m14:42:25.355602 [debug] [Thread-3 (]: Began executing node test.dbt_exercise.source_unique_northwind_us_states_state_id.c374c85cda
[0m14:42:25.360122 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_exercise.source_unique_northwind_us_states_state_id.c374c85cda"
[0m14:42:25.362040 [debug] [Thread-3 (]: On test.dbt_exercise.source_unique_northwind_us_states_state_id.c374c85cda: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "test.dbt_exercise.source_unique_northwind_us_states_state_id.c374c85cda"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with dbt_test__target as (

  select state_id as unique_field
  from `corded-sunlight-464012-e2`.`dbt_dw_raw`.`us_states`
  where state_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m14:42:25.364023 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:42:25.620126 [info ] [Thread-1 (]: 30 of 35 PASS source_unique_northwind_shippers_shipper_id ...................... [[32mPASS[0m in 2.35s]
[0m14:42:25.621477 [debug] [Thread-1 (]: Finished running node test.dbt_exercise.source_unique_northwind_shippers_shipper_id.61edb3f736
[0m14:42:25.622278 [debug] [Thread-1 (]: Began running node test.dbt_exercise.unique_my_first_dbt_model_id.16e066b321
[0m14:42:25.623616 [info ] [Thread-1 (]: 34 of 35 START test unique_my_first_dbt_model_id ............................... [RUN]
[0m14:42:25.624811 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_exercise.source_unique_northwind_shippers_shipper_id.61edb3f736, now test.dbt_exercise.unique_my_first_dbt_model_id.16e066b321)
[0m14:42:25.625697 [debug] [Thread-1 (]: Began compiling node test.dbt_exercise.unique_my_first_dbt_model_id.16e066b321
[0m14:42:25.633824 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_exercise.unique_my_first_dbt_model_id.16e066b321"
[0m14:42:25.635543 [debug] [Thread-1 (]: Began executing node test.dbt_exercise.unique_my_first_dbt_model_id.16e066b321
[0m14:42:25.641193 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_exercise.unique_my_first_dbt_model_id.16e066b321"
[0m14:42:25.644475 [debug] [Thread-1 (]: On test.dbt_exercise.unique_my_first_dbt_model_id.16e066b321: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "test.dbt_exercise.unique_my_first_dbt_model_id.16e066b321"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with dbt_test__target as (

  select id as unique_field
  from `corded-sunlight-464012-e2`.`dbt_dw`.`my_first_dbt_model`
  where id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m14:42:25.645811 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:42:25.719130 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:e4f5a620-38e5-4035-827b-050844cf8936&page=queryresults
[0m14:42:26.230726 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:4eb7f2a1-43aa-4507-a7a1-bc081089cf36&page=queryresults
[0m14:42:26.600798 [info ] [Thread-4 (]: 31 of 35 PASS source_unique_northwind_suppliers_supplier_id .................... [[32mPASS[0m in 2.11s]
[0m14:42:26.602690 [debug] [Thread-4 (]: Finished running node test.dbt_exercise.source_unique_northwind_suppliers_supplier_id.aa7461739b
[0m14:42:26.603721 [debug] [Thread-4 (]: Began running node test.dbt_exercise.unique_my_second_dbt_model_id.57a0f8c493
[0m14:42:26.604682 [info ] [Thread-4 (]: 35 of 35 START test unique_my_second_dbt_model_id .............................. [RUN]
[0m14:42:26.605741 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_exercise.source_unique_northwind_suppliers_supplier_id.aa7461739b, now test.dbt_exercise.unique_my_second_dbt_model_id.57a0f8c493)
[0m14:42:26.606562 [debug] [Thread-4 (]: Began compiling node test.dbt_exercise.unique_my_second_dbt_model_id.57a0f8c493
[0m14:42:26.617491 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_exercise.unique_my_second_dbt_model_id.57a0f8c493"
[0m14:42:26.620502 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:cdce33ec-a32b-4534-b95b-a08252a4b2f7&page=queryresults
[0m14:42:26.621978 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:cdce33ec-a32b-4534-b95b-a08252a4b2f7&page=queryresults
[0m14:42:26.623272 [debug] [Thread-4 (]: Began executing node test.dbt_exercise.unique_my_second_dbt_model_id.57a0f8c493
[0m14:42:26.631490 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_exercise.unique_my_second_dbt_model_id.57a0f8c493"
[0m14:42:26.635557 [debug] [Thread-4 (]: On test.dbt_exercise.unique_my_second_dbt_model_id.57a0f8c493: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "test.dbt_exercise.unique_my_second_dbt_model_id.57a0f8c493"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with dbt_test__target as (

  select id as unique_field
  from `corded-sunlight-464012-e2`.`dbt_dw`.`my_second_dbt_model`
  where id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m14:42:26.637221 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m14:42:26.721668 [debug] [Thread-1 (]: Database Error in test unique_my_first_dbt_model_id (models/schema.yml)
  Not found: Table corded-sunlight-464012-e2:dbt_dw.my_first_dbt_model was not found in location US
  compiled code at target/run/dbt_exercise/models/schema.yml/unique_my_first_dbt_model_id.sql
[0m14:42:26.723182 [error] [Thread-1 (]: 34 of 35 ERROR unique_my_first_dbt_model_id .................................... [[31mERROR[0m in 1.10s]
[0m14:42:26.724681 [debug] [Thread-1 (]: Finished running node test.dbt_exercise.unique_my_first_dbt_model_id.16e066b321
[0m14:42:26.725803 [debug] [Thread-7 (]: Marking all children of 'test.dbt_exercise.unique_my_first_dbt_model_id.16e066b321' to be skipped because of status 'error'.  Reason: Database Error in test unique_my_first_dbt_model_id (models/schema.yml)
  Not found: Table corded-sunlight-464012-e2:dbt_dw.my_first_dbt_model was not found in location US
  compiled code at target/run/dbt_exercise/models/schema.yml/unique_my_first_dbt_model_id.sql.
[0m14:42:26.866558 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:0bc101b9-efa9-49e9-8314-267605279dfa&page=queryresults
[0m14:42:27.100198 [info ] [Thread-2 (]: 32 of 35 PASS source_unique_northwind_territories_territory_id ................. [[32mPASS[0m in 2.12s]
[0m14:42:27.101652 [debug] [Thread-2 (]: Finished running node test.dbt_exercise.source_unique_northwind_territories_territory_id.08bc548860
[0m14:42:27.539167 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:4f180308-32ff-4984-b9b3-86f56e4648a4&page=queryresults
[0m14:42:27.540120 [error] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:4f180308-32ff-4984-b9b3-86f56e4648a4&page=queryresults
[0m14:42:27.588040 [debug] [Thread-4 (]: Database Error in test unique_my_second_dbt_model_id (models/schema.yml)
  Not found: Table corded-sunlight-464012-e2:dbt_dw.my_second_dbt_model was not found in location US
  compiled code at target/run/dbt_exercise/models/schema.yml/unique_my_second_dbt_model_id.sql
[0m14:42:27.589235 [error] [Thread-4 (]: 35 of 35 ERROR unique_my_second_dbt_model_id ................................... [[31mERROR[0m in 0.98s]
[0m14:42:27.590515 [debug] [Thread-4 (]: Finished running node test.dbt_exercise.unique_my_second_dbt_model_id.57a0f8c493
[0m14:42:27.591973 [debug] [Thread-7 (]: Marking all children of 'test.dbt_exercise.unique_my_second_dbt_model_id.57a0f8c493' to be skipped because of status 'error'.  Reason: Database Error in test unique_my_second_dbt_model_id (models/schema.yml)
  Not found: Table corded-sunlight-464012-e2:dbt_dw.my_second_dbt_model was not found in location US
  compiled code at target/run/dbt_exercise/models/schema.yml/unique_my_second_dbt_model_id.sql.
[0m14:42:27.710662 [info ] [Thread-3 (]: 33 of 35 PASS source_unique_northwind_us_states_state_id ....................... [[32mPASS[0m in 2.37s]
[0m14:42:27.712637 [debug] [Thread-3 (]: Finished running node test.dbt_exercise.source_unique_northwind_us_states_state_id.c374c85cda
[0m14:42:27.717162 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:42:27.731857 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:42:27.734672 [debug] [MainThread]: Connection 'test.dbt_exercise.unique_my_first_dbt_model_id.16e066b321' was properly closed.
[0m14:42:27.736682 [debug] [MainThread]: Connection 'test.dbt_exercise.source_unique_northwind_territories_territory_id.08bc548860' was properly closed.
[0m14:42:27.737490 [debug] [MainThread]: Connection 'test.dbt_exercise.source_unique_northwind_us_states_state_id.c374c85cda' was properly closed.
[0m14:42:27.738430 [debug] [MainThread]: Connection 'test.dbt_exercise.unique_my_second_dbt_model_id.57a0f8c493' was properly closed.
[0m14:42:27.739616 [info ] [MainThread]: 
[0m14:42:27.740847 [info ] [MainThread]: Finished running 35 data tests in 0 hours 0 minutes and 24.32 seconds (24.32s).
[0m14:42:27.753323 [debug] [MainThread]: Command end result
[0m14:42:27.840762 [debug] [MainThread]: Wrote artifact WritableManifest to /home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/target/manifest.json
[0m14:42:27.859543 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/target/semantic_manifest.json
[0m14:42:27.872949 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/target/run_results.json
[0m14:42:27.873963 [info ] [MainThread]: 
[0m14:42:27.875319 [info ] [MainThread]: [31mCompleted with 4 errors, 0 partial successes, and 0 warnings:[0m
[0m14:42:27.876344 [info ] [MainThread]: 
[0m14:42:27.877239 [error] [MainThread]: [31mFailure in test not_null_my_second_dbt_model_id (models/schema.yml)[0m
[0m14:42:27.878203 [error] [MainThread]:   Database Error in test not_null_my_second_dbt_model_id (models/schema.yml)
  Not found: Table corded-sunlight-464012-e2:dbt_dw.my_second_dbt_model was not found in location US
  compiled code at target/run/dbt_exercise/models/schema.yml/not_null_my_second_dbt_model_id.sql
[0m14:42:27.878919 [info ] [MainThread]: 
[0m14:42:27.879858 [info ] [MainThread]:   compiled code at target/compiled/dbt_exercise/models/schema.yml/not_null_my_second_dbt_model_id.sql
[0m14:42:27.880570 [info ] [MainThread]: 
[0m14:42:27.881642 [error] [MainThread]: [31mFailure in test not_null_my_first_dbt_model_id (models/schema.yml)[0m
[0m14:42:27.882726 [error] [MainThread]:   Database Error in test not_null_my_first_dbt_model_id (models/schema.yml)
  Not found: Table corded-sunlight-464012-e2:dbt_dw.my_first_dbt_model was not found in location US
  compiled code at target/run/dbt_exercise/models/schema.yml/not_null_my_first_dbt_model_id.sql
[0m14:42:27.884082 [info ] [MainThread]: 
[0m14:42:27.885739 [info ] [MainThread]:   compiled code at target/compiled/dbt_exercise/models/schema.yml/not_null_my_first_dbt_model_id.sql
[0m14:42:27.887542 [info ] [MainThread]: 
[0m14:42:27.890154 [error] [MainThread]: [31mFailure in test unique_my_first_dbt_model_id (models/schema.yml)[0m
[0m14:42:27.891746 [error] [MainThread]:   Database Error in test unique_my_first_dbt_model_id (models/schema.yml)
  Not found: Table corded-sunlight-464012-e2:dbt_dw.my_first_dbt_model was not found in location US
  compiled code at target/run/dbt_exercise/models/schema.yml/unique_my_first_dbt_model_id.sql
[0m14:42:27.893636 [info ] [MainThread]: 
[0m14:42:27.895934 [info ] [MainThread]:   compiled code at target/compiled/dbt_exercise/models/schema.yml/unique_my_first_dbt_model_id.sql
[0m14:42:27.898156 [info ] [MainThread]: 
[0m14:42:27.900463 [error] [MainThread]: [31mFailure in test unique_my_second_dbt_model_id (models/schema.yml)[0m
[0m14:42:27.902668 [error] [MainThread]:   Database Error in test unique_my_second_dbt_model_id (models/schema.yml)
  Not found: Table corded-sunlight-464012-e2:dbt_dw.my_second_dbt_model was not found in location US
  compiled code at target/run/dbt_exercise/models/schema.yml/unique_my_second_dbt_model_id.sql
[0m14:42:27.904405 [info ] [MainThread]: 
[0m14:42:27.907946 [info ] [MainThread]:   compiled code at target/compiled/dbt_exercise/models/schema.yml/unique_my_second_dbt_model_id.sql
[0m14:42:27.909843 [info ] [MainThread]: 
[0m14:42:27.911870 [info ] [MainThread]: Done. PASS=31 WARN=0 ERROR=4 SKIP=0 NO-OP=0 TOTAL=35
[0m14:42:27.915197 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- DuplicateYAMLKeysDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m14:42:27.926376 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": false, "command_wall_clock_time": 138.61313, "process_in_blocks": "143400", "process_kernel_time": 15.640013, "process_mem_max_rss": "372184", "process_out_blocks": "4096", "process_user_time": 16.386715}
[0m14:42:27.928101 [debug] [MainThread]: Command `dbt test` failed at 14:42:27.927654 after 138.62 seconds
[0m14:42:27.929510 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a04cbd5f320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a047a469e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a047a19fb60>]}
[0m14:42:27.931186 [debug] [MainThread]: Flushing usage events
[0m14:42:28.283508 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:50:55.817103 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7df9246fb590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7df9242167e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7df9245bf410>]}


============================== 14:50:55.839470 | 3ea69802-5178-4b3c-8e5c-b1f13b222fd8 ==============================
[0m14:50:55.839470 [info ] [MainThread]: Running with dbt=1.10.2
[0m14:50:55.840757 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/logs', 'debug': 'False', 'profiles_dir': '/home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'invocation_command': 'dbt test', 'send_anonymous_usage_stats': 'True'}
[0m14:51:48.076122 [warn ] [MainThread]: [[33mWARNING[0m][DuplicateYAMLKeysDeprecation]: Deprecated functionality
Duplicate key 'version' in "<unicode string>", line 4, column 1 in file
`/home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/dbt_project.yml`
[0m14:51:48.076973 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '3ea69802-5178-4b3c-8e5c-b1f13b222fd8', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7df8e6a52270>]}
[0m14:51:48.866916 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3ea69802-5178-4b3c-8e5c-b1f13b222fd8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7df8e6abc170>]}
[0m14:51:48.989685 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3ea69802-5178-4b3c-8e5c-b1f13b222fd8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7df925f4be60>]}
[0m14:51:48.994544 [info ] [MainThread]: Registered adapter: bigquery=1.9.2
[0m14:52:41.592079 [debug] [MainThread]: checksum: 1adc40777973ef30f45f80b3b6d04d5013c1edd53d96363881b3b199e612468b, vars: {}, profile: , target: , version: 1.10.2
[0m14:52:47.309522 [debug] [MainThread]: Partial parsing enabled: 2 files deleted, 0 files added, 0 files changed.
[0m14:52:47.311240 [debug] [MainThread]: Partial parsing: deleted file: dbt_exercise://models/my_second_dbt_model.sql
[0m14:52:47.312102 [debug] [MainThread]: Partial parsing: deleted file: dbt_exercise://models/my_first_dbt_model.sql
[0m14:52:47.595322 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'my_second_dbt_model' in the 'models' section of file 'models/schema.yml'
[0m14:52:47.597420 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'my_first_dbt_model' in the 'models' section of file 'models/schema.yml'
[0m14:52:47.752240 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_exercise.unique_my_second_dbt_model_id.57a0f8c493' (models/schema.yml) depends on a node named 'my_second_dbt_model' in package '' which was not found
[0m14:52:47.753095 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_exercise.not_null_my_second_dbt_model_id.151b76d778' (models/schema.yml) depends on a node named 'my_second_dbt_model' in package '' which was not found
[0m14:52:47.753918 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_exercise.unique_my_first_dbt_model_id.16e066b321' (models/schema.yml) depends on a node named 'my_first_dbt_model' in package '' which was not found
[0m14:52:47.754618 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_exercise.not_null_my_first_dbt_model_id.5fb22c2710' (models/schema.yml) depends on a node named 'my_first_dbt_model' in package '' which was not found
[0m14:52:47.908941 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.dbt_exercise.marts
- models.dbt_exercise.intermediate
[0m14:52:47.933101 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3ea69802-5178-4b3c-8e5c-b1f13b222fd8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7df8e6647950>]}
[0m14:52:48.109274 [debug] [MainThread]: Wrote artifact WritableManifest to /home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/target/manifest.json
[0m14:52:48.127971 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/target/semantic_manifest.json
[0m14:52:48.690492 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3ea69802-5178-4b3c-8e5c-b1f13b222fd8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7df8e605b110>]}
[0m14:52:48.691485 [info ] [MainThread]: Found 14 seeds, 31 data tests, 2 models, 14 sources, 609 macros
[0m14:52:48.692187 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3ea69802-5178-4b3c-8e5c-b1f13b222fd8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7df8e66d9a00>]}
[0m14:52:48.697078 [info ] [MainThread]: 
[0m14:52:48.697825 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:52:48.698547 [info ] [MainThread]: 
[0m14:52:48.699723 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m14:52:48.709472 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_corded-sunlight-464012-e2_dbt_dw_staging'
[0m14:52:48.711890 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_corded-sunlight-464012-e2_dbt_dw_raw'
[0m14:52:48.713303 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:52:48.714491 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:52:49.871615 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3ea69802-5178-4b3c-8e5c-b1f13b222fd8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7df8e678fc80>]}
[0m14:52:49.872682 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:52:49.890627 [debug] [Thread-1 (]: Began running node test.dbt_exercise.source_accepted_values_northwind_categories_category_name__Beverages__Condiments__Confections__Dairy_Products__Grains_Cereals__Meat_Poultry__Produce__Seafood.ea6d0ab2ae
[0m14:52:49.892302 [debug] [Thread-2 (]: Began running node test.dbt_exercise.source_not_null_northwind_categories_category_id.9a6df29828
[0m14:52:49.893770 [info ] [Thread-1 (]: 1 of 31 START test source_accepted_values_northwind_categories_category_name__Beverages__Condiments__Confections__Dairy_Products__Grains_Cereals__Meat_Poultry__Produce__Seafood  [RUN]
[0m14:52:49.895751 [debug] [Thread-3 (]: Began running node test.dbt_exercise.source_not_null_northwind_country_codes_country_code.c623b5676c
[0m14:52:49.897303 [info ] [Thread-2 (]: 2 of 31 START test source_not_null_northwind_categories_category_id ............ [RUN]
[0m14:52:49.899277 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_corded-sunlight-464012-e2_dbt_dw_raw, now test.dbt_exercise.source_accepted_values_northwind_categories_category_name__Beverages__Condiments__Confections__Dairy_Products__Grains_Cereals__Meat_Poultry__Produce__Seafood.ea6d0ab2ae)
[0m14:52:49.900447 [debug] [Thread-4 (]: Began running node test.dbt_exercise.source_not_null_northwind_customers_customer_id.dba99593d2
[0m14:52:49.902006 [info ] [Thread-3 (]: 3 of 31 START test source_not_null_northwind_country_codes_country_code ........ [RUN]
[0m14:52:49.903875 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_corded-sunlight-464012-e2_dbt_dw_staging, now test.dbt_exercise.source_not_null_northwind_categories_category_id.9a6df29828)
[0m14:52:49.905404 [debug] [Thread-1 (]: Began compiling node test.dbt_exercise.source_accepted_values_northwind_categories_category_name__Beverages__Condiments__Confections__Dairy_Products__Grains_Cereals__Meat_Poultry__Produce__Seafood.ea6d0ab2ae
[0m14:52:49.907259 [info ] [Thread-4 (]: 4 of 31 START test source_not_null_northwind_customers_customer_id ............. [RUN]
[0m14:52:49.909648 [debug] [Thread-3 (]: Acquiring new bigquery connection 'test.dbt_exercise.source_not_null_northwind_country_codes_country_code.c623b5676c'
[0m14:52:49.911508 [debug] [Thread-2 (]: Began compiling node test.dbt_exercise.source_not_null_northwind_categories_category_id.9a6df29828
[0m14:52:49.920573 [debug] [Thread-4 (]: Acquiring new bigquery connection 'test.dbt_exercise.source_not_null_northwind_customers_customer_id.dba99593d2'
[0m14:52:49.928195 [debug] [Thread-3 (]: Began compiling node test.dbt_exercise.source_not_null_northwind_country_codes_country_code.c623b5676c
[0m14:52:50.004094 [debug] [Thread-4 (]: Began compiling node test.dbt_exercise.source_not_null_northwind_customers_customer_id.dba99593d2
[0m14:52:50.014304 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_exercise.source_accepted_values_northwind_categories_category_name__Beverages__Condiments__Confections__Dairy_Products__Grains_Cereals__Meat_Poultry__Produce__Seafood.ea6d0ab2ae"
[0m14:52:50.025144 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_exercise.source_not_null_northwind_categories_category_id.9a6df29828"
[0m14:52:50.033687 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_exercise.source_not_null_northwind_country_codes_country_code.c623b5676c"
[0m14:52:50.043622 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_exercise.source_not_null_northwind_customers_customer_id.dba99593d2"
[0m14:52:50.048559 [debug] [Thread-3 (]: Began executing node test.dbt_exercise.source_not_null_northwind_country_codes_country_code.c623b5676c
[0m14:52:50.050178 [debug] [Thread-2 (]: Began executing node test.dbt_exercise.source_not_null_northwind_categories_category_id.9a6df29828
[0m14:52:50.057113 [debug] [Thread-4 (]: Began executing node test.dbt_exercise.source_not_null_northwind_customers_customer_id.dba99593d2
[0m14:52:50.067715 [debug] [Thread-1 (]: Began executing node test.dbt_exercise.source_accepted_values_northwind_categories_category_name__Beverages__Condiments__Confections__Dairy_Products__Grains_Cereals__Meat_Poultry__Produce__Seafood.ea6d0ab2ae
[0m14:52:50.108158 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_exercise.source_not_null_northwind_country_codes_country_code.c623b5676c"
[0m14:52:50.109600 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_exercise.source_not_null_northwind_categories_category_id.9a6df29828"
[0m14:52:50.115156 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_exercise.source_not_null_northwind_customers_customer_id.dba99593d2"
[0m14:52:50.119816 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_exercise.source_accepted_values_northwind_categories_category_name__Beverages__Condiments__Confections__Dairy_Products__Grains_Cereals__Meat_Poultry__Produce__Seafood.ea6d0ab2ae"
[0m14:52:50.123768 [debug] [Thread-3 (]: On test.dbt_exercise.source_not_null_northwind_country_codes_country_code.c623b5676c: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "test.dbt_exercise.source_not_null_northwind_country_codes_country_code.c623b5676c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select country_code
from `corded-sunlight-464012-e2`.`dbt_dw_raw`.`country_codes`
where country_code is null



  
  
      
    ) dbt_internal_test
[0m14:52:50.125533 [debug] [Thread-2 (]: On test.dbt_exercise.source_not_null_northwind_categories_category_id.9a6df29828: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "test.dbt_exercise.source_not_null_northwind_categories_category_id.9a6df29828"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select category_id
from `corded-sunlight-464012-e2`.`dbt_dw_raw`.`categories`
where category_id is null



  
  
      
    ) dbt_internal_test
[0m14:52:50.126604 [debug] [Thread-4 (]: On test.dbt_exercise.source_not_null_northwind_customers_customer_id.dba99593d2: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "test.dbt_exercise.source_not_null_northwind_customers_customer_id.dba99593d2"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select customer_id
from `corded-sunlight-464012-e2`.`dbt_dw_raw`.`customers`
where customer_id is null



  
  
      
    ) dbt_internal_test
[0m14:52:50.128060 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m14:52:50.129255 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:52:50.130364 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m14:52:50.131659 [debug] [Thread-1 (]: On test.dbt_exercise.source_accepted_values_northwind_categories_category_name__Beverages__Condiments__Confections__Dairy_Products__Grains_Cereals__Meat_Poultry__Produce__Seafood.ea6d0ab2ae: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "test.dbt_exercise.source_accepted_values_northwind_categories_category_name__Beverages__Condiments__Confections__Dairy_Products__Grains_Cereals__Meat_Poultry__Produce__Seafood.ea6d0ab2ae"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        category_name as value_field,
        count(*) as n_records

    from `corded-sunlight-464012-e2`.`dbt_dw_raw`.`categories`
    group by category_name

)

select *
from all_values
where value_field not in (
    'Beverages','Condiments','Confections','Dairy Products','Grains/Cereals','Meat/Poultry','Produce','Seafood'
)



  
  
      
    ) dbt_internal_test
[0m14:52:50.133841 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:52:51.278083 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:7da7c9b1-5a98-47ac-bcfd-15dd1f113720&page=queryresults
[0m14:52:51.319552 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:d8ebea2e-74e9-4309-9d28-1134bc2a8086&page=queryresults
[0m14:52:51.370972 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:2c22fcff-6bb8-48ee-a93b-2f323cf36bdf&page=queryresults
[0m14:52:51.450002 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:6fdd6bef-768f-4b5b-b2d7-2d458f8156c0&page=queryresults
[0m14:52:57.901507 [info ] [Thread-1 (]: 1 of 31 PASS source_accepted_values_northwind_categories_category_name__Beverages__Condiments__Confections__Dairy_Products__Grains_Cereals__Meat_Poultry__Produce__Seafood  [[32mPASS[0m in 8.00s]
[0m14:52:57.903141 [debug] [Thread-1 (]: Finished running node test.dbt_exercise.source_accepted_values_northwind_categories_category_name__Beverages__Condiments__Confections__Dairy_Products__Grains_Cereals__Meat_Poultry__Produce__Seafood.ea6d0ab2ae
[0m14:52:57.904169 [debug] [Thread-1 (]: Began running node test.dbt_exercise.source_not_null_northwind_dados_financeiros_data.cdd6b46fe7
[0m14:52:57.905008 [info ] [Thread-1 (]: 5 of 31 START test source_not_null_northwind_dados_financeiros_data ............ [RUN]
[0m14:52:57.905924 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_exercise.source_accepted_values_northwind_categories_category_name__Beverages__Condiments__Confections__Dairy_Products__Grains_Cereals__Meat_Poultry__Produce__Seafood.ea6d0ab2ae, now test.dbt_exercise.source_not_null_northwind_dados_financeiros_data.cdd6b46fe7)
[0m14:52:57.906641 [debug] [Thread-1 (]: Began compiling node test.dbt_exercise.source_not_null_northwind_dados_financeiros_data.cdd6b46fe7
[0m14:52:57.911092 [info ] [Thread-3 (]: 3 of 31 PASS source_not_null_northwind_country_codes_country_code .............. [[32mPASS[0m in 8.00s]
[0m14:52:57.919899 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_exercise.source_not_null_northwind_dados_financeiros_data.cdd6b46fe7"
[0m14:52:57.923898 [debug] [Thread-3 (]: Finished running node test.dbt_exercise.source_not_null_northwind_country_codes_country_code.c623b5676c
[0m14:52:57.926065 [info ] [Thread-4 (]: 4 of 31 PASS source_not_null_northwind_customers_customer_id ................... [[32mPASS[0m in 8.01s]
[0m14:52:57.930496 [debug] [Thread-3 (]: Began running node test.dbt_exercise.source_not_null_northwind_employee_territories_employee_id.d7372217ec
[0m14:52:57.933039 [info ] [Thread-2 (]: 2 of 31 PASS source_not_null_northwind_categories_category_id .................. [[32mPASS[0m in 8.03s]
[0m14:52:57.936319 [debug] [Thread-4 (]: Finished running node test.dbt_exercise.source_not_null_northwind_customers_customer_id.dba99593d2
[0m14:52:57.938322 [info ] [Thread-3 (]: 6 of 31 START test source_not_null_northwind_employee_territories_employee_id .. [RUN]
[0m14:52:57.940789 [debug] [Thread-2 (]: Finished running node test.dbt_exercise.source_not_null_northwind_categories_category_id.9a6df29828
[0m14:52:57.941897 [debug] [Thread-1 (]: Began executing node test.dbt_exercise.source_not_null_northwind_dados_financeiros_data.cdd6b46fe7
[0m14:52:57.943453 [debug] [Thread-4 (]: Began running node test.dbt_exercise.source_not_null_northwind_employee_territories_territory_id.ae648a0b88
[0m14:52:57.944710 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_exercise.source_not_null_northwind_country_codes_country_code.c623b5676c, now test.dbt_exercise.source_not_null_northwind_employee_territories_employee_id.d7372217ec)
[0m14:52:57.945883 [debug] [Thread-2 (]: Began running node test.dbt_exercise.source_not_null_northwind_employees_employee_id.829479a08c
[0m14:52:57.954403 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_exercise.source_not_null_northwind_dados_financeiros_data.cdd6b46fe7"
[0m14:52:57.955829 [info ] [Thread-4 (]: 7 of 31 START test source_not_null_northwind_employee_territories_territory_id . [RUN]
[0m14:52:57.957616 [debug] [Thread-3 (]: Began compiling node test.dbt_exercise.source_not_null_northwind_employee_territories_employee_id.d7372217ec
[0m14:52:57.958684 [info ] [Thread-2 (]: 8 of 31 START test source_not_null_northwind_employees_employee_id ............. [RUN]
[0m14:52:57.960539 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_exercise.source_not_null_northwind_customers_customer_id.dba99593d2, now test.dbt_exercise.source_not_null_northwind_employee_territories_territory_id.ae648a0b88)
[0m14:52:57.972267 [debug] [Thread-1 (]: On test.dbt_exercise.source_not_null_northwind_dados_financeiros_data.cdd6b46fe7: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "test.dbt_exercise.source_not_null_northwind_dados_financeiros_data.cdd6b46fe7"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select data
from `corded-sunlight-464012-e2`.`dbt_dw_raw`.`dados_financeiros`
where data is null



  
  
      
    ) dbt_internal_test
[0m14:52:57.970544 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_exercise.source_not_null_northwind_employee_territories_employee_id.d7372217ec"
[0m14:52:57.974008 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_exercise.source_not_null_northwind_categories_category_id.9a6df29828, now test.dbt_exercise.source_not_null_northwind_employees_employee_id.829479a08c)
[0m14:52:57.975561 [debug] [Thread-4 (]: Began compiling node test.dbt_exercise.source_not_null_northwind_employee_territories_territory_id.ae648a0b88
[0m14:52:57.976745 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:52:57.978727 [debug] [Thread-2 (]: Began compiling node test.dbt_exercise.source_not_null_northwind_employees_employee_id.829479a08c
[0m14:52:57.985529 [debug] [Thread-3 (]: Began executing node test.dbt_exercise.source_not_null_northwind_employee_territories_employee_id.d7372217ec
[0m14:52:57.991478 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_exercise.source_not_null_northwind_employee_territories_territory_id.ae648a0b88"
[0m14:52:58.000490 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_exercise.source_not_null_northwind_employees_employee_id.829479a08c"
[0m14:52:58.005088 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_exercise.source_not_null_northwind_employee_territories_employee_id.d7372217ec"
[0m14:52:58.007856 [debug] [Thread-2 (]: Began executing node test.dbt_exercise.source_not_null_northwind_employees_employee_id.829479a08c
[0m14:52:58.009397 [debug] [Thread-4 (]: Began executing node test.dbt_exercise.source_not_null_northwind_employee_territories_territory_id.ae648a0b88
[0m14:52:58.017219 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_exercise.source_not_null_northwind_employees_employee_id.829479a08c"
[0m14:52:58.018282 [debug] [Thread-3 (]: On test.dbt_exercise.source_not_null_northwind_employee_territories_employee_id.d7372217ec: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "test.dbt_exercise.source_not_null_northwind_employee_territories_employee_id.d7372217ec"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select employee_id
from `corded-sunlight-464012-e2`.`dbt_dw_raw`.`employee_territories`
where employee_id is null



  
  
      
    ) dbt_internal_test
[0m14:52:58.062993 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_exercise.source_not_null_northwind_employee_territories_territory_id.ae648a0b88"
[0m14:52:58.066429 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:52:58.068580 [debug] [Thread-2 (]: On test.dbt_exercise.source_not_null_northwind_employees_employee_id.829479a08c: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "test.dbt_exercise.source_not_null_northwind_employees_employee_id.829479a08c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select employee_id
from `corded-sunlight-464012-e2`.`dbt_dw_raw`.`employees`
where employee_id is null



  
  
      
    ) dbt_internal_test
[0m14:52:58.069839 [debug] [Thread-4 (]: On test.dbt_exercise.source_not_null_northwind_employee_territories_territory_id.ae648a0b88: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "test.dbt_exercise.source_not_null_northwind_employee_territories_territory_id.ae648a0b88"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select territory_id
from `corded-sunlight-464012-e2`.`dbt_dw_raw`.`employee_territories`
where territory_id is null



  
  
      
    ) dbt_internal_test
[0m14:52:58.071042 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:52:58.072475 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m14:52:59.092851 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:fe0e96c0-2dcb-4756-a585-fe3d8b0fb0d7&page=queryresults
[0m14:52:59.180415 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:b82e5069-6592-4d1f-af9e-02692634cbab&page=queryresults
[0m14:52:59.189712 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:4df37e01-1612-4db8-8dda-83e516046d98&page=queryresults
[0m14:52:59.202142 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:18786fa7-d6f4-483d-a3d3-85b8d522209f&page=queryresults
[0m14:52:59.984616 [info ] [Thread-1 (]: 5 of 31 PASS source_not_null_northwind_dados_financeiros_data .................. [[32mPASS[0m in 2.08s]
[0m14:52:59.986407 [debug] [Thread-1 (]: Finished running node test.dbt_exercise.source_not_null_northwind_dados_financeiros_data.cdd6b46fe7
[0m14:52:59.987752 [debug] [Thread-1 (]: Began running node test.dbt_exercise.source_not_null_northwind_order_details_order_id.8acd43693e
[0m14:52:59.989760 [info ] [Thread-1 (]: 9 of 31 START test source_not_null_northwind_order_details_order_id ............ [RUN]
[0m14:52:59.991850 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_exercise.source_not_null_northwind_dados_financeiros_data.cdd6b46fe7, now test.dbt_exercise.source_not_null_northwind_order_details_order_id.8acd43693e)
[0m14:52:59.993475 [debug] [Thread-1 (]: Began compiling node test.dbt_exercise.source_not_null_northwind_order_details_order_id.8acd43693e
[0m14:53:00.003780 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_exercise.source_not_null_northwind_order_details_order_id.8acd43693e"
[0m14:53:00.005539 [debug] [Thread-1 (]: Began executing node test.dbt_exercise.source_not_null_northwind_order_details_order_id.8acd43693e
[0m14:53:00.022270 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_exercise.source_not_null_northwind_order_details_order_id.8acd43693e"
[0m14:53:00.024586 [debug] [Thread-1 (]: On test.dbt_exercise.source_not_null_northwind_order_details_order_id.8acd43693e: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "test.dbt_exercise.source_not_null_northwind_order_details_order_id.8acd43693e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select order_id
from `corded-sunlight-464012-e2`.`dbt_dw_raw`.`order_details`
where order_id is null



  
  
      
    ) dbt_internal_test
[0m14:53:00.026241 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:53:00.083427 [info ] [Thread-3 (]: 6 of 31 PASS source_not_null_northwind_employee_territories_employee_id ........ [[32mPASS[0m in 2.14s]
[0m14:53:00.084988 [debug] [Thread-3 (]: Finished running node test.dbt_exercise.source_not_null_northwind_employee_territories_employee_id.d7372217ec
[0m14:53:00.087494 [debug] [Thread-3 (]: Began running node test.dbt_exercise.source_not_null_northwind_order_details_product_id.c084f7ad12
[0m14:53:00.091161 [info ] [Thread-3 (]: 10 of 31 START test source_not_null_northwind_order_details_product_id ......... [RUN]
[0m14:53:00.096474 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_exercise.source_not_null_northwind_employee_territories_employee_id.d7372217ec, now test.dbt_exercise.source_not_null_northwind_order_details_product_id.c084f7ad12)
[0m14:53:00.099819 [debug] [Thread-3 (]: Began compiling node test.dbt_exercise.source_not_null_northwind_order_details_product_id.c084f7ad12
[0m14:53:00.098768 [info ] [Thread-4 (]: 7 of 31 PASS source_not_null_northwind_employee_territories_territory_id ....... [[32mPASS[0m in 2.14s]
[0m14:53:00.114388 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_exercise.source_not_null_northwind_order_details_product_id.c084f7ad12"
[0m14:53:00.118285 [debug] [Thread-4 (]: Finished running node test.dbt_exercise.source_not_null_northwind_employee_territories_territory_id.ae648a0b88
[0m14:53:00.121825 [info ] [Thread-2 (]: 8 of 31 PASS source_not_null_northwind_employees_employee_id ................... [[32mPASS[0m in 2.15s]
[0m14:53:00.125502 [debug] [Thread-4 (]: Began running node test.dbt_exercise.source_not_null_northwind_orders_customer_id.3e09955b24
[0m14:53:00.127428 [debug] [Thread-3 (]: Began executing node test.dbt_exercise.source_not_null_northwind_order_details_product_id.c084f7ad12
[0m14:53:00.129705 [debug] [Thread-2 (]: Finished running node test.dbt_exercise.source_not_null_northwind_employees_employee_id.829479a08c
[0m14:53:00.131588 [info ] [Thread-4 (]: 11 of 31 START test source_not_null_northwind_orders_customer_id ............... [RUN]
[0m14:53:00.140083 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_exercise.source_not_null_northwind_order_details_product_id.c084f7ad12"
[0m14:53:00.141950 [debug] [Thread-2 (]: Began running node test.dbt_exercise.source_not_null_northwind_orders_employee_id.a8f4bf5ca3
[0m14:53:00.144565 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_exercise.source_not_null_northwind_employee_territories_territory_id.ae648a0b88, now test.dbt_exercise.source_not_null_northwind_orders_customer_id.3e09955b24)
[0m14:53:00.147783 [info ] [Thread-2 (]: 12 of 31 START test source_not_null_northwind_orders_employee_id ............... [RUN]
[0m14:53:00.151269 [debug] [Thread-3 (]: On test.dbt_exercise.source_not_null_northwind_order_details_product_id.c084f7ad12: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "test.dbt_exercise.source_not_null_northwind_order_details_product_id.c084f7ad12"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select product_id
from `corded-sunlight-464012-e2`.`dbt_dw_raw`.`order_details`
where product_id is null



  
  
      
    ) dbt_internal_test
[0m14:53:00.152552 [debug] [Thread-4 (]: Began compiling node test.dbt_exercise.source_not_null_northwind_orders_customer_id.3e09955b24
[0m14:53:00.154271 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_exercise.source_not_null_northwind_employees_employee_id.829479a08c, now test.dbt_exercise.source_not_null_northwind_orders_employee_id.a8f4bf5ca3)
[0m14:53:00.156433 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:53:00.167315 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_exercise.source_not_null_northwind_orders_customer_id.3e09955b24"
[0m14:53:00.169359 [debug] [Thread-2 (]: Began compiling node test.dbt_exercise.source_not_null_northwind_orders_employee_id.a8f4bf5ca3
[0m14:53:00.184002 [debug] [Thread-4 (]: Began executing node test.dbt_exercise.source_not_null_northwind_orders_customer_id.3e09955b24
[0m14:53:00.187235 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_exercise.source_not_null_northwind_orders_employee_id.a8f4bf5ca3"
[0m14:53:00.197755 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_exercise.source_not_null_northwind_orders_customer_id.3e09955b24"
[0m14:53:00.203218 [debug] [Thread-2 (]: Began executing node test.dbt_exercise.source_not_null_northwind_orders_employee_id.a8f4bf5ca3
[0m14:53:00.204770 [debug] [Thread-4 (]: On test.dbt_exercise.source_not_null_northwind_orders_customer_id.3e09955b24: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "test.dbt_exercise.source_not_null_northwind_orders_customer_id.3e09955b24"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select customer_id
from `corded-sunlight-464012-e2`.`dbt_dw_raw`.`orders`
where customer_id is null



  
  
      
    ) dbt_internal_test
[0m14:53:00.209700 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_exercise.source_not_null_northwind_orders_employee_id.a8f4bf5ca3"
[0m14:53:00.213315 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m14:53:00.256333 [debug] [Thread-2 (]: On test.dbt_exercise.source_not_null_northwind_orders_employee_id.a8f4bf5ca3: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "test.dbt_exercise.source_not_null_northwind_orders_employee_id.a8f4bf5ca3"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select employee_id
from `corded-sunlight-464012-e2`.`dbt_dw_raw`.`orders`
where employee_id is null



  
  
      
    ) dbt_internal_test
[0m14:53:00.258334 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:53:01.149184 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:418b6ff8-9a12-4ac5-8d3b-26537aaad845&page=queryresults
[0m14:53:01.311375 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:38b7698d-1f98-40ae-b9d5-15abdbc0cf16&page=queryresults
[0m14:53:01.330157 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:70eb7dfc-86c8-4bfc-a962-171a17bf741f&page=queryresults
[0m14:53:01.349344 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:e08fa89b-af21-4656-a065-2485120109e2&page=queryresults
[0m14:53:02.119690 [info ] [Thread-1 (]: 9 of 31 PASS source_not_null_northwind_order_details_order_id .................. [[32mPASS[0m in 2.13s]
[0m14:53:02.127751 [debug] [Thread-1 (]: Finished running node test.dbt_exercise.source_not_null_northwind_order_details_order_id.8acd43693e
[0m14:53:02.129577 [debug] [Thread-1 (]: Began running node test.dbt_exercise.source_not_null_northwind_orders_order_id.5a7c008c6e
[0m14:53:02.131345 [info ] [Thread-1 (]: 13 of 31 START test source_not_null_northwind_orders_order_id .................. [RUN]
[0m14:53:02.132450 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_exercise.source_not_null_northwind_order_details_order_id.8acd43693e, now test.dbt_exercise.source_not_null_northwind_orders_order_id.5a7c008c6e)
[0m14:53:02.133312 [debug] [Thread-1 (]: Began compiling node test.dbt_exercise.source_not_null_northwind_orders_order_id.5a7c008c6e
[0m14:53:02.146127 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_exercise.source_not_null_northwind_orders_order_id.5a7c008c6e"
[0m14:53:02.149662 [debug] [Thread-1 (]: Began executing node test.dbt_exercise.source_not_null_northwind_orders_order_id.5a7c008c6e
[0m14:53:02.156798 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_exercise.source_not_null_northwind_orders_order_id.5a7c008c6e"
[0m14:53:02.159693 [debug] [Thread-1 (]: On test.dbt_exercise.source_not_null_northwind_orders_order_id.5a7c008c6e: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "test.dbt_exercise.source_not_null_northwind_orders_order_id.5a7c008c6e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select order_id
from `corded-sunlight-464012-e2`.`dbt_dw_raw`.`orders`
where order_id is null



  
  
      
    ) dbt_internal_test
[0m14:53:02.161375 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:53:02.175567 [info ] [Thread-4 (]: 11 of 31 PASS source_not_null_northwind_orders_customer_id ..................... [[32mPASS[0m in 2.03s]
[0m14:53:02.224320 [debug] [Thread-4 (]: Finished running node test.dbt_exercise.source_not_null_northwind_orders_customer_id.3e09955b24
[0m14:53:02.226474 [debug] [Thread-4 (]: Began running node test.dbt_exercise.source_not_null_northwind_products_product_id.1bc1aa1d1c
[0m14:53:02.228010 [info ] [Thread-4 (]: 14 of 31 START test source_not_null_northwind_products_product_id .............. [RUN]
[0m14:53:02.229615 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_exercise.source_not_null_northwind_orders_customer_id.3e09955b24, now test.dbt_exercise.source_not_null_northwind_products_product_id.1bc1aa1d1c)
[0m14:53:02.231065 [debug] [Thread-4 (]: Began compiling node test.dbt_exercise.source_not_null_northwind_products_product_id.1bc1aa1d1c
[0m14:53:02.241701 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_exercise.source_not_null_northwind_products_product_id.1bc1aa1d1c"
[0m14:53:02.251775 [debug] [Thread-4 (]: Began executing node test.dbt_exercise.source_not_null_northwind_products_product_id.1bc1aa1d1c
[0m14:53:02.250374 [info ] [Thread-2 (]: 12 of 31 PASS source_not_null_northwind_orders_employee_id ..................... [[32mPASS[0m in 2.10s]
[0m14:53:02.257200 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_exercise.source_not_null_northwind_products_product_id.1bc1aa1d1c"
[0m14:53:02.259494 [debug] [Thread-2 (]: Finished running node test.dbt_exercise.source_not_null_northwind_orders_employee_id.a8f4bf5ca3
[0m14:53:02.262021 [debug] [Thread-2 (]: Began running node test.dbt_exercise.source_not_null_northwind_region_region_id.c95367d9e3
[0m14:53:02.263826 [info ] [Thread-2 (]: 15 of 31 START test source_not_null_northwind_region_region_id ................. [RUN]
[0m14:53:02.265640 [debug] [Thread-4 (]: On test.dbt_exercise.source_not_null_northwind_products_product_id.1bc1aa1d1c: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "test.dbt_exercise.source_not_null_northwind_products_product_id.1bc1aa1d1c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select product_id
from `corded-sunlight-464012-e2`.`dbt_dw_raw`.`products`
where product_id is null



  
  
      
    ) dbt_internal_test
[0m14:53:02.266889 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_exercise.source_not_null_northwind_orders_employee_id.a8f4bf5ca3, now test.dbt_exercise.source_not_null_northwind_region_region_id.c95367d9e3)
[0m14:53:02.268001 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m14:53:02.269231 [debug] [Thread-2 (]: Began compiling node test.dbt_exercise.source_not_null_northwind_region_region_id.c95367d9e3
[0m14:53:02.286167 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_exercise.source_not_null_northwind_region_region_id.c95367d9e3"
[0m14:53:02.289860 [debug] [Thread-2 (]: Began executing node test.dbt_exercise.source_not_null_northwind_region_region_id.c95367d9e3
[0m14:53:02.296708 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_exercise.source_not_null_northwind_region_region_id.c95367d9e3"
[0m14:53:02.344625 [debug] [Thread-2 (]: On test.dbt_exercise.source_not_null_northwind_region_region_id.c95367d9e3: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "test.dbt_exercise.source_not_null_northwind_region_region_id.c95367d9e3"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select region_id
from `corded-sunlight-464012-e2`.`dbt_dw_raw`.`region`
where region_id is null



  
  
      
    ) dbt_internal_test
[0m14:53:02.346361 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:53:02.348986 [info ] [Thread-3 (]: 10 of 31 PASS source_not_null_northwind_order_details_product_id ............... [[32mPASS[0m in 2.25s]
[0m14:53:02.351754 [debug] [Thread-3 (]: Finished running node test.dbt_exercise.source_not_null_northwind_order_details_product_id.c084f7ad12
[0m14:53:02.353664 [debug] [Thread-3 (]: Began running node test.dbt_exercise.source_not_null_northwind_shippers_shipper_id.45221752ca
[0m14:53:02.356152 [info ] [Thread-3 (]: 16 of 31 START test source_not_null_northwind_shippers_shipper_id .............. [RUN]
[0m14:53:02.357953 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_exercise.source_not_null_northwind_order_details_product_id.c084f7ad12, now test.dbt_exercise.source_not_null_northwind_shippers_shipper_id.45221752ca)
[0m14:53:02.360057 [debug] [Thread-3 (]: Began compiling node test.dbt_exercise.source_not_null_northwind_shippers_shipper_id.45221752ca
[0m14:53:02.375282 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_exercise.source_not_null_northwind_shippers_shipper_id.45221752ca"
[0m14:53:02.423226 [debug] [Thread-3 (]: Began executing node test.dbt_exercise.source_not_null_northwind_shippers_shipper_id.45221752ca
[0m14:53:02.429318 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_exercise.source_not_null_northwind_shippers_shipper_id.45221752ca"
[0m14:53:02.430927 [debug] [Thread-3 (]: On test.dbt_exercise.source_not_null_northwind_shippers_shipper_id.45221752ca: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "test.dbt_exercise.source_not_null_northwind_shippers_shipper_id.45221752ca"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select shipper_id
from `corded-sunlight-464012-e2`.`dbt_dw_raw`.`shippers`
where shipper_id is null



  
  
      
    ) dbt_internal_test
[0m14:53:02.432619 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:53:03.216366 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:a58eb79d-50b3-4144-81d2-ce0004e4f20f&page=queryresults
[0m14:53:03.333974 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:38284e97-5cad-43bb-8050-b2ae322ad1f6&page=queryresults
[0m14:53:03.386007 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:81e96016-0b70-4285-a2ba-0041ea8ef4dc&page=queryresults
[0m14:53:03.496051 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:df06bce8-2999-41c4-95b4-2d0e67006913&page=queryresults
[0m14:53:04.070774 [info ] [Thread-1 (]: 13 of 31 PASS source_not_null_northwind_orders_order_id ........................ [[32mPASS[0m in 1.94s]
[0m14:53:04.072577 [debug] [Thread-1 (]: Finished running node test.dbt_exercise.source_not_null_northwind_orders_order_id.5a7c008c6e
[0m14:53:04.073476 [debug] [Thread-1 (]: Began running node test.dbt_exercise.source_not_null_northwind_suppliers_supplier_id.de5c4d0062
[0m14:53:04.074307 [info ] [Thread-1 (]: 17 of 31 START test source_not_null_northwind_suppliers_supplier_id ............ [RUN]
[0m14:53:04.076529 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_exercise.source_not_null_northwind_orders_order_id.5a7c008c6e, now test.dbt_exercise.source_not_null_northwind_suppliers_supplier_id.de5c4d0062)
[0m14:53:04.078010 [debug] [Thread-1 (]: Began compiling node test.dbt_exercise.source_not_null_northwind_suppliers_supplier_id.de5c4d0062
[0m14:53:04.090611 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_exercise.source_not_null_northwind_suppliers_supplier_id.de5c4d0062"
[0m14:53:04.098404 [debug] [Thread-1 (]: Began executing node test.dbt_exercise.source_not_null_northwind_suppliers_supplier_id.de5c4d0062
[0m14:53:04.104618 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_exercise.source_not_null_northwind_suppliers_supplier_id.de5c4d0062"
[0m14:53:04.106318 [debug] [Thread-1 (]: On test.dbt_exercise.source_not_null_northwind_suppliers_supplier_id.de5c4d0062: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "test.dbt_exercise.source_not_null_northwind_suppliers_supplier_id.de5c4d0062"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select supplier_id
from `corded-sunlight-464012-e2`.`dbt_dw_raw`.`suppliers`
where supplier_id is null



  
  
      
    ) dbt_internal_test
[0m14:53:04.107346 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:53:04.229604 [info ] [Thread-4 (]: 14 of 31 PASS source_not_null_northwind_products_product_id .................... [[32mPASS[0m in 2.00s]
[0m14:53:04.231123 [debug] [Thread-4 (]: Finished running node test.dbt_exercise.source_not_null_northwind_products_product_id.1bc1aa1d1c
[0m14:53:04.232017 [debug] [Thread-4 (]: Began running node test.dbt_exercise.source_not_null_northwind_territories_region_id.5df71bcf81
[0m14:53:04.232958 [info ] [Thread-4 (]: 18 of 31 START test source_not_null_northwind_territories_region_id ............ [RUN]
[0m14:53:04.234194 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_exercise.source_not_null_northwind_products_product_id.1bc1aa1d1c, now test.dbt_exercise.source_not_null_northwind_territories_region_id.5df71bcf81)
[0m14:53:04.235898 [debug] [Thread-4 (]: Began compiling node test.dbt_exercise.source_not_null_northwind_territories_region_id.5df71bcf81
[0m14:53:04.248383 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_exercise.source_not_null_northwind_territories_region_id.5df71bcf81"
[0m14:53:04.250703 [debug] [Thread-4 (]: Began executing node test.dbt_exercise.source_not_null_northwind_territories_region_id.5df71bcf81
[0m14:53:04.260356 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_exercise.source_not_null_northwind_territories_region_id.5df71bcf81"
[0m14:53:04.262441 [debug] [Thread-4 (]: On test.dbt_exercise.source_not_null_northwind_territories_region_id.5df71bcf81: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "test.dbt_exercise.source_not_null_northwind_territories_region_id.5df71bcf81"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select region_id
from `corded-sunlight-464012-e2`.`dbt_dw_raw`.`territories`
where region_id is null



  
  
      
    ) dbt_internal_test
[0m14:53:04.264094 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m14:53:04.389562 [info ] [Thread-3 (]: 16 of 31 PASS source_not_null_northwind_shippers_shipper_id .................... [[32mPASS[0m in 2.03s]
[0m14:53:04.391355 [debug] [Thread-3 (]: Finished running node test.dbt_exercise.source_not_null_northwind_shippers_shipper_id.45221752ca
[0m14:53:04.393269 [debug] [Thread-3 (]: Began running node test.dbt_exercise.source_not_null_northwind_territories_territory_id.9b9655b8a9
[0m14:53:04.395103 [info ] [Thread-3 (]: 19 of 31 START test source_not_null_northwind_territories_territory_id ......... [RUN]
[0m14:53:04.396697 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_exercise.source_not_null_northwind_shippers_shipper_id.45221752ca, now test.dbt_exercise.source_not_null_northwind_territories_territory_id.9b9655b8a9)
[0m14:53:04.398490 [debug] [Thread-3 (]: Began compiling node test.dbt_exercise.source_not_null_northwind_territories_territory_id.9b9655b8a9
[0m14:53:04.414102 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_exercise.source_not_null_northwind_territories_territory_id.9b9655b8a9"
[0m14:53:04.416512 [debug] [Thread-3 (]: Began executing node test.dbt_exercise.source_not_null_northwind_territories_territory_id.9b9655b8a9
[0m14:53:04.425811 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_exercise.source_not_null_northwind_territories_territory_id.9b9655b8a9"
[0m14:53:04.428835 [debug] [Thread-3 (]: On test.dbt_exercise.source_not_null_northwind_territories_territory_id.9b9655b8a9: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "test.dbt_exercise.source_not_null_northwind_territories_territory_id.9b9655b8a9"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select territory_id
from `corded-sunlight-464012-e2`.`dbt_dw_raw`.`territories`
where territory_id is null



  
  
      
    ) dbt_internal_test
[0m14:53:04.429980 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:53:04.484111 [info ] [Thread-2 (]: 15 of 31 PASS source_not_null_northwind_region_region_id ....................... [[32mPASS[0m in 2.22s]
[0m14:53:04.485464 [debug] [Thread-2 (]: Finished running node test.dbt_exercise.source_not_null_northwind_region_region_id.c95367d9e3
[0m14:53:04.486625 [debug] [Thread-2 (]: Began running node test.dbt_exercise.source_not_null_northwind_us_states_state_id.2e33a23d78
[0m14:53:04.487783 [info ] [Thread-2 (]: 20 of 31 START test source_not_null_northwind_us_states_state_id ............... [RUN]
[0m14:53:04.489718 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_exercise.source_not_null_northwind_region_region_id.c95367d9e3, now test.dbt_exercise.source_not_null_northwind_us_states_state_id.2e33a23d78)
[0m14:53:04.491415 [debug] [Thread-2 (]: Began compiling node test.dbt_exercise.source_not_null_northwind_us_states_state_id.2e33a23d78
[0m14:53:04.500774 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_exercise.source_not_null_northwind_us_states_state_id.2e33a23d78"
[0m14:53:04.502700 [debug] [Thread-2 (]: Began executing node test.dbt_exercise.source_not_null_northwind_us_states_state_id.2e33a23d78
[0m14:53:04.512760 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_exercise.source_not_null_northwind_us_states_state_id.2e33a23d78"
[0m14:53:04.515627 [debug] [Thread-2 (]: On test.dbt_exercise.source_not_null_northwind_us_states_state_id.2e33a23d78: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "test.dbt_exercise.source_not_null_northwind_us_states_state_id.2e33a23d78"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select state_id
from `corded-sunlight-464012-e2`.`dbt_dw_raw`.`us_states`
where state_id is null



  
  
      
    ) dbt_internal_test
[0m14:53:04.517323 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:53:05.182333 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:b951db79-56d5-4361-af17-bcd93175a544&page=queryresults
[0m14:53:05.284708 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:c121ddc2-d7f4-4d90-acf7-fd2b59bf9296&page=queryresults
[0m14:53:05.431657 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:2bf80694-f416-4d39-9983-4fa3ecdfaada&page=queryresults
[0m14:53:05.579767 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:73c360d6-ef69-4cb2-ad69-768c7389f823&page=queryresults
[0m14:53:06.194364 [info ] [Thread-4 (]: 18 of 31 PASS source_not_null_northwind_territories_region_id .................. [[32mPASS[0m in 1.96s]
[0m14:53:06.195899 [debug] [Thread-4 (]: Finished running node test.dbt_exercise.source_not_null_northwind_territories_region_id.5df71bcf81
[0m14:53:06.197132 [debug] [Thread-4 (]: Began running node test.dbt_exercise.source_unique_northwind_categories_category_id.17d9baa2e0
[0m14:53:06.198756 [info ] [Thread-4 (]: 21 of 31 START test source_unique_northwind_categories_category_id ............. [RUN]
[0m14:53:06.201068 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_exercise.source_not_null_northwind_territories_region_id.5df71bcf81, now test.dbt_exercise.source_unique_northwind_categories_category_id.17d9baa2e0)
[0m14:53:06.206048 [debug] [Thread-4 (]: Began compiling node test.dbt_exercise.source_unique_northwind_categories_category_id.17d9baa2e0
[0m14:53:06.219248 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_exercise.source_unique_northwind_categories_category_id.17d9baa2e0"
[0m14:53:06.221093 [debug] [Thread-4 (]: Began executing node test.dbt_exercise.source_unique_northwind_categories_category_id.17d9baa2e0
[0m14:53:06.226696 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_exercise.source_unique_northwind_categories_category_id.17d9baa2e0"
[0m14:53:06.228730 [debug] [Thread-4 (]: On test.dbt_exercise.source_unique_northwind_categories_category_id.17d9baa2e0: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "test.dbt_exercise.source_unique_northwind_categories_category_id.17d9baa2e0"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with dbt_test__target as (

  select category_id as unique_field
  from `corded-sunlight-464012-e2`.`dbt_dw_raw`.`categories`
  where category_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m14:53:06.229656 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m14:53:06.282698 [info ] [Thread-1 (]: 17 of 31 PASS source_not_null_northwind_suppliers_supplier_id .................. [[32mPASS[0m in 2.21s]
[0m14:53:06.284018 [debug] [Thread-1 (]: Finished running node test.dbt_exercise.source_not_null_northwind_suppliers_supplier_id.de5c4d0062
[0m14:53:06.284821 [debug] [Thread-1 (]: Began running node test.dbt_exercise.source_unique_northwind_country_codes_country_code.cf83d0431e
[0m14:53:06.286146 [info ] [Thread-1 (]: 22 of 31 START test source_unique_northwind_country_codes_country_code ......... [RUN]
[0m14:53:06.288102 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_exercise.source_not_null_northwind_suppliers_supplier_id.de5c4d0062, now test.dbt_exercise.source_unique_northwind_country_codes_country_code.cf83d0431e)
[0m14:53:06.289298 [debug] [Thread-1 (]: Began compiling node test.dbt_exercise.source_unique_northwind_country_codes_country_code.cf83d0431e
[0m14:53:06.297991 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_exercise.source_unique_northwind_country_codes_country_code.cf83d0431e"
[0m14:53:06.299280 [debug] [Thread-1 (]: Began executing node test.dbt_exercise.source_unique_northwind_country_codes_country_code.cf83d0431e
[0m14:53:06.303200 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_exercise.source_unique_northwind_country_codes_country_code.cf83d0431e"
[0m14:53:06.304663 [debug] [Thread-1 (]: On test.dbt_exercise.source_unique_northwind_country_codes_country_code.cf83d0431e: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "test.dbt_exercise.source_unique_northwind_country_codes_country_code.cf83d0431e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with dbt_test__target as (

  select country_code as unique_field
  from `corded-sunlight-464012-e2`.`dbt_dw_raw`.`country_codes`
  where country_code is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m14:53:06.305527 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:53:06.362410 [info ] [Thread-3 (]: 19 of 31 PASS source_not_null_northwind_territories_territory_id ............... [[32mPASS[0m in 1.97s]
[0m14:53:06.364487 [debug] [Thread-3 (]: Finished running node test.dbt_exercise.source_not_null_northwind_territories_territory_id.9b9655b8a9
[0m14:53:06.365514 [debug] [Thread-3 (]: Began running node test.dbt_exercise.source_unique_northwind_customers_customer_id.ff818c137b
[0m14:53:06.366548 [info ] [Thread-3 (]: 23 of 31 START test source_unique_northwind_customers_customer_id .............. [RUN]
[0m14:53:06.367704 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_exercise.source_not_null_northwind_territories_territory_id.9b9655b8a9, now test.dbt_exercise.source_unique_northwind_customers_customer_id.ff818c137b)
[0m14:53:06.368824 [debug] [Thread-3 (]: Began compiling node test.dbt_exercise.source_unique_northwind_customers_customer_id.ff818c137b
[0m14:53:06.376881 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_exercise.source_unique_northwind_customers_customer_id.ff818c137b"
[0m14:53:06.378305 [debug] [Thread-3 (]: Began executing node test.dbt_exercise.source_unique_northwind_customers_customer_id.ff818c137b
[0m14:53:06.384022 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_exercise.source_unique_northwind_customers_customer_id.ff818c137b"
[0m14:53:06.385878 [debug] [Thread-3 (]: On test.dbt_exercise.source_unique_northwind_customers_customer_id.ff818c137b: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "test.dbt_exercise.source_unique_northwind_customers_customer_id.ff818c137b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with dbt_test__target as (

  select customer_id as unique_field
  from `corded-sunlight-464012-e2`.`dbt_dw_raw`.`customers`
  where customer_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m14:53:06.387338 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:53:06.522299 [info ] [Thread-2 (]: 20 of 31 PASS source_not_null_northwind_us_states_state_id ..................... [[32mPASS[0m in 2.03s]
[0m14:53:06.524409 [debug] [Thread-2 (]: Finished running node test.dbt_exercise.source_not_null_northwind_us_states_state_id.2e33a23d78
[0m14:53:06.526062 [debug] [Thread-2 (]: Began running node test.dbt_exercise.source_unique_northwind_employees_employee_id.e63c624594
[0m14:53:06.528006 [info ] [Thread-2 (]: 24 of 31 START test source_unique_northwind_employees_employee_id .............. [RUN]
[0m14:53:06.529024 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_exercise.source_not_null_northwind_us_states_state_id.2e33a23d78, now test.dbt_exercise.source_unique_northwind_employees_employee_id.e63c624594)
[0m14:53:06.529879 [debug] [Thread-2 (]: Began compiling node test.dbt_exercise.source_unique_northwind_employees_employee_id.e63c624594
[0m14:53:06.537596 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_exercise.source_unique_northwind_employees_employee_id.e63c624594"
[0m14:53:06.539229 [debug] [Thread-2 (]: Began executing node test.dbt_exercise.source_unique_northwind_employees_employee_id.e63c624594
[0m14:53:06.545559 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_exercise.source_unique_northwind_employees_employee_id.e63c624594"
[0m14:53:06.547658 [debug] [Thread-2 (]: On test.dbt_exercise.source_unique_northwind_employees_employee_id.e63c624594: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "test.dbt_exercise.source_unique_northwind_employees_employee_id.e63c624594"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with dbt_test__target as (

  select employee_id as unique_field
  from `corded-sunlight-464012-e2`.`dbt_dw_raw`.`employees`
  where employee_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m14:53:06.548818 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m14:53:07.245689 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:aee3b804-2ded-409f-be97-1b125d862b32&page=queryresults
[0m14:53:07.332557 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:fb5a433d-d0b6-4a54-bf14-c9a3889999ff&page=queryresults
[0m14:53:07.400670 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:6572eba4-14db-4e33-83ef-3800e6812499&page=queryresults
[0m14:53:08.184811 [info ] [Thread-1 (]: 22 of 31 PASS source_unique_northwind_country_codes_country_code ............... [[32mPASS[0m in 1.90s]
[0m14:53:08.186344 [debug] [Thread-1 (]: Finished running node test.dbt_exercise.source_unique_northwind_country_codes_country_code.cf83d0431e
[0m14:53:08.187670 [debug] [Thread-1 (]: Began running node test.dbt_exercise.source_unique_northwind_orders_order_id.4a8a4df128
[0m14:53:08.189319 [info ] [Thread-1 (]: 25 of 31 START test source_unique_northwind_orders_order_id .................... [RUN]
[0m14:53:08.191078 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_exercise.source_unique_northwind_country_codes_country_code.cf83d0431e, now test.dbt_exercise.source_unique_northwind_orders_order_id.4a8a4df128)
[0m14:53:08.193180 [debug] [Thread-1 (]: Began compiling node test.dbt_exercise.source_unique_northwind_orders_order_id.4a8a4df128
[0m14:53:08.204635 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_exercise.source_unique_northwind_orders_order_id.4a8a4df128"
[0m14:53:08.212129 [info ] [Thread-3 (]: 23 of 31 PASS source_unique_northwind_customers_customer_id .................... [[32mPASS[0m in 1.84s]
[0m14:53:08.214143 [debug] [Thread-3 (]: Finished running node test.dbt_exercise.source_unique_northwind_customers_customer_id.ff818c137b
[0m14:53:08.215862 [debug] [Thread-1 (]: Began executing node test.dbt_exercise.source_unique_northwind_orders_order_id.4a8a4df128
[0m14:53:08.217638 [debug] [Thread-3 (]: Began running node test.dbt_exercise.source_unique_northwind_products_product_id.740bf6f9a5
[0m14:53:08.222620 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_exercise.source_unique_northwind_orders_order_id.4a8a4df128"
[0m14:53:08.224561 [info ] [Thread-3 (]: 26 of 31 START test source_unique_northwind_products_product_id ................ [RUN]
[0m14:53:08.227063 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_exercise.source_unique_northwind_customers_customer_id.ff818c137b, now test.dbt_exercise.source_unique_northwind_products_product_id.740bf6f9a5)
[0m14:53:08.228312 [debug] [Thread-3 (]: Began compiling node test.dbt_exercise.source_unique_northwind_products_product_id.740bf6f9a5
[0m14:53:08.230064 [debug] [Thread-1 (]: On test.dbt_exercise.source_unique_northwind_orders_order_id.4a8a4df128: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "test.dbt_exercise.source_unique_northwind_orders_order_id.4a8a4df128"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with dbt_test__target as (

  select order_id as unique_field
  from `corded-sunlight-464012-e2`.`dbt_dw_raw`.`orders`
  where order_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m14:53:08.237890 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_exercise.source_unique_northwind_products_product_id.740bf6f9a5"
[0m14:53:08.239333 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:53:08.241401 [debug] [Thread-3 (]: Began executing node test.dbt_exercise.source_unique_northwind_products_product_id.740bf6f9a5
[0m14:53:08.248517 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_exercise.source_unique_northwind_products_product_id.740bf6f9a5"
[0m14:53:08.250281 [debug] [Thread-3 (]: On test.dbt_exercise.source_unique_northwind_products_product_id.740bf6f9a5: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "test.dbt_exercise.source_unique_northwind_products_product_id.740bf6f9a5"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with dbt_test__target as (

  select product_id as unique_field
  from `corded-sunlight-464012-e2`.`dbt_dw_raw`.`products`
  where product_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m14:53:08.251844 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:53:08.395289 [info ] [Thread-4 (]: 21 of 31 PASS source_unique_northwind_categories_category_id ................... [[32mPASS[0m in 2.19s]
[0m14:53:08.397122 [debug] [Thread-4 (]: Finished running node test.dbt_exercise.source_unique_northwind_categories_category_id.17d9baa2e0
[0m14:53:08.397972 [debug] [Thread-4 (]: Began running node test.dbt_exercise.source_unique_northwind_region_region_id.9688f1f5fd
[0m14:53:08.399416 [info ] [Thread-4 (]: 27 of 31 START test source_unique_northwind_region_region_id ................... [RUN]
[0m14:53:08.400778 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_exercise.source_unique_northwind_categories_category_id.17d9baa2e0, now test.dbt_exercise.source_unique_northwind_region_region_id.9688f1f5fd)
[0m14:53:08.401687 [debug] [Thread-4 (]: Began compiling node test.dbt_exercise.source_unique_northwind_region_region_id.9688f1f5fd
[0m14:53:08.410782 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_exercise.source_unique_northwind_region_region_id.9688f1f5fd"
[0m14:53:08.412977 [debug] [Thread-4 (]: Began executing node test.dbt_exercise.source_unique_northwind_region_region_id.9688f1f5fd
[0m14:53:08.417472 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_exercise.source_unique_northwind_region_region_id.9688f1f5fd"
[0m14:53:08.418930 [debug] [Thread-4 (]: On test.dbt_exercise.source_unique_northwind_region_region_id.9688f1f5fd: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "test.dbt_exercise.source_unique_northwind_region_region_id.9688f1f5fd"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with dbt_test__target as (

  select region_id as unique_field
  from `corded-sunlight-464012-e2`.`dbt_dw_raw`.`region`
  where region_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m14:53:08.419713 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m14:53:09.237876 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:33272e86-a064-4aac-950b-fc2350ea5df8&page=queryresults
[0m14:53:09.382185 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:a7f72855-64ab-4350-b380-f2db380977df&page=queryresults
[0m14:53:09.411015 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:6565bc85-80e7-4148-b46c-6f3fe236e931&page=queryresults
[0m14:53:10.140729 [info ] [Thread-3 (]: 26 of 31 PASS source_unique_northwind_products_product_id ...................... [[32mPASS[0m in 1.91s]
[0m14:53:10.142499 [debug] [Thread-3 (]: Finished running node test.dbt_exercise.source_unique_northwind_products_product_id.740bf6f9a5
[0m14:53:10.143996 [debug] [Thread-3 (]: Began running node test.dbt_exercise.source_unique_northwind_shippers_shipper_id.61edb3f736
[0m14:53:10.145398 [info ] [Thread-3 (]: 28 of 31 START test source_unique_northwind_shippers_shipper_id ................ [RUN]
[0m14:53:10.147209 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_exercise.source_unique_northwind_products_product_id.740bf6f9a5, now test.dbt_exercise.source_unique_northwind_shippers_shipper_id.61edb3f736)
[0m14:53:10.148366 [debug] [Thread-3 (]: Began compiling node test.dbt_exercise.source_unique_northwind_shippers_shipper_id.61edb3f736
[0m14:53:10.159493 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_exercise.source_unique_northwind_shippers_shipper_id.61edb3f736"
[0m14:53:10.164363 [debug] [Thread-3 (]: Began executing node test.dbt_exercise.source_unique_northwind_shippers_shipper_id.61edb3f736
[0m14:53:10.171578 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_exercise.source_unique_northwind_shippers_shipper_id.61edb3f736"
[0m14:53:10.173654 [debug] [Thread-3 (]: On test.dbt_exercise.source_unique_northwind_shippers_shipper_id.61edb3f736: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "test.dbt_exercise.source_unique_northwind_shippers_shipper_id.61edb3f736"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with dbt_test__target as (

  select shipper_id as unique_field
  from `corded-sunlight-464012-e2`.`dbt_dw_raw`.`shippers`
  where shipper_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m14:53:10.175343 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:53:10.252215 [info ] [Thread-1 (]: 25 of 31 PASS source_unique_northwind_orders_order_id .......................... [[32mPASS[0m in 2.06s]
[0m14:53:10.253789 [debug] [Thread-1 (]: Finished running node test.dbt_exercise.source_unique_northwind_orders_order_id.4a8a4df128
[0m14:53:10.254692 [debug] [Thread-1 (]: Began running node test.dbt_exercise.source_unique_northwind_suppliers_supplier_id.aa7461739b
[0m14:53:10.255686 [info ] [Thread-1 (]: 29 of 31 START test source_unique_northwind_suppliers_supplier_id .............. [RUN]
[0m14:53:10.256946 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_exercise.source_unique_northwind_orders_order_id.4a8a4df128, now test.dbt_exercise.source_unique_northwind_suppliers_supplier_id.aa7461739b)
[0m14:53:10.257739 [debug] [Thread-1 (]: Began compiling node test.dbt_exercise.source_unique_northwind_suppliers_supplier_id.aa7461739b
[0m14:53:10.272601 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_exercise.source_unique_northwind_suppliers_supplier_id.aa7461739b"
[0m14:53:10.274278 [debug] [Thread-1 (]: Began executing node test.dbt_exercise.source_unique_northwind_suppliers_supplier_id.aa7461739b
[0m14:53:10.281191 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_exercise.source_unique_northwind_suppliers_supplier_id.aa7461739b"
[0m14:53:10.283091 [debug] [Thread-1 (]: On test.dbt_exercise.source_unique_northwind_suppliers_supplier_id.aa7461739b: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "test.dbt_exercise.source_unique_northwind_suppliers_supplier_id.aa7461739b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with dbt_test__target as (

  select supplier_id as unique_field
  from `corded-sunlight-464012-e2`.`dbt_dw_raw`.`suppliers`
  where supplier_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m14:53:10.284711 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:53:10.292749 [info ] [Thread-4 (]: 27 of 31 PASS source_unique_northwind_region_region_id ......................... [[32mPASS[0m in 1.89s]
[0m14:53:10.295025 [debug] [Thread-4 (]: Finished running node test.dbt_exercise.source_unique_northwind_region_region_id.9688f1f5fd
[0m14:53:10.296358 [debug] [Thread-4 (]: Began running node test.dbt_exercise.source_unique_northwind_territories_territory_id.08bc548860
[0m14:53:10.298065 [info ] [Thread-4 (]: 30 of 31 START test source_unique_northwind_territories_territory_id ........... [RUN]
[0m14:53:10.301686 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_exercise.source_unique_northwind_region_region_id.9688f1f5fd, now test.dbt_exercise.source_unique_northwind_territories_territory_id.08bc548860)
[0m14:53:10.349495 [debug] [Thread-4 (]: Began compiling node test.dbt_exercise.source_unique_northwind_territories_territory_id.08bc548860
[0m14:53:10.364841 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_exercise.source_unique_northwind_territories_territory_id.08bc548860"
[0m14:53:10.366623 [debug] [Thread-4 (]: Began executing node test.dbt_exercise.source_unique_northwind_territories_territory_id.08bc548860
[0m14:53:10.372315 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_exercise.source_unique_northwind_territories_territory_id.08bc548860"
[0m14:53:10.374084 [debug] [Thread-4 (]: On test.dbt_exercise.source_unique_northwind_territories_territory_id.08bc548860: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "test.dbt_exercise.source_unique_northwind_territories_territory_id.08bc548860"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with dbt_test__target as (

  select territory_id as unique_field
  from `corded-sunlight-464012-e2`.`dbt_dw_raw`.`territories`
  where territory_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m14:53:10.375773 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m14:53:11.124146 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:685c2987-3e50-45d7-9c92-17c33e87c4d4&page=queryresults
[0m14:53:11.317348 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:6148927c-1d33-467c-8f6e-f2a2d24fab0d&page=queryresults
[0m14:53:11.344249 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:9432c671-c7e6-4d57-8c4b-5504fe8ec265&page=queryresults
[0m14:53:11.929953 [info ] [Thread-3 (]: 28 of 31 PASS source_unique_northwind_shippers_shipper_id ...................... [[32mPASS[0m in 1.78s]
[0m14:53:11.931545 [debug] [Thread-3 (]: Finished running node test.dbt_exercise.source_unique_northwind_shippers_shipper_id.61edb3f736
[0m14:53:11.932492 [debug] [Thread-3 (]: Began running node test.dbt_exercise.source_unique_northwind_us_states_state_id.c374c85cda
[0m14:53:11.933632 [info ] [Thread-3 (]: 31 of 31 START test source_unique_northwind_us_states_state_id ................. [RUN]
[0m14:53:11.934656 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_exercise.source_unique_northwind_shippers_shipper_id.61edb3f736, now test.dbt_exercise.source_unique_northwind_us_states_state_id.c374c85cda)
[0m14:53:11.935570 [debug] [Thread-3 (]: Began compiling node test.dbt_exercise.source_unique_northwind_us_states_state_id.c374c85cda
[0m14:53:11.945015 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_exercise.source_unique_northwind_us_states_state_id.c374c85cda"
[0m14:53:11.947168 [debug] [Thread-3 (]: Began executing node test.dbt_exercise.source_unique_northwind_us_states_state_id.c374c85cda
[0m14:53:11.953565 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_exercise.source_unique_northwind_us_states_state_id.c374c85cda"
[0m14:53:11.956010 [debug] [Thread-3 (]: On test.dbt_exercise.source_unique_northwind_us_states_state_id.c374c85cda: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "test.dbt_exercise.source_unique_northwind_us_states_state_id.c374c85cda"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with dbt_test__target as (

  select state_id as unique_field
  from `corded-sunlight-464012-e2`.`dbt_dw_raw`.`us_states`
  where state_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m14:53:11.958207 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m14:53:12.180704 [info ] [Thread-4 (]: 30 of 31 PASS source_unique_northwind_territories_territory_id ................. [[32mPASS[0m in 1.88s]
[0m14:53:12.182347 [debug] [Thread-4 (]: Finished running node test.dbt_exercise.source_unique_northwind_territories_territory_id.08bc548860
[0m14:53:12.194206 [info ] [Thread-1 (]: 29 of 31 PASS source_unique_northwind_suppliers_supplier_id .................... [[32mPASS[0m in 1.94s]
[0m14:53:12.196383 [debug] [Thread-1 (]: Finished running node test.dbt_exercise.source_unique_northwind_suppliers_supplier_id.aa7461739b
[0m14:53:12.925798 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:ef577cd1-ac33-49bf-9e21-3f22a13f5f61&page=queryresults
[0m14:53:13.836266 [info ] [Thread-3 (]: 31 of 31 PASS source_unique_northwind_us_states_state_id ....................... [[32mPASS[0m in 1.90s]
[0m14:53:13.837817 [debug] [Thread-3 (]: Finished running node test.dbt_exercise.source_unique_northwind_us_states_state_id.c374c85cda
[0m14:54:08.008585 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:1d8085d8-065a-43d9-91a6-7802c5afc8a2&page=queryresults
[0m14:54:08.880894 [info ] [Thread-2 (]: 24 of 31 PASS source_unique_northwind_employees_employee_id .................... [[32mPASS[0m in 62.35s]
[0m14:54:08.882393 [debug] [Thread-2 (]: Finished running node test.dbt_exercise.source_unique_northwind_employees_employee_id.e63c624594
[0m14:54:08.886752 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:54:08.900332 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:54:08.904131 [debug] [MainThread]: Connection 'test.dbt_exercise.source_unique_northwind_employees_employee_id.e63c624594' was properly closed.
[0m14:54:08.905289 [debug] [MainThread]: Connection 'test.dbt_exercise.source_unique_northwind_suppliers_supplier_id.aa7461739b' was properly closed.
[0m14:54:08.906543 [debug] [MainThread]: Connection 'test.dbt_exercise.source_unique_northwind_us_states_state_id.c374c85cda' was properly closed.
[0m14:54:08.908168 [debug] [MainThread]: Connection 'test.dbt_exercise.source_unique_northwind_territories_territory_id.08bc548860' was properly closed.
[0m14:54:08.909090 [info ] [MainThread]: 
[0m14:54:08.909808 [info ] [MainThread]: Finished running 31 data tests in 0 hours 1 minutes and 20.21 seconds (80.21s).
[0m14:54:08.918970 [debug] [MainThread]: Command end result
[0m14:54:09.015276 [debug] [MainThread]: Wrote artifact WritableManifest to /home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/target/manifest.json
[0m14:54:09.035513 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/target/semantic_manifest.json
[0m14:54:09.048068 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/target/run_results.json
[0m14:54:09.048959 [info ] [MainThread]: 
[0m14:54:09.049726 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:54:09.050515 [info ] [MainThread]: 
[0m14:54:09.051370 [info ] [MainThread]: Done. PASS=31 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=31
[0m14:54:09.053075 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- DuplicateYAMLKeysDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m14:54:09.060827 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 193.33273, "process_in_blocks": "144784", "process_kernel_time": 15.583776, "process_mem_max_rss": "372952", "process_out_blocks": "5504", "process_user_time": 15.996261}
[0m14:54:09.061974 [debug] [MainThread]: Command `dbt test` succeeded at 14:54:09.061741 after 193.33 seconds
[0m14:54:09.062740 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7df92381f9b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7df8e4612960>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7df9264331d0>]}
[0m14:54:09.063673 [debug] [MainThread]: Flushing usage events
[0m14:54:09.411953 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:27:52.292201 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dbf5fd81670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dbf5d408d40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dbf5eed6360>]}


============================== 15:27:52.313743 | 3b8f1695-472b-4cb2-93a6-e957c14d9c39 ==============================
[0m15:27:52.313743 [info ] [MainThread]: Running with dbt=1.10.2
[0m15:27:52.315047 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/logs', 'profiles_dir': '/home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run -s stg_products_northwind', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m15:28:51.602501 [warn ] [MainThread]: [[33mWARNING[0m][DuplicateYAMLKeysDeprecation]: Deprecated functionality
Duplicate key 'version' in "<unicode string>", line 4, column 1 in file
`/home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/dbt_project.yml`
[0m15:28:51.603629 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '3b8f1695-472b-4cb2-93a6-e957c14d9c39', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dbf1f632420>]}
[0m15:28:52.705980 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3b8f1695-472b-4cb2-93a6-e957c14d9c39', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dbf5c495a00>]}
[0m15:28:52.828836 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3b8f1695-472b-4cb2-93a6-e957c14d9c39', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dbf1f7121b0>]}
[0m15:28:52.835090 [info ] [MainThread]: Registered adapter: bigquery=1.9.2
[0m15:29:51.611643 [debug] [MainThread]: checksum: 1adc40777973ef30f45f80b3b6d04d5013c1edd53d96363881b3b199e612468b, vars: {}, profile: , target: , version: 1.10.2
[0m15:29:58.289975 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:29:58.290634 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:29:58.300672 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.dbt_exercise.intermediate
- models.dbt_exercise.marts
[0m15:29:58.399537 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3b8f1695-472b-4cb2-93a6-e957c14d9c39', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dbf1f270050>]}
[0m15:29:58.812670 [debug] [MainThread]: Wrote artifact WritableManifest to /home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/target/manifest.json
[0m15:29:58.832819 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/target/semantic_manifest.json
[0m15:29:59.407339 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3b8f1695-472b-4cb2-93a6-e957c14d9c39', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dbf1f1a2540>]}
[0m15:29:59.408298 [info ] [MainThread]: Found 14 seeds, 31 data tests, 5 models, 14 sources, 609 macros
[0m15:29:59.409182 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3b8f1695-472b-4cb2-93a6-e957c14d9c39', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dbf5c4946e0>]}
[0m15:29:59.412778 [info ] [MainThread]: 
[0m15:29:59.413515 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:29:59.414175 [info ] [MainThread]: 
[0m15:29:59.415381 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m15:29:59.417353 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_corded-sunlight-464012-e2'
[0m15:29:59.418561 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:30:00.455573 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_corded-sunlight-464012-e2, now list_corded-sunlight-464012-e2_dbt_dw_staging)
[0m15:30:00.456725 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_corded-sunlight-464012-e2_dbt_dw_raw'
[0m15:30:00.457570 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:30:00.458295 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:30:01.431503 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3b8f1695-472b-4cb2-93a6-e957c14d9c39', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dbf1f0246b0>]}
[0m15:30:01.432537 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:30:01.450300 [debug] [Thread-1 (]: Began running node model.dbt_exercise.stg_products_northwind
[0m15:30:01.451374 [info ] [Thread-1 (]: 1 of 1 START sql view model dbt_dw_staging.stg_products_northwind .............. [RUN]
[0m15:30:01.452424 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_corded-sunlight-464012-e2_dbt_dw_staging, now model.dbt_exercise.stg_products_northwind)
[0m15:30:01.453147 [debug] [Thread-1 (]: Began compiling node model.dbt_exercise.stg_products_northwind
[0m15:30:01.472689 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_exercise.stg_products_northwind"
[0m15:30:01.476165 [debug] [Thread-1 (]: Began executing node model.dbt_exercise.stg_products_northwind
[0m15:30:01.556094 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_exercise.stg_products_northwind"
[0m15:30:01.558415 [debug] [Thread-1 (]: On model.dbt_exercise.stg_products_northwind: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "model.dbt_exercise.stg_products_northwind"} */


  create or replace view `corded-sunlight-464012-e2`.`dbt_dw_staging`.`stg_products_northwind`
  OPTIONS()
  as with products as (
    select *
    from `corded-sunlight-464012-e2`.`dbt_dw_raw`.`products`
)

select
    cast(product_id as string) as product_id
    , cast(product_name as string) as product_name
    , cast(supplier_id as string) as supplier_id
    , cast(category_id as string) as category_id
    , cast(quantity_per_unit as string) as quantity_per_unit
    , cast(unit_price as numeric) as unit_price
    , cast(units_in_stock as numeric) as units_in_stock
    , cast(units_on_order as numeric) as units_on_order
    , cast(reorder_level as numeric) as reorder_level
    , cast(discontinued as boolean) as discontinued
from products;


[0m15:30:01.559620 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:30:02.708113 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:2ea55977-702b-453f-9424-d502d9636f66&page=queryresults
[0m15:30:10.262796 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3b8f1695-472b-4cb2-93a6-e957c14d9c39', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dbf5d541ee0>]}
[0m15:30:10.264052 [info ] [Thread-1 (]: 1 of 1 OK created sql view model dbt_dw_staging.stg_products_northwind ......... [[32mCREATE VIEW (0 processed)[0m in 8.79s]
[0m15:30:10.265004 [debug] [Thread-1 (]: Finished running node model.dbt_exercise.stg_products_northwind
[0m15:30:10.268386 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:30:10.277661 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:30:10.278580 [debug] [MainThread]: Connection 'model.dbt_exercise.stg_products_northwind' was properly closed.
[0m15:30:10.279752 [debug] [MainThread]: Connection 'list_corded-sunlight-464012-e2_dbt_dw_raw' was properly closed.
[0m15:30:10.280755 [info ] [MainThread]: 
[0m15:30:10.281889 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 10.87 seconds (10.87s).
[0m15:30:10.284035 [debug] [MainThread]: Command end result
[0m15:30:10.361840 [debug] [MainThread]: Wrote artifact WritableManifest to /home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/target/manifest.json
[0m15:30:10.380197 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/target/semantic_manifest.json
[0m15:30:10.389377 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/target/run_results.json
[0m15:30:10.390025 [info ] [MainThread]: 
[0m15:30:10.390736 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:30:10.391540 [info ] [MainThread]: 
[0m15:30:10.392318 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m15:30:10.393326 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- DuplicateYAMLKeysDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m15:30:10.401620 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 138.21854, "process_in_blocks": "126968", "process_kernel_time": 17.319447, "process_mem_max_rss": "365840", "process_out_blocks": "3272", "process_user_time": 14.021353}
[0m15:30:10.402619 [debug] [MainThread]: Command `dbt run` succeeded at 15:30:10.402414 after 138.22 seconds
[0m15:30:10.403315 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dbf5c66fb00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dbf5c8eef90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dbf5c4df500>]}
[0m15:30:10.403881 [debug] [MainThread]: Flushing usage events
[0m15:30:10.755566 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:31:43.105197 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7658134b16a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x765811592180>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x765811285760>]}


============================== 15:31:43.127868 | 2b3e40e3-39ae-47e7-a6bf-dd15016e2525 ==============================
[0m15:31:43.127868 [info ] [MainThread]: Running with dbt=1.10.2
[0m15:31:43.129158 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/logs', 'debug': 'False', 'profiles_dir': '/home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m15:32:55.444687 [warn ] [MainThread]: [[33mWARNING[0m][DuplicateYAMLKeysDeprecation]: Deprecated functionality
Duplicate key 'version' in "<unicode string>", line 4, column 1 in file
`/home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/dbt_project.yml`
[0m15:32:55.445966 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '2b3e40e3-39ae-47e7-a6bf-dd15016e2525', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7657d3ccffb0>]}
[0m15:32:56.837053 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2b3e40e3-39ae-47e7-a6bf-dd15016e2525', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7657d4323aa0>]}
[0m15:32:56.947442 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2b3e40e3-39ae-47e7-a6bf-dd15016e2525', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7657d3c214f0>]}
[0m15:32:56.954085 [info ] [MainThread]: Registered adapter: bigquery=1.9.2
[0m15:34:09.360554 [debug] [MainThread]: checksum: 1adc40777973ef30f45f80b3b6d04d5013c1edd53d96363881b3b199e612468b, vars: {}, profile: , target: , version: 1.10.2
[0m15:34:16.783683 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:34:16.784477 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:34:16.795575 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.dbt_exercise.intermediate
- models.dbt_exercise.marts
[0m15:34:16.889146 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2b3e40e3-39ae-47e7-a6bf-dd15016e2525', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7657d3890bf0>]}
[0m15:34:17.389295 [debug] [MainThread]: Wrote artifact WritableManifest to /home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/target/manifest.json
[0m15:34:17.408287 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/target/semantic_manifest.json
[0m15:34:18.047393 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2b3e40e3-39ae-47e7-a6bf-dd15016e2525', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7657d3617d70>]}
[0m15:34:18.048210 [info ] [MainThread]: Found 14 seeds, 31 data tests, 5 models, 14 sources, 609 macros
[0m15:34:18.048917 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2b3e40e3-39ae-47e7-a6bf-dd15016e2525', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7657d3683cb0>]}
[0m15:34:18.053525 [info ] [MainThread]: 
[0m15:34:18.055238 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:34:18.056087 [info ] [MainThread]: 
[0m15:34:18.057395 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m15:34:18.064556 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_corded-sunlight-464012-e2'
[0m15:34:18.065526 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:34:19.021235 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_corded-sunlight-464012-e2, now list_corded-sunlight-464012-e2_dbt_dw_raw)
[0m15:34:19.022310 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:34:19.024018 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_corded-sunlight-464012-e2_dbt_dw_staging'
[0m15:34:19.025710 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:34:19.932547 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2b3e40e3-39ae-47e7-a6bf-dd15016e2525', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7657d3cb5d00>]}
[0m15:34:19.933514 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:34:19.958987 [debug] [Thread-1 (]: Began running node model.dbt_exercise.stg_categories_northwind
[0m15:34:19.959994 [debug] [Thread-2 (]: Began running node model.dbt_exercise.stg_customers_northwind
[0m15:34:19.962384 [debug] [Thread-3 (]: Began running node model.dbt_exercise.stg_employees_northwind
[0m15:34:19.961433 [info ] [Thread-1 (]: 1 of 5 START sql view model dbt_dw_staging.stg_categories_northwind ............ [RUN]
[0m15:34:19.964014 [debug] [Thread-4 (]: Began running node model.dbt_exercise.stg_orders_northwind
[0m15:34:19.965219 [info ] [Thread-2 (]: 2 of 5 START sql view model dbt_dw_staging.stg_customers_northwind ............. [RUN]
[0m15:34:19.967513 [info ] [Thread-3 (]: 3 of 5 START sql view model dbt_dw_staging.stg_employees_northwind ............. [RUN]
[0m15:34:19.969727 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_corded-sunlight-464012-e2_dbt_dw_staging, now model.dbt_exercise.stg_categories_northwind)
[0m15:34:19.971363 [info ] [Thread-4 (]: 4 of 5 START sql view model dbt_dw_staging.stg_orders_northwind ................ [RUN]
[0m15:34:19.972625 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_corded-sunlight-464012-e2_dbt_dw_raw, now model.dbt_exercise.stg_customers_northwind)
[0m15:34:19.974226 [debug] [Thread-3 (]: Acquiring new bigquery connection 'model.dbt_exercise.stg_employees_northwind'
[0m15:34:19.975602 [debug] [Thread-1 (]: Began compiling node model.dbt_exercise.stg_categories_northwind
[0m15:34:19.977210 [debug] [Thread-4 (]: Acquiring new bigquery connection 'model.dbt_exercise.stg_orders_northwind'
[0m15:34:19.978665 [debug] [Thread-2 (]: Began compiling node model.dbt_exercise.stg_customers_northwind
[0m15:34:19.980456 [debug] [Thread-3 (]: Began compiling node model.dbt_exercise.stg_employees_northwind
[0m15:34:20.001031 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_exercise.stg_categories_northwind"
[0m15:34:20.002035 [debug] [Thread-4 (]: Began compiling node model.dbt_exercise.stg_orders_northwind
[0m15:34:20.007304 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_exercise.stg_customers_northwind"
[0m15:34:20.015392 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_exercise.stg_employees_northwind"
[0m15:34:20.026581 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_exercise.stg_orders_northwind"
[0m15:34:20.028630 [debug] [Thread-1 (]: Began executing node model.dbt_exercise.stg_categories_northwind
[0m15:34:20.031843 [debug] [Thread-2 (]: Began executing node model.dbt_exercise.stg_customers_northwind
[0m15:34:20.033140 [debug] [Thread-3 (]: Began executing node model.dbt_exercise.stg_employees_northwind
[0m15:34:20.111371 [debug] [Thread-4 (]: Began executing node model.dbt_exercise.stg_orders_northwind
[0m15:34:20.148437 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_exercise.stg_customers_northwind"
[0m15:34:20.150537 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_exercise.stg_categories_northwind"
[0m15:34:20.156870 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_exercise.stg_employees_northwind"
[0m15:34:20.162509 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_exercise.stg_orders_northwind"
[0m15:34:20.165735 [debug] [Thread-2 (]: On model.dbt_exercise.stg_customers_northwind: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "model.dbt_exercise.stg_customers_northwind"} */


  create or replace view `corded-sunlight-464012-e2`.`dbt_dw_staging`.`stg_customers_northwind`
  OPTIONS()
  as with customers as (
    select *
    from `corded-sunlight-464012-e2`.`dbt_dw_raw`.`customers`
)

select
    cast(customer_id as string) as customer_id
    , cast(company_name as string) as company_name
    , cast(contact_name as string) as contact_name
    , cast(contact_title as string) as contact_title
    , cast(address as string) as address
    , cast(city as string) as city
    , cast(region as string) as region
    , cast(postal_code as string) as postal_code
    , cast(country as string) as country
    , cast(phone as string) as phone
    , cast(fax as string) as fax
from customers;


[0m15:34:20.167422 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:34:20.168938 [debug] [Thread-3 (]: On model.dbt_exercise.stg_employees_northwind: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "model.dbt_exercise.stg_employees_northwind"} */


  create or replace view `corded-sunlight-464012-e2`.`dbt_dw_staging`.`stg_employees_northwind`
  OPTIONS()
  as with employees as (
    select *
    from `corded-sunlight-464012-e2`.`dbt_dw_raw`.`employees`
)

/* Os campos photo, notes e reports_to e photo_path não são carregadas na staging */
select
    cast(employee_id as string) as employee_id
    , cast(first_name as string) as first_name
    , cast(last_name as string) as last_name
    , cast(title as string) as title
    , cast(title_of_courtesy as string) as title_of_courtesy
    , cast(birth_date as date) as birth_date
    , cast(hire_date as date) as hire_date
    , cast(address as string) as address
    , cast(city as string) as city
    , cast(region as string) as region
    , cast(postal_code as string) as postal_code
    , cast(country as string) as country
    , cast(home_phone as string) as home_phone
    , cast(extension as string) as extension
from employees;


[0m15:34:20.170596 [debug] [Thread-1 (]: On model.dbt_exercise.stg_categories_northwind: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "model.dbt_exercise.stg_categories_northwind"} */


  create or replace view `corded-sunlight-464012-e2`.`dbt_dw_staging`.`stg_categories_northwind`
  OPTIONS()
  as with categories as (
    select *
    from `corded-sunlight-464012-e2`.`dbt_dw_raw`.`categories`
)

/* Ao construir a staging não vamos trazer a coluna picture, pois ela não traz informação relevante */
select
    cast(category_id as string) as category_id
    , cast(category_name as string) as category_name
    , cast(description as string) as description
from categories;


[0m15:34:20.172312 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m15:34:20.173715 [debug] [Thread-4 (]: On model.dbt_exercise.stg_orders_northwind: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "model.dbt_exercise.stg_orders_northwind"} */


  create or replace view `corded-sunlight-464012-e2`.`dbt_dw_staging`.`stg_orders_northwind`
  OPTIONS()
  as with orders as (
    select *
    from `corded-sunlight-464012-e2`.`dbt_dw_raw`.`orders`
)

select
    cast(order_id as string) as order_id
    , cast(customer_id as string) as customer_id
    , cast(employee_id as string) as employee_id
    , cast(order_date as date) as order_date
    , cast(required_date as date) as required_date
    , cast(shipped_date as date) as shipped_date
    , cast(ship_via as string) as ship_via
    , cast(freight as numeric) as freight
    , cast(ship_name as string) as ship_name
    , cast(ship_address as string) as ship_address
    , cast(ship_city as string) as ship_city
    , cast(ship_region as string) as ship_region
    , cast(ship_postal_code as string) as ship_postal_code
    , cast(ship_country as string) as ship_country
from orders;


[0m15:34:20.174677 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:34:20.176387 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m15:34:21.255569 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:7180ada9-c152-45b8-8e97-bba441d19eb2&page=queryresults
[0m15:34:21.322103 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:894fa3ec-544b-4058-b4b0-0edec57afa04&page=queryresults
[0m15:34:21.433442 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:c9b4fccb-bf62-45e9-9ffb-6a7b70f9b475&page=queryresults
[0m15:34:21.438021 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:4eeca997-c18e-4d6b-9274-eab5a06e241e&page=queryresults
[0m15:34:28.511562 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2b3e40e3-39ae-47e7-a6bf-dd15016e2525', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7657d01fe450>]}
[0m15:34:28.512362 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2b3e40e3-39ae-47e7-a6bf-dd15016e2525', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7657dc6ca780>]}
[0m15:34:28.513310 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2b3e40e3-39ae-47e7-a6bf-dd15016e2525', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7657d3bc0da0>]}
[0m15:34:28.515443 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2b3e40e3-39ae-47e7-a6bf-dd15016e2525', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7657d376c7d0>]}
[0m15:34:28.514605 [info ] [Thread-3 (]: 3 of 5 OK created sql view model dbt_dw_staging.stg_employees_northwind ........ [[32mCREATE VIEW (0 processed)[0m in 8.51s]
[0m15:34:28.517221 [info ] [Thread-2 (]: 2 of 5 OK created sql view model dbt_dw_staging.stg_customers_northwind ........ [[32mCREATE VIEW (0 processed)[0m in 8.52s]
[0m15:34:28.518955 [info ] [Thread-1 (]: 1 of 5 OK created sql view model dbt_dw_staging.stg_categories_northwind ....... [[32mCREATE VIEW (0 processed)[0m in 8.53s]
[0m15:34:28.520745 [info ] [Thread-4 (]: 4 of 5 OK created sql view model dbt_dw_staging.stg_orders_northwind ........... [[32mCREATE VIEW (0 processed)[0m in 8.53s]
[0m15:34:28.522682 [debug] [Thread-3 (]: Finished running node model.dbt_exercise.stg_employees_northwind
[0m15:34:28.524791 [debug] [Thread-2 (]: Finished running node model.dbt_exercise.stg_customers_northwind
[0m15:34:28.526302 [debug] [Thread-1 (]: Finished running node model.dbt_exercise.stg_categories_northwind
[0m15:34:28.527814 [debug] [Thread-4 (]: Finished running node model.dbt_exercise.stg_orders_northwind
[0m15:34:28.529432 [debug] [Thread-3 (]: Began running node model.dbt_exercise.stg_products_northwind
[0m15:34:28.533052 [info ] [Thread-3 (]: 5 of 5 START sql view model dbt_dw_staging.stg_products_northwind .............. [RUN]
[0m15:34:28.534336 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_exercise.stg_employees_northwind, now model.dbt_exercise.stg_products_northwind)
[0m15:34:28.535540 [debug] [Thread-3 (]: Began compiling node model.dbt_exercise.stg_products_northwind
[0m15:34:28.543490 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_exercise.stg_products_northwind"
[0m15:34:28.544723 [debug] [Thread-3 (]: Began executing node model.dbt_exercise.stg_products_northwind
[0m15:34:28.551250 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_exercise.stg_products_northwind"
[0m15:34:28.553161 [debug] [Thread-3 (]: On model.dbt_exercise.stg_products_northwind: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "model.dbt_exercise.stg_products_northwind"} */


  create or replace view `corded-sunlight-464012-e2`.`dbt_dw_staging`.`stg_products_northwind`
  OPTIONS()
  as with products as (
    select *
    from `corded-sunlight-464012-e2`.`dbt_dw_raw`.`products`
)

select
    cast(product_id as string) as product_id
    , cast(product_name as string) as product_name
    , cast(supplier_id as string) as supplier_id
    , cast(category_id as string) as category_id
    , cast(quantity_per_unit as string) as quantity_per_unit
    , cast(unit_price as numeric) as unit_price
    , cast(units_in_stock as numeric) as units_in_stock
    , cast(units_on_order as numeric) as units_on_order
    , cast(reorder_level as numeric) as reorder_level
    , cast(discontinued as boolean) as discontinued
from products;


[0m15:34:28.554563 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:34:29.581010 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:c3a5dd0d-688a-4c0b-ab67-6708a81058e2&page=queryresults
[0m15:34:30.227431 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2b3e40e3-39ae-47e7-a6bf-dd15016e2525', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7657dc6ca780>]}
[0m15:34:30.228688 [info ] [Thread-3 (]: 5 of 5 OK created sql view model dbt_dw_staging.stg_products_northwind ......... [[32mCREATE VIEW (0 processed)[0m in 1.69s]
[0m15:34:30.230101 [debug] [Thread-3 (]: Finished running node model.dbt_exercise.stg_products_northwind
[0m15:34:30.235368 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:34:30.245165 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:34:30.246464 [debug] [MainThread]: Connection 'model.dbt_exercise.stg_customers_northwind' was properly closed.
[0m15:34:30.247163 [debug] [MainThread]: Connection 'model.dbt_exercise.stg_categories_northwind' was properly closed.
[0m15:34:30.247930 [debug] [MainThread]: Connection 'model.dbt_exercise.stg_products_northwind' was properly closed.
[0m15:34:30.249065 [debug] [MainThread]: Connection 'model.dbt_exercise.stg_orders_northwind' was properly closed.
[0m15:34:30.253231 [info ] [MainThread]: 
[0m15:34:30.255205 [info ] [MainThread]: Finished running 5 view models in 0 hours 0 minutes and 12.19 seconds (12.19s).
[0m15:34:30.257356 [debug] [MainThread]: Command end result
[0m15:34:30.329383 [debug] [MainThread]: Wrote artifact WritableManifest to /home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/target/manifest.json
[0m15:34:30.345307 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/target/semantic_manifest.json
[0m15:34:30.355642 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/target/run_results.json
[0m15:34:30.356322 [info ] [MainThread]: 
[0m15:34:30.356955 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:34:30.357612 [info ] [MainThread]: 
[0m15:34:30.358204 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=5
[0m15:34:30.359389 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- DuplicateYAMLKeysDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m15:34:30.365753 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 167.3544, "process_in_blocks": "144360", "process_kernel_time": 20.170736, "process_mem_max_rss": "367856", "process_out_blocks": "3384", "process_user_time": 15.702907}
[0m15:34:30.367675 [debug] [MainThread]: Command `dbt run` succeeded at 15:34:30.366939 after 167.36 seconds
[0m15:34:30.369094 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x765811285760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x765811a3cc50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x765810b3bf20>]}
[0m15:34:30.369950 [debug] [MainThread]: Flushing usage events
[0m15:34:30.796637 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:45:30.292566 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x709c469cd730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x709c4699f650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x709c483b5b80>]}


============================== 15:45:30.317160 | 5e1fec64-14f0-4a5e-9773-c2abf377bd95 ==============================
[0m15:45:30.317160 [info ] [MainThread]: Running with dbt=1.10.2
[0m15:45:30.318205 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'invocation_command': 'dbt run -s stg_shippers_northwind', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:46:27.808764 [warn ] [MainThread]: [[33mWARNING[0m][DuplicateYAMLKeysDeprecation]: Deprecated functionality
Duplicate key 'version' in "<unicode string>", line 4, column 1 in file
`/home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/dbt_project.yml`
[0m15:46:27.809648 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '5e1fec64-14f0-4a5e-9773-c2abf377bd95', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x709c45944d70>]}
[0m15:46:28.629247 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5e1fec64-14f0-4a5e-9773-c2abf377bd95', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x709c087c36b0>]}
[0m15:46:28.757376 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5e1fec64-14f0-4a5e-9773-c2abf377bd95', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x709c08e466f0>]}
[0m15:46:28.762055 [info ] [MainThread]: Registered adapter: bigquery=1.9.2
[0m15:47:23.402726 [debug] [MainThread]: checksum: 1adc40777973ef30f45f80b3b6d04d5013c1edd53d96363881b3b199e612468b, vars: {}, profile: , target: , version: 1.10.2
[0m15:47:28.898085 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 1 files added, 0 files changed.
[0m15:47:28.899739 [debug] [MainThread]: Partial parsing: added file: dbt_exercise://models/staging/stg_shippers_northwind.sql
[0m15:47:28.900731 [debug] [MainThread]: Partial parsing: deleted file: dbt_exercise://models/staging/stg_shippers.sql
[0m15:47:29.659514 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.dbt_exercise.intermediate
- models.dbt_exercise.marts
[0m15:47:29.694388 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5e1fec64-14f0-4a5e-9773-c2abf377bd95', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x709c083a32c0>]}
[0m15:47:29.888932 [debug] [MainThread]: Wrote artifact WritableManifest to /home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/target/manifest.json
[0m15:47:29.905310 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/target/semantic_manifest.json
[0m15:47:30.475746 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5e1fec64-14f0-4a5e-9773-c2abf377bd95', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x709c08522ff0>]}
[0m15:47:30.476558 [info ] [MainThread]: Found 14 seeds, 31 data tests, 7 models, 14 sources, 609 macros
[0m15:47:30.477231 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5e1fec64-14f0-4a5e-9773-c2abf377bd95', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x709c083d6450>]}
[0m15:47:30.480554 [info ] [MainThread]: 
[0m15:47:30.481503 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:47:30.482126 [info ] [MainThread]: 
[0m15:47:30.483201 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m15:47:30.485090 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_corded-sunlight-464012-e2'
[0m15:47:30.486245 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:47:31.394785 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_corded-sunlight-464012-e2, now list_corded-sunlight-464012-e2_dbt_dw_raw)
[0m15:47:31.396519 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:47:31.397797 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_corded-sunlight-464012-e2_dbt_dw_staging'
[0m15:47:31.399000 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:47:32.450371 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5e1fec64-14f0-4a5e-9773-c2abf377bd95', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x709c480e6a20>]}
[0m15:47:32.451602 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:47:32.484814 [debug] [Thread-1 (]: Began running node model.dbt_exercise.stg_shippers_northwind
[0m15:47:32.486020 [info ] [Thread-1 (]: 1 of 1 START sql view model dbt_dw_staging.stg_shippers_northwind .............. [RUN]
[0m15:47:32.487234 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_corded-sunlight-464012-e2_dbt_dw_staging, now model.dbt_exercise.stg_shippers_northwind)
[0m15:47:32.488067 [debug] [Thread-1 (]: Began compiling node model.dbt_exercise.stg_shippers_northwind
[0m15:47:32.503094 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_exercise.stg_shippers_northwind"
[0m15:47:32.506068 [debug] [Thread-1 (]: Began executing node model.dbt_exercise.stg_shippers_northwind
[0m15:47:32.578320 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_exercise.stg_shippers_northwind"
[0m15:47:32.580958 [debug] [Thread-1 (]: On model.dbt_exercise.stg_shippers_northwind: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "model.dbt_exercise.stg_shippers_northwind"} */


  create or replace view `corded-sunlight-464012-e2`.`dbt_dw_staging`.`stg_shippers_northwind`
  OPTIONS()
  as with shippers as (
    select *
    from `corded-sunlight-464012-e2`.`dbt_dw_raw`.`shippers`
)

select
    cast(shipper_id as string) as shipper_id
    , cast(company_name as string) as company_name
    , cast(phone as string) as phone
from shippers;


[0m15:47:32.581903 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:47:33.599372 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:8cf1019b-60a7-4bff-80f9-ca5ef56b7f28&page=queryresults
[0m15:47:38.948185 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5e1fec64-14f0-4a5e-9773-c2abf377bd95', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x709c0d6920c0>]}
[0m15:47:38.949303 [info ] [Thread-1 (]: 1 of 1 OK created sql view model dbt_dw_staging.stg_shippers_northwind ......... [[32mCREATE VIEW (0 processed)[0m in 6.44s]
[0m15:47:38.950441 [debug] [Thread-1 (]: Finished running node model.dbt_exercise.stg_shippers_northwind
[0m15:47:38.953738 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:47:38.962125 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:47:38.962984 [debug] [MainThread]: Connection 'list_corded-sunlight-464012-e2_dbt_dw_raw' was properly closed.
[0m15:47:38.963663 [debug] [MainThread]: Connection 'model.dbt_exercise.stg_shippers_northwind' was properly closed.
[0m15:47:38.964393 [info ] [MainThread]: 
[0m15:47:38.965328 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 8.48 seconds (8.48s).
[0m15:47:38.966658 [debug] [MainThread]: Command end result
[0m15:47:39.050246 [debug] [MainThread]: Wrote artifact WritableManifest to /home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/target/manifest.json
[0m15:47:39.067930 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/target/semantic_manifest.json
[0m15:47:39.076646 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/target/run_results.json
[0m15:47:39.077385 [info ] [MainThread]: 
[0m15:47:39.078213 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:47:39.079003 [info ] [MainThread]: 
[0m15:47:39.079790 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m15:47:39.080993 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- DuplicateYAMLKeysDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m15:47:39.089097 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 128.90279, "process_in_blocks": "128784", "process_kernel_time": 16.492266, "process_mem_max_rss": "368808", "process_out_blocks": "4784", "process_user_time": 13.476153}
[0m15:47:39.090197 [debug] [MainThread]: Command `dbt run` succeeded at 15:47:39.089924 after 128.90 seconds
[0m15:47:39.091104 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x709c46287b30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x709c45d52420>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x709c08853fe0>]}
[0m15:47:39.092019 [debug] [MainThread]: Flushing usage events
[0m15:47:39.542531 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:05:29.162112 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78fed88bd250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78fed6625be0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78fed65f1040>]}


============================== 16:05:29.182482 | 7fc90732-cb82-466d-80a7-116f4af3da55 ==============================
[0m16:05:29.182482 [info ] [MainThread]: Running with dbt=1.10.2
[0m16:05:29.183863 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/logs', 'profiles_dir': '/home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run -s stg_suppliers_northwind', 'send_anonymous_usage_stats': 'True'}
[0m16:06:33.759004 [warn ] [MainThread]: [[33mWARNING[0m][DuplicateYAMLKeysDeprecation]: Deprecated functionality
Duplicate key 'version' in "<unicode string>", line 4, column 1 in file
`/home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/dbt_project.yml`
[0m16:06:33.760362 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '7fc90732-cb82-466d-80a7-116f4af3da55', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78fe99021700>]}
[0m16:06:34.694160 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7fc90732-cb82-466d-80a7-116f4af3da55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78fed6ed54c0>]}
[0m16:06:34.804030 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7fc90732-cb82-466d-80a7-116f4af3da55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78fe9906e840>]}
[0m16:06:34.808503 [info ] [MainThread]: Registered adapter: bigquery=1.9.2
[0m16:07:40.109958 [debug] [MainThread]: checksum: 1adc40777973ef30f45f80b3b6d04d5013c1edd53d96363881b3b199e612468b, vars: {}, profile: , target: , version: 1.10.2
[0m16:07:45.493820 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:07:45.494682 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:07:45.507739 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.dbt_exercise.intermediate
- models.dbt_exercise.marts
[0m16:07:45.585322 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7fc90732-cb82-466d-80a7-116f4af3da55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78fe98953da0>]}
[0m16:07:45.967830 [debug] [MainThread]: Wrote artifact WritableManifest to /home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/target/manifest.json
[0m16:07:45.990690 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/target/semantic_manifest.json
[0m16:07:46.419965 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7fc90732-cb82-466d-80a7-116f4af3da55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78fe98b691c0>]}
[0m16:07:46.420955 [info ] [MainThread]: Found 14 seeds, 31 data tests, 8 models, 14 sources, 609 macros
[0m16:07:46.421643 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7fc90732-cb82-466d-80a7-116f4af3da55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78fe98948fe0>]}
[0m16:07:46.423864 [info ] [MainThread]: 
[0m16:07:46.424588 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:07:46.425037 [info ] [MainThread]: 
[0m16:07:46.425696 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m16:07:46.427039 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_corded-sunlight-464012-e2'
[0m16:07:46.427887 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:07:47.357920 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_corded-sunlight-464012-e2, now list_corded-sunlight-464012-e2_dbt_dw_raw)
[0m16:07:47.359873 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_corded-sunlight-464012-e2_dbt_dw_staging'
[0m16:07:47.360413 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:07:47.361088 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:07:48.239048 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7fc90732-cb82-466d-80a7-116f4af3da55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78fed86501d0>]}
[0m16:07:48.240381 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:07:48.272317 [debug] [Thread-1 (]: Began running node model.dbt_exercise.stg_suppliers_northwind
[0m16:07:48.273599 [info ] [Thread-1 (]: 1 of 1 START sql view model dbt_dw_staging.stg_suppliers_northwind ............. [RUN]
[0m16:07:48.274622 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_corded-sunlight-464012-e2_dbt_dw_raw, now model.dbt_exercise.stg_suppliers_northwind)
[0m16:07:48.275759 [debug] [Thread-1 (]: Began compiling node model.dbt_exercise.stg_suppliers_northwind
[0m16:07:48.294113 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_exercise.stg_suppliers_northwind"
[0m16:07:48.296534 [debug] [Thread-1 (]: Began executing node model.dbt_exercise.stg_suppliers_northwind
[0m16:07:48.360166 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_exercise.stg_suppliers_northwind"
[0m16:07:48.362688 [debug] [Thread-1 (]: On model.dbt_exercise.stg_suppliers_northwind: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "model.dbt_exercise.stg_suppliers_northwind"} */


  create or replace view `corded-sunlight-464012-e2`.`dbt_dw_staging`.`stg_suppliers_northwind`
  OPTIONS()
  as with suppliers as (
    select *
    from `corded-sunlight-464012-e2`.`dbt_dw_raw`.`suppliers`
)

select 
    cast(supplier_id as string) as supplier_id
    , cast(company_name as string) as company_name
    , cast(contact_name as string) as contact_name
    , cast(contact_title as string) as contact_title
    , cast(address as string) as address
    , cast(city as string) as city
    , cast(region as string) as region
    , cast(postal_code as string) as postal_code
    , cast(country as string) as country
    , cast(phone as string) as phone
    , cast(fax as string) as fax
    , cast(homepage as string) as home_page
from suppliers;


[0m16:07:48.364749 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:07:49.427762 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:9a41bec9-8149-4524-bb69-6bce5cedeb88&page=queryresults
[0m16:07:56.624419 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7fc90732-cb82-466d-80a7-116f4af3da55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78fed6e15e50>]}
[0m16:07:56.625739 [info ] [Thread-1 (]: 1 of 1 OK created sql view model dbt_dw_staging.stg_suppliers_northwind ........ [[32mCREATE VIEW (0 processed)[0m in 8.33s]
[0m16:07:56.627141 [debug] [Thread-1 (]: Finished running node model.dbt_exercise.stg_suppliers_northwind
[0m16:07:56.631519 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:07:56.641891 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:07:56.642628 [debug] [MainThread]: Connection 'model.dbt_exercise.stg_suppliers_northwind' was properly closed.
[0m16:07:56.643312 [debug] [MainThread]: Connection 'list_corded-sunlight-464012-e2_dbt_dw_staging' was properly closed.
[0m16:07:56.644207 [info ] [MainThread]: 
[0m16:07:56.645295 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 10.22 seconds (10.22s).
[0m16:07:56.653371 [debug] [MainThread]: Command end result
[0m16:07:56.741306 [debug] [MainThread]: Wrote artifact WritableManifest to /home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/target/manifest.json
[0m16:07:56.762080 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/target/semantic_manifest.json
[0m16:07:56.770360 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/target/run_results.json
[0m16:07:56.770904 [info ] [MainThread]: 
[0m16:07:56.771562 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:07:56.772058 [info ] [MainThread]: 
[0m16:07:56.772571 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m16:07:56.773319 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- DuplicateYAMLKeysDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m16:07:56.781232 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 143.08319, "process_in_blocks": "123288", "process_kernel_time": 18.747822, "process_mem_max_rss": "365496", "process_out_blocks": "3304", "process_user_time": 14.458497}
[0m16:07:56.782621 [debug] [MainThread]: Command `dbt run` succeeded at 16:07:56.782322 after 143.09 seconds
[0m16:07:56.783829 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78fed5f3fb00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78fe98a1ab10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78fe990f70b0>]}
[0m16:07:56.784747 [debug] [MainThread]: Flushing usage events
[0m16:07:57.127686 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:12:12.649392 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x746b9e6b6ab0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x746b9dc3d2e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x746b9e313440>]}


============================== 16:12:12.671504 | c87102c7-bb66-4f0f-88a6-33a6d5c70de2 ==============================
[0m16:12:12.671504 [info ] [MainThread]: Running with dbt=1.10.2
[0m16:12:12.672635 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/logs', 'profiles_dir': '/home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt run -s stg_territories_northwind', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:13:15.734690 [warn ] [MainThread]: [[33mWARNING[0m][DuplicateYAMLKeysDeprecation]: Deprecated functionality
Duplicate key 'version' in "<unicode string>", line 4, column 1 in file
`/home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/dbt_project.yml`
[0m16:13:15.736063 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'c87102c7-bb66-4f0f-88a6-33a6d5c70de2', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x746b6c1e1010>]}
[0m16:13:16.613590 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c87102c7-bb66-4f0f-88a6-33a6d5c70de2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x746b603c1b80>]}
[0m16:13:16.714356 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c87102c7-bb66-4f0f-88a6-33a6d5c70de2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x746b9fb3c0b0>]}
[0m16:13:16.719638 [info ] [MainThread]: Registered adapter: bigquery=1.9.2
[0m16:14:24.908134 [debug] [MainThread]: checksum: 1adc40777973ef30f45f80b3b6d04d5013c1edd53d96363881b3b199e612468b, vars: {}, profile: , target: , version: 1.10.2
[0m16:14:31.493964 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:14:31.494736 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:14:31.504547 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.dbt_exercise.marts
- models.dbt_exercise.intermediate
[0m16:14:31.591017 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c87102c7-bb66-4f0f-88a6-33a6d5c70de2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x746b6011cdd0>]}
[0m16:14:32.060436 [debug] [MainThread]: Wrote artifact WritableManifest to /home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/target/manifest.json
[0m16:14:32.084695 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/target/semantic_manifest.json
[0m16:14:32.714850 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c87102c7-bb66-4f0f-88a6-33a6d5c70de2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x746b6003d850>]}
[0m16:14:32.715763 [info ] [MainThread]: Found 14 seeds, 31 data tests, 9 models, 14 sources, 609 macros
[0m16:14:32.716493 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c87102c7-bb66-4f0f-88a6-33a6d5c70de2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x746b9feaddf0>]}
[0m16:14:32.720013 [info ] [MainThread]: 
[0m16:14:32.721543 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:14:32.722976 [info ] [MainThread]: 
[0m16:14:32.724885 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m16:14:32.728038 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_corded-sunlight-464012-e2'
[0m16:14:32.729291 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:14:33.688546 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_corded-sunlight-464012-e2, now list_corded-sunlight-464012-e2_dbt_dw_staging)
[0m16:14:33.689767 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:14:33.690727 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_corded-sunlight-464012-e2_dbt_dw_raw'
[0m16:14:33.691898 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:14:34.591175 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c87102c7-bb66-4f0f-88a6-33a6d5c70de2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x746b5fe2fef0>]}
[0m16:14:34.592451 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:14:34.605838 [debug] [Thread-1 (]: Began running node model.dbt_exercise.stg_territories_northwind
[0m16:14:34.606845 [info ] [Thread-1 (]: 1 of 1 START sql view model dbt_dw_staging.stg_territories_northwind ........... [RUN]
[0m16:14:34.607646 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_corded-sunlight-464012-e2_dbt_dw_raw, now model.dbt_exercise.stg_territories_northwind)
[0m16:14:34.608660 [debug] [Thread-1 (]: Began compiling node model.dbt_exercise.stg_territories_northwind
[0m16:14:34.623024 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_exercise.stg_territories_northwind"
[0m16:14:34.624112 [debug] [Thread-1 (]: Began executing node model.dbt_exercise.stg_territories_northwind
[0m16:14:34.678860 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_exercise.stg_territories_northwind"
[0m16:14:34.680026 [debug] [Thread-1 (]: On model.dbt_exercise.stg_territories_northwind: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "model.dbt_exercise.stg_territories_northwind"} */


  create or replace view `corded-sunlight-464012-e2`.`dbt_dw_staging`.`stg_territories_northwind`
  OPTIONS()
  as with territories as (
    select *
    from `corded-sunlight-464012-e2`.`dbt_dw_raw`.`territories`
)

select 
    cast(territory_id as string) as territory_id
    , cast(territory_description as string) as territory_description
    , cast(region_id as string) as region_id
from territories;


[0m16:14:34.680777 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:14:35.699560 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:a627b785-2f13-4f9f-b214-c1e8d16a9c1d&page=queryresults
[0m16:14:44.537502 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c87102c7-bb66-4f0f-88a6-33a6d5c70de2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x746b64fa2780>]}
[0m16:14:44.539014 [info ] [Thread-1 (]: 1 of 1 OK created sql view model dbt_dw_staging.stg_territories_northwind ...... [[32mCREATE VIEW (0 processed)[0m in 9.91s]
[0m16:14:44.540519 [debug] [Thread-1 (]: Finished running node model.dbt_exercise.stg_territories_northwind
[0m16:14:44.544576 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:14:44.554754 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:14:44.555444 [debug] [MainThread]: Connection 'list_corded-sunlight-464012-e2_dbt_dw_staging' was properly closed.
[0m16:14:44.556093 [debug] [MainThread]: Connection 'model.dbt_exercise.stg_territories_northwind' was properly closed.
[0m16:14:44.557179 [info ] [MainThread]: 
[0m16:14:44.558147 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 11.83 seconds (11.83s).
[0m16:14:44.562018 [debug] [MainThread]: Command end result
[0m16:14:44.647815 [debug] [MainThread]: Wrote artifact WritableManifest to /home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/target/manifest.json
[0m16:14:44.666740 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/target/semantic_manifest.json
[0m16:14:44.676856 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/target/run_results.json
[0m16:14:44.677462 [info ] [MainThread]: 
[0m16:14:44.678132 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:14:44.678689 [info ] [MainThread]: 
[0m16:14:44.679274 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m16:14:44.680286 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- DuplicateYAMLKeysDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m16:14:44.685522 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 145.95386, "process_in_blocks": "122920", "process_kernel_time": 18.641987, "process_mem_max_rss": "365624", "process_out_blocks": "3320", "process_user_time": 14.234124}
[0m16:14:44.686574 [debug] [MainThread]: Command `dbt run` succeeded at 16:14:44.686283 after 145.96 seconds
[0m16:14:44.687391 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x746b9dbd1a00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x746b9e310500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x746b5fef6f00>]}
[0m16:14:44.689182 [debug] [MainThread]: Flushing usage events
[0m16:14:45.026347 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:17:50.806621 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e697f85d2b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e697d851e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e697d850950>]}


============================== 16:17:50.829778 | 6bbe6879-4d51-4696-b48f-df265769d568 ==============================
[0m16:17:50.829778 [info ] [MainThread]: Running with dbt=1.10.2
[0m16:17:50.830690 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/logs', 'debug': 'False', 'profiles_dir': '/home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run -s stg_us_states_northwind', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m16:18:49.480032 [warn ] [MainThread]: [[33mWARNING[0m][DuplicateYAMLKeysDeprecation]: Deprecated functionality
Duplicate key 'version' in "<unicode string>", line 4, column 1 in file
`/home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/dbt_project.yml`
[0m16:18:49.481317 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '6bbe6879-4d51-4696-b48f-df265769d568', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e69402c85c0>]}
[0m16:18:50.321057 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6bbe6879-4d51-4696-b48f-df265769d568', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e697d0d3140>]}
[0m16:18:50.420040 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6bbe6879-4d51-4696-b48f-df265769d568', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e697de0db50>]}
[0m16:18:50.424692 [info ] [MainThread]: Registered adapter: bigquery=1.9.2
[0m16:19:44.762020 [debug] [MainThread]: checksum: 1adc40777973ef30f45f80b3b6d04d5013c1edd53d96363881b3b199e612468b, vars: {}, profile: , target: , version: 1.10.2
[0m16:19:49.856492 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:19:49.857300 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:19:49.866640 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.dbt_exercise.intermediate
- models.dbt_exercise.marts
[0m16:19:49.957367 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6bbe6879-4d51-4696-b48f-df265769d568', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e693f947fe0>]}
[0m16:19:50.309920 [debug] [MainThread]: Wrote artifact WritableManifest to /home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/target/manifest.json
[0m16:19:50.324206 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/target/semantic_manifest.json
[0m16:19:50.844386 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6bbe6879-4d51-4696-b48f-df265769d568', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e693fe068d0>]}
[0m16:19:50.845689 [info ] [MainThread]: Found 14 seeds, 31 data tests, 10 models, 14 sources, 609 macros
[0m16:19:50.846553 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6bbe6879-4d51-4696-b48f-df265769d568', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e693fbee1e0>]}
[0m16:19:50.850514 [info ] [MainThread]: 
[0m16:19:50.851276 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:19:50.852006 [info ] [MainThread]: 
[0m16:19:50.853158 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m16:19:50.855342 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_corded-sunlight-464012-e2'
[0m16:19:50.856291 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:19:51.792209 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_corded-sunlight-464012-e2, now list_corded-sunlight-464012-e2_dbt_dw_staging)
[0m16:19:51.794398 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:19:51.795835 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_corded-sunlight-464012-e2_dbt_dw_raw'
[0m16:19:51.797094 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:19:52.665864 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6bbe6879-4d51-4696-b48f-df265769d568', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e693fb8f950>]}
[0m16:19:52.666811 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:19:52.680245 [debug] [Thread-1 (]: Began running node model.dbt_exercise.stg_us_states_northwind
[0m16:19:52.681527 [info ] [Thread-1 (]: 1 of 1 START sql view model dbt_dw_staging.stg_us_states_northwind ............. [RUN]
[0m16:19:52.682610 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_corded-sunlight-464012-e2_dbt_dw_raw, now model.dbt_exercise.stg_us_states_northwind)
[0m16:19:52.683340 [debug] [Thread-1 (]: Began compiling node model.dbt_exercise.stg_us_states_northwind
[0m16:19:52.700201 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_exercise.stg_us_states_northwind"
[0m16:19:52.701969 [debug] [Thread-1 (]: Began executing node model.dbt_exercise.stg_us_states_northwind
[0m16:19:52.767187 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_exercise.stg_us_states_northwind"
[0m16:19:52.768480 [debug] [Thread-1 (]: On model.dbt_exercise.stg_us_states_northwind: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "model.dbt_exercise.stg_us_states_northwind"} */


  create or replace view `corded-sunlight-464012-e2`.`dbt_dw_staging`.`stg_us_states_northwind`
  OPTIONS()
  as with us_states as (
    select *
    from `corded-sunlight-464012-e2`.`dbt_dw_raw`.`us_states`
)

select
    cast(state_id as string) as state_id
    , cast(state_name as string) as state_name
    , cast(state_abbr as string) as state_abbr
    , cast(state_region as string) as state_region
from us_states;


[0m16:19:52.769316 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:19:53.848725 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:8cc8d1e1-0e3c-4815-b284-0681e29b9c48&page=queryresults
[0m16:19:58.935866 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6bbe6879-4d51-4696-b48f-df265769d568', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e697dfb9df0>]}
[0m16:19:58.937189 [info ] [Thread-1 (]: 1 of 1 OK created sql view model dbt_dw_staging.stg_us_states_northwind ........ [[32mCREATE VIEW (0 processed)[0m in 6.24s]
[0m16:19:58.938368 [debug] [Thread-1 (]: Finished running node model.dbt_exercise.stg_us_states_northwind
[0m16:19:58.941548 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:19:58.950060 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:19:58.950757 [debug] [MainThread]: Connection 'list_corded-sunlight-464012-e2_dbt_dw_staging' was properly closed.
[0m16:19:58.951542 [debug] [MainThread]: Connection 'model.dbt_exercise.stg_us_states_northwind' was properly closed.
[0m16:19:58.952465 [info ] [MainThread]: 
[0m16:19:58.953532 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 8.10 seconds (8.10s).
[0m16:19:58.955007 [debug] [MainThread]: Command end result
[0m16:19:59.032276 [debug] [MainThread]: Wrote artifact WritableManifest to /home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/target/manifest.json
[0m16:19:59.049780 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/target/semantic_manifest.json
[0m16:19:59.058367 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/target/run_results.json
[0m16:19:59.058963 [info ] [MainThread]: 
[0m16:19:59.059606 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:19:59.060240 [info ] [MainThread]: 
[0m16:19:59.061032 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m16:19:59.061966 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- DuplicateYAMLKeysDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m16:19:59.066579 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 123.202866, "process_in_blocks": "122920", "process_kernel_time": 16.975517, "process_mem_max_rss": "366164", "process_out_blocks": "3320", "process_user_time": 12.808965}
[0m16:19:59.067387 [debug] [MainThread]: Command `dbt run` succeeded at 16:19:59.067207 after 123.20 seconds
[0m16:19:59.068066 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e69811b73b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e693fb8eed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e693fb8d8e0>]}
[0m16:19:59.069005 [debug] [MainThread]: Flushing usage events
[0m16:19:59.402630 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:26:45.273775 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74d00cd81370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74d00cf9bf50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74d00cf9bb60>]}


============================== 16:26:45.297465 | bd68f209-0a20-4e5e-8b98-39889c142aec ==============================
[0m16:26:45.297465 [info ] [MainThread]: Running with dbt=1.10.2
[0m16:26:45.298971 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/logs', 'fail_fast': 'False', 'profiles_dir': '/home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run -s stg_employee_territories', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:27:46.798805 [warn ] [MainThread]: [[33mWARNING[0m][DuplicateYAMLKeysDeprecation]: Deprecated functionality
Duplicate key 'version' in "<unicode string>", line 4, column 1 in file
`/home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/dbt_project.yml`
[0m16:27:46.800584 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'bd68f209-0a20-4e5e-8b98-39889c142aec', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74cfcfb26720>]}
[0m16:27:47.679495 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bd68f209-0a20-4e5e-8b98-39889c142aec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74cfcf673f20>]}
[0m16:27:47.780653 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bd68f209-0a20-4e5e-8b98-39889c142aec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74d00ed1c1d0>]}
[0m16:27:47.786064 [info ] [MainThread]: Registered adapter: bigquery=1.9.2
[0m16:28:50.576104 [debug] [MainThread]: checksum: 1adc40777973ef30f45f80b3b6d04d5013c1edd53d96363881b3b199e612468b, vars: {}, profile: , target: , version: 1.10.2
[0m16:28:57.256530 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 1 files added, 0 files changed.
[0m16:28:57.258032 [debug] [MainThread]: Partial parsing: added file: dbt_exercise://models/staging/stg_employee_territories.sql
[0m16:28:57.259208 [debug] [MainThread]: Partial parsing: deleted file: dbt_exercise://models/staging/stg_employees_territories.sql
[0m16:28:58.140525 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.dbt_exercise.marts
- models.dbt_exercise.intermediate
[0m16:28:58.170273 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bd68f209-0a20-4e5e-8b98-39889c142aec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74cfcf0f4b60>]}
[0m16:28:58.356179 [debug] [MainThread]: Wrote artifact WritableManifest to /home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/target/manifest.json
[0m16:28:58.374196 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/target/semantic_manifest.json
[0m16:28:59.035061 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bd68f209-0a20-4e5e-8b98-39889c142aec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74cfcf3a46e0>]}
[0m16:28:59.037385 [info ] [MainThread]: Found 14 seeds, 31 data tests, 11 models, 14 sources, 609 macros
[0m16:28:59.039381 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bd68f209-0a20-4e5e-8b98-39889c142aec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74cfcf0f78f0>]}
[0m16:28:59.047127 [info ] [MainThread]: 
[0m16:28:59.048632 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:28:59.049851 [info ] [MainThread]: 
[0m16:28:59.051445 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m16:28:59.054358 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_corded-sunlight-464012-e2'
[0m16:28:59.056378 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:28:59.994481 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_corded-sunlight-464012-e2, now list_corded-sunlight-464012-e2_dbt_dw_staging)
[0m16:28:59.996959 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_corded-sunlight-464012-e2_dbt_dw_raw'
[0m16:28:59.997901 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:28:59.998514 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:29:00.856344 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bd68f209-0a20-4e5e-8b98-39889c142aec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74cfcf3a6ed0>]}
[0m16:29:00.857480 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:29:00.895221 [debug] [Thread-1 (]: Began running node model.dbt_exercise.stg_employee_territories
[0m16:29:00.897123 [info ] [Thread-1 (]: 1 of 1 START sql view model dbt_dw_staging.stg_employee_territories ............ [RUN]
[0m16:29:00.898463 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_corded-sunlight-464012-e2_dbt_dw_raw, now model.dbt_exercise.stg_employee_territories)
[0m16:29:00.899602 [debug] [Thread-1 (]: Began compiling node model.dbt_exercise.stg_employee_territories
[0m16:29:00.916215 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_exercise.stg_employee_territories"
[0m16:29:00.920089 [debug] [Thread-1 (]: Began executing node model.dbt_exercise.stg_employee_territories
[0m16:29:00.985719 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_exercise.stg_employee_territories"
[0m16:29:00.988672 [debug] [Thread-1 (]: On model.dbt_exercise.stg_employee_territories: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "model.dbt_exercise.stg_employee_territories"} */


  create or replace view `corded-sunlight-464012-e2`.`dbt_dw_staging`.`stg_employee_territories`
  OPTIONS()
  as with emplyoee_ territories as (
    select *
    from `corded-sunlight-464012-e2`.`dbt_dw_raw`.`employee_territories`
)

select
    cast(employee_id as string) as employee_id
    , cast(territory_id as string) as territory_id
from employee_territories;


[0m16:29:00.989498 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:29:01.780766 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:6601f15b-4362-4845-8bf2-44c9c9c564c2&page=queryresults
[0m16:29:01.781661 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:6601f15b-4362-4845-8bf2-44c9c9c564c2&page=queryresults
[0m16:29:01.963217 [debug] [Thread-1 (]: Database Error in model stg_employee_territories (models/staging/stg_employee_territories.sql)
  Syntax error: Expected keyword AS but got identifier "territories" at [6:21]
  compiled code at target/run/dbt_exercise/models/staging/stg_employee_territories.sql
[0m16:29:01.987147 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bd68f209-0a20-4e5e-8b98-39889c142aec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74d00d6b1d90>]}
[0m16:29:01.989195 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model dbt_dw_staging.stg_employee_territories ... [[31mERROR[0m in 1.07s]
[0m16:29:01.990844 [debug] [Thread-1 (]: Finished running node model.dbt_exercise.stg_employee_territories
[0m16:29:01.992948 [debug] [Thread-7 (]: Marking all children of 'model.dbt_exercise.stg_employee_territories' to be skipped because of status 'error'.  Reason: Database Error in model stg_employee_territories (models/staging/stg_employee_territories.sql)
  Syntax error: Expected keyword AS but got identifier "territories" at [6:21]
  compiled code at target/run/dbt_exercise/models/staging/stg_employee_territories.sql.
[0m16:29:01.997945 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:29:02.008426 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:29:02.009474 [debug] [MainThread]: Connection 'list_corded-sunlight-464012-e2_dbt_dw_staging' was properly closed.
[0m16:29:02.010902 [debug] [MainThread]: Connection 'model.dbt_exercise.stg_employee_territories' was properly closed.
[0m16:29:02.012434 [info ] [MainThread]: 
[0m16:29:02.014087 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.96 seconds (2.96s).
[0m16:29:02.017583 [debug] [MainThread]: Command end result
[0m16:29:02.098463 [debug] [MainThread]: Wrote artifact WritableManifest to /home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/target/manifest.json
[0m16:29:02.115186 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/target/semantic_manifest.json
[0m16:29:02.123848 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/target/run_results.json
[0m16:29:02.124511 [info ] [MainThread]: 
[0m16:29:02.125210 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m16:29:02.125923 [info ] [MainThread]: 
[0m16:29:02.126707 [error] [MainThread]: [31mFailure in model stg_employee_territories (models/staging/stg_employee_territories.sql)[0m
[0m16:29:02.127539 [error] [MainThread]:   Database Error in model stg_employee_territories (models/staging/stg_employee_territories.sql)
  Syntax error: Expected keyword AS but got identifier "territories" at [6:21]
  compiled code at target/run/dbt_exercise/models/staging/stg_employee_territories.sql
[0m16:29:02.128137 [info ] [MainThread]: 
[0m16:29:02.128918 [info ] [MainThread]:   compiled code at target/compiled/dbt_exercise/models/staging/stg_employee_territories.sql
[0m16:29:02.129485 [info ] [MainThread]: 
[0m16:29:02.130163 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m16:29:02.131979 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- DuplicateYAMLKeysDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m16:29:02.139835 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 130.75932, "process_in_blocks": "127800", "process_kernel_time": 18.002386, "process_mem_max_rss": "365612", "process_out_blocks": "4880", "process_user_time": 14.944047}
[0m16:29:02.141215 [debug] [MainThread]: Command `dbt run` failed at 16:29:02.140934 after 130.76 seconds
[0m16:29:02.142457 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74d00cc66570>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74cfcf042c30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74cfcf0d4da0>]}
[0m16:29:02.143698 [debug] [MainThread]: Flushing usage events
[0m16:29:02.465920 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:32:20.605449 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd8cd3d1430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd8cc6bf110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd8cb751670>]}


============================== 16:32:20.627600 | 2f47a724-68cf-404c-93df-7c52e7e372db ==============================
[0m16:32:20.627600 [info ] [MainThread]: Running with dbt=1.10.2
[0m16:32:20.628462 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise', 'log_path': '/home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run -s stg_employee_territories', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m16:33:18.514711 [warn ] [MainThread]: [[33mWARNING[0m][DuplicateYAMLKeysDeprecation]: Deprecated functionality
Duplicate key 'version' in "<unicode string>", line 4, column 1 in file
`/home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/dbt_project.yml`
[0m16:33:18.515471 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '2f47a724-68cf-404c-93df-7c52e7e372db', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd8caac0d70>]}
[0m16:33:19.340495 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2f47a724-68cf-404c-93df-7c52e7e372db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd8caac18e0>]}
[0m16:33:19.433252 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2f47a724-68cf-404c-93df-7c52e7e372db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd8cd2c2930>]}
[0m16:33:19.438188 [info ] [MainThread]: Registered adapter: bigquery=1.9.2
[0m16:34:15.898837 [debug] [MainThread]: checksum: 1adc40777973ef30f45f80b3b6d04d5013c1edd53d96363881b3b199e612468b, vars: {}, profile: , target: , version: 1.10.2
[0m16:34:23.865050 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:34:23.865872 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:34:23.877837 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.dbt_exercise.marts
- models.dbt_exercise.intermediate
[0m16:34:23.945225 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2f47a724-68cf-404c-93df-7c52e7e372db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd88dad25a0>]}
[0m16:34:24.406815 [debug] [MainThread]: Wrote artifact WritableManifest to /home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/target/manifest.json
[0m16:34:24.420169 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/target/semantic_manifest.json
[0m16:34:24.981992 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2f47a724-68cf-404c-93df-7c52e7e372db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd88dc10620>]}
[0m16:34:24.983722 [info ] [MainThread]: Found 14 seeds, 31 data tests, 11 models, 14 sources, 609 macros
[0m16:34:24.984925 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2f47a724-68cf-404c-93df-7c52e7e372db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd88d64a8d0>]}
[0m16:34:24.987595 [info ] [MainThread]: 
[0m16:34:24.988254 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:34:24.988665 [info ] [MainThread]: 
[0m16:34:24.989357 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m16:34:24.992721 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_corded-sunlight-464012-e2'
[0m16:34:24.994590 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:34:25.892888 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_corded-sunlight-464012-e2, now list_corded-sunlight-464012-e2_dbt_dw_staging)
[0m16:34:25.894566 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_corded-sunlight-464012-e2_dbt_dw_raw'
[0m16:34:25.895249 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:34:25.896008 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:34:26.751672 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2f47a724-68cf-404c-93df-7c52e7e372db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd88dcfab10>]}
[0m16:34:26.752955 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:34:26.788516 [debug] [Thread-1 (]: Began running node model.dbt_exercise.stg_employee_territories
[0m16:34:26.789698 [info ] [Thread-1 (]: 1 of 1 START sql view model dbt_dw_staging.stg_employee_territories ............ [RUN]
[0m16:34:26.791219 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_corded-sunlight-464012-e2_dbt_dw_raw, now model.dbt_exercise.stg_employee_territories)
[0m16:34:26.791888 [debug] [Thread-1 (]: Began compiling node model.dbt_exercise.stg_employee_territories
[0m16:34:26.805374 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_exercise.stg_employee_territories"
[0m16:34:26.807376 [debug] [Thread-1 (]: Began executing node model.dbt_exercise.stg_employee_territories
[0m16:34:26.857615 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_exercise.stg_employee_territories"
[0m16:34:26.858850 [debug] [Thread-1 (]: On model.dbt_exercise.stg_employee_territories: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "model.dbt_exercise.stg_employee_territories"} */


  create or replace view `corded-sunlight-464012-e2`.`dbt_dw_staging`.`stg_employee_territories`
  OPTIONS()
  as with emplyoee_territories as (
    select *
    from `corded-sunlight-464012-e2`.`dbt_dw_raw`.`employee_territories`
)

select
    cast(employee_id as string) as employee_id
    , cast(territory_id as string) as territory_id
from employee_territories;


[0m16:34:26.859593 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:34:27.688548 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:6df9df1a-15a3-4bd6-a6ad-65a9853985de&page=queryresults
[0m16:34:27.689226 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:6df9df1a-15a3-4bd6-a6ad-65a9853985de&page=queryresults
[0m16:34:27.803827 [debug] [Thread-1 (]: Database Error in model stg_employee_territories (models/staging/stg_employee_territories.sql)
  Table "employee_territories" must be qualified with a dataset (e.g. dataset.table).
  compiled code at target/run/dbt_exercise/models/staging/stg_employee_territories.sql
[0m16:34:27.844146 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2f47a724-68cf-404c-93df-7c52e7e372db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd88dad27b0>]}
[0m16:34:27.845897 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model dbt_dw_staging.stg_employee_territories ... [[31mERROR[0m in 1.01s]
[0m16:34:27.847202 [debug] [Thread-1 (]: Finished running node model.dbt_exercise.stg_employee_territories
[0m16:34:27.848531 [debug] [Thread-7 (]: Marking all children of 'model.dbt_exercise.stg_employee_territories' to be skipped because of status 'error'.  Reason: Database Error in model stg_employee_territories (models/staging/stg_employee_territories.sql)
  Table "employee_territories" must be qualified with a dataset (e.g. dataset.table).
  compiled code at target/run/dbt_exercise/models/staging/stg_employee_territories.sql.
[0m16:34:27.853914 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:34:27.863999 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:34:27.866219 [debug] [MainThread]: Connection 'list_corded-sunlight-464012-e2_dbt_dw_staging' was properly closed.
[0m16:34:27.867516 [debug] [MainThread]: Connection 'model.dbt_exercise.stg_employee_territories' was properly closed.
[0m16:34:27.868716 [info ] [MainThread]: 
[0m16:34:27.869762 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 2.88 seconds (2.88s).
[0m16:34:27.871248 [debug] [MainThread]: Command end result
[0m16:34:27.943455 [debug] [MainThread]: Wrote artifact WritableManifest to /home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/target/manifest.json
[0m16:34:27.961527 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/target/semantic_manifest.json
[0m16:34:27.969838 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/target/run_results.json
[0m16:34:27.970602 [info ] [MainThread]: 
[0m16:34:27.971472 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m16:34:27.972036 [info ] [MainThread]: 
[0m16:34:27.972775 [error] [MainThread]: [31mFailure in model stg_employee_territories (models/staging/stg_employee_territories.sql)[0m
[0m16:34:27.973362 [error] [MainThread]:   Database Error in model stg_employee_territories (models/staging/stg_employee_territories.sql)
  Table "employee_territories" must be qualified with a dataset (e.g. dataset.table).
  compiled code at target/run/dbt_exercise/models/staging/stg_employee_territories.sql
[0m16:34:27.974086 [info ] [MainThread]: 
[0m16:34:27.974880 [info ] [MainThread]:   compiled code at target/compiled/dbt_exercise/models/staging/stg_employee_territories.sql
[0m16:34:27.975811 [info ] [MainThread]: 
[0m16:34:27.976866 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m16:34:27.977940 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- DuplicateYAMLKeysDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m16:34:27.984450 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 121.381775, "process_in_blocks": "139864", "process_kernel_time": 16.482712, "process_mem_max_rss": "362196", "process_out_blocks": "3344", "process_user_time": 14.865206}
[0m16:34:27.986344 [debug] [MainThread]: Command `dbt run` failed at 16:34:27.985864 after 121.38 seconds
[0m16:34:27.987511 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd8cd4d9d60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd8cb42ff80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd8cb42f620>]}
[0m16:34:27.988446 [debug] [MainThread]: Flushing usage events
[0m16:34:28.322663 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:38:46.524671 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a2d61507d40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a2d61bee9f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a2d61a4f680>]}


============================== 16:38:46.545165 | 7ebd5682-c0a8-4f98-9186-cae0aa0eb4d8 ==============================
[0m16:38:46.545165 [info ] [MainThread]: Running with dbt=1.10.2
[0m16:38:46.546371 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise', 'log_path': '/home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run -s stg_employee_territories', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:39:41.436427 [warn ] [MainThread]: [[33mWARNING[0m][DuplicateYAMLKeysDeprecation]: Deprecated functionality
Duplicate key 'version' in "<unicode string>", line 4, column 1 in file
`/home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/dbt_project.yml`
[0m16:39:41.437052 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '7ebd5682-c0a8-4f98-9186-cae0aa0eb4d8', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a2d60b66240>]}
[0m16:39:42.166918 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7ebd5682-c0a8-4f98-9186-cae0aa0eb4d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a2d23ef7a40>]}
[0m16:39:42.258855 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7ebd5682-c0a8-4f98-9186-cae0aa0eb4d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a2d2cfccaa0>]}
[0m16:39:42.263229 [info ] [MainThread]: Registered adapter: bigquery=1.9.2
[0m16:40:36.314223 [debug] [MainThread]: checksum: 1adc40777973ef30f45f80b3b6d04d5013c1edd53d96363881b3b199e612468b, vars: {}, profile: , target: , version: 1.10.2
[0m16:40:41.505431 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:40:41.506082 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:40:41.515563 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.dbt_exercise.marts
- models.dbt_exercise.intermediate
[0m16:40:41.586057 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7ebd5682-c0a8-4f98-9186-cae0aa0eb4d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a2d23ab3e90>]}
[0m16:40:41.931911 [debug] [MainThread]: Wrote artifact WritableManifest to /home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/target/manifest.json
[0m16:40:41.945288 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/target/semantic_manifest.json
[0m16:40:42.441370 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7ebd5682-c0a8-4f98-9186-cae0aa0eb4d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a2d23781fa0>]}
[0m16:40:42.442133 [info ] [MainThread]: Found 14 seeds, 31 data tests, 11 models, 14 sources, 609 macros
[0m16:40:42.442765 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7ebd5682-c0a8-4f98-9186-cae0aa0eb4d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a2d2360bb90>]}
[0m16:40:42.445263 [info ] [MainThread]: 
[0m16:40:42.445944 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:40:42.446512 [info ] [MainThread]: 
[0m16:40:42.447571 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m16:40:42.449487 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_corded-sunlight-464012-e2'
[0m16:40:42.450723 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:40:43.416169 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_corded-sunlight-464012-e2, now list_corded-sunlight-464012-e2_dbt_dw_staging)
[0m16:40:43.417939 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_corded-sunlight-464012-e2_dbt_dw_raw'
[0m16:40:43.418681 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:40:43.419493 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:40:44.270444 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7ebd5682-c0a8-4f98-9186-cae0aa0eb4d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a2d23bb9880>]}
[0m16:40:44.271529 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:40:44.283667 [debug] [Thread-1 (]: Began running node model.dbt_exercise.stg_employee_territories
[0m16:40:44.284965 [info ] [Thread-1 (]: 1 of 1 START sql view model dbt_dw_staging.stg_employee_territories ............ [RUN]
[0m16:40:44.286065 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_corded-sunlight-464012-e2_dbt_dw_staging, now model.dbt_exercise.stg_employee_territories)
[0m16:40:44.286689 [debug] [Thread-1 (]: Began compiling node model.dbt_exercise.stg_employee_territories
[0m16:40:44.301059 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_exercise.stg_employee_territories"
[0m16:40:44.302399 [debug] [Thread-1 (]: Began executing node model.dbt_exercise.stg_employee_territories
[0m16:40:44.353682 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_exercise.stg_employee_territories"
[0m16:40:44.358239 [debug] [Thread-1 (]: On model.dbt_exercise.stg_employee_territories: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "model.dbt_exercise.stg_employee_territories"} */


  create or replace view `corded-sunlight-464012-e2`.`dbt_dw_staging`.`stg_employee_territories`
  OPTIONS()
  as with employee_territories as (
    select *
    from `corded-sunlight-464012-e2`.`dbt_dw_raw`.`employee_territories`
)

select
    cast(employee_id as string) as employee_id
    , cast(territory_id as string) as territory_id
from employee_territories;


[0m16:40:44.359805 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:40:45.858119 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:fafb0a95-c9ea-4d2e-90df-5a75017984cf&page=queryresults
[0m16:40:51.108129 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7ebd5682-c0a8-4f98-9186-cae0aa0eb4d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a2d61c1dc40>]}
[0m16:40:51.109099 [info ] [Thread-1 (]: 1 of 1 OK created sql view model dbt_dw_staging.stg_employee_territories ....... [[32mCREATE VIEW (0 processed)[0m in 6.81s]
[0m16:40:51.110157 [debug] [Thread-1 (]: Finished running node model.dbt_exercise.stg_employee_territories
[0m16:40:51.113262 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:40:51.120680 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:40:51.121420 [debug] [MainThread]: Connection 'model.dbt_exercise.stg_employee_territories' was properly closed.
[0m16:40:51.122062 [debug] [MainThread]: Connection 'list_corded-sunlight-464012-e2_dbt_dw_raw' was properly closed.
[0m16:40:51.122827 [info ] [MainThread]: 
[0m16:40:51.123613 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 8.68 seconds (8.68s).
[0m16:40:51.125124 [debug] [MainThread]: Command end result
[0m16:40:51.188331 [debug] [MainThread]: Wrote artifact WritableManifest to /home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/target/manifest.json
[0m16:40:51.201704 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/target/semantic_manifest.json
[0m16:40:51.209153 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/target/run_results.json
[0m16:40:51.209821 [info ] [MainThread]: 
[0m16:40:51.210550 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:40:51.212142 [info ] [MainThread]: 
[0m16:40:51.213323 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m16:40:51.214923 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- DuplicateYAMLKeysDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m16:40:51.220466 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 118.67392, "process_in_blocks": "122920", "process_kernel_time": 16.046938, "process_mem_max_rss": "366016", "process_out_blocks": "3336", "process_user_time": 13.240268}
[0m16:40:51.221397 [debug] [MainThread]: Command `dbt run` succeeded at 16:40:51.221185 after 118.68 seconds
[0m16:40:51.222016 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a2d62f59e20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a2d237dd3d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a2d2cc25280>]}
[0m16:40:51.222699 [debug] [MainThread]: Flushing usage events
[0m16:40:51.548310 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:44:12.348138 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7932f4193b90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7932f4784c80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7932f47865a0>]}


============================== 16:44:12.364715 | d7d10ad9-742e-4393-96eb-08f9e94989ab ==============================
[0m16:44:12.364715 [info ] [MainThread]: Running with dbt=1.10.2
[0m16:44:12.365454 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise', 'debug': 'False', 'warn_error': 'None', 'log_path': '/home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt run -s stg_order_details_northwind', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m16:45:02.858524 [warn ] [MainThread]: [[33mWARNING[0m][DuplicateYAMLKeysDeprecation]: Deprecated functionality
Duplicate key 'version' in "<unicode string>", line 4, column 1 in file
`/home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/dbt_project.yml`
[0m16:45:02.859686 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'd7d10ad9-742e-4393-96eb-08f9e94989ab', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7932b7774ec0>]}
[0m16:45:05.203163 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd7d10ad9-742e-4393-96eb-08f9e94989ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7932f604aa80>]}
[0m16:45:05.410910 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd7d10ad9-742e-4393-96eb-08f9e94989ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7932b6ab7a70>]}
[0m16:45:05.419031 [info ] [MainThread]: Registered adapter: bigquery=1.9.2
[0m16:45:58.588603 [debug] [MainThread]: checksum: 1adc40777973ef30f45f80b3b6d04d5013c1edd53d96363881b3b199e612468b, vars: {}, profile: , target: , version: 1.10.2
[0m16:46:03.596921 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:46:03.597609 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:46:03.604634 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 2 unused configuration paths:
- models.dbt_exercise.marts
- models.dbt_exercise.intermediate
[0m16:46:03.674590 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd7d10ad9-742e-4393-96eb-08f9e94989ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7932b6465c40>]}
[0m16:46:04.200879 [debug] [MainThread]: Wrote artifact WritableManifest to /home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/target/manifest.json
[0m16:46:04.216723 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/target/semantic_manifest.json
[0m16:46:04.709873 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd7d10ad9-742e-4393-96eb-08f9e94989ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7932b626a060>]}
[0m16:46:04.710693 [info ] [MainThread]: Found 14 seeds, 31 data tests, 12 models, 14 sources, 609 macros
[0m16:46:04.711662 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd7d10ad9-742e-4393-96eb-08f9e94989ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7932f41621b0>]}
[0m16:46:04.715777 [info ] [MainThread]: 
[0m16:46:04.716703 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:46:04.717316 [info ] [MainThread]: 
[0m16:46:04.718896 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m16:46:04.721058 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_corded-sunlight-464012-e2'
[0m16:46:04.721867 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:46:05.571153 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_corded-sunlight-464012-e2, now list_corded-sunlight-464012-e2_dbt_dw_staging)
[0m16:46:05.572361 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:46:05.574801 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_corded-sunlight-464012-e2_dbt_dw_raw'
[0m16:46:05.576299 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:46:06.404806 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd7d10ad9-742e-4393-96eb-08f9e94989ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7932b61f6d20>]}
[0m16:46:06.405896 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:46:06.415260 [debug] [Thread-1 (]: Began running node model.dbt_exercise.stg_order_details_northwind
[0m16:46:06.416156 [info ] [Thread-1 (]: 1 of 1 START sql view model dbt_dw_staging.stg_order_details_northwind ......... [RUN]
[0m16:46:06.417174 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_corded-sunlight-464012-e2_dbt_dw_raw, now model.dbt_exercise.stg_order_details_northwind)
[0m16:46:06.417942 [debug] [Thread-1 (]: Began compiling node model.dbt_exercise.stg_order_details_northwind
[0m16:46:06.430369 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_exercise.stg_order_details_northwind"
[0m16:46:06.449127 [debug] [Thread-1 (]: Began executing node model.dbt_exercise.stg_order_details_northwind
[0m16:46:06.497718 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_exercise.stg_order_details_northwind"
[0m16:46:06.500256 [debug] [Thread-1 (]: On model.dbt_exercise.stg_order_details_northwind: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "model.dbt_exercise.stg_order_details_northwind"} */


  create or replace view `corded-sunlight-464012-e2`.`dbt_dw_staging`.`stg_order_details_northwind`
  OPTIONS()
  as with order_details as (
    select *
    from `corded-sunlight-464012-e2`.`dbt_dw_raw`.`order_details`
)

select
    cast(order_id as string) as order_id
    , cast(product_id as string) as product_id
    , cast(unit_price as numeric) as unit_price
    , cast(quantity as integer) as quantity
    , cast(discount as numeric) as discount
from order_details;


[0m16:46:06.501179 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:46:07.742737 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:8619f938-c02c-49ce-ad81-2fa69621b1aa&page=queryresults
[0m16:46:15.073759 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd7d10ad9-742e-4393-96eb-08f9e94989ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7932f46c5c40>]}
[0m16:46:15.075492 [info ] [Thread-1 (]: 1 of 1 OK created sql view model dbt_dw_staging.stg_order_details_northwind .... [[32mCREATE VIEW (0 processed)[0m in 8.64s]
[0m16:46:15.076711 [debug] [Thread-1 (]: Finished running node model.dbt_exercise.stg_order_details_northwind
[0m16:46:15.079940 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:46:15.087328 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:46:15.087841 [debug] [MainThread]: Connection 'list_corded-sunlight-464012-e2_dbt_dw_staging' was properly closed.
[0m16:46:15.088303 [debug] [MainThread]: Connection 'model.dbt_exercise.stg_order_details_northwind' was properly closed.
[0m16:46:15.088921 [info ] [MainThread]: 
[0m16:46:15.089588 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 10.37 seconds (10.37s).
[0m16:46:15.091608 [debug] [MainThread]: Command end result
[0m16:46:15.151505 [debug] [MainThread]: Wrote artifact WritableManifest to /home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/target/manifest.json
[0m16:46:15.166761 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/target/semantic_manifest.json
[0m16:46:15.174896 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/target/run_results.json
[0m16:46:15.175500 [info ] [MainThread]: 
[0m16:46:15.176215 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:46:15.176720 [info ] [MainThread]: 
[0m16:46:15.177259 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m16:46:15.178082 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- DuplicateYAMLKeysDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m16:46:15.182377 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 116.91346, "process_in_blocks": "122944", "process_kernel_time": 16.39374, "process_mem_max_rss": "365984", "process_out_blocks": "3328", "process_user_time": 13.256694}
[0m16:46:15.183245 [debug] [MainThread]: Command `dbt run` succeeded at 16:46:15.183039 after 116.91 seconds
[0m16:46:15.183818 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7932b6244350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7932b6245670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7932f46f0b00>]}
[0m16:46:15.184420 [debug] [MainThread]: Flushing usage events
[0m16:46:15.521331 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:44:19.656092 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72514822b5f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x725148eaa180>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x725149cb1b50>]}


============================== 12:44:19.660750 | e89e5489-3842-4c18-9b3f-1c25551d3b99 ==============================
[0m12:44:19.660750 [info ] [MainThread]: Running with dbt=1.10.2
[0m12:44:19.661439 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/logs', 'version_check': 'True', 'profiles_dir': '/home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'invocation_command': 'dbt ', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m12:44:19.662480 [warn ] [MainThread]: [[33mWARNING[0m][DuplicateYAMLKeysDeprecation]: Deprecated functionality
Duplicate key 'version' in "<unicode string>", line 4, column 1 in file
`/home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/dbt_project.yml`
[0m12:44:19.662925 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'e89e5489-3842-4c18-9b3f-1c25551d3b99', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7251471b9c40>]}
[0m12:44:19.767184 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e89e5489-3842-4c18-9b3f-1c25551d3b99', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x725149a665d0>]}
[0m12:44:19.804138 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-x3bzu5l9'
[0m12:44:19.804575 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m12:44:20.027626 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m12:44:20.028324 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m12:44:20.105368 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m12:44:20.109282 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m12:44:20.573362 [info ] [MainThread]: Installed from version 1.3.0
[0m12:44:20.573754 [info ] [MainThread]: Up to date!
[0m12:44:20.574051 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'e89e5489-3842-4c18-9b3f-1c25551d3b99', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7251499d4140>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x725147b19c70>]}
[0m12:44:20.574882 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- DuplicateYAMLKeysDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m12:44:20.576008 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.9713087, "process_in_blocks": "408", "process_kernel_time": 0.452519, "process_mem_max_rss": "102832", "process_out_blocks": "2304", "process_user_time": 1.430824}
[0m12:44:20.576658 [debug] [MainThread]: Command `cli deps` succeeded at 12:44:20.576502 after 0.97 seconds
[0m12:44:20.577160 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x725148eaa180>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7251471eaf90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x725147197f50>]}
[0m12:44:20.577550 [debug] [MainThread]: Flushing usage events
[0m12:44:21.161945 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:48:02.852794 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76787a2f4110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76787aa0d850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76787aa0e8a0>]}


============================== 19:48:02.871039 | a52e48da-be75-4e56-bd2e-140493f71451 ==============================
[0m19:48:02.871039 [info ] [MainThread]: Running with dbt=1.10.2
[0m19:48:02.872320 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/logs', 'fail_fast': 'False', 'profiles_dir': '/home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt run -s int_orders_northwind', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m19:49:27.929105 [warn ] [MainThread]: [[33mWARNING[0m][DuplicateYAMLKeysDeprecation]: Deprecated functionality
Duplicate key 'version' in "<unicode string>", line 4, column 1 in file
`/home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/dbt_project.yml`
[0m19:49:27.931253 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'a52e48da-be75-4e56-bd2e-140493f71451', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7678799bdac0>]}
[0m19:49:28.719356 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a52e48da-be75-4e56-bd2e-140493f71451', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76787c1a6630>]}
[0m19:49:28.808870 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a52e48da-be75-4e56-bd2e-140493f71451', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76787c07c080>]}
[0m19:49:28.813453 [info ] [MainThread]: Registered adapter: bigquery=1.9.2
[0m19:50:22.360730 [debug] [MainThread]: checksum: 1adc40777973ef30f45f80b3b6d04d5013c1edd53d96363881b3b199e612468b, vars: {}, profile: , target: , version: 1.10.2
[0m19:50:30.088086 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:50:30.088679 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:50:30.097697 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt_exercise.marts
[0m19:50:30.173320 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a52e48da-be75-4e56-bd2e-140493f71451', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x767879e14320>]}
[0m19:50:30.541275 [debug] [MainThread]: Wrote artifact WritableManifest to /home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/target/manifest.json
[0m19:50:30.577807 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/target/semantic_manifest.json
[0m19:50:31.428766 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a52e48da-be75-4e56-bd2e-140493f71451', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76783c5c3e00>]}
[0m19:50:31.429522 [info ] [MainThread]: Found 14 seeds, 31 data tests, 13 models, 14 sources, 609 macros
[0m19:50:31.430180 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a52e48da-be75-4e56-bd2e-140493f71451', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76783c454620>]}
[0m19:50:31.432961 [info ] [MainThread]: 
[0m19:50:31.433668 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m19:50:31.434264 [info ] [MainThread]: 
[0m19:50:31.435173 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m19:50:31.436939 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_corded-sunlight-464012-e2'
[0m19:50:31.438139 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:50:32.424344 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_corded-sunlight-464012-e2, now create_corded-sunlight-464012-e2_dbt_dw_intermediate)
[0m19:50:32.425643 [debug] [ThreadPool]: Creating schema "database: "corded-sunlight-464012-e2"
schema: "dbt_dw_intermediate"
"
[0m19:50:32.450900 [debug] [ThreadPool]: On create_corded-sunlight-464012-e2_dbt_dw_intermediate: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "connection_name": "create_corded-sunlight-464012-e2_dbt_dw_intermediate"} */
create schema if not exists `corded-sunlight-464012-e2`.`dbt_dw_intermediate`
  
[0m19:50:32.451724 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:50:34.024980 [debug] [ThreadPool]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:7363d2bd-d6dc-4273-95b1-b7ad07e41ab3&page=queryresults
[0m19:50:47.869974 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_corded-sunlight-464012-e2_dbt_dw_intermediate, now list_corded-sunlight-464012-e2_dbt_dw_raw)
[0m19:50:47.871264 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:50:47.872638 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_corded-sunlight-464012-e2_dbt_dw_staging'
[0m19:50:47.874305 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_corded-sunlight-464012-e2_dbt_dw_intermediate'
[0m19:50:47.875732 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:50:47.876834 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:50:48.753994 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a52e48da-be75-4e56-bd2e-140493f71451', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76783b975340>]}
[0m19:50:48.755465 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:50:48.790326 [debug] [Thread-1 (]: Began running node model.dbt_exercise.int_orders_northwind
[0m19:50:48.791375 [info ] [Thread-1 (]: 1 of 1 START sql view model dbt_dw_intermediate.int_orders_northwind ........... [RUN]
[0m19:50:48.792623 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_corded-sunlight-464012-e2_dbt_dw_staging, now model.dbt_exercise.int_orders_northwind)
[0m19:50:48.793336 [debug] [Thread-1 (]: Began compiling node model.dbt_exercise.int_orders_northwind
[0m19:50:48.809657 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_exercise.int_orders_northwind"
[0m19:50:48.818531 [debug] [Thread-1 (]: Began executing node model.dbt_exercise.int_orders_northwind
[0m19:50:48.864658 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_exercise.int_orders_northwind"
[0m19:50:48.867187 [debug] [Thread-1 (]: On model.dbt_exercise.int_orders_northwind: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "model.dbt_exercise.int_orders_northwind"} */


  create or replace view `corded-sunlight-464012-e2`.`dbt_dw_intermediate`.`int_orders_northwind`
  OPTIONS()
  as with orders as (
    select *
    from `corded-sunlight-464012-e2`.`dbt_dw_staging`.`stg_orders_northwind`
)

, order_details as (
    select *
    from `corded-sunlight-464012-e2`.`dbt_dw_staging`.`stg_order_details_northwind`
)

, transformed_table as (    
    select
        orders.order_id 
        , orders.customer_id
        , orders.employee_id
        , orders.order_date
        , orders.required_date
        , orders.shipped_date
        , date_diff(orders.shipped_date, orders.order_date, day) as days_to_ship      
        , orders.ship_via
        , sum(order_details.unit_price * order_details.quantity * (1 - order_details.discount)) as total_order_amount
        , orders.freight
        , orders.ship_name
        , orders.ship_address
        , orders.ship_city
        , orders.ship_region
        , orders.ship_country
    from orders
    left join order_details
        on orders.order_id = order_details.order_id
    group by 
        orders.order_id
        , orders.customer_id
        , orders.employee_id
        , orders.order_date
        , orders.required_date
        , orders.shipped_date
        , orders.ship_via
        , orders.freight
        , orders.ship_name
        , orders.ship_address
        , orders.ship_city
        , orders.ship_region
        , orders.ship_country
)

, final_table as (
    select
        transformed_table.order_id
        , transformed_table.customer_id
        , transformed_table.employee_id
        , transformed_table.order_date
        , transformed_table.required_date
        , transformed_table.shipped_date
        , transformed_table.days_to_ship
        , transformed_table.ship_via
        , transformed_table.total_order_amount
        , transformed_table.freight
        , transformed_table.ship_name
        , transformed_table.ship_address
        , transformed_table.ship_city
        , transformed_table.ship_region
        , transformed_table.ship_country
        , case 
            when transformed_table.days_to_ship is null then False
            else True
          end as is_shipped
    from transformed_table
)

select *
from final_table;


[0m19:50:48.867968 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:50:49.997557 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:89d13116-27e0-47a5-b3cf-a31d1baeeea3&page=queryresults
[0m19:50:50.584546 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a52e48da-be75-4e56-bd2e-140493f71451', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76784151a420>]}
[0m19:50:50.585927 [info ] [Thread-1 (]: 1 of 1 OK created sql view model dbt_dw_intermediate.int_orders_northwind ...... [[32mCREATE VIEW (0 processed)[0m in 1.76s]
[0m19:50:50.587176 [debug] [Thread-1 (]: Finished running node model.dbt_exercise.int_orders_northwind
[0m19:50:50.590642 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:50:50.601107 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:50:50.601882 [debug] [MainThread]: Connection 'list_corded-sunlight-464012-e2_dbt_dw_raw' was properly closed.
[0m19:50:50.602445 [debug] [MainThread]: Connection 'model.dbt_exercise.int_orders_northwind' was properly closed.
[0m19:50:50.603319 [debug] [MainThread]: Connection 'list_corded-sunlight-464012-e2_dbt_dw_intermediate' was properly closed.
[0m19:50:50.604440 [info ] [MainThread]: 
[0m19:50:50.605225 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 19.17 seconds (19.17s).
[0m19:50:50.607084 [debug] [MainThread]: Command end result
[0m19:50:50.702982 [debug] [MainThread]: Wrote artifact WritableManifest to /home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/target/manifest.json
[0m19:50:50.721388 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/target/semantic_manifest.json
[0m19:50:50.729835 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/target/run_results.json
[0m19:50:50.730756 [info ] [MainThread]: 
[0m19:50:50.731589 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:50:50.732396 [info ] [MainThread]: 
[0m19:50:50.733051 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m19:50:50.734082 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- DuplicateYAMLKeysDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m19:50:50.741750 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 153.90456, "process_in_blocks": "128584", "process_kernel_time": 15.989406, "process_mem_max_rss": "365988", "process_out_blocks": "3376", "process_user_time": 12.522855}
[0m19:50:50.743170 [debug] [MainThread]: Command `dbt run` succeeded at 19:50:50.742852 after 153.91 seconds
[0m19:50:50.744141 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76787a901160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76787a86caa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76783c363470>]}
[0m19:50:50.745078 [debug] [MainThread]: Flushing usage events
[0m19:50:51.064578 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:12:48.046382 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a71ea6b1430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a71e8fd6090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a71e8fd4080>]}


============================== 20:12:48.069820 | 79e3283a-c69f-4382-a052-42c225a6bcb9 ==============================
[0m20:12:48.069820 [info ] [MainThread]: Running with dbt=1.10.2
[0m20:12:48.071001 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run -s int_employees_northwind', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m20:13:51.109089 [warn ] [MainThread]: [[33mWARNING[0m][DuplicateYAMLKeysDeprecation]: Deprecated functionality
Duplicate key 'version' in "<unicode string>", line 4, column 1 in file
`/home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/dbt_project.yml`
[0m20:13:51.109804 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '79e3283a-c69f-4382-a052-42c225a6bcb9', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a71aaf78860>]}
[0m20:13:51.891700 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '79e3283a-c69f-4382-a052-42c225a6bcb9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a71af8358b0>]}
[0m20:13:51.996385 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '79e3283a-c69f-4382-a052-42c225a6bcb9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a71ea623f20>]}
[0m20:13:52.000915 [info ] [MainThread]: Registered adapter: bigquery=1.9.2
[0m20:14:51.416589 [debug] [MainThread]: checksum: 1adc40777973ef30f45f80b3b6d04d5013c1edd53d96363881b3b199e612468b, vars: {}, profile: , target: , version: 1.10.2
[0m20:15:00.962658 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:15:00.963326 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:15:00.973384 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt_exercise.marts
[0m20:15:01.051793 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '79e3283a-c69f-4382-a052-42c225a6bcb9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a71aaccfe30>]}
[0m20:15:01.397213 [debug] [MainThread]: Wrote artifact WritableManifest to /home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/target/manifest.json
[0m20:15:01.410141 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/target/semantic_manifest.json
[0m20:15:01.949335 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '79e3283a-c69f-4382-a052-42c225a6bcb9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a71aa864f20>]}
[0m20:15:01.950098 [info ] [MainThread]: Found 14 seeds, 31 data tests, 14 models, 14 sources, 609 macros
[0m20:15:01.950671 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '79e3283a-c69f-4382-a052-42c225a6bcb9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a71aa72f830>]}
[0m20:15:01.953224 [info ] [MainThread]: 
[0m20:15:01.954152 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:15:01.955253 [info ] [MainThread]: 
[0m20:15:01.956592 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m20:15:01.958641 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_corded-sunlight-464012-e2'
[0m20:15:01.959656 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:15:02.805524 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_corded-sunlight-464012-e2, now list_corded-sunlight-464012-e2_dbt_dw_raw)
[0m20:15:02.806779 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:15:02.807823 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_corded-sunlight-464012-e2_dbt_dw_intermediate'
[0m20:15:02.809881 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_corded-sunlight-464012-e2_dbt_dw_staging'
[0m20:15:02.811507 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:15:02.812715 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:15:03.823623 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '79e3283a-c69f-4382-a052-42c225a6bcb9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a71aad1ee40>]}
[0m20:15:03.825111 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:15:03.857295 [debug] [Thread-1 (]: Began running node model.dbt_exercise.int_employees_northwind
[0m20:15:03.858445 [info ] [Thread-1 (]: 1 of 1 START sql view model dbt_dw_intermediate.int_employees_northwind ........ [RUN]
[0m20:15:03.859413 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_corded-sunlight-464012-e2_dbt_dw_raw, now model.dbt_exercise.int_employees_northwind)
[0m20:15:03.860080 [debug] [Thread-1 (]: Began compiling node model.dbt_exercise.int_employees_northwind
[0m20:15:03.878876 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_exercise.int_employees_northwind"
[0m20:15:03.884095 [debug] [Thread-1 (]: Began executing node model.dbt_exercise.int_employees_northwind
[0m20:15:03.950207 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_exercise.int_employees_northwind"
[0m20:15:03.952767 [debug] [Thread-1 (]: On model.dbt_exercise.int_employees_northwind: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "model.dbt_exercise.int_employees_northwind"} */


  create or replace view `corded-sunlight-464012-e2`.`dbt_dw_intermediate`.`int_employees_northwind`
  OPTIONS()
  as with employees as (
    select *
    from `corded-sunlight-464012-e2`.`dbt_dw_staging`.`stg_employees_northwind`
)

, max_fact_date as (
    select 
        case 
            when max(order_date) >= max(shipped_date) then max(order_date)
            else max(shipped_date)
        end as max_date
    from `corded-sunlight-464012-e2`.`dbt_dw_staging`.`stg_orders_northwind`
)

, final_table as (
    select
        employee_id
        , concat(first_name, ' ', last_name) as employee_name
        , title
        , birth_date
        , date_diff((select * from max_fact_date), birth_date, year) as age
        , hire_date
        , date_diff((select * from max_fact_date), hire_date, year) as years_hired
        , address
        , city
        , region
        , country
    from employees
)

select *
from final_table;


[0m20:15:03.953941 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:15:04.987199 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:395eba13-e96f-4ff7-8855-ece8e356ab9f&page=queryresults
[0m20:15:10.332383 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '79e3283a-c69f-4382-a052-42c225a6bcb9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a71e8bf9eb0>]}
[0m20:15:10.333609 [info ] [Thread-1 (]: 1 of 1 OK created sql view model dbt_dw_intermediate.int_employees_northwind ... [[32mCREATE VIEW (0 processed)[0m in 6.45s]
[0m20:15:10.334788 [debug] [Thread-1 (]: Finished running node model.dbt_exercise.int_employees_northwind
[0m20:15:10.337861 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:15:10.345964 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:15:10.346804 [debug] [MainThread]: Connection 'model.dbt_exercise.int_employees_northwind' was properly closed.
[0m20:15:10.347521 [debug] [MainThread]: Connection 'list_corded-sunlight-464012-e2_dbt_dw_intermediate' was properly closed.
[0m20:15:10.348301 [debug] [MainThread]: Connection 'list_corded-sunlight-464012-e2_dbt_dw_staging' was properly closed.
[0m20:15:10.349134 [info ] [MainThread]: 
[0m20:15:10.349960 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 8.39 seconds (8.39s).
[0m20:15:10.351366 [debug] [MainThread]: Command end result
[0m20:15:10.424193 [debug] [MainThread]: Wrote artifact WritableManifest to /home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/target/manifest.json
[0m20:15:10.438397 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/target/semantic_manifest.json
[0m20:15:10.446435 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/target/run_results.json
[0m20:15:10.447044 [info ] [MainThread]: 
[0m20:15:10.448135 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:15:10.449652 [info ] [MainThread]: 
[0m20:15:10.451178 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m20:15:10.452282 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- DuplicateYAMLKeysDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m20:15:10.458326 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 131.98221, "process_in_blocks": "123016", "process_kernel_time": 17.697464, "process_mem_max_rss": "365784", "process_out_blocks": "3392", "process_user_time": 13.636154}
[0m20:15:10.459076 [debug] [MainThread]: Command `dbt run` succeeded at 20:15:10.458935 after 131.98 seconds
[0m20:15:10.459613 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a71e834f8f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a71aa8c86b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a71aa8c86e0>]}
[0m20:15:10.460127 [debug] [MainThread]: Flushing usage events
[0m20:15:10.774714 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m20:34:23.476217 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73d4199640b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73d418e991f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73d41a2dbda0>]}


============================== 20:34:23.496288 | 4d89a7a9-5a7b-4bdd-9f48-5297a2b9dc1c ==============================
[0m20:34:23.496288 [info ] [MainThread]: Running with dbt=1.10.2
[0m20:34:23.497309 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise', 'log_path': '/home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt run -s int_customers_northwind', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m20:35:21.827540 [warn ] [MainThread]: [[33mWARNING[0m][DuplicateYAMLKeysDeprecation]: Deprecated functionality
Duplicate key 'version' in "<unicode string>", line 4, column 1 in file
`/home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/dbt_project.yml`
[0m20:35:21.828625 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '4d89a7a9-5a7b-4bdd-9f48-5297a2b9dc1c', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73d3db72acf0>]}
[0m20:35:22.571217 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4d89a7a9-5a7b-4bdd-9f48-5297a2b9dc1c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73d3db989df0>]}
[0m20:35:22.758729 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4d89a7a9-5a7b-4bdd-9f48-5297a2b9dc1c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73d418791640>]}
[0m20:35:22.763756 [info ] [MainThread]: Registered adapter: bigquery=1.9.2
[0m20:36:33.345376 [debug] [MainThread]: checksum: 1adc40777973ef30f45f80b3b6d04d5013c1edd53d96363881b3b199e612468b, vars: {}, profile: , target: , version: 1.10.2
[0m20:36:41.584717 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:36:41.585503 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:36:41.594481 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt_exercise.marts
[0m20:36:41.671315 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4d89a7a9-5a7b-4bdd-9f48-5297a2b9dc1c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73d3db674a70>]}
[0m20:36:42.032533 [debug] [MainThread]: Wrote artifact WritableManifest to /home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/target/manifest.json
[0m20:36:42.046965 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/target/semantic_manifest.json
[0m20:36:42.541196 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4d89a7a9-5a7b-4bdd-9f48-5297a2b9dc1c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73d3db79c650>]}
[0m20:36:42.541991 [info ] [MainThread]: Found 14 seeds, 31 data tests, 15 models, 14 sources, 609 macros
[0m20:36:42.542760 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4d89a7a9-5a7b-4bdd-9f48-5297a2b9dc1c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73d3db3f2030>]}
[0m20:36:42.546187 [info ] [MainThread]: 
[0m20:36:42.547170 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:36:42.547820 [info ] [MainThread]: 
[0m20:36:42.549009 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m20:36:42.551338 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_corded-sunlight-464012-e2'
[0m20:36:42.552412 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:36:43.392950 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_corded-sunlight-464012-e2, now list_corded-sunlight-464012-e2_dbt_dw_raw)
[0m20:36:43.394291 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m20:36:43.395593 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_corded-sunlight-464012-e2_dbt_dw_staging'
[0m20:36:43.397456 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_corded-sunlight-464012-e2_dbt_dw_intermediate'
[0m20:36:43.399103 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:36:43.400463 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:36:44.304768 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4d89a7a9-5a7b-4bdd-9f48-5297a2b9dc1c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73d3db212960>]}
[0m20:36:44.306801 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:36:44.339065 [debug] [Thread-1 (]: Began running node model.dbt_exercise.int_customers_northwind
[0m20:36:44.339930 [info ] [Thread-1 (]: 1 of 1 START sql view model dbt_dw_intermediate.int_customers_northwind ........ [RUN]
[0m20:36:44.340632 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_corded-sunlight-464012-e2_dbt_dw_intermediate, now model.dbt_exercise.int_customers_northwind)
[0m20:36:44.341234 [debug] [Thread-1 (]: Began compiling node model.dbt_exercise.int_customers_northwind
[0m20:36:44.354613 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_exercise.int_customers_northwind"
[0m20:36:44.356820 [debug] [Thread-1 (]: Began executing node model.dbt_exercise.int_customers_northwind
[0m20:36:44.412726 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_exercise.int_customers_northwind"
[0m20:36:44.414923 [debug] [Thread-1 (]: On model.dbt_exercise.int_customers_northwind: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "model.dbt_exercise.int_customers_northwind"} */


  create or replace view `corded-sunlight-464012-e2`.`dbt_dw_intermediate`.`int_customers_northwind`
  OPTIONS()
  as with customers as (
    select *
    from `corded-sunlight-464012-e2`.`dbt_dw_staging`.`stg_customers_northwind`
)

, final_table as (
    select 
        customer_id
        , company_name
        , contact_name
        , contact_title
        , address
        , city
        , region
        , country
        , case 
            when country in ('USA', 'Canada', 'Mexico') then 'North America'
            when country in ('UK', 'France', 'Germany', 'Austria', 'Belgium', 'Denmark', 'Ireland'
            , 'Finland', 'Italy', 'Norway', 'Poland', 'Portugal', 'Spain', 'Sweden', 'Switzerland') then 'Europe'
            when country in ('Brazil', 'Argentina', 'Venezuela') then 'South America'
            else 'Other'
        end as continent
    from customers
)

select *
from final_table;


[0m20:36:44.415721 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:36:45.546822 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:66fa6343-827f-45a3-9579-a6d77bfde903&page=queryresults
[0m20:36:51.433293 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4d89a7a9-5a7b-4bdd-9f48-5297a2b9dc1c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73d41975df10>]}
[0m20:36:51.434440 [info ] [Thread-1 (]: 1 of 1 OK created sql view model dbt_dw_intermediate.int_customers_northwind ... [[32mCREATE VIEW (0 processed)[0m in 7.08s]
[0m20:36:51.435720 [debug] [Thread-1 (]: Finished running node model.dbt_exercise.int_customers_northwind
[0m20:36:51.439348 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m20:36:51.447199 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:36:51.447828 [debug] [MainThread]: Connection 'list_corded-sunlight-464012-e2_dbt_dw_raw' was properly closed.
[0m20:36:51.448244 [debug] [MainThread]: Connection 'list_corded-sunlight-464012-e2_dbt_dw_staging' was properly closed.
[0m20:36:51.448632 [debug] [MainThread]: Connection 'model.dbt_exercise.int_customers_northwind' was properly closed.
[0m20:36:51.449074 [info ] [MainThread]: 
[0m20:36:51.449601 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 8.90 seconds (8.90s).
[0m20:36:51.450810 [debug] [MainThread]: Command end result
[0m20:36:51.518622 [debug] [MainThread]: Wrote artifact WritableManifest to /home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/target/manifest.json
[0m20:36:51.532783 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/target/semantic_manifest.json
[0m20:36:51.541169 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/target/run_results.json
[0m20:36:51.541821 [info ] [MainThread]: 
[0m20:36:51.542610 [info ] [MainThread]: [32mCompleted successfully[0m
[0m20:36:51.543292 [info ] [MainThread]: 
[0m20:36:51.544105 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m20:36:51.545192 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- DuplicateYAMLKeysDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m20:36:51.551949 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 136.93729, "process_in_blocks": "123016", "process_kernel_time": 18.206558, "process_mem_max_rss": "365456", "process_out_blocks": "3400", "process_user_time": 13.881647}
[0m20:36:51.553086 [debug] [MainThread]: Command `dbt run` succeeded at 20:36:51.552795 after 136.94 seconds
[0m20:36:51.553767 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73d418e0b800>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73d419588d70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73d3dbb06ab0>]}
[0m20:36:51.554476 [debug] [MainThread]: Flushing usage events
[0m20:36:51.867650 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:05:56.715459 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x789599c11730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x789599c6acc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x789599c13f20>]}


============================== 21:05:56.733697 | f1efb203-e958-4b87-a979-e3700144745a ==============================
[0m21:05:56.733697 [info ] [MainThread]: Running with dbt=1.10.2
[0m21:05:56.734751 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/logs', 'profiles_dir': '/home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt run -s int_products_northwind', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m21:06:52.478680 [warn ] [MainThread]: [[33mWARNING[0m][DuplicateYAMLKeysDeprecation]: Deprecated functionality
Duplicate key 'version' in "<unicode string>", line 4, column 1 in file
`/home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/dbt_project.yml`
[0m21:06:52.479490 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'f1efb203-e958-4b87-a979-e3700144745a', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78955d3a85c0>]}
[0m21:06:53.177810 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f1efb203-e958-4b87-a979-e3700144745a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78955bb026f0>]}
[0m21:06:53.255930 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f1efb203-e958-4b87-a979-e3700144745a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78959b2dfec0>]}
[0m21:06:53.260344 [info ] [MainThread]: Registered adapter: bigquery=1.9.2
[0m21:07:44.017605 [debug] [MainThread]: checksum: 1adc40777973ef30f45f80b3b6d04d5013c1edd53d96363881b3b199e612468b, vars: {}, profile: , target: , version: 1.10.2
[0m21:07:49.119356 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:07:49.119945 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:07:49.128915 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt_exercise.marts
[0m21:07:49.202297 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f1efb203-e958-4b87-a979-e3700144745a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78955bbbfc50>]}
[0m21:07:49.533096 [debug] [MainThread]: Wrote artifact WritableManifest to /home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/target/manifest.json
[0m21:07:49.545786 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/target/semantic_manifest.json
[0m21:07:49.985684 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f1efb203-e958-4b87-a979-e3700144745a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78955b837cb0>]}
[0m21:07:49.986414 [info ] [MainThread]: Found 14 seeds, 31 data tests, 16 models, 14 sources, 609 macros
[0m21:07:49.987029 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f1efb203-e958-4b87-a979-e3700144745a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78955b7732c0>]}
[0m21:07:49.989685 [info ] [MainThread]: 
[0m21:07:49.990377 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m21:07:49.990948 [info ] [MainThread]: 
[0m21:07:49.991733 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m21:07:49.993492 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_corded-sunlight-464012-e2'
[0m21:07:49.994457 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:07:50.855315 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_corded-sunlight-464012-e2, now list_corded-sunlight-464012-e2_dbt_dw_raw)
[0m21:07:50.857115 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_corded-sunlight-464012-e2_dbt_dw_staging'
[0m21:07:50.857784 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:07:50.858964 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_corded-sunlight-464012-e2_dbt_dw_intermediate'
[0m21:07:50.859775 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:07:50.861020 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:07:51.785174 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f1efb203-e958-4b87-a979-e3700144745a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x789598c2c9e0>]}
[0m21:07:51.786375 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:07:51.802989 [debug] [Thread-1 (]: Began running node model.dbt_exercise.int_products_northwind
[0m21:07:51.804285 [info ] [Thread-1 (]: 1 of 1 START sql view model dbt_dw_intermediate.int_products_northwind ......... [RUN]
[0m21:07:51.805632 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_corded-sunlight-464012-e2_dbt_dw_intermediate, now model.dbt_exercise.int_products_northwind)
[0m21:07:51.806312 [debug] [Thread-1 (]: Began compiling node model.dbt_exercise.int_products_northwind
[0m21:07:51.821560 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_exercise.int_products_northwind"
[0m21:07:51.825234 [debug] [Thread-1 (]: Began executing node model.dbt_exercise.int_products_northwind
[0m21:07:51.882813 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_exercise.int_products_northwind"
[0m21:07:51.885073 [debug] [Thread-1 (]: On model.dbt_exercise.int_products_northwind: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "model.dbt_exercise.int_products_northwind"} */


  create or replace view `corded-sunlight-464012-e2`.`dbt_dw_intermediate`.`int_products_northwind`
  OPTIONS()
  as with products as (
    select *
    from `corded-sunlight-464012-e2`.`dbt_dw_staging`.`stg_products_northwind`
)

, categories as (
    select *
    from `corded-sunlight-464012-e2`.`dbt_dw_staging`.`stg_categories_northwind`
)

, suppliers as (
    select *
    from `corded-sunlight-464012-e2`.`dbt_dw_staging`.`stg_suppliers_northwind`
)

, final_table as (
    select
        products.product_id
        , products.product_name
        , products.quantity_per_unit
        , categories.category_name
        , suppliers.company_name as supplier_name
        , suppliers.city as supplier_city
        , suppliers.region as supplier_region
        , suppliers.country as supplier_country
        , products.discontinued
    from products
    left join categories
        on products.category_id = categories.category_id
    left join suppliers
        on products.supplier_id = suppliers.supplier_id
)

select * 
from final_table;


[0m21:07:51.885980 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:07:53.012685 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:6ca50bfa-81e6-48f9-816e-d5eff516d2ac&page=queryresults
[0m21:08:02.438273 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f1efb203-e958-4b87-a979-e3700144745a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x789599c99e20>]}
[0m21:08:02.439377 [info ] [Thread-1 (]: 1 of 1 OK created sql view model dbt_dw_intermediate.int_products_northwind .... [[32mCREATE VIEW (0 processed)[0m in 10.62s]
[0m21:08:02.440402 [debug] [Thread-1 (]: Finished running node model.dbt_exercise.int_products_northwind
[0m21:08:02.443904 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:08:02.451994 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:08:02.452564 [debug] [MainThread]: Connection 'list_corded-sunlight-464012-e2_dbt_dw_raw' was properly closed.
[0m21:08:02.453025 [debug] [MainThread]: Connection 'list_corded-sunlight-464012-e2_dbt_dw_staging' was properly closed.
[0m21:08:02.453455 [debug] [MainThread]: Connection 'model.dbt_exercise.int_products_northwind' was properly closed.
[0m21:08:02.454083 [info ] [MainThread]: 
[0m21:08:02.454881 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 12.46 seconds (12.46s).
[0m21:08:02.456486 [debug] [MainThread]: Command end result
[0m21:08:02.541053 [debug] [MainThread]: Wrote artifact WritableManifest to /home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/target/manifest.json
[0m21:08:02.558729 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/target/semantic_manifest.json
[0m21:08:02.568501 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/target/run_results.json
[0m21:08:02.569214 [info ] [MainThread]: 
[0m21:08:02.569915 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:08:02.570514 [info ] [MainThread]: 
[0m21:08:02.571121 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m21:08:02.571936 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- DuplicateYAMLKeysDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m21:08:02.578379 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 111.75983, "process_in_blocks": "123016", "process_kernel_time": 16.710718, "process_mem_max_rss": "366176", "process_out_blocks": "3424", "process_user_time": 11.553257}
[0m21:08:02.579942 [debug] [MainThread]: Command `dbt run` succeeded at 21:08:02.579485 after 111.76 seconds
[0m21:08:02.581334 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78959b604680>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78955b635550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x789599acc3b0>]}
[0m21:08:02.582363 [debug] [MainThread]: Flushing usage events
[0m21:08:03.049255 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m21:27:51.704150 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75a48b448f80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75a48b6723c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75a48bc94f80>]}


============================== 21:27:51.729489 | 845fd243-ace5-40a3-8638-c74f4cc3893f ==============================
[0m21:27:51.729489 [info ] [MainThread]: Running with dbt=1.10.2
[0m21:27:51.730857 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run -s int_orders_northwind', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m21:28:45.823590 [warn ] [MainThread]: [[33mWARNING[0m][DuplicateYAMLKeysDeprecation]: Deprecated functionality
Duplicate key 'version' in "<unicode string>", line 4, column 1 in file
`/home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/dbt_project.yml`
[0m21:28:45.824482 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '845fd243-ace5-40a3-8638-c74f4cc3893f', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75a48b5729f0>]}
[0m21:28:50.118803 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '845fd243-ace5-40a3-8638-c74f4cc3893f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75a44e0a9010>]}
[0m21:28:50.203602 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '845fd243-ace5-40a3-8638-c74f4cc3893f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75a48b822e70>]}
[0m21:28:50.207851 [info ] [MainThread]: Registered adapter: bigquery=1.9.2
[0m21:29:41.395274 [debug] [MainThread]: checksum: 1adc40777973ef30f45f80b3b6d04d5013c1edd53d96363881b3b199e612468b, vars: {}, profile: , target: , version: 1.10.2
[0m21:29:46.690413 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:29:46.691379 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:29:46.707217 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.dbt_exercise.marts
[0m21:29:46.817159 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '845fd243-ace5-40a3-8638-c74f4cc3893f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75a44d9e1ac0>]}
[0m21:29:47.266031 [debug] [MainThread]: Wrote artifact WritableManifest to /home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/target/manifest.json
[0m21:29:47.282794 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/target/semantic_manifest.json
[0m21:29:47.773959 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '845fd243-ace5-40a3-8638-c74f4cc3893f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75a44d8c01a0>]}
[0m21:29:47.774911 [info ] [MainThread]: Found 14 seeds, 31 data tests, 16 models, 14 sources, 609 macros
[0m21:29:47.775894 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '845fd243-ace5-40a3-8638-c74f4cc3893f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75a48d46e150>]}
[0m21:29:47.778914 [info ] [MainThread]: 
[0m21:29:47.780073 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m21:29:47.780796 [info ] [MainThread]: 
[0m21:29:47.781797 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m21:29:47.783843 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_corded-sunlight-464012-e2'
[0m21:29:47.784872 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:29:48.752668 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_corded-sunlight-464012-e2, now list_corded-sunlight-464012-e2_dbt_dw_raw)
[0m21:29:48.753825 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m21:29:48.755074 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_corded-sunlight-464012-e2_dbt_dw_staging'
[0m21:29:48.756934 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_corded-sunlight-464012-e2_dbt_dw_intermediate'
[0m21:29:48.758169 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:29:48.759144 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:29:49.622328 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '845fd243-ace5-40a3-8638-c74f4cc3893f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75a48bbb1340>]}
[0m21:29:49.623369 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:29:49.653605 [debug] [Thread-1 (]: Began running node model.dbt_exercise.int_orders_northwind
[0m21:29:49.654682 [info ] [Thread-1 (]: 1 of 1 START sql view model dbt_dw_intermediate.int_orders_northwind ........... [RUN]
[0m21:29:49.655977 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_corded-sunlight-464012-e2_dbt_dw_intermediate, now model.dbt_exercise.int_orders_northwind)
[0m21:29:49.656940 [debug] [Thread-1 (]: Began compiling node model.dbt_exercise.int_orders_northwind
[0m21:29:49.674495 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_exercise.int_orders_northwind"
[0m21:29:49.681283 [debug] [Thread-1 (]: Began executing node model.dbt_exercise.int_orders_northwind
[0m21:29:49.735587 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_exercise.int_orders_northwind"
[0m21:29:49.737031 [debug] [Thread-1 (]: On model.dbt_exercise.int_orders_northwind: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "model.dbt_exercise.int_orders_northwind"} */


  create or replace view `corded-sunlight-464012-e2`.`dbt_dw_intermediate`.`int_orders_northwind`
  OPTIONS()
  as with orders as (
    select *
    from `corded-sunlight-464012-e2`.`dbt_dw_staging`.`stg_orders_northwind`
)

, order_details as (
    select *
    from `corded-sunlight-464012-e2`.`dbt_dw_staging`.`stg_order_details_northwind`
)

, shippers as (
    select *
    from `corded-sunlight-464012-e2`.`dbt_dw_staging`.`stg_shippers_northwind`
)

, transformed_table as (    
    select
        orders.order_id 
        , orders.customer_id
        , orders.employee_id
        , orders.order_date
        , orders.required_date
        , orders.shipped_date
        , date_diff(orders.shipped_date, orders.order_date, day) as days_to_ship
        , orders.ship_via      
        , shippers.company_name as shipper_name
        , sum(order_details.unit_price * order_details.quantity * (1 - order_details.discount)) as total_order_amount
        , orders.freight
        , orders.ship_name
        , orders.ship_address
        , orders.ship_city
        , orders.ship_region
        , orders.ship_country
    from orders
    left join order_details
        on orders.order_id = order_details.order_id
    left join shippers
        on orders.ship_via = shippers.shipper_id
    group by 
        orders.order_id
        , orders.customer_id
        , orders.employee_id
        , orders.order_date
        , orders.required_date
        , orders.shipped_date
        , orders.ship_via
        , shippers.company_name
        , orders.freight
        , orders.ship_name
        , orders.ship_address
        , orders.ship_city
        , orders.ship_region
        , orders.ship_country
)

, final_table as (
    select
        transformed_table.order_id
        , transformed_table.customer_id
        , transformed_table.employee_id
        , transformed_table.order_date
        , transformed_table.required_date
        , transformed_table.shipped_date
        , transformed_table.days_to_ship
        , transformed_table.shipper_name
        , transformed_table.total_order_amount
        , transformed_table.freight
        , transformed_table.ship_name
        , transformed_table.ship_address
        , transformed_table.ship_city
        , transformed_table.ship_region
        , transformed_table.ship_country
        , case 
            when transformed_table.days_to_ship is null then False
            else True
          end as is_shipped
    from transformed_table
)

select *
from final_table;


[0m21:29:49.737992 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m21:29:50.953217 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:107e706a-aeae-44f5-a814-f630aac466dd&page=queryresults
[0m21:29:55.783953 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '845fd243-ace5-40a3-8638-c74f4cc3893f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75a48baf20f0>]}
[0m21:29:55.785142 [info ] [Thread-1 (]: 1 of 1 OK created sql view model dbt_dw_intermediate.int_orders_northwind ...... [[32mCREATE VIEW (0 processed)[0m in 6.11s]
[0m21:29:55.786278 [debug] [Thread-1 (]: Finished running node model.dbt_exercise.int_orders_northwind
[0m21:29:55.789688 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m21:29:55.797526 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:29:55.798162 [debug] [MainThread]: Connection 'list_corded-sunlight-464012-e2_dbt_dw_raw' was properly closed.
[0m21:29:55.798819 [debug] [MainThread]: Connection 'list_corded-sunlight-464012-e2_dbt_dw_staging' was properly closed.
[0m21:29:55.799642 [debug] [MainThread]: Connection 'model.dbt_exercise.int_orders_northwind' was properly closed.
[0m21:29:55.800238 [info ] [MainThread]: 
[0m21:29:55.800925 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 8.02 seconds (8.02s).
[0m21:29:55.802183 [debug] [MainThread]: Command end result
[0m21:29:55.874250 [debug] [MainThread]: Wrote artifact WritableManifest to /home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/target/manifest.json
[0m21:29:55.887641 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/target/semantic_manifest.json
[0m21:29:55.895505 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/target/run_results.json
[0m21:29:55.896084 [info ] [MainThread]: 
[0m21:29:55.896792 [info ] [MainThread]: [32mCompleted successfully[0m
[0m21:29:55.897388 [info ] [MainThread]: 
[0m21:29:55.898049 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m21:29:55.898861 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- DuplicateYAMLKeysDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m21:29:55.904932 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 113.65932, "process_in_blocks": "140360", "process_kernel_time": 16.711267, "process_mem_max_rss": "366084", "process_out_blocks": "3432", "process_user_time": 12.03628}
[0m21:29:55.905835 [debug] [MainThread]: Command `dbt run` succeeded at 21:29:55.905628 after 113.66 seconds
[0m21:29:55.906558 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75a48ac1b7d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75a48c05cc80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75a44dc93ec0>]}
[0m21:29:55.907252 [debug] [MainThread]: Flushing usage events
[0m21:29:56.219216 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:59:18.145966 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eec72fecc50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eec7256daf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eec72f2a4e0>]}


============================== 09:59:18.150229 | cc31cd4b-17f8-4a7a-a4f3-b2766a528c15 ==============================
[0m09:59:18.150229 [info ] [MainThread]: Running with dbt=1.10.2
[0m09:59:18.150923 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/logs', 'version_check': 'True', 'profiles_dir': '/home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt ', 'send_anonymous_usage_stats': 'True'}
[0m09:59:18.152241 [warn ] [MainThread]: [[33mWARNING[0m][DuplicateYAMLKeysDeprecation]: Deprecated functionality
Duplicate key 'version' in "<unicode string>", line 4, column 1 in file
`/home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/dbt_project.yml`
[0m09:59:18.152852 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'cc31cd4b-17f8-4a7a-a4f3-b2766a528c15', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eec724f5b20>]}
[0m09:59:18.270281 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cc31cd4b-17f8-4a7a-a4f3-b2766a528c15', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eec720b6d80>]}
[0m09:59:18.310706 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-aanrxs5e'
[0m09:59:18.311145 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m09:59:18.621135 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m09:59:18.622704 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m09:59:18.693812 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m09:59:18.697557 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m09:59:19.142517 [info ] [MainThread]: Installed from version 1.3.0
[0m09:59:19.143326 [info ] [MainThread]: Up to date!
[0m09:59:19.144059 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'cc31cd4b-17f8-4a7a-a4f3-b2766a528c15', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eec720371d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eec720378f0>]}
[0m09:59:19.145600 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- DuplicateYAMLKeysDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m09:59:19.147362 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 1.0609177, "process_in_blocks": "392", "process_kernel_time": 0.354963, "process_mem_max_rss": "102768", "process_out_blocks": "2304", "process_user_time": 1.623261}
[0m09:59:19.148073 [debug] [MainThread]: Command `cli deps` succeeded at 09:59:19.147891 after 1.06 seconds
[0m09:59:19.148525 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eec72846a20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eec72701ee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eec71fdb8f0>]}
[0m09:59:19.149130 [debug] [MainThread]: Flushing usage events
[0m09:59:19.604848 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:52:58.275902 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x784b9310b2f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x784b9358a600>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x784b91545bb0>]}


============================== 10:52:58.291832 | 4342193a-f95d-4981-bd01-b06eade9ec34 ==============================
[0m10:52:58.291832 [info ] [MainThread]: Running with dbt=1.10.2
[0m10:52:58.292705 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt run -s int_shippers_northwind', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m10:54:08.476242 [warn ] [MainThread]: [[33mWARNING[0m][DuplicateYAMLKeysDeprecation]: Deprecated functionality
Duplicate key 'version' in "<unicode string>", line 4, column 1 in file
`/home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/dbt_project.yml`
[0m10:54:08.478366 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '4342193a-f95d-4981-bd01-b06eade9ec34', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x784b53e5e240>]}
[0m10:54:09.144886 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4342193a-f95d-4981-bd01-b06eade9ec34', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x784b5c929b20>]}
[0m10:54:09.199332 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4342193a-f95d-4981-bd01-b06eade9ec34', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x784b5400c4a0>]}
[0m10:54:09.203900 [info ] [MainThread]: Registered adapter: bigquery=1.9.2
[0m10:54:51.899692 [debug] [MainThread]: checksum: 1adc40777973ef30f45f80b3b6d04d5013c1edd53d96363881b3b199e612468b, vars: {}, profile: , target: , version: 1.10.2
[0m10:54:57.802159 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m10:54:57.802613 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m10:54:57.848878 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4342193a-f95d-4981-bd01-b06eade9ec34', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x784b53dac1d0>]}
[0m10:54:58.144679 [debug] [MainThread]: Wrote artifact WritableManifest to /home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/target/manifest.json
[0m10:54:58.178232 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/target/semantic_manifest.json
[0m10:54:58.835943 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4342193a-f95d-4981-bd01-b06eade9ec34', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x784b53edde50>]}
[0m10:54:58.836486 [info ] [MainThread]: Found 14 seeds, 31 data tests, 18 models, 14 sources, 609 macros
[0m10:54:58.836849 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4342193a-f95d-4981-bd01-b06eade9ec34', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x784b90d91340>]}
[0m10:54:58.838467 [info ] [MainThread]: 
[0m10:54:58.838974 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m10:54:58.839407 [info ] [MainThread]: 
[0m10:54:58.840027 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m10:54:58.841397 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_corded-sunlight-464012-e2'
[0m10:54:58.841986 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:54:59.689058 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_corded-sunlight-464012-e2, now list_corded-sunlight-464012-e2_dbt_dw_marts)
[0m10:54:59.690575 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_corded-sunlight-464012-e2_dbt_dw_intermediate'
[0m10:54:59.691250 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:54:59.692361 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_corded-sunlight-464012-e2_dbt_dw_staging'
[0m10:54:59.692721 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:54:59.693839 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_corded-sunlight-464012-e2_dbt_dw_raw'
[0m10:54:59.695429 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:54:59.696327 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:55:00.656010 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4342193a-f95d-4981-bd01-b06eade9ec34', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x784b935e1f70>]}
[0m10:55:00.656650 [debug] [MainThread]: Opening a new connection, currently in state init
[0m10:55:00.670739 [debug] [Thread-1 (]: Began running node model.dbt_exercise.int_shippers_northwind
[0m10:55:00.671482 [info ] [Thread-1 (]: 1 of 1 START sql view model dbt_dw_intermediate.int_shippers_northwind ......... [RUN]
[0m10:55:00.672003 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_corded-sunlight-464012-e2_dbt_dw_marts, now model.dbt_exercise.int_shippers_northwind)
[0m10:55:00.672377 [debug] [Thread-1 (]: Began compiling node model.dbt_exercise.int_shippers_northwind
[0m10:55:00.680518 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_exercise.int_shippers_northwind"
[0m10:55:00.683513 [debug] [Thread-1 (]: Began executing node model.dbt_exercise.int_shippers_northwind
[0m10:55:00.712067 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_exercise.int_shippers_northwind"
[0m10:55:00.714605 [debug] [Thread-1 (]: On model.dbt_exercise.int_shippers_northwind: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "model.dbt_exercise.int_shippers_northwind"} */


  create or replace view `corded-sunlight-464012-e2`.`dbt_dw_intermediate`.`int_shippers_northwind`
  OPTIONS()
  as with shippers as (
    select *
    from `corded-sunlight-464012-e2`.`dbt_dw_staging`.`stg_shippers_northwind`
)

, orders as (
    select *
    from `corded-sunlight-464012-e2`.`dbt_dw_staging`.`stg_orders_northwind`
)

, transformed_table as (
    select
        shippers.shipper_id
        , shippers.company_name
        , orders.ship_address
        , orders.ship_city
        , orders.ship_region
        , orders.ship_country
        , case
            when orders.ship_country in ('USA', 'Canada', 'Mexico') then 'North America'
            when orders.ship_country in ('UK', 'France', 'Germany', 'Austria', 'Belgium', 
            'Denmark', 'Ireland', 'Finland', 'Italy', 'Norway', 'Poland', 'Portugal', 'Spain', 'Sweden', 'Switzerland') then 'Europe'
            when orders.ship_country in ('Brazil', 'Argentina', 'Venezuela') then 'South America'
            else 'Other'
        end as ship_continent
    from shippers
    left join orders
        on shippers.shipper_id = orders.ship_via
)

/* Aqui é feita a deduplicação da transformed_table */
, final_table as (
    select distinct *
    from transformed_table
)

select *
from final_table;


[0m10:55:00.715201 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:55:01.961675 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:451607f6-9f11-4e8e-94b8-5da379144c10&page=queryresults
[0m10:55:12.203394 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4342193a-f95d-4981-bd01-b06eade9ec34', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x784b5c92a3c0>]}
[0m10:55:12.204407 [info ] [Thread-1 (]: 1 of 1 OK created sql view model dbt_dw_intermediate.int_shippers_northwind .... [[32mCREATE VIEW (0 processed)[0m in 11.51s]
[0m10:55:12.205158 [debug] [Thread-1 (]: Finished running node model.dbt_exercise.int_shippers_northwind
[0m10:55:12.208676 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m10:55:12.213673 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:55:12.214252 [debug] [MainThread]: Connection 'model.dbt_exercise.int_shippers_northwind' was properly closed.
[0m10:55:12.214554 [debug] [MainThread]: Connection 'list_corded-sunlight-464012-e2_dbt_dw_intermediate' was properly closed.
[0m10:55:12.214871 [debug] [MainThread]: Connection 'list_corded-sunlight-464012-e2_dbt_dw_staging' was properly closed.
[0m10:55:12.215167 [debug] [MainThread]: Connection 'list_corded-sunlight-464012-e2_dbt_dw_raw' was properly closed.
[0m10:55:12.215454 [info ] [MainThread]: 
[0m10:55:12.215834 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 13.38 seconds (13.38s).
[0m10:55:12.216488 [debug] [MainThread]: Command end result
[0m10:55:12.256691 [debug] [MainThread]: Wrote artifact WritableManifest to /home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/target/manifest.json
[0m10:55:12.266442 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/target/semantic_manifest.json
[0m10:55:12.271593 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/target/run_results.json
[0m10:55:12.272013 [info ] [MainThread]: 
[0m10:55:12.272415 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:55:12.272809 [info ] [MainThread]: 
[0m10:55:12.273204 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m10:55:12.273738 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- DuplicateYAMLKeysDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m10:55:12.277786 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 123.35181, "process_in_blocks": "128744", "process_kernel_time": 13.082499, "process_mem_max_rss": "366128", "process_out_blocks": "3472", "process_user_time": 10.092604}
[0m10:55:12.278451 [debug] [MainThread]: Command `dbt run` succeeded at 10:55:12.278328 after 123.35 seconds
[0m10:55:12.278796 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x784b90f6bbc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x784b53ed7110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x784b91ca0500>]}
[0m10:55:12.279202 [debug] [MainThread]: Flushing usage events
[0m10:55:12.613760 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m11:54:15.018455 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e3d1e6b0dd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e3d207e6090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e3d1ecc50a0>]}


============================== 11:54:15.051715 | 027029f9-fc94-45e4-a805-a17ebe3f13e9 ==============================
[0m11:54:15.051715 [info ] [MainThread]: Running with dbt=1.10.2
[0m11:54:15.052648 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run -s int_shippers_northwind', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m11:55:21.661254 [warn ] [MainThread]: [[33mWARNING[0m][DuplicateYAMLKeysDeprecation]: Deprecated functionality
Duplicate key 'version' in "<unicode string>", line 4, column 1 in file
`/home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/dbt_project.yml`
[0m11:55:21.663725 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '027029f9-fc94-45e4-a805-a17ebe3f13e9', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e3d1dd76870>]}
[0m11:55:22.312672 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '027029f9-fc94-45e4-a805-a17ebe3f13e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e3ce0bdfa10>]}
[0m11:55:22.371248 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '027029f9-fc94-45e4-a805-a17ebe3f13e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e3d1e760140>]}
[0m11:55:22.374462 [info ] [MainThread]: Registered adapter: bigquery=1.9.2
[0m11:56:08.092410 [debug] [MainThread]: checksum: 1adc40777973ef30f45f80b3b6d04d5013c1edd53d96363881b3b199e612468b, vars: {}, profile: , target: , version: 1.10.2
[0m11:56:13.428690 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:56:13.429124 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:56:13.473069 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '027029f9-fc94-45e4-a805-a17ebe3f13e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e3ce0c48110>]}
[0m11:56:13.721175 [debug] [MainThread]: Wrote artifact WritableManifest to /home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/target/manifest.json
[0m11:56:13.733900 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/target/semantic_manifest.json
[0m11:56:14.329393 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '027029f9-fc94-45e4-a805-a17ebe3f13e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e3ce0d1ba70>]}
[0m11:56:14.330056 [info ] [MainThread]: Found 14 seeds, 31 data tests, 18 models, 14 sources, 609 macros
[0m11:56:14.330593 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '027029f9-fc94-45e4-a805-a17ebe3f13e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e3ce0cbbfe0>]}
[0m11:56:14.332497 [info ] [MainThread]: 
[0m11:56:14.333073 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m11:56:14.333444 [info ] [MainThread]: 
[0m11:56:14.334238 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m11:56:14.335652 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_corded-sunlight-464012-e2'
[0m11:56:14.336142 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:56:15.153880 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_corded-sunlight-464012-e2, now list_corded-sunlight-464012-e2_dbt_dw_marts)
[0m11:56:15.155177 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_corded-sunlight-464012-e2_dbt_dw_intermediate'
[0m11:56:15.155639 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:56:15.157086 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_corded-sunlight-464012-e2_dbt_dw_raw'
[0m11:56:15.157467 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:56:15.158598 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_corded-sunlight-464012-e2_dbt_dw_staging'
[0m11:56:15.159867 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:56:15.160848 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:56:17.180432 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '027029f9-fc94-45e4-a805-a17ebe3f13e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e3ce0e47fb0>]}
[0m11:56:17.181053 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:56:17.191560 [debug] [Thread-1 (]: Began running node model.dbt_exercise.int_shippers_northwind
[0m11:56:17.192234 [info ] [Thread-1 (]: 1 of 1 START sql view model dbt_dw_intermediate.int_shippers_northwind ......... [RUN]
[0m11:56:17.192707 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_corded-sunlight-464012-e2_dbt_dw_marts, now model.dbt_exercise.int_shippers_northwind)
[0m11:56:17.193007 [debug] [Thread-1 (]: Began compiling node model.dbt_exercise.int_shippers_northwind
[0m11:56:17.200577 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_exercise.int_shippers_northwind"
[0m11:56:17.203165 [debug] [Thread-1 (]: Began executing node model.dbt_exercise.int_shippers_northwind
[0m11:56:17.235765 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_exercise.int_shippers_northwind"
[0m11:56:17.237682 [debug] [Thread-1 (]: On model.dbt_exercise.int_shippers_northwind: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "model.dbt_exercise.int_shippers_northwind"} */


  create or replace view `corded-sunlight-464012-e2`.`dbt_dw_intermediate`.`int_shippers_northwind`
  OPTIONS()
  as with shippers as (
    select *
    from `corded-sunlight-464012-e2`.`dbt_dw_staging`.`stg_shippers_northwind`
)

, orders as (
    select *
    from `corded-sunlight-464012-e2`.`dbt_dw_staging`.`stg_orders_northwind`
)

, transformed_table as (
    select
        concat(
            coalesce(shippers.shipper_id, '')
            , '-'
            , coalesce(shippers.company_name, '')
            , '-'
            , coalesce(orders.ship_address, '')
        ) as ship_id
        , shippers.shipper_id
        , shippers.company_name
        , orders.ship_address
        , orders.ship_city
        , orders.ship_region
        , orders.ship_country
    from shippers
    left join orders
        on shippers.shipper_id = orders.ship_via
)

/* Aqui é feita a deduplicação da transformed_table */
, dedup_table as (
    select distinct *
    from transformed_table
)

, final_table as (
    select 
        *
        , case
            when dedup_table.ship_country in ('USA', 'Canada', 'Mexico') then 'North America'
            when dedup_table.ship_country in ('UK', 'France', 'Germany', 'Austria', 'Belgium', 
            'Denmark', 'Ireland', 'Finland', 'Italy', 'Norway', 'Poland', 'Portugal', 'Spain', 'Sweden', 'Switzerland') then 'Europe'
            when dedup_table.ship_country in ('Brazil', 'Argentina', 'Venezuela') then 'South America'
            else 'Other'
        end as ship_continent
    from dedup_table
)

select *
from final_table;


[0m11:56:17.238552 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:56:18.359118 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:48f539a4-88b4-49c9-b9e7-67fdf7c2bd7b&page=queryresults
[0m11:56:28.419127 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '027029f9-fc94-45e4-a805-a17ebe3f13e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e3ce05bc410>]}
[0m11:56:28.419941 [info ] [Thread-1 (]: 1 of 1 OK created sql view model dbt_dw_intermediate.int_shippers_northwind .... [[32mCREATE VIEW (0 processed)[0m in 11.21s]
[0m11:56:28.420745 [debug] [Thread-1 (]: Finished running node model.dbt_exercise.int_shippers_northwind
[0m11:56:28.423457 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m11:56:28.429351 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:56:28.429886 [debug] [MainThread]: Connection 'model.dbt_exercise.int_shippers_northwind' was properly closed.
[0m11:56:28.430209 [debug] [MainThread]: Connection 'list_corded-sunlight-464012-e2_dbt_dw_intermediate' was properly closed.
[0m11:56:28.430476 [debug] [MainThread]: Connection 'list_corded-sunlight-464012-e2_dbt_dw_raw' was properly closed.
[0m11:56:28.430782 [debug] [MainThread]: Connection 'list_corded-sunlight-464012-e2_dbt_dw_staging' was properly closed.
[0m11:56:28.431141 [info ] [MainThread]: 
[0m11:56:28.431541 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 14.10 seconds (14.10s).
[0m11:56:28.432329 [debug] [MainThread]: Command end result
[0m11:56:28.474415 [debug] [MainThread]: Wrote artifact WritableManifest to /home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/target/manifest.json
[0m11:56:28.485526 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/target/semantic_manifest.json
[0m11:56:28.490210 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/target/run_results.json
[0m11:56:28.490574 [info ] [MainThread]: 
[0m11:56:28.490994 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:56:28.491301 [info ] [MainThread]: 
[0m11:56:28.491624 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m11:56:28.492202 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- DuplicateYAMLKeysDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m11:56:28.498595 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 121.86531, "process_in_blocks": "143824", "process_kernel_time": 14.105837, "process_mem_max_rss": "366432", "process_out_blocks": "3480", "process_user_time": 10.312069}
[0m11:56:28.499311 [debug] [MainThread]: Command `dbt run` succeeded at 11:56:28.499161 after 121.87 seconds
[0m11:56:28.499789 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e3d1e5bf8c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e3d1ec30bc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e3ce05cb3e0>]}
[0m11:56:28.500387 [debug] [MainThread]: Flushing usage events
[0m11:56:28.931161 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m12:20:19.950306 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x752a9780cda0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x752a95dc7740>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x752a95dc4650>]}


============================== 12:20:19.967268 | 7d0d33a9-0f91-41a2-95f0-8e84dcd60088 ==============================
[0m12:20:19.967268 [info ] [MainThread]: Running with dbt=1.10.2
[0m12:20:19.967845 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise', 'log_path': '/home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'invocation_command': 'dbt run', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m12:21:06.235696 [warn ] [MainThread]: [[33mWARNING[0m][DuplicateYAMLKeysDeprecation]: Deprecated functionality
Duplicate key 'version' in "<unicode string>", line 4, column 1 in file
`/home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/dbt_project.yml`
[0m12:21:06.236502 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '7d0d33a9-0f91-41a2-95f0-8e84dcd60088', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x752a57e4dfd0>]}
[0m12:21:06.846916 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7d0d33a9-0f91-41a2-95f0-8e84dcd60088', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x752a57eb7a40>]}
[0m12:21:06.896462 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7d0d33a9-0f91-41a2-95f0-8e84dcd60088', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x752a588d8ce0>]}
[0m12:21:06.901472 [info ] [MainThread]: Registered adapter: bigquery=1.9.2
[0m12:21:51.676335 [debug] [MainThread]: checksum: 1adc40777973ef30f45f80b3b6d04d5013c1edd53d96363881b3b199e612468b, vars: {}, profile: , target: , version: 1.10.2
[0m12:21:58.822293 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:21:58.822717 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:21:58.866032 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7d0d33a9-0f91-41a2-95f0-8e84dcd60088', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x752a57cf7230>]}
[0m12:21:59.136572 [debug] [MainThread]: Wrote artifact WritableManifest to /home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/target/manifest.json
[0m12:21:59.147697 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/target/semantic_manifest.json
[0m12:21:59.493871 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7d0d33a9-0f91-41a2-95f0-8e84dcd60088', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x752a57ded460>]}
[0m12:21:59.494411 [info ] [MainThread]: Found 14 seeds, 31 data tests, 18 models, 14 sources, 609 macros
[0m12:21:59.494856 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7d0d33a9-0f91-41a2-95f0-8e84dcd60088', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x752a57810470>]}
[0m12:21:59.497318 [info ] [MainThread]: 
[0m12:21:59.497786 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m12:21:59.498115 [info ] [MainThread]: 
[0m12:21:59.498650 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m12:21:59.503540 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_corded-sunlight-464012-e2'
[0m12:21:59.504727 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:21:59.505460 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_corded-sunlight-464012-e2'
[0m12:21:59.506412 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:22:00.638429 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_corded-sunlight-464012-e2, now list_corded-sunlight-464012-e2_dbt_dw_raw)
[0m12:22:00.639579 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:22:00.640445 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_corded-sunlight-464012-e2, now list_corded-sunlight-464012-e2_dbt_dw_marts)
[0m12:22:00.642046 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_corded-sunlight-464012-e2_dbt_dw_staging'
[0m12:22:00.643304 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:22:00.644266 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_corded-sunlight-464012-e2_dbt_dw_intermediate'
[0m12:22:00.645191 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:22:00.646271 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:22:01.670410 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7d0d33a9-0f91-41a2-95f0-8e84dcd60088', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x752a578895b0>]}
[0m12:22:01.671261 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:22:01.687843 [debug] [Thread-1 (]: Began running node model.dbt_exercise.stg_categories_northwind
[0m12:22:01.688941 [debug] [Thread-2 (]: Began running node model.dbt_exercise.stg_customers_northwind
[0m12:22:01.689883 [info ] [Thread-1 (]: 1 of 17 START sql view model dbt_dw_staging.stg_categories_northwind ........... [RUN]
[0m12:22:01.690698 [debug] [Thread-3 (]: Began running node model.dbt_exercise.stg_employee_territories
[0m12:22:01.691782 [debug] [Thread-4 (]: Began running node model.dbt_exercise.stg_employees_northwind
[0m12:22:01.691449 [info ] [Thread-2 (]: 2 of 17 START sql view model dbt_dw_staging.stg_customers_northwind ............ [RUN]
[0m12:22:01.693035 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_corded-sunlight-464012-e2_dbt_dw_marts, now model.dbt_exercise.stg_categories_northwind)
[0m12:22:01.693985 [info ] [Thread-3 (]: 3 of 17 START sql view model dbt_dw_staging.stg_employee_territories ........... [RUN]
[0m12:22:01.694850 [info ] [Thread-4 (]: 4 of 17 START sql view model dbt_dw_staging.stg_employees_northwind ............ [RUN]
[0m12:22:01.695734 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_corded-sunlight-464012-e2_dbt_dw_staging, now model.dbt_exercise.stg_customers_northwind)
[0m12:22:01.696774 [debug] [Thread-1 (]: Began compiling node model.dbt_exercise.stg_categories_northwind
[0m12:22:01.697878 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_corded-sunlight-464012-e2_dbt_dw_intermediate, now model.dbt_exercise.stg_employee_territories)
[0m12:22:01.698859 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly list_corded-sunlight-464012-e2_dbt_dw_raw, now model.dbt_exercise.stg_employees_northwind)
[0m12:22:01.700010 [debug] [Thread-2 (]: Began compiling node model.dbt_exercise.stg_customers_northwind
[0m12:22:01.710067 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_exercise.stg_categories_northwind"
[0m12:22:01.711085 [debug] [Thread-3 (]: Began compiling node model.dbt_exercise.stg_employee_territories
[0m12:22:01.711813 [debug] [Thread-4 (]: Began compiling node model.dbt_exercise.stg_employees_northwind
[0m12:22:01.716873 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_exercise.stg_customers_northwind"
[0m12:22:01.721696 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_exercise.stg_employee_territories"
[0m12:22:01.726886 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_exercise.stg_employees_northwind"
[0m12:22:01.729216 [debug] [Thread-1 (]: Began executing node model.dbt_exercise.stg_categories_northwind
[0m12:22:01.737804 [debug] [Thread-2 (]: Began executing node model.dbt_exercise.stg_customers_northwind
[0m12:22:01.767060 [debug] [Thread-4 (]: Began executing node model.dbt_exercise.stg_employees_northwind
[0m12:22:01.786715 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_exercise.stg_employees_northwind"
[0m12:22:01.787389 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_exercise.stg_categories_northwind"
[0m12:22:01.790760 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_exercise.stg_customers_northwind"
[0m12:22:01.792771 [debug] [Thread-3 (]: Began executing node model.dbt_exercise.stg_employee_territories
[0m12:22:01.793641 [debug] [Thread-1 (]: On model.dbt_exercise.stg_categories_northwind: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "model.dbt_exercise.stg_categories_northwind"} */


  create or replace view `corded-sunlight-464012-e2`.`dbt_dw_staging`.`stg_categories_northwind`
  OPTIONS()
  as with categories as (
    select *
    from `corded-sunlight-464012-e2`.`dbt_dw_raw`.`categories`
)

/* Ao construir a staging não vamos trazer a coluna picture, pois ela não traz informação relevante */
select
    cast(category_id as string) as category_id
    , cast(category_name as string) as category_name
    , cast(description as string) as description
from categories;


[0m12:22:01.794340 [debug] [Thread-4 (]: On model.dbt_exercise.stg_employees_northwind: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "model.dbt_exercise.stg_employees_northwind"} */


  create or replace view `corded-sunlight-464012-e2`.`dbt_dw_staging`.`stg_employees_northwind`
  OPTIONS()
  as with employees as (
    select *
    from `corded-sunlight-464012-e2`.`dbt_dw_raw`.`employees`
)

/* Os campos photo, notes e reports_to e photo_path não são carregadas na staging */
select
    cast(employee_id as string) as employee_id
    , cast(first_name as string) as first_name
    , cast(last_name as string) as last_name
    , cast(title as string) as title
    , cast(title_of_courtesy as string) as title_of_courtesy
    , cast(birth_date as date) as birth_date
    , cast(hire_date as date) as hire_date
    , cast(address as string) as address
    , cast(city as string) as city
    , cast(region as string) as region
    , cast(postal_code as string) as postal_code
    , cast(country as string) as country
    , cast(home_phone as string) as home_phone
    , cast(extension as string) as extension
from employees;


[0m12:22:01.798879 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_exercise.stg_employee_territories"
[0m12:22:01.800170 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:22:01.801103 [debug] [Thread-2 (]: On model.dbt_exercise.stg_customers_northwind: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "model.dbt_exercise.stg_customers_northwind"} */


  create or replace view `corded-sunlight-464012-e2`.`dbt_dw_staging`.`stg_customers_northwind`
  OPTIONS()
  as with customers as (
    select *
    from `corded-sunlight-464012-e2`.`dbt_dw_raw`.`customers`
)

select
    cast(customer_id as string) as customer_id
    , cast(company_name as string) as company_name
    , cast(contact_name as string) as contact_name
    , cast(contact_title as string) as contact_title
    , cast(address as string) as address
    , cast(city as string) as city
    , cast(region as string) as region
    , cast(postal_code as string) as postal_code
    , cast(country as string) as country
    , cast(phone as string) as phone
    , cast(fax as string) as fax
from customers;


[0m12:22:01.801833 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m12:22:01.803655 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m12:22:01.804748 [debug] [Thread-3 (]: On model.dbt_exercise.stg_employee_territories: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "model.dbt_exercise.stg_employee_territories"} */


  create or replace view `corded-sunlight-464012-e2`.`dbt_dw_staging`.`stg_employee_territories`
  OPTIONS()
  as with employee_territories as (
    select *
    from `corded-sunlight-464012-e2`.`dbt_dw_raw`.`employee_territories`
)

select
    cast(employee_id as string) as employee_id
    , cast(territory_id as string) as territory_id
from employee_territories;


[0m12:22:01.805682 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m12:22:02.923238 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:0d16d209-5a44-441b-9f62-173b822d7e9f&page=queryresults
[0m12:22:02.924960 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:4645f4e9-a7f5-47a2-863e-c9cc0075ecad&page=queryresults
[0m12:22:02.972135 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:0a3c6f33-52a0-4269-9376-9da428a5f0f6&page=queryresults
[0m12:22:03.004721 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:dbcb21b5-63f2-4fc0-99c1-3ef9b7a47935&page=queryresults
[0m12:22:07.430187 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7d0d33a9-0f91-41a2-95f0-8e84dcd60088', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x752a95bf9c70>]}
[0m12:22:07.431212 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7d0d33a9-0f91-41a2-95f0-8e84dcd60088', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x752a98eef140>]}
[0m12:22:07.432676 [info ] [Thread-4 (]: 4 of 17 OK created sql view model dbt_dw_staging.stg_employees_northwind ....... [[32mCREATE VIEW (0 processed)[0m in 5.72s]
[0m12:22:07.433625 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7d0d33a9-0f91-41a2-95f0-8e84dcd60088', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x752a54432de0>]}
[0m12:22:07.434243 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7d0d33a9-0f91-41a2-95f0-8e84dcd60088', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x752a57cd2030>]}
[0m12:22:07.435115 [info ] [Thread-1 (]: 1 of 17 OK created sql view model dbt_dw_staging.stg_categories_northwind ...... [[32mCREATE VIEW (0 processed)[0m in 5.73s]
[0m12:22:07.436274 [debug] [Thread-4 (]: Finished running node model.dbt_exercise.stg_employees_northwind
[0m12:22:07.437452 [info ] [Thread-3 (]: 3 of 17 OK created sql view model dbt_dw_staging.stg_employee_territories ...... [[32mCREATE VIEW (0 processed)[0m in 5.72s]
[0m12:22:07.438677 [info ] [Thread-2 (]: 2 of 17 OK created sql view model dbt_dw_staging.stg_customers_northwind ....... [[32mCREATE VIEW (0 processed)[0m in 5.73s]
[0m12:22:07.439759 [debug] [Thread-1 (]: Finished running node model.dbt_exercise.stg_categories_northwind
[0m12:22:07.440804 [debug] [Thread-4 (]: Began running node model.dbt_exercise.stg_order_details_northwind
[0m12:22:07.442014 [debug] [Thread-3 (]: Finished running node model.dbt_exercise.stg_employee_territories
[0m12:22:07.442906 [debug] [Thread-2 (]: Finished running node model.dbt_exercise.stg_customers_northwind
[0m12:22:07.443592 [debug] [Thread-1 (]: Began running node model.dbt_exercise.stg_orders_northwind
[0m12:22:07.444417 [info ] [Thread-4 (]: 5 of 17 START sql view model dbt_dw_staging.stg_order_details_northwind ........ [RUN]
[0m12:22:07.445511 [debug] [Thread-3 (]: Began running node model.dbt_exercise.stg_products_northwind
[0m12:22:07.446635 [debug] [Thread-2 (]: Began running node model.dbt_exercise.stg_region_northwind
[0m12:22:07.448945 [info ] [Thread-1 (]: 6 of 17 START sql view model dbt_dw_staging.stg_orders_northwind ............... [RUN]
[0m12:22:07.450463 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.dbt_exercise.stg_employees_northwind, now model.dbt_exercise.stg_order_details_northwind)
[0m12:22:07.451703 [info ] [Thread-3 (]: 7 of 17 START sql view model dbt_dw_staging.stg_products_northwind ............. [RUN]
[0m12:22:07.453585 [info ] [Thread-2 (]: 8 of 17 START sql view model dbt_dw_staging.stg_region_northwind ............... [RUN]
[0m12:22:07.454947 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_exercise.stg_categories_northwind, now model.dbt_exercise.stg_orders_northwind)
[0m12:22:07.455993 [debug] [Thread-4 (]: Began compiling node model.dbt_exercise.stg_order_details_northwind
[0m12:22:07.457040 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_exercise.stg_employee_territories, now model.dbt_exercise.stg_products_northwind)
[0m12:22:07.457716 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_exercise.stg_customers_northwind, now model.dbt_exercise.stg_region_northwind)
[0m12:22:07.458493 [debug] [Thread-1 (]: Began compiling node model.dbt_exercise.stg_orders_northwind
[0m12:22:07.462415 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_exercise.stg_order_details_northwind"
[0m12:22:07.464185 [debug] [Thread-3 (]: Began compiling node model.dbt_exercise.stg_products_northwind
[0m12:22:07.465785 [debug] [Thread-2 (]: Began compiling node model.dbt_exercise.stg_region_northwind
[0m12:22:07.470069 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_exercise.stg_orders_northwind"
[0m12:22:07.474496 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_exercise.stg_products_northwind"
[0m12:22:07.478590 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_exercise.stg_region_northwind"
[0m12:22:07.480830 [debug] [Thread-4 (]: Began executing node model.dbt_exercise.stg_order_details_northwind
[0m12:22:07.482908 [debug] [Thread-3 (]: Began executing node model.dbt_exercise.stg_products_northwind
[0m12:22:07.486877 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_exercise.stg_order_details_northwind"
[0m12:22:07.487758 [debug] [Thread-1 (]: Began executing node model.dbt_exercise.stg_orders_northwind
[0m12:22:07.490941 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_exercise.stg_products_northwind"
[0m12:22:07.491440 [debug] [Thread-2 (]: Began executing node model.dbt_exercise.stg_region_northwind
[0m12:22:07.500299 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_exercise.stg_orders_northwind"
[0m12:22:07.501079 [debug] [Thread-4 (]: On model.dbt_exercise.stg_order_details_northwind: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "model.dbt_exercise.stg_order_details_northwind"} */


  create or replace view `corded-sunlight-464012-e2`.`dbt_dw_staging`.`stg_order_details_northwind`
  OPTIONS()
  as with order_details as (
    select *
    from `corded-sunlight-464012-e2`.`dbt_dw_raw`.`order_details`
)

select
    cast(order_id as string) as order_id
    , cast(product_id as string) as product_id
    , cast(unit_price as numeric) as unit_price
    , cast(quantity as integer) as quantity
    , cast(discount as numeric) as discount
from order_details;


[0m12:22:07.503723 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_exercise.stg_region_northwind"
[0m12:22:07.505735 [debug] [Thread-3 (]: On model.dbt_exercise.stg_products_northwind: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "model.dbt_exercise.stg_products_northwind"} */


  create or replace view `corded-sunlight-464012-e2`.`dbt_dw_staging`.`stg_products_northwind`
  OPTIONS()
  as with products as (
    select *
    from `corded-sunlight-464012-e2`.`dbt_dw_raw`.`products`
)

select
    cast(product_id as string) as product_id
    , cast(product_name as string) as product_name
    , cast(supplier_id as string) as supplier_id
    , cast(category_id as string) as category_id
    , cast(quantity_per_unit as string) as quantity_per_unit
    , cast(unit_price as numeric) as unit_price
    , cast(units_in_stock as numeric) as units_in_stock
    , cast(units_on_order as numeric) as units_on_order
    , cast(reorder_level as numeric) as reorder_level
    , cast(discontinued as boolean) as discontinued
from products;


[0m12:22:07.506436 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m12:22:07.508270 [debug] [Thread-1 (]: On model.dbt_exercise.stg_orders_northwind: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "model.dbt_exercise.stg_orders_northwind"} */


  create or replace view `corded-sunlight-464012-e2`.`dbt_dw_staging`.`stg_orders_northwind`
  OPTIONS()
  as with orders as (
    select *
    from `corded-sunlight-464012-e2`.`dbt_dw_raw`.`orders`
)

select
    cast(order_id as string) as order_id
    , cast(customer_id as string) as customer_id
    , cast(employee_id as string) as employee_id
    , cast(order_date as date) as order_date
    , cast(required_date as date) as required_date
    , cast(shipped_date as date) as shipped_date
    , cast(ship_via as string) as ship_via
    , cast(freight as numeric) as freight
    , cast(ship_name as string) as ship_name
    , cast(ship_address as string) as ship_address
    , cast(ship_city as string) as ship_city
    , cast(ship_region as string) as ship_region
    , cast(ship_postal_code as string) as ship_postal_code
    , cast(ship_country as string) as ship_country
from orders;


[0m12:22:07.509746 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m12:22:07.512711 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:22:07.513687 [debug] [Thread-2 (]: On model.dbt_exercise.stg_region_northwind: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "model.dbt_exercise.stg_region_northwind"} */


  create or replace view `corded-sunlight-464012-e2`.`dbt_dw_staging`.`stg_region_northwind`
  OPTIONS()
  as with region as (
    select *
    from `corded-sunlight-464012-e2`.`dbt_dw_raw`.`region`
)

select 
    cast(region_id as string) as region_id
    , cast(region_description as string) as region_description
from region;


[0m12:22:07.515557 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m12:22:08.468854 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:125b5809-651a-4b9d-8a9a-24d586c14aa1&page=queryresults
[0m12:22:08.487649 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:25e6aff1-8006-4566-baef-d6d6c3450df8&page=queryresults
[0m12:22:08.528146 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:da47f43c-274b-4735-a836-37b4c75ae684&page=queryresults
[0m12:22:08.566128 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:a89ef55d-269e-4790-93bd-7bc65a4e8fcc&page=queryresults
[0m12:22:09.047774 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7d0d33a9-0f91-41a2-95f0-8e84dcd60088', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x752a5436cfe0>]}
[0m12:22:09.048620 [info ] [Thread-1 (]: 6 of 17 OK created sql view model dbt_dw_staging.stg_orders_northwind .......... [[32mCREATE VIEW (0 processed)[0m in 1.59s]
[0m12:22:09.049249 [debug] [Thread-1 (]: Finished running node model.dbt_exercise.stg_orders_northwind
[0m12:22:09.049727 [debug] [Thread-1 (]: Began running node model.dbt_exercise.stg_shippers_northwind
[0m12:22:09.051049 [info ] [Thread-1 (]: 9 of 17 START sql view model dbt_dw_staging.stg_shippers_northwind ............. [RUN]
[0m12:22:09.051846 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_exercise.stg_orders_northwind, now model.dbt_exercise.stg_shippers_northwind)
[0m12:22:09.052358 [debug] [Thread-1 (]: Began compiling node model.dbt_exercise.stg_shippers_northwind
[0m12:22:09.056231 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_exercise.stg_shippers_northwind"
[0m12:22:09.057791 [debug] [Thread-1 (]: Began executing node model.dbt_exercise.stg_shippers_northwind
[0m12:22:09.060279 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_exercise.stg_shippers_northwind"
[0m12:22:09.061159 [debug] [Thread-1 (]: On model.dbt_exercise.stg_shippers_northwind: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "model.dbt_exercise.stg_shippers_northwind"} */


  create or replace view `corded-sunlight-464012-e2`.`dbt_dw_staging`.`stg_shippers_northwind`
  OPTIONS()
  as with shippers as (
    select *
    from `corded-sunlight-464012-e2`.`dbt_dw_raw`.`shippers`
)

select
    cast(shipper_id as string) as shipper_id
    , cast(company_name as string) as company_name
    , cast(phone as string) as phone
from shippers;


[0m12:22:09.061697 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:22:09.096525 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7d0d33a9-0f91-41a2-95f0-8e84dcd60088', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x752a5420d520>]}
[0m12:22:09.098672 [info ] [Thread-3 (]: 7 of 17 OK created sql view model dbt_dw_staging.stg_products_northwind ........ [[32mCREATE VIEW (0 processed)[0m in 1.64s]
[0m12:22:09.104736 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7d0d33a9-0f91-41a2-95f0-8e84dcd60088', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x752a54433890>]}
[0m12:22:09.106088 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7d0d33a9-0f91-41a2-95f0-8e84dcd60088', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x752a54432db0>]}
[0m12:22:09.106802 [debug] [Thread-3 (]: Finished running node model.dbt_exercise.stg_products_northwind
[0m12:22:09.107888 [info ] [Thread-2 (]: 8 of 17 OK created sql view model dbt_dw_staging.stg_region_northwind .......... [[32mCREATE VIEW (0 processed)[0m in 1.65s]
[0m12:22:09.109154 [info ] [Thread-4 (]: 5 of 17 OK created sql view model dbt_dw_staging.stg_order_details_northwind ... [[32mCREATE VIEW (0 processed)[0m in 1.66s]
[0m12:22:09.110200 [debug] [Thread-3 (]: Began running node model.dbt_exercise.stg_suppliers_northwind
[0m12:22:09.111369 [debug] [Thread-2 (]: Finished running node model.dbt_exercise.stg_region_northwind
[0m12:22:09.112469 [debug] [Thread-4 (]: Finished running node model.dbt_exercise.stg_order_details_northwind
[0m12:22:09.113349 [info ] [Thread-3 (]: 10 of 17 START sql view model dbt_dw_staging.stg_suppliers_northwind ........... [RUN]
[0m12:22:09.114487 [debug] [Thread-2 (]: Began running node model.dbt_exercise.stg_territories_northwind
[0m12:22:09.115425 [debug] [Thread-4 (]: Began running node model.dbt_exercise.stg_us_states_northwind
[0m12:22:09.116703 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_exercise.stg_products_northwind, now model.dbt_exercise.stg_suppliers_northwind)
[0m12:22:09.117632 [info ] [Thread-2 (]: 11 of 17 START sql view model dbt_dw_staging.stg_territories_northwind ......... [RUN]
[0m12:22:09.118596 [info ] [Thread-4 (]: 12 of 17 START sql view model dbt_dw_staging.stg_us_states_northwind ........... [RUN]
[0m12:22:09.119262 [debug] [Thread-3 (]: Began compiling node model.dbt_exercise.stg_suppliers_northwind
[0m12:22:09.120031 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_exercise.stg_region_northwind, now model.dbt_exercise.stg_territories_northwind)
[0m12:22:09.120953 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.dbt_exercise.stg_order_details_northwind, now model.dbt_exercise.stg_us_states_northwind)
[0m12:22:09.124980 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_exercise.stg_suppliers_northwind"
[0m12:22:09.125838 [debug] [Thread-2 (]: Began compiling node model.dbt_exercise.stg_territories_northwind
[0m12:22:09.126569 [debug] [Thread-4 (]: Began compiling node model.dbt_exercise.stg_us_states_northwind
[0m12:22:09.130886 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_exercise.stg_territories_northwind"
[0m12:22:09.134093 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_exercise.stg_us_states_northwind"
[0m12:22:09.134931 [debug] [Thread-3 (]: Began executing node model.dbt_exercise.stg_suppliers_northwind
[0m12:22:09.139475 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_exercise.stg_suppliers_northwind"
[0m12:22:09.140059 [debug] [Thread-2 (]: Began executing node model.dbt_exercise.stg_territories_northwind
[0m12:22:09.140693 [debug] [Thread-4 (]: Began executing node model.dbt_exercise.stg_us_states_northwind
[0m12:22:09.147129 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_exercise.stg_territories_northwind"
[0m12:22:09.149941 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_exercise.stg_us_states_northwind"
[0m12:22:09.150732 [debug] [Thread-3 (]: On model.dbt_exercise.stg_suppliers_northwind: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "model.dbt_exercise.stg_suppliers_northwind"} */


  create or replace view `corded-sunlight-464012-e2`.`dbt_dw_staging`.`stg_suppliers_northwind`
  OPTIONS()
  as with suppliers as (
    select *
    from `corded-sunlight-464012-e2`.`dbt_dw_raw`.`suppliers`
)

select 
    cast(supplier_id as string) as supplier_id
    , cast(company_name as string) as company_name
    , cast(contact_name as string) as contact_name
    , cast(contact_title as string) as contact_title
    , cast(address as string) as address
    , cast(city as string) as city
    , cast(region as string) as region
    , cast(postal_code as string) as postal_code
    , cast(country as string) as country
    , cast(phone as string) as phone
    , cast(fax as string) as fax
    , cast(homepage as string) as home_page
from suppliers;


[0m12:22:09.152288 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m12:22:09.153697 [debug] [Thread-4 (]: On model.dbt_exercise.stg_us_states_northwind: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "model.dbt_exercise.stg_us_states_northwind"} */


  create or replace view `corded-sunlight-464012-e2`.`dbt_dw_staging`.`stg_us_states_northwind`
  OPTIONS()
  as with us_states as (
    select *
    from `corded-sunlight-464012-e2`.`dbt_dw_raw`.`us_states`
)

select
    cast(state_id as string) as state_id
    , cast(state_name as string) as state_name
    , cast(state_abbr as string) as state_abbr
    , cast(state_region as string) as state_region
from us_states;


[0m12:22:09.154431 [debug] [Thread-2 (]: On model.dbt_exercise.stg_territories_northwind: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "model.dbt_exercise.stg_territories_northwind"} */


  create or replace view `corded-sunlight-464012-e2`.`dbt_dw_staging`.`stg_territories_northwind`
  OPTIONS()
  as with territories as (
    select *
    from `corded-sunlight-464012-e2`.`dbt_dw_raw`.`territories`
)

select 
    cast(territory_id as string) as territory_id
    , cast(territory_description as string) as territory_description
    , cast(region_id as string) as region_id
from territories;


[0m12:22:09.154959 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m12:22:09.155534 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m12:22:09.991656 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:afd15af3-3210-4b5c-b555-eeb3529e1d33&page=queryresults
[0m12:22:10.116310 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:34d8026c-5b5a-4dd2-bd76-ca56a92e2c11&page=queryresults
[0m12:22:10.146400 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:4bdc7b15-08c0-48e5-ac44-b3f0e1cf72ec&page=queryresults
[0m12:22:10.214404 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:719f108c-5246-4fd1-a5cf-c7424ea8e94c&page=queryresults
[0m12:22:10.557532 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7d0d33a9-0f91-41a2-95f0-8e84dcd60088', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x752a542399d0>]}
[0m12:22:10.558277 [info ] [Thread-1 (]: 9 of 17 OK created sql view model dbt_dw_staging.stg_shippers_northwind ........ [[32mCREATE VIEW (0 processed)[0m in 1.51s]
[0m12:22:10.558885 [debug] [Thread-1 (]: Finished running node model.dbt_exercise.stg_shippers_northwind
[0m12:22:10.559328 [debug] [Thread-1 (]: Began running node model.dbt_exercise.int_customers_northwind
[0m12:22:10.560291 [info ] [Thread-1 (]: 13 of 17 START sql view model dbt_dw_intermediate.int_customers_northwind ...... [RUN]
[0m12:22:10.561007 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_exercise.stg_shippers_northwind, now model.dbt_exercise.int_customers_northwind)
[0m12:22:10.561409 [debug] [Thread-1 (]: Began compiling node model.dbt_exercise.int_customers_northwind
[0m12:22:10.563856 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_exercise.int_customers_northwind"
[0m12:22:10.568882 [debug] [Thread-1 (]: Began executing node model.dbt_exercise.int_customers_northwind
[0m12:22:10.571503 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_exercise.int_customers_northwind"
[0m12:22:10.572594 [debug] [Thread-1 (]: On model.dbt_exercise.int_customers_northwind: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "model.dbt_exercise.int_customers_northwind"} */


  create or replace view `corded-sunlight-464012-e2`.`dbt_dw_intermediate`.`int_customers_northwind`
  OPTIONS()
  as with customers as (
    select *
    from `corded-sunlight-464012-e2`.`dbt_dw_staging`.`stg_customers_northwind`
)

, final_table as (
    select 
        customer_id
        , company_name
        , contact_name
        , contact_title
        , address
        , city
        , region
        , country
        , case 
            when country in ('USA', 'Canada', 'Mexico') then 'North America'
            when country in ('UK', 'France', 'Germany', 'Austria', 'Belgium', 'Denmark', 'Ireland'
            , 'Finland', 'Italy', 'Norway', 'Poland', 'Portugal', 'Spain', 'Sweden', 'Switzerland') then 'Europe'
            when country in ('Brazil', 'Argentina', 'Venezuela') then 'South America'
            else 'Other'
        end as continent
    from customers
)

select *
from final_table;


[0m12:22:10.573123 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:22:10.634509 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7d0d33a9-0f91-41a2-95f0-8e84dcd60088', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x752a541fd5b0>]}
[0m12:22:10.635249 [info ] [Thread-4 (]: 12 of 17 OK created sql view model dbt_dw_staging.stg_us_states_northwind ...... [[32mCREATE VIEW (0 processed)[0m in 1.51s]
[0m12:22:10.635847 [debug] [Thread-4 (]: Finished running node model.dbt_exercise.stg_us_states_northwind
[0m12:22:10.636254 [debug] [Thread-4 (]: Began running node model.dbt_exercise.int_employees_northwind
[0m12:22:10.636836 [info ] [Thread-4 (]: 14 of 17 START sql view model dbt_dw_intermediate.int_employees_northwind ...... [RUN]
[0m12:22:10.637305 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.dbt_exercise.stg_us_states_northwind, now model.dbt_exercise.int_employees_northwind)
[0m12:22:10.637691 [debug] [Thread-4 (]: Began compiling node model.dbt_exercise.int_employees_northwind
[0m12:22:10.640358 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_exercise.int_employees_northwind"
[0m12:22:10.641447 [debug] [Thread-4 (]: Began executing node model.dbt_exercise.int_employees_northwind
[0m12:22:10.644288 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_exercise.int_employees_northwind"
[0m12:22:10.645118 [debug] [Thread-4 (]: On model.dbt_exercise.int_employees_northwind: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "model.dbt_exercise.int_employees_northwind"} */


  create or replace view `corded-sunlight-464012-e2`.`dbt_dw_intermediate`.`int_employees_northwind`
  OPTIONS()
  as with employees as (
    select *
    from `corded-sunlight-464012-e2`.`dbt_dw_staging`.`stg_employees_northwind`
)

, max_fact_date as (
    select 
        case 
            when max(order_date) >= max(shipped_date) then max(order_date)
            else max(shipped_date)
        end as max_date
    from `corded-sunlight-464012-e2`.`dbt_dw_staging`.`stg_orders_northwind`
)

, final_table as (
    select
        employee_id
        , concat(first_name, ' ', last_name) as employee_name
        , title
        , birth_date
        , date_diff((select * from max_fact_date), birth_date, year) as age
        , hire_date
        , date_diff((select * from max_fact_date), hire_date, year) as years_hired
        , address
        , city
        , region
        , country
    from employees
)

select *
from final_table;


[0m12:22:10.645673 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m12:22:10.676629 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7d0d33a9-0f91-41a2-95f0-8e84dcd60088', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x752a5425dbe0>]}
[0m12:22:10.677851 [info ] [Thread-3 (]: 10 of 17 OK created sql view model dbt_dw_staging.stg_suppliers_northwind ...... [[32mCREATE VIEW (0 processed)[0m in 1.56s]
[0m12:22:10.678583 [debug] [Thread-3 (]: Finished running node model.dbt_exercise.stg_suppliers_northwind
[0m12:22:10.679195 [debug] [Thread-3 (]: Began running node model.dbt_exercise.int_orders_northwind
[0m12:22:10.680510 [info ] [Thread-3 (]: 15 of 17 START sql view model dbt_dw_intermediate.int_orders_northwind ......... [RUN]
[0m12:22:10.681109 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_exercise.stg_suppliers_northwind, now model.dbt_exercise.int_orders_northwind)
[0m12:22:10.681436 [debug] [Thread-3 (]: Began compiling node model.dbt_exercise.int_orders_northwind
[0m12:22:10.684169 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_exercise.int_orders_northwind"
[0m12:22:10.685521 [debug] [Thread-3 (]: Began executing node model.dbt_exercise.int_orders_northwind
[0m12:22:10.688554 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_exercise.int_orders_northwind"
[0m12:22:10.689317 [debug] [Thread-3 (]: On model.dbt_exercise.int_orders_northwind: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "model.dbt_exercise.int_orders_northwind"} */


  create or replace view `corded-sunlight-464012-e2`.`dbt_dw_intermediate`.`int_orders_northwind`
  OPTIONS()
  as with orders as (
    select *
    from `corded-sunlight-464012-e2`.`dbt_dw_staging`.`stg_orders_northwind`
)

, order_details as (
    select *
    from `corded-sunlight-464012-e2`.`dbt_dw_staging`.`stg_order_details_northwind`
)

, shippers as (
    select *
    from `corded-sunlight-464012-e2`.`dbt_dw_staging`.`stg_shippers_northwind`
)

, transformed_table as (    
    select
        orders.order_id 
        , orders.customer_id
        , orders.employee_id
        , orders.order_date
        , orders.required_date
        , orders.shipped_date
        , date_diff(orders.shipped_date, orders.order_date, day) as days_to_ship
        , concat(
            coalesce(orders.ship_via, '')
            , '-'
            , coalesce(shippers.company_name, '')
            , '-'
            , coalesce(orders.ship_address, '')
        ) as ship_id
        , orders.ship_via      
        , shippers.company_name as shipper_name
        , sum(order_details.unit_price * order_details.quantity * (1 - order_details.discount)) as total_order_amount
        , orders.freight
        , orders.ship_name
        , orders.ship_address
        , orders.ship_city
        , orders.ship_region
        , orders.ship_country
        , case
            when orders.ship_country in ('USA', 'Canada', 'Mexico') then 'North America'
            when orders.ship_country in ('UK', 'France', 'Germany', 'Austria', 'Belgium', 
            'Denmark', 'Ireland', 'Finland', 'Italy', 'Norway', 'Poland', 'Portugal', 'Spain', 'Sweden', 'Switzerland') then 'Europe'
            when orders.ship_country in ('Brazil', 'Argentina', 'Venezuela') then 'South America'
            else 'Other'
        end as ship_continent
    from orders
    left join order_details
        on orders.order_id = order_details.order_id
    left join shippers
        on orders.ship_via = shippers.shipper_id
    group by 
        orders.order_id
        , orders.customer_id
        , orders.employee_id
        , orders.order_date
        , orders.required_date
        , orders.shipped_date
        , orders.ship_via
        , shippers.company_name
        , orders.freight
        , orders.ship_name
        , orders.ship_address
        , orders.ship_city
        , orders.ship_region
        , orders.ship_country
)

, final_table as (
    select
        transformed_table.order_id
        , transformed_table.customer_id
        , transformed_table.employee_id
        , transformed_table.order_date
        , transformed_table.required_date
        , transformed_table.shipped_date
        , transformed_table.days_to_ship
        , transformed_table.ship_id
        , transformed_table.ship_via
        , transformed_table.shipper_name
        , transformed_table.total_order_amount
        , transformed_table.freight
        , transformed_table.ship_name
        , transformed_table.ship_address
        , transformed_table.ship_city
        , transformed_table.ship_region
        , transformed_table.ship_country
        , transformed_table.ship_continent
        , case 
            when transformed_table.days_to_ship is null then False
            else True
          end as is_shipped
    from transformed_table
)

select *
from final_table;


[0m12:22:10.689793 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m12:22:10.722810 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7d0d33a9-0f91-41a2-95f0-8e84dcd60088', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x752a542df560>]}
[0m12:22:10.723644 [info ] [Thread-2 (]: 11 of 17 OK created sql view model dbt_dw_staging.stg_territories_northwind .... [[32mCREATE VIEW (0 processed)[0m in 1.60s]
[0m12:22:10.724515 [debug] [Thread-2 (]: Finished running node model.dbt_exercise.stg_territories_northwind
[0m12:22:10.725046 [debug] [Thread-2 (]: Began running node model.dbt_exercise.int_shippers_northwind
[0m12:22:10.725804 [info ] [Thread-2 (]: 16 of 17 START sql view model dbt_dw_intermediate.int_shippers_northwind ....... [RUN]
[0m12:22:10.726421 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_exercise.stg_territories_northwind, now model.dbt_exercise.int_shippers_northwind)
[0m12:22:10.726864 [debug] [Thread-2 (]: Began compiling node model.dbt_exercise.int_shippers_northwind
[0m12:22:10.729562 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_exercise.int_shippers_northwind"
[0m12:22:10.731334 [debug] [Thread-2 (]: Began executing node model.dbt_exercise.int_shippers_northwind
[0m12:22:10.734602 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_exercise.int_shippers_northwind"
[0m12:22:10.736607 [debug] [Thread-2 (]: On model.dbt_exercise.int_shippers_northwind: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "model.dbt_exercise.int_shippers_northwind"} */


  create or replace view `corded-sunlight-464012-e2`.`dbt_dw_intermediate`.`int_shippers_northwind`
  OPTIONS()
  as with shippers as (
    select *
    from `corded-sunlight-464012-e2`.`dbt_dw_staging`.`stg_shippers_northwind`
)

, orders as (
    select *
    from `corded-sunlight-464012-e2`.`dbt_dw_staging`.`stg_orders_northwind`
)

, transformed_table as (
    select
        concat(
            coalesce(shippers.shipper_id, '')
            , '-'
            , coalesce(shippers.company_name, '')
            , '-'
            , coalesce(orders.ship_address, '')
        ) as ship_id
        , shippers.shipper_id
        , shippers.company_name
        , orders.ship_address
        , orders.ship_city
        , orders.ship_region
        , orders.ship_country
    from shippers
    left join orders
        on shippers.shipper_id = orders.ship_via
)

/* Aqui é feita a deduplicação da transformed_table */
, dedup_table as (
    select distinct *
    from transformed_table
)

, final_table as (
    select 
        *
        , case
            when dedup_table.ship_country in ('USA', 'Canada', 'Mexico') then 'North America'
            when dedup_table.ship_country in ('UK', 'France', 'Germany', 'Austria', 'Belgium', 
            'Denmark', 'Ireland', 'Finland', 'Italy', 'Norway', 'Poland', 'Portugal', 'Spain', 'Sweden', 'Switzerland') then 'Europe'
            when dedup_table.ship_country in ('Brazil', 'Argentina', 'Venezuela') then 'South America'
            else 'Other'
        end as ship_continent
    from dedup_table
)

select *
from final_table;


[0m12:22:10.737256 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m12:22:11.782225 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:dd4047ed-18cd-4ab7-8a93-c2dac5e76cc4&page=queryresults
[0m12:22:11.788089 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:975a21c3-ff92-41c4-9e47-e13df2d40ee7&page=queryresults
[0m12:22:11.792216 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:f2ae584a-c73d-4769-90c1-71b50e3bea19&page=queryresults
[0m12:22:11.912604 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:1a157380-1f51-4fc0-a329-0f0554cf144c&page=queryresults
[0m12:22:12.310396 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7d0d33a9-0f91-41a2-95f0-8e84dcd60088', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x752a57679070>]}
[0m12:22:12.312658 [info ] [Thread-1 (]: 13 of 17 OK created sql view model dbt_dw_intermediate.int_customers_northwind . [[32mCREATE VIEW (0 processed)[0m in 1.75s]
[0m12:22:12.315575 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7d0d33a9-0f91-41a2-95f0-8e84dcd60088', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x752a5433ea50>]}
[0m12:22:12.316425 [debug] [Thread-1 (]: Finished running node model.dbt_exercise.int_customers_northwind
[0m12:22:12.317211 [info ] [Thread-2 (]: 16 of 17 OK created sql view model dbt_dw_intermediate.int_shippers_northwind .. [[32mCREATE VIEW (0 processed)[0m in 1.59s]
[0m12:22:12.318343 [debug] [Thread-1 (]: Began running node model.dbt_exercise.int_products_northwind
[0m12:22:12.319490 [debug] [Thread-2 (]: Finished running node model.dbt_exercise.int_shippers_northwind
[0m12:22:12.320283 [info ] [Thread-1 (]: 17 of 17 START sql view model dbt_dw_intermediate.int_products_northwind ....... [RUN]
[0m12:22:12.321696 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_exercise.int_customers_northwind, now model.dbt_exercise.int_products_northwind)
[0m12:22:12.322349 [debug] [Thread-1 (]: Began compiling node model.dbt_exercise.int_products_northwind
[0m12:22:12.325880 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_exercise.int_products_northwind"
[0m12:22:12.326681 [debug] [Thread-1 (]: Began executing node model.dbt_exercise.int_products_northwind
[0m12:22:12.329151 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_exercise.int_products_northwind"
[0m12:22:12.330032 [debug] [Thread-1 (]: On model.dbt_exercise.int_products_northwind: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "model.dbt_exercise.int_products_northwind"} */


  create or replace view `corded-sunlight-464012-e2`.`dbt_dw_intermediate`.`int_products_northwind`
  OPTIONS()
  as with products as (
    select *
    from `corded-sunlight-464012-e2`.`dbt_dw_staging`.`stg_products_northwind`
)

, categories as (
    select *
    from `corded-sunlight-464012-e2`.`dbt_dw_staging`.`stg_categories_northwind`
)

, suppliers as (
    select *
    from `corded-sunlight-464012-e2`.`dbt_dw_staging`.`stg_suppliers_northwind`
)

, final_table as (
    select
        products.product_id
        , products.product_name
        , products.quantity_per_unit
        , categories.category_name
        , suppliers.company_name as supplier_name
        , suppliers.city as supplier_city
        , suppliers.region as supplier_region
        , suppliers.country as supplier_country
        , products.discontinued
    from products
    left join categories
        on products.category_id = categories.category_id
    left join suppliers
        on products.supplier_id = suppliers.supplier_id
)

select * 
from final_table;


[0m12:22:12.331483 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:22:12.334967 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7d0d33a9-0f91-41a2-95f0-8e84dcd60088', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x752a54356ab0>]}
[0m12:22:12.336619 [info ] [Thread-3 (]: 15 of 17 OK created sql view model dbt_dw_intermediate.int_orders_northwind .... [[32mCREATE VIEW (0 processed)[0m in 1.65s]
[0m12:22:12.337564 [debug] [Thread-3 (]: Finished running node model.dbt_exercise.int_orders_northwind
[0m12:22:12.438216 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7d0d33a9-0f91-41a2-95f0-8e84dcd60088', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x752a543564b0>]}
[0m12:22:12.439050 [info ] [Thread-4 (]: 14 of 17 OK created sql view model dbt_dw_intermediate.int_employees_northwind . [[32mCREATE VIEW (0 processed)[0m in 1.80s]
[0m12:22:12.439770 [debug] [Thread-4 (]: Finished running node model.dbt_exercise.int_employees_northwind
[0m12:22:13.344626 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:781e0c07-8910-4f69-875b-459bb2d018df&page=queryresults
[0m12:22:13.857164 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7d0d33a9-0f91-41a2-95f0-8e84dcd60088', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x752a544c0260>]}
[0m12:22:13.857902 [info ] [Thread-1 (]: 17 of 17 OK created sql view model dbt_dw_intermediate.int_products_northwind .. [[32mCREATE VIEW (0 processed)[0m in 1.54s]
[0m12:22:13.858539 [debug] [Thread-1 (]: Finished running node model.dbt_exercise.int_products_northwind
[0m12:22:13.861631 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m12:22:13.868202 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:22:13.868710 [debug] [MainThread]: Connection 'model.dbt_exercise.int_products_northwind' was properly closed.
[0m12:22:13.868977 [debug] [MainThread]: Connection 'model.dbt_exercise.int_employees_northwind' was properly closed.
[0m12:22:13.869223 [debug] [MainThread]: Connection 'model.dbt_exercise.int_shippers_northwind' was properly closed.
[0m12:22:13.869505 [debug] [MainThread]: Connection 'model.dbt_exercise.int_orders_northwind' was properly closed.
[0m12:22:13.869862 [info ] [MainThread]: 
[0m12:22:13.870274 [info ] [MainThread]: Finished running 17 view models in 0 hours 0 minutes and 14.37 seconds (14.37s).
[0m12:22:13.872902 [debug] [MainThread]: Command end result
[0m12:22:13.915642 [debug] [MainThread]: Wrote artifact WritableManifest to /home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/target/manifest.json
[0m12:22:13.929391 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/target/semantic_manifest.json
[0m12:22:13.935350 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/target/run_results.json
[0m12:22:13.935784 [info ] [MainThread]: 
[0m12:22:13.936207 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:22:13.936732 [info ] [MainThread]: 
[0m12:22:13.937244 [info ] [MainThread]: Done. PASS=17 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=17
[0m12:22:13.937885 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- DuplicateYAMLKeysDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m12:22:13.943364 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 105.6576, "process_in_blocks": "137720", "process_kernel_time": 13.591503, "process_mem_max_rss": "367744", "process_out_blocks": "3888", "process_user_time": 10.753187}
[0m12:22:13.944189 [debug] [MainThread]: Command `dbt run` succeeded at 12:22:13.943955 after 105.66 seconds
[0m12:22:13.944734 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x752a95110410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x752a54423b60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x752a95cb8fb0>]}
[0m12:22:13.945239 [debug] [MainThread]: Flushing usage events
[0m12:22:14.334689 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:47:31.237196 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7431cf2e9d00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7431cf326ba0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7431cf9bb7d0>]}


============================== 14:47:31.265024 | 0a51ecaa-0a7e-4b69-a7b2-099c1baa7089 ==============================
[0m14:47:31.265024 [info ] [MainThread]: Running with dbt=1.10.2
[0m14:47:31.265533 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise', 'debug': 'False', 'warn_error': 'None', 'log_path': '/home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'invocation_command': 'dbt run -s int_products_northwind', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:48:40.806843 [warn ] [MainThread]: [[33mWARNING[0m][DuplicateYAMLKeysDeprecation]: Deprecated functionality
Duplicate key 'version' in "<unicode string>", line 4, column 1 in file
`/home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/dbt_project.yml`
[0m14:48:40.807555 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '0a51ecaa-0a7e-4b69-a7b2-099c1baa7089', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x743191899a60>]}
[0m14:48:41.448779 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0a51ecaa-0a7e-4b69-a7b2-099c1baa7089', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7431ce900290>]}
[0m14:48:41.501650 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0a51ecaa-0a7e-4b69-a7b2-099c1baa7089', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x743191ac4c50>]}
[0m14:48:41.507438 [info ] [MainThread]: Registered adapter: bigquery=1.9.2
[0m14:49:26.783799 [debug] [MainThread]: checksum: 1adc40777973ef30f45f80b3b6d04d5013c1edd53d96363881b3b199e612468b, vars: {}, profile: , target: , version: 1.10.2
[0m14:49:35.591288 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:49:35.591719 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:49:35.641426 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0a51ecaa-0a7e-4b69-a7b2-099c1baa7089', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x743191590da0>]}
[0m14:49:36.037523 [debug] [MainThread]: Wrote artifact WritableManifest to /home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/target/manifest.json
[0m14:49:36.050920 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/target/semantic_manifest.json
[0m14:49:36.644093 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0a51ecaa-0a7e-4b69-a7b2-099c1baa7089', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x743191a098e0>]}
[0m14:49:36.644795 [info ] [MainThread]: Found 14 seeds, 35 data tests, 19 models, 14 sources, 609 macros
[0m14:49:36.645354 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0a51ecaa-0a7e-4b69-a7b2-099c1baa7089', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7431912cdca0>]}
[0m14:49:36.648231 [info ] [MainThread]: 
[0m14:49:36.648996 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:49:36.649432 [info ] [MainThread]: 
[0m14:49:36.650010 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m14:49:36.651587 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_corded-sunlight-464012-e2'
[0m14:49:36.652297 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:49:37.469143 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_corded-sunlight-464012-e2, now list_corded-sunlight-464012-e2_dbt_dw_marts)
[0m14:49:37.469918 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:49:37.471280 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_corded-sunlight-464012-e2_dbt_dw_raw'
[0m14:49:37.473364 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_corded-sunlight-464012-e2_dbt_dw_intermediate'
[0m14:49:37.474408 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:49:37.475146 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_corded-sunlight-464012-e2_dbt_dw_staging'
[0m14:49:37.476115 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:49:37.477308 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:49:39.431251 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0a51ecaa-0a7e-4b69-a7b2-099c1baa7089', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x743191756270>]}
[0m14:49:39.432257 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:49:39.447831 [debug] [Thread-1 (]: Began running node model.dbt_exercise.int_products_northwind
[0m14:49:39.448877 [info ] [Thread-1 (]: 1 of 1 START sql view model dbt_dw_intermediate.int_products_northwind ......... [RUN]
[0m14:49:39.449491 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_corded-sunlight-464012-e2_dbt_dw_marts, now model.dbt_exercise.int_products_northwind)
[0m14:49:39.449897 [debug] [Thread-1 (]: Began compiling node model.dbt_exercise.int_products_northwind
[0m14:49:39.458033 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_exercise.int_products_northwind"
[0m14:49:39.459733 [debug] [Thread-1 (]: Began executing node model.dbt_exercise.int_products_northwind
[0m14:49:39.488297 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_exercise.int_products_northwind"
[0m14:49:39.489497 [debug] [Thread-1 (]: On model.dbt_exercise.int_products_northwind: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "model.dbt_exercise.int_products_northwind"} */


  create or replace view `corded-sunlight-464012-e2`.`dbt_dw_intermediate`.`int_products_northwind`
  OPTIONS()
  as with products as (
    select *
    from `corded-sunlight-464012-e2`.`dbt_dw_staging`.`stg_products_northwind`
)

, categories as (
    select *
    from `corded-sunlight-464012-e2`.`dbt_dw_staging`.`stg_categories_northwind`
)

, suppliers as (
    select *
    from `corded-sunlight-464012-e2`.`dbt_dw_staging`.`stg_suppliers_northwind`
)

, final_table as (
    select
        products.product_id
        , products.product_name
        , products.quantity_per_unit
        , categories.category_name
        , suppliers.company_name as supplier_name
        , suppliers.city as supplier_city
        , suppliers.region as supplier_region
        , suppliers.country as supplier_country
        , case
            when suppliers.country in ('USA', 'Canada') then 'North America'
            when suppliers.country in ('Brazil') then 'South America'
            when suppliers.country in ('UK', 'Germany', 'Netherlands', 'Spain', 'France', 'Norway', 'Italy', 'Denmark', 'Sweden', 'Finland') then 'Europe'
            when suppliers.country in ('Singapore', 'Japan') then 'Asia'
            when suppliers.country in ('Australia') then 'Oceania'
            else 'Other'
          end as supplier_continent
        , products.discontinued
    from products
    left join categories
        on products.category_id = categories.category_id
    left join suppliers
        on products.supplier_id = suppliers.supplier_id
)

select * 
from final_table;


[0m14:49:39.490120 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:49:40.524089 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:5a72a7f3-4206-403c-af47-c28c2450d75a&page=queryresults
[0m14:49:47.180815 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0a51ecaa-0a7e-4b69-a7b2-099c1baa7089', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7431cf9ba090>]}
[0m14:49:47.182141 [info ] [Thread-1 (]: 1 of 1 OK created sql view model dbt_dw_intermediate.int_products_northwind .... [[32mCREATE VIEW (0 processed)[0m in 7.72s]
[0m14:49:47.182920 [debug] [Thread-1 (]: Finished running node model.dbt_exercise.int_products_northwind
[0m14:49:47.185964 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:49:47.192716 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:49:47.193203 [debug] [MainThread]: Connection 'model.dbt_exercise.int_products_northwind' was properly closed.
[0m14:49:47.193504 [debug] [MainThread]: Connection 'list_corded-sunlight-464012-e2_dbt_dw_raw' was properly closed.
[0m14:49:47.193789 [debug] [MainThread]: Connection 'list_corded-sunlight-464012-e2_dbt_dw_intermediate' was properly closed.
[0m14:49:47.194081 [debug] [MainThread]: Connection 'list_corded-sunlight-464012-e2_dbt_dw_staging' was properly closed.
[0m14:49:47.194479 [info ] [MainThread]: 
[0m14:49:47.194936 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 10.54 seconds (10.54s).
[0m14:49:47.195797 [debug] [MainThread]: Command end result
[0m14:49:47.237179 [debug] [MainThread]: Wrote artifact WritableManifest to /home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/target/manifest.json
[0m14:49:47.247992 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/target/semantic_manifest.json
[0m14:49:47.254158 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/target/run_results.json
[0m14:49:47.254650 [info ] [MainThread]: 
[0m14:49:47.255168 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:49:47.255667 [info ] [MainThread]: 
[0m14:49:47.256096 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m14:49:47.256803 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- DuplicateYAMLKeysDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m14:49:47.261833 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 121.746635, "process_in_blocks": "139728", "process_kernel_time": 14.465782, "process_mem_max_rss": "366880", "process_out_blocks": "3528", "process_user_time": 11.06181}
[0m14:49:47.262421 [debug] [MainThread]: Command `dbt run` succeeded at 14:49:47.262329 after 121.75 seconds
[0m14:49:47.262769 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7431ceaafb00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7431918eec00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7431918ef680>]}
[0m14:49:47.263118 [debug] [MainThread]: Flushing usage events
[0m14:49:47.774345 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:55:12.397813 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b4acf88b350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b4acff9c320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b4acfcdedb0>]}


============================== 14:55:12.415663 | 7716e0a6-a8ef-4c7e-b59a-c3ea5a952d8e ==============================
[0m14:55:12.415663 [info ] [MainThread]: Running with dbt=1.10.2
[0m14:55:12.416397 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt test -s dim_products', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:55:57.250245 [warn ] [MainThread]: [[33mWARNING[0m][DuplicateYAMLKeysDeprecation]: Deprecated functionality
Duplicate key 'version' in "<unicode string>", line 4, column 1 in file
`/home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/dbt_project.yml`
[0m14:55:57.250860 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '7716e0a6-a8ef-4c7e-b59a-c3ea5a952d8e', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b4a91ea4cb0>]}
[0m14:55:57.830472 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7716e0a6-a8ef-4c7e-b59a-c3ea5a952d8e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b4a91f5bef0>]}
[0m14:55:57.880810 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7716e0a6-a8ef-4c7e-b59a-c3ea5a952d8e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b4a922a8470>]}
[0m14:55:57.885952 [info ] [MainThread]: Registered adapter: bigquery=1.9.2
[0m14:56:47.294746 [debug] [MainThread]: checksum: 1adc40777973ef30f45f80b3b6d04d5013c1edd53d96363881b3b199e612468b, vars: {}, profile: , target: , version: 1.10.2
[0m14:56:51.614434 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:56:51.615281 [debug] [MainThread]: Partial parsing: updated file: dbt_exercise://models/marts/dim_products.yml
[0m14:56:52.098340 [error] [MainThread]: Encountered an error:
Parsing Error
  Invalid test config given in models/marts/dim_products.yml:
  	test definition dictionary must have exactly one key, got [('accepted_values', None), ('values', [True, False])] instead (2 keys)
  	@: UnparsedModelUpdate(original_file_path='mode...ne)
[0m14:56:52.098968 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- DuplicateYAMLKeysDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m14:56:52.104936 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": false, "command_wall_clock_time": 89.01483, "process_in_blocks": "143112", "process_kernel_time": 13.405168, "process_mem_max_rss": "361016", "process_out_blocks": "32", "process_user_time": 10.189017}
[0m14:56:52.105703 [debug] [MainThread]: Command `dbt test` failed at 14:56:52.105569 after 89.02 seconds
[0m14:56:52.106151 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b4ad34ef3e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b4a9197cfb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b4a91956c60>]}
[0m14:56:52.106505 [debug] [MainThread]: Flushing usage events
[0m14:56:52.424663 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:58:53.625396 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7aee4f39cbc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7aee4f329d00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7aee50536c90>]}


============================== 14:58:53.643117 | fbf8cffa-9e09-4163-bd95-ada2973e5b7b ==============================
[0m14:58:53.643117 [info ] [MainThread]: Running with dbt=1.10.2
[0m14:58:53.643693 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt test -s dim_products', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:59:42.836206 [warn ] [MainThread]: [[33mWARNING[0m][DuplicateYAMLKeysDeprecation]: Deprecated functionality
Duplicate key 'version' in "<unicode string>", line 4, column 1 in file
`/home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/dbt_project.yml`
[0m14:59:42.836782 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'fbf8cffa-9e09-4163-bd95-ada2973e5b7b', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7aee4ea7c800>]}
[0m14:59:43.449791 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fbf8cffa-9e09-4163-bd95-ada2973e5b7b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7aee11a17d40>]}
[0m14:59:43.505600 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fbf8cffa-9e09-4163-bd95-ada2973e5b7b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7aee4ea633b0>]}
[0m14:59:43.510131 [info ] [MainThread]: Registered adapter: bigquery=1.9.2
[0m15:00:29.671750 [debug] [MainThread]: checksum: 1adc40777973ef30f45f80b3b6d04d5013c1edd53d96363881b3b199e612468b, vars: {}, profile: , target: , version: 1.10.2
[0m15:00:33.997428 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:00:33.997955 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:00:34.044834 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fbf8cffa-9e09-4163-bd95-ada2973e5b7b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7aee1170a2d0>]}
[0m15:00:34.377725 [debug] [MainThread]: Wrote artifact WritableManifest to /home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/target/manifest.json
[0m15:00:34.389870 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/target/semantic_manifest.json
[0m15:00:34.815836 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fbf8cffa-9e09-4163-bd95-ada2973e5b7b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7aee11a15a60>]}
[0m15:00:34.816411 [info ] [MainThread]: Found 14 seeds, 36 data tests, 19 models, 14 sources, 609 macros
[0m15:00:34.816818 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fbf8cffa-9e09-4163-bd95-ada2973e5b7b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7aee4ea37530>]}
[0m15:00:34.818753 [info ] [MainThread]: 
[0m15:00:34.819343 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:00:34.819685 [info ] [MainThread]: 
[0m15:00:34.820303 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m15:00:34.825809 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_corded-sunlight-464012-e2_dbt_dw_marts'
[0m15:00:34.827079 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_corded-sunlight-464012-e2_dbt_dw_intermediate'
[0m15:00:34.827775 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:00:34.829309 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_corded-sunlight-464012-e2_dbt_dw_raw'
[0m15:00:34.829991 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:00:34.831249 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_corded-sunlight-464012-e2_dbt_dw_staging'
[0m15:00:34.832502 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:00:34.833539 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:00:35.802627 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fbf8cffa-9e09-4163-bd95-ada2973e5b7b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7aee119aefc0>]}
[0m15:00:35.803253 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:00:35.819109 [debug] [Thread-1 (]: Began running node test.dbt_exercise.accepted_values_dim_products_discontinued__True__False.07bc696cf6
[0m15:00:35.819958 [debug] [Thread-2 (]: Began running node test.dbt_exercise.not_null_dim_products_product_id.c8aba288d1
[0m15:00:35.820716 [info ] [Thread-1 (]: 1 of 5 START test accepted_values_dim_products_discontinued__True__False ....... [RUN]
[0m15:00:35.821605 [debug] [Thread-3 (]: Began running node test.dbt_exercise.not_null_dim_products_product_sk.2a2df3e1b9
[0m15:00:35.822638 [debug] [Thread-4 (]: Began running node test.dbt_exercise.unique_dim_products_product_id.ef7b2a9985
[0m15:00:35.823559 [info ] [Thread-2 (]: 2 of 5 START test not_null_dim_products_product_id ............................. [RUN]
[0m15:00:35.824643 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_corded-sunlight-464012-e2_dbt_dw_marts, now test.dbt_exercise.accepted_values_dim_products_discontinued__True__False.07bc696cf6)
[0m15:00:35.825404 [info ] [Thread-3 (]: 3 of 5 START test not_null_dim_products_product_sk ............................. [RUN]
[0m15:00:35.826615 [info ] [Thread-4 (]: 4 of 5 START test unique_dim_products_product_id ............................... [RUN]
[0m15:00:35.827747 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_corded-sunlight-464012-e2_dbt_dw_staging, now test.dbt_exercise.not_null_dim_products_product_id.c8aba288d1)
[0m15:00:35.828668 [debug] [Thread-1 (]: Began compiling node test.dbt_exercise.accepted_values_dim_products_discontinued__True__False.07bc696cf6
[0m15:00:35.829341 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_corded-sunlight-464012-e2_dbt_dw_intermediate, now test.dbt_exercise.not_null_dim_products_product_sk.2a2df3e1b9)
[0m15:00:35.830281 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly list_corded-sunlight-464012-e2_dbt_dw_raw, now test.dbt_exercise.unique_dim_products_product_id.ef7b2a9985)
[0m15:00:35.831263 [debug] [Thread-2 (]: Began compiling node test.dbt_exercise.not_null_dim_products_product_id.c8aba288d1
[0m15:00:35.848788 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_exercise.accepted_values_dim_products_discontinued__True__False.07bc696cf6"
[0m15:00:35.849330 [debug] [Thread-3 (]: Began compiling node test.dbt_exercise.not_null_dim_products_product_sk.2a2df3e1b9
[0m15:00:35.849965 [debug] [Thread-4 (]: Began compiling node test.dbt_exercise.unique_dim_products_product_id.ef7b2a9985
[0m15:00:35.861939 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_exercise.not_null_dim_products_product_id.c8aba288d1"
[0m15:00:35.866781 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_exercise.not_null_dim_products_product_sk.2a2df3e1b9"
[0m15:00:35.875516 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_exercise.unique_dim_products_product_id.ef7b2a9985"
[0m15:00:35.877346 [debug] [Thread-1 (]: Began executing node test.dbt_exercise.accepted_values_dim_products_discontinued__True__False.07bc696cf6
[0m15:00:35.878072 [debug] [Thread-2 (]: Began executing node test.dbt_exercise.not_null_dim_products_product_id.c8aba288d1
[0m15:00:35.890942 [debug] [Thread-4 (]: Began executing node test.dbt_exercise.unique_dim_products_product_id.ef7b2a9985
[0m15:00:35.906565 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_exercise.not_null_dim_products_product_id.c8aba288d1"
[0m15:00:35.907214 [debug] [Thread-3 (]: Began executing node test.dbt_exercise.not_null_dim_products_product_sk.2a2df3e1b9
[0m15:00:35.908729 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_exercise.accepted_values_dim_products_discontinued__True__False.07bc696cf6"
[0m15:00:35.912237 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_exercise.unique_dim_products_product_id.ef7b2a9985"
[0m15:00:35.915341 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_exercise.not_null_dim_products_product_sk.2a2df3e1b9"
[0m15:00:35.919306 [debug] [Thread-1 (]: On test.dbt_exercise.accepted_values_dim_products_discontinued__True__False.07bc696cf6: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "test.dbt_exercise.accepted_values_dim_products_discontinued__True__False.07bc696cf6"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        discontinued as value_field,
        count(*) as n_records

    from `corded-sunlight-464012-e2`.`dbt_dw_marts`.`dim_products`
    group by discontinued

)

select *
from all_values
where value_field not in (
    'True','False'
)



  
  
      
    ) dbt_internal_test
[0m15:00:35.920509 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:00:35.921310 [debug] [Thread-3 (]: On test.dbt_exercise.not_null_dim_products_product_sk.2a2df3e1b9: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "test.dbt_exercise.not_null_dim_products_product_sk.2a2df3e1b9"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select product_sk
from `corded-sunlight-464012-e2`.`dbt_dw_marts`.`dim_products`
where product_sk is null



  
  
      
    ) dbt_internal_test
[0m15:00:35.922608 [debug] [Thread-4 (]: On test.dbt_exercise.unique_dim_products_product_id.ef7b2a9985: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "test.dbt_exercise.unique_dim_products_product_id.ef7b2a9985"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with dbt_test__target as (

  select product_id as unique_field
  from `corded-sunlight-464012-e2`.`dbt_dw_marts`.`dim_products`
  where product_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m15:00:35.923227 [debug] [Thread-2 (]: On test.dbt_exercise.not_null_dim_products_product_id.c8aba288d1: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "test.dbt_exercise.not_null_dim_products_product_id.c8aba288d1"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select product_id
from `corded-sunlight-464012-e2`.`dbt_dw_marts`.`dim_products`
where product_id is null



  
  
      
    ) dbt_internal_test
[0m15:00:35.923922 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:00:35.924481 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m15:00:35.925271 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:00:37.197958 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:6d1c1d1c-6dff-45f3-bb5c-8cbd60799e8f&page=queryresults
[0m15:00:37.199240 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:6d1c1d1c-6dff-45f3-bb5c-8cbd60799e8f&page=queryresults
[0m15:00:37.240290 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:0784453b-26de-44ec-86ef-af6948251eb2&page=queryresults
[0m15:00:37.241087 [error] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:0784453b-26de-44ec-86ef-af6948251eb2&page=queryresults
[0m15:00:37.440583 [debug] [Thread-1 (]: Database Error in test accepted_values_dim_products_discontinued__True__False (models/marts/dim_products.yml)
  Not found: Dataset corded-sunlight-464012-e2:dbt_dw_marts was not found in location US
  compiled code at target/run/dbt_exercise/models/marts/dim_products.yml/accepted_values_dim_products_discontinued__True__False.sql
[0m15:00:37.441941 [error] [Thread-1 (]: 1 of 5 ERROR accepted_values_dim_products_discontinued__True__False ............ [[31mERROR[0m in 1.62s]
[0m15:00:37.442854 [debug] [Thread-1 (]: Finished running node test.dbt_exercise.accepted_values_dim_products_discontinued__True__False.07bc696cf6
[0m15:00:37.444364 [debug] [Thread-3 (]: Database Error in test not_null_dim_products_product_sk (models/marts/dim_products.yml)
  Not found: Dataset corded-sunlight-464012-e2:dbt_dw_marts was not found in location US
  compiled code at target/run/dbt_exercise/models/marts/dim_products.yml/not_null_dim_products_product_sk.sql
[0m15:00:37.445229 [debug] [Thread-1 (]: Began running node test.dbt_exercise.unique_dim_products_product_sk.8f20ac7c5b
[0m15:00:37.446648 [debug] [Thread-7 (]: Marking all children of 'test.dbt_exercise.accepted_values_dim_products_discontinued__True__False.07bc696cf6' to be skipped because of status 'error'.  Reason: Database Error in test accepted_values_dim_products_discontinued__True__False (models/marts/dim_products.yml)
  Not found: Dataset corded-sunlight-464012-e2:dbt_dw_marts was not found in location US
  compiled code at target/run/dbt_exercise/models/marts/dim_products.yml/accepted_values_dim_products_discontinued__True__False.sql.
[0m15:00:37.448324 [error] [Thread-3 (]: 3 of 5 ERROR not_null_dim_products_product_sk .................................. [[31mERROR[0m in 1.62s]
[0m15:00:37.449847 [info ] [Thread-1 (]: 5 of 5 START test unique_dim_products_product_sk ............................... [RUN]
[0m15:00:37.452236 [debug] [Thread-3 (]: Finished running node test.dbt_exercise.not_null_dim_products_product_sk.2a2df3e1b9
[0m15:00:37.453346 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_exercise.accepted_values_dim_products_discontinued__True__False.07bc696cf6, now test.dbt_exercise.unique_dim_products_product_sk.8f20ac7c5b)
[0m15:00:37.454720 [debug] [Thread-7 (]: Marking all children of 'test.dbt_exercise.not_null_dim_products_product_sk.2a2df3e1b9' to be skipped because of status 'error'.  Reason: Database Error in test not_null_dim_products_product_sk (models/marts/dim_products.yml)
  Not found: Dataset corded-sunlight-464012-e2:dbt_dw_marts was not found in location US
  compiled code at target/run/dbt_exercise/models/marts/dim_products.yml/not_null_dim_products_product_sk.sql.
[0m15:00:37.455502 [debug] [Thread-1 (]: Began compiling node test.dbt_exercise.unique_dim_products_product_sk.8f20ac7c5b
[0m15:00:37.465124 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_exercise.unique_dim_products_product_sk.8f20ac7c5b"
[0m15:00:37.466474 [debug] [Thread-1 (]: Began executing node test.dbt_exercise.unique_dim_products_product_sk.8f20ac7c5b
[0m15:00:37.470077 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_exercise.unique_dim_products_product_sk.8f20ac7c5b"
[0m15:00:37.471315 [debug] [Thread-1 (]: On test.dbt_exercise.unique_dim_products_product_sk.8f20ac7c5b: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "test.dbt_exercise.unique_dim_products_product_sk.8f20ac7c5b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with dbt_test__target as (

  select product_sk as unique_field
  from `corded-sunlight-464012-e2`.`dbt_dw_marts`.`dim_products`
  where product_sk is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m15:00:37.471999 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:00:38.001440 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:8add67d1-9dec-48bf-afa0-45ce6c7d8efa&page=queryresults
[0m15:00:38.003222 [error] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:8add67d1-9dec-48bf-afa0-45ce6c7d8efa&page=queryresults
[0m15:00:38.030510 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:7d000b2b-0a43-4e7b-9c47-ae90685b59fd&page=queryresults
[0m15:00:38.031771 [error] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:7d000b2b-0a43-4e7b-9c47-ae90685b59fd&page=queryresults
[0m15:00:38.036324 [debug] [Thread-4 (]: Database Error in test unique_dim_products_product_id (models/marts/dim_products.yml)
  Not found: Dataset corded-sunlight-464012-e2:dbt_dw_marts was not found in location US
  compiled code at target/run/dbt_exercise/models/marts/dim_products.yml/unique_dim_products_product_id.sql
[0m15:00:38.037769 [error] [Thread-4 (]: 4 of 5 ERROR unique_dim_products_product_id .................................... [[31mERROR[0m in 2.21s]
[0m15:00:38.038910 [debug] [Thread-4 (]: Finished running node test.dbt_exercise.unique_dim_products_product_id.ef7b2a9985
[0m15:00:38.040004 [debug] [Thread-7 (]: Marking all children of 'test.dbt_exercise.unique_dim_products_product_id.ef7b2a9985' to be skipped because of status 'error'.  Reason: Database Error in test unique_dim_products_product_id (models/marts/dim_products.yml)
  Not found: Dataset corded-sunlight-464012-e2:dbt_dw_marts was not found in location US
  compiled code at target/run/dbt_exercise/models/marts/dim_products.yml/unique_dim_products_product_id.sql.
[0m15:00:38.064054 [debug] [Thread-2 (]: Database Error in test not_null_dim_products_product_id (models/marts/dim_products.yml)
  Not found: Dataset corded-sunlight-464012-e2:dbt_dw_marts was not found in location US
  compiled code at target/run/dbt_exercise/models/marts/dim_products.yml/not_null_dim_products_product_id.sql
[0m15:00:38.064840 [error] [Thread-2 (]: 2 of 5 ERROR not_null_dim_products_product_id .................................. [[31mERROR[0m in 2.24s]
[0m15:00:38.065700 [debug] [Thread-2 (]: Finished running node test.dbt_exercise.not_null_dim_products_product_id.c8aba288d1
[0m15:00:38.066601 [debug] [Thread-7 (]: Marking all children of 'test.dbt_exercise.not_null_dim_products_product_id.c8aba288d1' to be skipped because of status 'error'.  Reason: Database Error in test not_null_dim_products_product_id (models/marts/dim_products.yml)
  Not found: Dataset corded-sunlight-464012-e2:dbt_dw_marts was not found in location US
  compiled code at target/run/dbt_exercise/models/marts/dim_products.yml/not_null_dim_products_product_id.sql.
[0m15:00:39.487260 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:c059a5c1-1c68-4e14-bec1-73a556599755&page=queryresults
[0m15:00:39.488623 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:c059a5c1-1c68-4e14-bec1-73a556599755&page=queryresults
[0m15:00:39.523064 [debug] [Thread-1 (]: Database Error in test unique_dim_products_product_sk (models/marts/dim_products.yml)
  Not found: Dataset corded-sunlight-464012-e2:dbt_dw_marts was not found in location US
  compiled code at target/run/dbt_exercise/models/marts/dim_products.yml/unique_dim_products_product_sk.sql
[0m15:00:39.524069 [error] [Thread-1 (]: 5 of 5 ERROR unique_dim_products_product_sk .................................... [[31mERROR[0m in 2.07s]
[0m15:00:39.524806 [debug] [Thread-1 (]: Finished running node test.dbt_exercise.unique_dim_products_product_sk.8f20ac7c5b
[0m15:00:39.526782 [debug] [Thread-7 (]: Marking all children of 'test.dbt_exercise.unique_dim_products_product_sk.8f20ac7c5b' to be skipped because of status 'error'.  Reason: Database Error in test unique_dim_products_product_sk (models/marts/dim_products.yml)
  Not found: Dataset corded-sunlight-464012-e2:dbt_dw_marts was not found in location US
  compiled code at target/run/dbt_exercise/models/marts/dim_products.yml/unique_dim_products_product_sk.sql.
[0m15:00:39.530594 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:00:39.537154 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:00:39.537582 [debug] [MainThread]: Connection 'test.dbt_exercise.unique_dim_products_product_sk.8f20ac7c5b' was properly closed.
[0m15:00:39.537788 [debug] [MainThread]: Connection 'test.dbt_exercise.not_null_dim_products_product_sk.2a2df3e1b9' was properly closed.
[0m15:00:39.538019 [debug] [MainThread]: Connection 'test.dbt_exercise.unique_dim_products_product_id.ef7b2a9985' was properly closed.
[0m15:00:39.538256 [debug] [MainThread]: Connection 'test.dbt_exercise.not_null_dim_products_product_id.c8aba288d1' was properly closed.
[0m15:00:39.538813 [info ] [MainThread]: 
[0m15:00:39.539324 [info ] [MainThread]: Finished running 5 data tests in 0 hours 0 minutes and 4.72 seconds (4.72s).
[0m15:00:39.540587 [debug] [MainThread]: Command end result
[0m15:00:39.588841 [debug] [MainThread]: Wrote artifact WritableManifest to /home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/target/manifest.json
[0m15:00:39.601862 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/target/semantic_manifest.json
[0m15:00:39.610683 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/target/run_results.json
[0m15:00:39.611099 [info ] [MainThread]: 
[0m15:00:39.611643 [info ] [MainThread]: [31mCompleted with 5 errors, 0 partial successes, and 0 warnings:[0m
[0m15:00:39.612133 [info ] [MainThread]: 
[0m15:00:39.612570 [error] [MainThread]: [31mFailure in test accepted_values_dim_products_discontinued__True__False (models/marts/dim_products.yml)[0m
[0m15:00:39.612973 [error] [MainThread]:   Database Error in test accepted_values_dim_products_discontinued__True__False (models/marts/dim_products.yml)
  Not found: Dataset corded-sunlight-464012-e2:dbt_dw_marts was not found in location US
  compiled code at target/run/dbt_exercise/models/marts/dim_products.yml/accepted_values_dim_products_discontinued__True__False.sql
[0m15:00:39.613375 [info ] [MainThread]: 
[0m15:00:39.613766 [info ] [MainThread]:   compiled code at target/compiled/dbt_exercise/models/marts/dim_products.yml/accepted_values_dim_products_discontinued__True__False.sql
[0m15:00:39.614087 [info ] [MainThread]: 
[0m15:00:39.614521 [error] [MainThread]: [31mFailure in test not_null_dim_products_product_sk (models/marts/dim_products.yml)[0m
[0m15:00:39.614899 [error] [MainThread]:   Database Error in test not_null_dim_products_product_sk (models/marts/dim_products.yml)
  Not found: Dataset corded-sunlight-464012-e2:dbt_dw_marts was not found in location US
  compiled code at target/run/dbt_exercise/models/marts/dim_products.yml/not_null_dim_products_product_sk.sql
[0m15:00:39.615173 [info ] [MainThread]: 
[0m15:00:39.615496 [info ] [MainThread]:   compiled code at target/compiled/dbt_exercise/models/marts/dim_products.yml/not_null_dim_products_product_sk.sql
[0m15:00:39.615794 [info ] [MainThread]: 
[0m15:00:39.616143 [error] [MainThread]: [31mFailure in test unique_dim_products_product_id (models/marts/dim_products.yml)[0m
[0m15:00:39.616547 [error] [MainThread]:   Database Error in test unique_dim_products_product_id (models/marts/dim_products.yml)
  Not found: Dataset corded-sunlight-464012-e2:dbt_dw_marts was not found in location US
  compiled code at target/run/dbt_exercise/models/marts/dim_products.yml/unique_dim_products_product_id.sql
[0m15:00:39.616910 [info ] [MainThread]: 
[0m15:00:39.617365 [info ] [MainThread]:   compiled code at target/compiled/dbt_exercise/models/marts/dim_products.yml/unique_dim_products_product_id.sql
[0m15:00:39.617675 [info ] [MainThread]: 
[0m15:00:39.618040 [error] [MainThread]: [31mFailure in test not_null_dim_products_product_id (models/marts/dim_products.yml)[0m
[0m15:00:39.618418 [error] [MainThread]:   Database Error in test not_null_dim_products_product_id (models/marts/dim_products.yml)
  Not found: Dataset corded-sunlight-464012-e2:dbt_dw_marts was not found in location US
  compiled code at target/run/dbt_exercise/models/marts/dim_products.yml/not_null_dim_products_product_id.sql
[0m15:00:39.618832 [info ] [MainThread]: 
[0m15:00:39.619269 [info ] [MainThread]:   compiled code at target/compiled/dbt_exercise/models/marts/dim_products.yml/not_null_dim_products_product_id.sql
[0m15:00:39.619731 [info ] [MainThread]: 
[0m15:00:39.620164 [error] [MainThread]: [31mFailure in test unique_dim_products_product_sk (models/marts/dim_products.yml)[0m
[0m15:00:39.620601 [error] [MainThread]:   Database Error in test unique_dim_products_product_sk (models/marts/dim_products.yml)
  Not found: Dataset corded-sunlight-464012-e2:dbt_dw_marts was not found in location US
  compiled code at target/run/dbt_exercise/models/marts/dim_products.yml/unique_dim_products_product_sk.sql
[0m15:00:39.621082 [info ] [MainThread]: 
[0m15:00:39.621587 [info ] [MainThread]:   compiled code at target/compiled/dbt_exercise/models/marts/dim_products.yml/unique_dim_products_product_sk.sql
[0m15:00:39.622083 [info ] [MainThread]: 
[0m15:00:39.622774 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=5 SKIP=0 NO-OP=0 TOTAL=5
[0m15:00:39.623800 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- DuplicateYAMLKeysDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m15:00:39.628210 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": false, "command_wall_clock_time": 95.34288, "process_in_blocks": "139888", "process_kernel_time": 13.976324, "process_mem_max_rss": "364040", "process_out_blocks": "3640", "process_user_time": 10.471164}
[0m15:00:39.629155 [debug] [MainThread]: Command `dbt test` failed at 15:00:39.628930 after 95.34 seconds
[0m15:00:39.630197 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7aee4f39e330>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7aee11546de0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7aee4f9af500>]}
[0m15:00:39.631055 [debug] [MainThread]: Flushing usage events
[0m15:00:39.941350 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:05:11.405222 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x794f619ab440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x794f632b5be0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x794f617cdd30>]}


============================== 15:05:11.421033 | d61fcca5-8d30-496f-accc-31f5bcc987ea ==============================
[0m15:05:11.421033 [info ] [MainThread]: Running with dbt=1.10.2
[0m15:05:11.421881 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt run -s dim_products', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m15:05:57.724612 [warn ] [MainThread]: [[33mWARNING[0m][DuplicateYAMLKeysDeprecation]: Deprecated functionality
Duplicate key 'version' in "<unicode string>", line 4, column 1 in file
`/home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/dbt_project.yml`
[0m15:05:57.725251 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'd61fcca5-8d30-496f-accc-31f5bcc987ea', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x794f23ed2300>]}
[0m15:05:58.287633 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd61fcca5-8d30-496f-accc-31f5bcc987ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x794f27481250>]}
[0m15:05:58.337812 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd61fcca5-8d30-496f-accc-31f5bcc987ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x794f613070e0>]}
[0m15:05:58.341246 [info ] [MainThread]: Registered adapter: bigquery=1.9.2
[0m15:06:45.346129 [debug] [MainThread]: checksum: 1adc40777973ef30f45f80b3b6d04d5013c1edd53d96363881b3b199e612468b, vars: {}, profile: , target: , version: 1.10.2
[0m15:06:53.227478 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:06:53.227881 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:06:53.272201 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd61fcca5-8d30-496f-accc-31f5bcc987ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x794f23870410>]}
[0m15:06:53.545746 [debug] [MainThread]: Wrote artifact WritableManifest to /home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/target/manifest.json
[0m15:06:53.557552 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/target/semantic_manifest.json
[0m15:06:53.914084 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd61fcca5-8d30-496f-accc-31f5bcc987ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x794f60efa4e0>]}
[0m15:06:53.914609 [info ] [MainThread]: Found 14 seeds, 36 data tests, 19 models, 14 sources, 609 macros
[0m15:06:53.914953 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd61fcca5-8d30-496f-accc-31f5bcc987ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x794f238d21b0>]}
[0m15:06:53.916846 [info ] [MainThread]: 
[0m15:06:53.917352 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:06:53.917654 [info ] [MainThread]: 
[0m15:06:53.918160 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m15:06:53.919496 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_corded-sunlight-464012-e2'
[0m15:06:53.920239 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:06:54.813588 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_corded-sunlight-464012-e2, now create_corded-sunlight-464012-e2_dbt_dw_marts)
[0m15:06:54.814418 [debug] [ThreadPool]: Creating schema "database: "corded-sunlight-464012-e2"
schema: "dbt_dw_marts"
"
[0m15:06:54.825087 [debug] [ThreadPool]: On create_corded-sunlight-464012-e2_dbt_dw_marts: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "connection_name": "create_corded-sunlight-464012-e2_dbt_dw_marts"} */
create schema if not exists `corded-sunlight-464012-e2`.`dbt_dw_marts`
  
[0m15:06:54.825650 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:06:55.939460 [debug] [ThreadPool]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:d9aea997-c13b-46fa-8928-6e8b6053f30f&page=queryresults
[0m15:07:00.423874 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_corded-sunlight-464012-e2_dbt_dw_marts, now list_corded-sunlight-464012-e2_dbt_dw_staging)
[0m15:07:00.424867 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:07:00.425887 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_corded-sunlight-464012-e2_dbt_dw_intermediate'
[0m15:07:00.427473 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_corded-sunlight-464012-e2_dbt_dw_marts'
[0m15:07:00.428231 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:07:00.429236 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_corded-sunlight-464012-e2_dbt_dw_raw'
[0m15:07:00.430223 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:07:00.431315 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:07:01.261619 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd61fcca5-8d30-496f-accc-31f5bcc987ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x794f253464b0>]}
[0m15:07:01.262248 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:07:01.274726 [debug] [Thread-1 (]: Began running node model.dbt_exercise.dim_products
[0m15:07:01.275380 [info ] [Thread-1 (]: 1 of 1 START sql table model dbt_dw_marts.dim_products ......................... [RUN]
[0m15:07:01.276022 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_corded-sunlight-464012-e2_dbt_dw_staging, now model.dbt_exercise.dim_products)
[0m15:07:01.276712 [debug] [Thread-1 (]: Began compiling node model.dbt_exercise.dim_products
[0m15:07:01.296030 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_exercise.dim_products"
[0m15:07:01.298085 [debug] [Thread-1 (]: Began executing node model.dbt_exercise.dim_products
[0m15:07:01.329759 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_exercise.dim_products"
[0m15:07:01.331753 [debug] [Thread-1 (]: On model.dbt_exercise.dim_products: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "model.dbt_exercise.dim_products"} */

  
    

    create or replace table `corded-sunlight-464012-e2`.`dbt_dw_marts`.`dim_products`
      
    
    

    OPTIONS()
    as (
      with int_products as (
    select *
    from `corded-sunlight-464012-e2`.`dbt_dw_intermediate`.`int_products_northwind`
)

, dim_products as (
    select
        to_hex(md5(cast(coalesce(cast(product_id as string), '_dbt_utils_surrogate_key_null_') as string))) as sk_product
        , product_id
        , product_name
        , quantity_per_unit
        , category_name
        , supplier_name
        , supplier_city
        , supplier_region
        , supplier_country
        , supplier_continent
        , discontinued
    from int_products
)

select *
from dim_products
    );
  
[0m15:07:01.332851 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:07:02.514343 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:a5c0587c-4efc-4d00-940c-2e5437a4e736&page=queryresults
[0m15:07:05.186567 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd61fcca5-8d30-496f-accc-31f5bcc987ea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x794f2c656720>]}
[0m15:07:05.187491 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dbt_dw_marts.dim_products .................... [[32mCREATE TABLE (77.0 rows, 6.6 KiB processed)[0m in 3.90s]
[0m15:07:05.188174 [debug] [Thread-1 (]: Finished running node model.dbt_exercise.dim_products
[0m15:07:05.191430 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:07:05.200029 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:07:05.200602 [debug] [MainThread]: Connection 'model.dbt_exercise.dim_products' was properly closed.
[0m15:07:05.200879 [debug] [MainThread]: Connection 'list_corded-sunlight-464012-e2_dbt_dw_intermediate' was properly closed.
[0m15:07:05.201158 [debug] [MainThread]: Connection 'list_corded-sunlight-464012-e2_dbt_dw_marts' was properly closed.
[0m15:07:05.201498 [debug] [MainThread]: Connection 'list_corded-sunlight-464012-e2_dbt_dw_raw' was properly closed.
[0m15:07:05.201988 [info ] [MainThread]: 
[0m15:07:05.202444 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 11.28 seconds (11.28s).
[0m15:07:05.203249 [debug] [MainThread]: Command end result
[0m15:07:05.253972 [debug] [MainThread]: Wrote artifact WritableManifest to /home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/target/manifest.json
[0m15:07:05.268003 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/target/semantic_manifest.json
[0m15:07:05.275612 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/target/run_results.json
[0m15:07:05.276054 [info ] [MainThread]: 
[0m15:07:05.276457 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:07:05.276877 [info ] [MainThread]: 
[0m15:07:05.277298 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m15:07:05.277921 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- DuplicateYAMLKeysDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m15:07:05.282836 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 103.18188, "process_in_blocks": "123024", "process_kernel_time": 14.586281, "process_mem_max_rss": "366760", "process_out_blocks": "3536", "process_user_time": 10.814873}
[0m15:07:05.284154 [debug] [MainThread]: Command `dbt run` succeeded at 15:07:05.283698 after 103.18 seconds
[0m15:07:05.285339 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x794f614c3bc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x794f636c5d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x794f632268a0>]}
[0m15:07:05.285942 [debug] [MainThread]: Flushing usage events
[0m15:07:05.598793 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:07:35.053893 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bbfd3204650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bbfd4c31ee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bbfd43e8200>]}


============================== 15:07:35.068794 | ce935e5d-c25d-4733-aa6b-7f11d9110a6f ==============================
[0m15:07:35.068794 [info ] [MainThread]: Running with dbt=1.10.2
[0m15:07:35.069332 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise', 'debug': 'False', 'warn_error': 'None', 'log_path': '/home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'invocation_command': 'dbt test', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:08:19.967347 [warn ] [MainThread]: [[33mWARNING[0m][DuplicateYAMLKeysDeprecation]: Deprecated functionality
Duplicate key 'version' in "<unicode string>", line 4, column 1 in file
`/home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/dbt_project.yml`
[0m15:08:19.967919 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'ce935e5d-c25d-4733-aa6b-7f11d9110a6f', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bbf955c2720>]}
[0m15:08:20.545122 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ce935e5d-c25d-4733-aa6b-7f11d9110a6f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bbfd49d2870>]}
[0m15:08:20.597372 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ce935e5d-c25d-4733-aa6b-7f11d9110a6f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bbfd2cb7c80>]}
[0m15:08:20.602863 [info ] [MainThread]: Registered adapter: bigquery=1.9.2
[0m15:09:04.406248 [debug] [MainThread]: checksum: 1adc40777973ef30f45f80b3b6d04d5013c1edd53d96363881b3b199e612468b, vars: {}, profile: , target: , version: 1.10.2
[0m15:09:08.793441 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:09:08.793960 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:09:08.847016 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ce935e5d-c25d-4733-aa6b-7f11d9110a6f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bbf950d7b00>]}
[0m15:09:09.144930 [debug] [MainThread]: Wrote artifact WritableManifest to /home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/target/manifest.json
[0m15:09:09.157220 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/target/semantic_manifest.json
[0m15:09:09.569839 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ce935e5d-c25d-4733-aa6b-7f11d9110a6f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bbf95045a30>]}
[0m15:09:09.570539 [info ] [MainThread]: Found 14 seeds, 36 data tests, 19 models, 14 sources, 609 macros
[0m15:09:09.571233 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ce935e5d-c25d-4733-aa6b-7f11d9110a6f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bbf9515c470>]}
[0m15:09:09.575232 [info ] [MainThread]: 
[0m15:09:09.576704 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:09:09.577571 [info ] [MainThread]: 
[0m15:09:09.578610 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m15:09:09.584179 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_corded-sunlight-464012-e2_dbt_dw_marts'
[0m15:09:09.585638 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_corded-sunlight-464012-e2_dbt_dw_staging'
[0m15:09:09.586279 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:09:09.587347 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_corded-sunlight-464012-e2_dbt_dw_raw'
[0m15:09:09.587798 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:09:09.588891 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_corded-sunlight-464012-e2_dbt_dw_intermediate'
[0m15:09:09.590147 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:09:09.591453 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:11:43.065991 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ce935e5d-c25d-4733-aa6b-7f11d9110a6f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bbfd4aac4d0>]}
[0m15:11:43.067332 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:11:43.080456 [debug] [Thread-1 (]: Began running node test.dbt_exercise.accepted_values_dim_products_discontinued__True__False.07bc696cf6
[0m15:11:43.081130 [debug] [Thread-2 (]: Began running node test.dbt_exercise.not_null_dim_products_product_id.c8aba288d1
[0m15:11:43.082660 [debug] [Thread-3 (]: Began running node test.dbt_exercise.not_null_dim_products_product_sk.2a2df3e1b9
[0m15:11:43.082011 [info ] [Thread-1 (]: 1 of 36 START test accepted_values_dim_products_discontinued__True__False ...... [RUN]
[0m15:11:43.083921 [debug] [Thread-4 (]: Began running node test.dbt_exercise.source_accepted_values_northwind_categories_category_name__Beverages__Condiments__Confections__Dairy_Products__Grains_Cereals__Meat_Poultry__Produce__Seafood.ea6d0ab2ae
[0m15:11:43.084789 [info ] [Thread-2 (]: 2 of 36 START test not_null_dim_products_product_id ............................ [RUN]
[0m15:11:43.085600 [info ] [Thread-3 (]: 3 of 36 START test not_null_dim_products_product_sk ............................ [RUN]
[0m15:11:43.086634 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_corded-sunlight-464012-e2_dbt_dw_marts, now test.dbt_exercise.accepted_values_dim_products_discontinued__True__False.07bc696cf6)
[0m15:11:43.087797 [info ] [Thread-4 (]: 4 of 36 START test source_accepted_values_northwind_categories_category_name__Beverages__Condiments__Confections__Dairy_Products__Grains_Cereals__Meat_Poultry__Produce__Seafood  [RUN]
[0m15:11:43.088472 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_corded-sunlight-464012-e2_dbt_dw_intermediate, now test.dbt_exercise.not_null_dim_products_product_id.c8aba288d1)
[0m15:11:43.089243 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_corded-sunlight-464012-e2_dbt_dw_raw, now test.dbt_exercise.not_null_dim_products_product_sk.2a2df3e1b9)
[0m15:11:43.090006 [debug] [Thread-1 (]: Began compiling node test.dbt_exercise.accepted_values_dim_products_discontinued__True__False.07bc696cf6
[0m15:11:43.090594 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly list_corded-sunlight-464012-e2_dbt_dw_staging, now test.dbt_exercise.source_accepted_values_northwind_categories_category_name__Beverages__Condiments__Confections__Dairy_Products__Grains_Cereals__Meat_Poultry__Produce__Seafood.ea6d0ab2ae)
[0m15:11:43.091311 [debug] [Thread-2 (]: Began compiling node test.dbt_exercise.not_null_dim_products_product_id.c8aba288d1
[0m15:11:43.092435 [debug] [Thread-3 (]: Began compiling node test.dbt_exercise.not_null_dim_products_product_sk.2a2df3e1b9
[0m15:11:43.112679 [debug] [Thread-4 (]: Began compiling node test.dbt_exercise.source_accepted_values_northwind_categories_category_name__Beverages__Condiments__Confections__Dairy_Products__Grains_Cereals__Meat_Poultry__Produce__Seafood.ea6d0ab2ae
[0m15:11:43.115829 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_exercise.accepted_values_dim_products_discontinued__True__False.07bc696cf6"
[0m15:11:43.126591 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_exercise.not_null_dim_products_product_id.c8aba288d1"
[0m15:11:43.130918 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_exercise.not_null_dim_products_product_sk.2a2df3e1b9"
[0m15:11:43.140240 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_exercise.source_accepted_values_northwind_categories_category_name__Beverages__Condiments__Confections__Dairy_Products__Grains_Cereals__Meat_Poultry__Produce__Seafood.ea6d0ab2ae"
[0m15:11:43.141841 [debug] [Thread-2 (]: Began executing node test.dbt_exercise.not_null_dim_products_product_id.c8aba288d1
[0m15:11:43.143379 [debug] [Thread-3 (]: Began executing node test.dbt_exercise.not_null_dim_products_product_sk.2a2df3e1b9
[0m15:11:43.144318 [debug] [Thread-1 (]: Began executing node test.dbt_exercise.accepted_values_dim_products_discontinued__True__False.07bc696cf6
[0m15:11:43.169043 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_exercise.not_null_dim_products_product_id.c8aba288d1"
[0m15:11:43.169936 [debug] [Thread-4 (]: Began executing node test.dbt_exercise.source_accepted_values_northwind_categories_category_name__Beverages__Condiments__Confections__Dairy_Products__Grains_Cereals__Meat_Poultry__Produce__Seafood.ea6d0ab2ae
[0m15:11:43.174012 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_exercise.not_null_dim_products_product_sk.2a2df3e1b9"
[0m15:11:43.176904 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_exercise.accepted_values_dim_products_discontinued__True__False.07bc696cf6"
[0m15:11:43.180233 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_exercise.source_accepted_values_northwind_categories_category_name__Beverages__Condiments__Confections__Dairy_Products__Grains_Cereals__Meat_Poultry__Produce__Seafood.ea6d0ab2ae"
[0m15:11:43.181452 [debug] [Thread-2 (]: On test.dbt_exercise.not_null_dim_products_product_id.c8aba288d1: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "test.dbt_exercise.not_null_dim_products_product_id.c8aba288d1"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select product_id
from `corded-sunlight-464012-e2`.`dbt_dw_marts`.`dim_products`
where product_id is null



  
  
      
    ) dbt_internal_test
[0m15:11:43.183504 [debug] [Thread-3 (]: On test.dbt_exercise.not_null_dim_products_product_sk.2a2df3e1b9: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "test.dbt_exercise.not_null_dim_products_product_sk.2a2df3e1b9"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select product_sk
from `corded-sunlight-464012-e2`.`dbt_dw_marts`.`dim_products`
where product_sk is null



  
  
      
    ) dbt_internal_test
[0m15:11:43.184629 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:11:43.185730 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:11:43.186401 [debug] [Thread-1 (]: On test.dbt_exercise.accepted_values_dim_products_discontinued__True__False.07bc696cf6: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "test.dbt_exercise.accepted_values_dim_products_discontinued__True__False.07bc696cf6"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        discontinued as value_field,
        count(*) as n_records

    from `corded-sunlight-464012-e2`.`dbt_dw_marts`.`dim_products`
    group by discontinued

)

select *
from all_values
where value_field not in (
    'True','False'
)



  
  
      
    ) dbt_internal_test
[0m15:11:43.187036 [debug] [Thread-4 (]: On test.dbt_exercise.source_accepted_values_northwind_categories_category_name__Beverages__Condiments__Confections__Dairy_Products__Grains_Cereals__Meat_Poultry__Produce__Seafood.ea6d0ab2ae: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "test.dbt_exercise.source_accepted_values_northwind_categories_category_name__Beverages__Condiments__Confections__Dairy_Products__Grains_Cereals__Meat_Poultry__Produce__Seafood.ea6d0ab2ae"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        category_name as value_field,
        count(*) as n_records

    from `corded-sunlight-464012-e2`.`dbt_dw_raw`.`categories`
    group by category_name

)

select *
from all_values
where value_field not in (
    'Beverages','Condiments','Confections','Dairy Products','Grains/Cereals','Meat/Poultry','Produce','Seafood'
)



  
  
      
    ) dbt_internal_test
[0m15:11:43.188310 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:11:43.188942 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m15:11:44.188199 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:fb98d673-2020-4e90-8a58-7717fdd0e51b&page=queryresults
[0m15:11:44.189056 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:fb98d673-2020-4e90-8a58-7717fdd0e51b&page=queryresults
[0m15:11:44.265696 [debug] [Thread-1 (]: Database Error in test accepted_values_dim_products_discontinued__True__False (models/marts/dim_products.yml)
  No matching signature for operator IN for argument types BOOL and {STRING} at [27:23]
  compiled code at target/run/dbt_exercise/models/marts/dim_products.yml/accepted_values_dim_products_discontinued__True__False.sql
[0m15:11:44.266513 [error] [Thread-1 (]: 1 of 36 ERROR accepted_values_dim_products_discontinued__True__False ........... [[31mERROR[0m in 1.18s]
[0m15:11:44.267255 [debug] [Thread-1 (]: Finished running node test.dbt_exercise.accepted_values_dim_products_discontinued__True__False.07bc696cf6
[0m15:11:44.267802 [debug] [Thread-1 (]: Began running node test.dbt_exercise.source_not_null_northwind_categories_category_id.9a6df29828
[0m15:11:44.268343 [debug] [Thread-7 (]: Marking all children of 'test.dbt_exercise.accepted_values_dim_products_discontinued__True__False.07bc696cf6' to be skipped because of status 'error'.  Reason: Database Error in test accepted_values_dim_products_discontinued__True__False (models/marts/dim_products.yml)
  No matching signature for operator IN for argument types BOOL and {STRING} at [27:23]
  compiled code at target/run/dbt_exercise/models/marts/dim_products.yml/accepted_values_dim_products_discontinued__True__False.sql.
[0m15:11:44.269037 [info ] [Thread-1 (]: 5 of 36 START test source_not_null_northwind_categories_category_id ............ [RUN]
[0m15:11:44.271131 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_exercise.accepted_values_dim_products_discontinued__True__False.07bc696cf6, now test.dbt_exercise.source_not_null_northwind_categories_category_id.9a6df29828)
[0m15:11:44.271693 [debug] [Thread-1 (]: Began compiling node test.dbt_exercise.source_not_null_northwind_categories_category_id.9a6df29828
[0m15:11:44.275844 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_exercise.source_not_null_northwind_categories_category_id.9a6df29828"
[0m15:11:44.276885 [debug] [Thread-1 (]: Began executing node test.dbt_exercise.source_not_null_northwind_categories_category_id.9a6df29828
[0m15:11:44.279055 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_exercise.source_not_null_northwind_categories_category_id.9a6df29828"
[0m15:11:44.279862 [debug] [Thread-1 (]: On test.dbt_exercise.source_not_null_northwind_categories_category_id.9a6df29828: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "test.dbt_exercise.source_not_null_northwind_categories_category_id.9a6df29828"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select category_id
from `corded-sunlight-464012-e2`.`dbt_dw_raw`.`categories`
where category_id is null



  
  
      
    ) dbt_internal_test
[0m15:11:44.280365 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:11:44.324839 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:cdf93ac2-64ba-4173-a23a-70fecafe174a&page=queryresults
[0m15:11:44.391238 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:cb83ca61-3f80-4780-9820-5987eef245c5&page=queryresults
[0m15:11:44.456773 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:8a05c8e6-41cc-4ff9-bdbe-79cd0c0e8889&page=queryresults
[0m15:11:44.457467 [error] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:8a05c8e6-41cc-4ff9-bdbe-79cd0c0e8889&page=queryresults
[0m15:11:44.488141 [debug] [Thread-3 (]: Database Error in test not_null_dim_products_product_sk (models/marts/dim_products.yml)
  Unrecognized name: product_sk; Did you mean product_id? at [18:7]
  compiled code at target/run/dbt_exercise/models/marts/dim_products.yml/not_null_dim_products_product_sk.sql
[0m15:11:44.488753 [error] [Thread-3 (]: 3 of 36 ERROR not_null_dim_products_product_sk ................................. [[31mERROR[0m in 1.40s]
[0m15:11:44.489462 [debug] [Thread-3 (]: Finished running node test.dbt_exercise.not_null_dim_products_product_sk.2a2df3e1b9
[0m15:11:44.489889 [debug] [Thread-3 (]: Began running node test.dbt_exercise.source_not_null_northwind_country_codes_country_code.c623b5676c
[0m15:11:44.490542 [debug] [Thread-7 (]: Marking all children of 'test.dbt_exercise.not_null_dim_products_product_sk.2a2df3e1b9' to be skipped because of status 'error'.  Reason: Database Error in test not_null_dim_products_product_sk (models/marts/dim_products.yml)
  Unrecognized name: product_sk; Did you mean product_id? at [18:7]
  compiled code at target/run/dbt_exercise/models/marts/dim_products.yml/not_null_dim_products_product_sk.sql.
[0m15:11:44.491370 [info ] [Thread-3 (]: 6 of 36 START test source_not_null_northwind_country_codes_country_code ........ [RUN]
[0m15:11:44.492695 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_exercise.not_null_dim_products_product_sk.2a2df3e1b9, now test.dbt_exercise.source_not_null_northwind_country_codes_country_code.c623b5676c)
[0m15:11:44.493131 [debug] [Thread-3 (]: Began compiling node test.dbt_exercise.source_not_null_northwind_country_codes_country_code.c623b5676c
[0m15:11:44.497308 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_exercise.source_not_null_northwind_country_codes_country_code.c623b5676c"
[0m15:11:44.498291 [debug] [Thread-3 (]: Began executing node test.dbt_exercise.source_not_null_northwind_country_codes_country_code.c623b5676c
[0m15:11:44.500494 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_exercise.source_not_null_northwind_country_codes_country_code.c623b5676c"
[0m15:11:44.501220 [debug] [Thread-3 (]: On test.dbt_exercise.source_not_null_northwind_country_codes_country_code.c623b5676c: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "test.dbt_exercise.source_not_null_northwind_country_codes_country_code.c623b5676c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select country_code
from `corded-sunlight-464012-e2`.`dbt_dw_raw`.`country_codes`
where country_code is null



  
  
      
    ) dbt_internal_test
[0m15:11:44.501650 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:11:45.420018 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:5170ded6-e677-4acc-be8b-e43d280b66a9&page=queryresults
[0m15:11:45.590059 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:89da4ab7-a9e6-4fce-bc95-bb11e6a1be93&page=queryresults
[0m15:11:48.826705 [info ] [Thread-2 (]: 2 of 36 PASS not_null_dim_products_product_id .................................. [[32mPASS[0m in 5.74s]
[0m15:11:48.827637 [debug] [Thread-2 (]: Finished running node test.dbt_exercise.not_null_dim_products_product_id.c8aba288d1
[0m15:11:48.828193 [debug] [Thread-2 (]: Began running node test.dbt_exercise.source_not_null_northwind_customers_customer_id.dba99593d2
[0m15:11:48.829610 [info ] [Thread-2 (]: 7 of 36 START test source_not_null_northwind_customers_customer_id ............. [RUN]
[0m15:11:48.830610 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_exercise.not_null_dim_products_product_id.c8aba288d1, now test.dbt_exercise.source_not_null_northwind_customers_customer_id.dba99593d2)
[0m15:11:48.833670 [debug] [Thread-2 (]: Began compiling node test.dbt_exercise.source_not_null_northwind_customers_customer_id.dba99593d2
[0m15:11:48.833216 [info ] [Thread-1 (]: 5 of 36 PASS source_not_null_northwind_categories_category_id .................. [[32mPASS[0m in 4.56s]
[0m15:11:48.839651 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_exercise.source_not_null_northwind_customers_customer_id.dba99593d2"
[0m15:11:48.842302 [debug] [Thread-1 (]: Finished running node test.dbt_exercise.source_not_null_northwind_categories_category_id.9a6df29828
[0m15:11:48.845409 [info ] [Thread-4 (]: 4 of 36 PASS source_accepted_values_northwind_categories_category_name__Beverages__Condiments__Confections__Dairy_Products__Grains_Cereals__Meat_Poultry__Produce__Seafood  [[32mPASS[0m in 5.75s]
[0m15:11:48.846114 [info ] [Thread-3 (]: 6 of 36 PASS source_not_null_northwind_country_codes_country_code .............. [[32mPASS[0m in 4.35s]
[0m15:11:48.847162 [debug] [Thread-1 (]: Began running node test.dbt_exercise.source_not_null_northwind_dados_financeiros_data.cdd6b46fe7
[0m15:11:48.848377 [debug] [Thread-4 (]: Finished running node test.dbt_exercise.source_accepted_values_northwind_categories_category_name__Beverages__Condiments__Confections__Dairy_Products__Grains_Cereals__Meat_Poultry__Produce__Seafood.ea6d0ab2ae
[0m15:11:48.849050 [debug] [Thread-2 (]: Began executing node test.dbt_exercise.source_not_null_northwind_customers_customer_id.dba99593d2
[0m15:11:48.849944 [debug] [Thread-3 (]: Finished running node test.dbt_exercise.source_not_null_northwind_country_codes_country_code.c623b5676c
[0m15:11:48.850864 [info ] [Thread-1 (]: 8 of 36 START test source_not_null_northwind_dados_financeiros_data ............ [RUN]
[0m15:11:48.851928 [debug] [Thread-4 (]: Began running node test.dbt_exercise.source_not_null_northwind_employee_territories_employee_id.d7372217ec
[0m15:11:48.855162 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_exercise.source_not_null_northwind_customers_customer_id.dba99593d2"
[0m15:11:48.856114 [debug] [Thread-3 (]: Began running node test.dbt_exercise.source_not_null_northwind_employee_territories_territory_id.ae648a0b88
[0m15:11:48.857265 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_exercise.source_not_null_northwind_categories_category_id.9a6df29828, now test.dbt_exercise.source_not_null_northwind_dados_financeiros_data.cdd6b46fe7)
[0m15:11:48.858315 [info ] [Thread-4 (]: 9 of 36 START test source_not_null_northwind_employee_territories_employee_id .. [RUN]
[0m15:11:48.859557 [info ] [Thread-3 (]: 10 of 36 START test source_not_null_northwind_employee_territories_territory_id  [RUN]
[0m15:11:48.860753 [debug] [Thread-1 (]: Began compiling node test.dbt_exercise.source_not_null_northwind_dados_financeiros_data.cdd6b46fe7
[0m15:11:48.861408 [debug] [Thread-2 (]: On test.dbt_exercise.source_not_null_northwind_customers_customer_id.dba99593d2: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "test.dbt_exercise.source_not_null_northwind_customers_customer_id.dba99593d2"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select customer_id
from `corded-sunlight-464012-e2`.`dbt_dw_raw`.`customers`
where customer_id is null



  
  
      
    ) dbt_internal_test
[0m15:11:48.862064 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_exercise.source_accepted_values_northwind_categories_category_name__Beverages__Condiments__Confections__Dairy_Products__Grains_Cereals__Meat_Poultry__Produce__Seafood.ea6d0ab2ae, now test.dbt_exercise.source_not_null_northwind_employee_territories_employee_id.d7372217ec)
[0m15:11:48.863059 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_exercise.source_not_null_northwind_country_codes_country_code.c623b5676c, now test.dbt_exercise.source_not_null_northwind_employee_territories_territory_id.ae648a0b88)
[0m15:11:48.867627 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_exercise.source_not_null_northwind_dados_financeiros_data.cdd6b46fe7"
[0m15:11:48.868659 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:11:48.869390 [debug] [Thread-4 (]: Began compiling node test.dbt_exercise.source_not_null_northwind_employee_territories_employee_id.d7372217ec
[0m15:11:48.870038 [debug] [Thread-3 (]: Began compiling node test.dbt_exercise.source_not_null_northwind_employee_territories_territory_id.ae648a0b88
[0m15:11:48.875328 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_exercise.source_not_null_northwind_employee_territories_employee_id.d7372217ec"
[0m15:11:48.876184 [debug] [Thread-1 (]: Began executing node test.dbt_exercise.source_not_null_northwind_dados_financeiros_data.cdd6b46fe7
[0m15:11:48.881927 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_exercise.source_not_null_northwind_employee_territories_territory_id.ae648a0b88"
[0m15:11:48.885991 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_exercise.source_not_null_northwind_dados_financeiros_data.cdd6b46fe7"
[0m15:11:48.887502 [debug] [Thread-4 (]: Began executing node test.dbt_exercise.source_not_null_northwind_employee_territories_employee_id.d7372217ec
[0m15:11:48.891347 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_exercise.source_not_null_northwind_employee_territories_employee_id.d7372217ec"
[0m15:11:48.894285 [debug] [Thread-1 (]: On test.dbt_exercise.source_not_null_northwind_dados_financeiros_data.cdd6b46fe7: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "test.dbt_exercise.source_not_null_northwind_dados_financeiros_data.cdd6b46fe7"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select data
from `corded-sunlight-464012-e2`.`dbt_dw_raw`.`dados_financeiros`
where data is null



  
  
      
    ) dbt_internal_test
[0m15:11:48.895056 [debug] [Thread-3 (]: Began executing node test.dbt_exercise.source_not_null_northwind_employee_territories_territory_id.ae648a0b88
[0m15:11:48.916056 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:11:48.918022 [debug] [Thread-4 (]: On test.dbt_exercise.source_not_null_northwind_employee_territories_employee_id.d7372217ec: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "test.dbt_exercise.source_not_null_northwind_employee_territories_employee_id.d7372217ec"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select employee_id
from `corded-sunlight-464012-e2`.`dbt_dw_raw`.`employee_territories`
where employee_id is null



  
  
      
    ) dbt_internal_test
[0m15:11:48.920430 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_exercise.source_not_null_northwind_employee_territories_territory_id.ae648a0b88"
[0m15:11:48.921586 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m15:11:48.923222 [debug] [Thread-3 (]: On test.dbt_exercise.source_not_null_northwind_employee_territories_territory_id.ae648a0b88: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "test.dbt_exercise.source_not_null_northwind_employee_territories_territory_id.ae648a0b88"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select territory_id
from `corded-sunlight-464012-e2`.`dbt_dw_raw`.`employee_territories`
where territory_id is null



  
  
      
    ) dbt_internal_test
[0m15:11:48.924081 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:11:49.923385 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:369548b6-fe7b-4501-96c3-9731e79567c3&page=queryresults
[0m15:11:49.970446 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:46472271-251a-49a2-b752-d19fcf426d9d&page=queryresults
[0m15:11:49.999735 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:ede731fd-cb6e-4cf3-87e0-745962ca7c93&page=queryresults
[0m15:11:50.084549 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:90bb6618-af41-4f73-9434-323ce95062c2&page=queryresults
[0m15:11:50.733430 [info ] [Thread-2 (]: 7 of 36 PASS source_not_null_northwind_customers_customer_id ................... [[32mPASS[0m in 1.90s]
[0m15:11:50.734247 [debug] [Thread-2 (]: Finished running node test.dbt_exercise.source_not_null_northwind_customers_customer_id.dba99593d2
[0m15:11:50.734808 [debug] [Thread-2 (]: Began running node test.dbt_exercise.source_not_null_northwind_employees_employee_id.829479a08c
[0m15:11:50.735427 [info ] [Thread-2 (]: 11 of 36 START test source_not_null_northwind_employees_employee_id ............ [RUN]
[0m15:11:50.736090 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_exercise.source_not_null_northwind_customers_customer_id.dba99593d2, now test.dbt_exercise.source_not_null_northwind_employees_employee_id.829479a08c)
[0m15:11:50.736504 [debug] [Thread-2 (]: Began compiling node test.dbt_exercise.source_not_null_northwind_employees_employee_id.829479a08c
[0m15:11:50.740576 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_exercise.source_not_null_northwind_employees_employee_id.829479a08c"
[0m15:11:50.741449 [debug] [Thread-2 (]: Began executing node test.dbt_exercise.source_not_null_northwind_employees_employee_id.829479a08c
[0m15:11:50.743778 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_exercise.source_not_null_northwind_employees_employee_id.829479a08c"
[0m15:11:50.744607 [debug] [Thread-2 (]: On test.dbt_exercise.source_not_null_northwind_employees_employee_id.829479a08c: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "test.dbt_exercise.source_not_null_northwind_employees_employee_id.829479a08c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select employee_id
from `corded-sunlight-464012-e2`.`dbt_dw_raw`.`employees`
where employee_id is null



  
  
      
    ) dbt_internal_test
[0m15:11:50.745025 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:11:50.810811 [info ] [Thread-3 (]: 10 of 36 PASS source_not_null_northwind_employee_territories_territory_id ...... [[32mPASS[0m in 1.95s]
[0m15:11:50.811625 [debug] [Thread-3 (]: Finished running node test.dbt_exercise.source_not_null_northwind_employee_territories_territory_id.ae648a0b88
[0m15:11:50.812192 [debug] [Thread-3 (]: Began running node test.dbt_exercise.source_not_null_northwind_order_details_order_id.8acd43693e
[0m15:11:50.813018 [info ] [Thread-3 (]: 12 of 36 START test source_not_null_northwind_order_details_order_id ........... [RUN]
[0m15:11:50.813801 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_exercise.source_not_null_northwind_employee_territories_territory_id.ae648a0b88, now test.dbt_exercise.source_not_null_northwind_order_details_order_id.8acd43693e)
[0m15:11:50.814283 [debug] [Thread-3 (]: Began compiling node test.dbt_exercise.source_not_null_northwind_order_details_order_id.8acd43693e
[0m15:11:50.819126 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_exercise.source_not_null_northwind_order_details_order_id.8acd43693e"
[0m15:11:50.822309 [info ] [Thread-1 (]: 8 of 36 PASS source_not_null_northwind_dados_financeiros_data .................. [[32mPASS[0m in 1.97s]
[0m15:11:50.823423 [debug] [Thread-1 (]: Finished running node test.dbt_exercise.source_not_null_northwind_dados_financeiros_data.cdd6b46fe7
[0m15:11:50.824197 [debug] [Thread-3 (]: Began executing node test.dbt_exercise.source_not_null_northwind_order_details_order_id.8acd43693e
[0m15:11:50.824689 [debug] [Thread-1 (]: Began running node test.dbt_exercise.source_not_null_northwind_order_details_product_id.c084f7ad12
[0m15:11:50.827371 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_exercise.source_not_null_northwind_order_details_order_id.8acd43693e"
[0m15:11:50.828413 [info ] [Thread-1 (]: 13 of 36 START test source_not_null_northwind_order_details_product_id ......... [RUN]
[0m15:11:50.829595 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_exercise.source_not_null_northwind_dados_financeiros_data.cdd6b46fe7, now test.dbt_exercise.source_not_null_northwind_order_details_product_id.c084f7ad12)
[0m15:11:50.830632 [debug] [Thread-1 (]: Began compiling node test.dbt_exercise.source_not_null_northwind_order_details_product_id.c084f7ad12
[0m15:11:50.837042 [debug] [Thread-3 (]: On test.dbt_exercise.source_not_null_northwind_order_details_order_id.8acd43693e: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "test.dbt_exercise.source_not_null_northwind_order_details_order_id.8acd43693e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select order_id
from `corded-sunlight-464012-e2`.`dbt_dw_raw`.`order_details`
where order_id is null



  
  
      
    ) dbt_internal_test
[0m15:11:50.838281 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_exercise.source_not_null_northwind_order_details_product_id.c084f7ad12"
[0m15:11:50.839033 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:11:50.840245 [debug] [Thread-1 (]: Began executing node test.dbt_exercise.source_not_null_northwind_order_details_product_id.c084f7ad12
[0m15:11:50.842999 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_exercise.source_not_null_northwind_order_details_product_id.c084f7ad12"
[0m15:11:50.843855 [debug] [Thread-1 (]: On test.dbt_exercise.source_not_null_northwind_order_details_product_id.c084f7ad12: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "test.dbt_exercise.source_not_null_northwind_order_details_product_id.c084f7ad12"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select product_id
from `corded-sunlight-464012-e2`.`dbt_dw_raw`.`order_details`
where product_id is null



  
  
      
    ) dbt_internal_test
[0m15:11:50.844554 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:11:50.872181 [info ] [Thread-4 (]: 9 of 36 PASS source_not_null_northwind_employee_territories_employee_id ........ [[32mPASS[0m in 2.01s]
[0m15:11:50.894945 [debug] [Thread-4 (]: Finished running node test.dbt_exercise.source_not_null_northwind_employee_territories_employee_id.d7372217ec
[0m15:11:50.896660 [debug] [Thread-4 (]: Began running node test.dbt_exercise.source_not_null_northwind_orders_customer_id.3e09955b24
[0m15:11:50.897655 [info ] [Thread-4 (]: 14 of 36 START test source_not_null_northwind_orders_customer_id ............... [RUN]
[0m15:11:50.898337 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_exercise.source_not_null_northwind_employee_territories_employee_id.d7372217ec, now test.dbt_exercise.source_not_null_northwind_orders_customer_id.3e09955b24)
[0m15:11:50.898758 [debug] [Thread-4 (]: Began compiling node test.dbt_exercise.source_not_null_northwind_orders_customer_id.3e09955b24
[0m15:11:50.902573 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_exercise.source_not_null_northwind_orders_customer_id.3e09955b24"
[0m15:11:50.903312 [debug] [Thread-4 (]: Began executing node test.dbt_exercise.source_not_null_northwind_orders_customer_id.3e09955b24
[0m15:11:50.905842 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_exercise.source_not_null_northwind_orders_customer_id.3e09955b24"
[0m15:11:50.906755 [debug] [Thread-4 (]: On test.dbt_exercise.source_not_null_northwind_orders_customer_id.3e09955b24: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "test.dbt_exercise.source_not_null_northwind_orders_customer_id.3e09955b24"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select customer_id
from `corded-sunlight-464012-e2`.`dbt_dw_raw`.`orders`
where customer_id is null



  
  
      
    ) dbt_internal_test
[0m15:11:50.907269 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m15:11:51.726940 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:ce20a458-2550-4c6f-9ba6-ab43ca05d59a&page=queryresults
[0m15:11:51.825888 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:9ba3ade1-5cfd-4f55-8c50-5ad9da190856&page=queryresults
[0m15:11:51.855972 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:6ba3f84c-d1fd-4cf8-92a9-334d25a5693a&page=queryresults
[0m15:11:51.921848 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:defad5df-1be0-45e5-863c-52eb4fea41c4&page=queryresults
[0m15:11:52.497267 [info ] [Thread-2 (]: 11 of 36 PASS source_not_null_northwind_employees_employee_id .................. [[32mPASS[0m in 1.76s]
[0m15:11:52.498200 [debug] [Thread-2 (]: Finished running node test.dbt_exercise.source_not_null_northwind_employees_employee_id.829479a08c
[0m15:11:52.498806 [debug] [Thread-2 (]: Began running node test.dbt_exercise.source_not_null_northwind_orders_employee_id.a8f4bf5ca3
[0m15:11:52.499804 [info ] [Thread-2 (]: 15 of 36 START test source_not_null_northwind_orders_employee_id ............... [RUN]
[0m15:11:52.500630 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_exercise.source_not_null_northwind_employees_employee_id.829479a08c, now test.dbt_exercise.source_not_null_northwind_orders_employee_id.a8f4bf5ca3)
[0m15:11:52.501156 [debug] [Thread-2 (]: Began compiling node test.dbt_exercise.source_not_null_northwind_orders_employee_id.a8f4bf5ca3
[0m15:11:52.505580 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_exercise.source_not_null_northwind_orders_employee_id.a8f4bf5ca3"
[0m15:11:52.506335 [debug] [Thread-2 (]: Began executing node test.dbt_exercise.source_not_null_northwind_orders_employee_id.a8f4bf5ca3
[0m15:11:52.508674 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_exercise.source_not_null_northwind_orders_employee_id.a8f4bf5ca3"
[0m15:11:52.509527 [debug] [Thread-2 (]: On test.dbt_exercise.source_not_null_northwind_orders_employee_id.a8f4bf5ca3: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "test.dbt_exercise.source_not_null_northwind_orders_employee_id.a8f4bf5ca3"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select employee_id
from `corded-sunlight-464012-e2`.`dbt_dw_raw`.`orders`
where employee_id is null



  
  
      
    ) dbt_internal_test
[0m15:11:52.509934 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:11:52.623806 [info ] [Thread-3 (]: 12 of 36 PASS source_not_null_northwind_order_details_order_id ................. [[32mPASS[0m in 1.81s]
[0m15:11:52.624535 [debug] [Thread-3 (]: Finished running node test.dbt_exercise.source_not_null_northwind_order_details_order_id.8acd43693e
[0m15:11:52.625023 [debug] [Thread-3 (]: Began running node test.dbt_exercise.source_not_null_northwind_orders_order_id.5a7c008c6e
[0m15:11:52.625695 [info ] [Thread-3 (]: 16 of 36 START test source_not_null_northwind_orders_order_id .................. [RUN]
[0m15:11:52.626639 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_exercise.source_not_null_northwind_order_details_order_id.8acd43693e, now test.dbt_exercise.source_not_null_northwind_orders_order_id.5a7c008c6e)
[0m15:11:52.627392 [debug] [Thread-3 (]: Began compiling node test.dbt_exercise.source_not_null_northwind_orders_order_id.5a7c008c6e
[0m15:11:52.631544 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_exercise.source_not_null_northwind_orders_order_id.5a7c008c6e"
[0m15:11:52.634236 [info ] [Thread-1 (]: 13 of 36 PASS source_not_null_northwind_order_details_product_id ............... [[32mPASS[0m in 1.80s]
[0m15:11:52.635691 [debug] [Thread-1 (]: Finished running node test.dbt_exercise.source_not_null_northwind_order_details_product_id.c084f7ad12
[0m15:11:52.636732 [debug] [Thread-1 (]: Began running node test.dbt_exercise.source_not_null_northwind_products_product_id.1bc1aa1d1c
[0m15:11:52.637654 [debug] [Thread-3 (]: Began executing node test.dbt_exercise.source_not_null_northwind_orders_order_id.5a7c008c6e
[0m15:11:52.638254 [info ] [Thread-1 (]: 17 of 36 START test source_not_null_northwind_products_product_id .............. [RUN]
[0m15:11:52.641023 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_exercise.source_not_null_northwind_orders_order_id.5a7c008c6e"
[0m15:11:52.641952 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_exercise.source_not_null_northwind_order_details_product_id.c084f7ad12, now test.dbt_exercise.source_not_null_northwind_products_product_id.1bc1aa1d1c)
[0m15:11:52.643303 [debug] [Thread-1 (]: Began compiling node test.dbt_exercise.source_not_null_northwind_products_product_id.1bc1aa1d1c
[0m15:11:52.649144 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_exercise.source_not_null_northwind_products_product_id.1bc1aa1d1c"
[0m15:11:52.650124 [debug] [Thread-3 (]: On test.dbt_exercise.source_not_null_northwind_orders_order_id.5a7c008c6e: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "test.dbt_exercise.source_not_null_northwind_orders_order_id.5a7c008c6e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select order_id
from `corded-sunlight-464012-e2`.`dbt_dw_raw`.`orders`
where order_id is null



  
  
      
    ) dbt_internal_test
[0m15:11:52.651058 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:11:52.652405 [debug] [Thread-1 (]: Began executing node test.dbt_exercise.source_not_null_northwind_products_product_id.1bc1aa1d1c
[0m15:11:52.655476 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_exercise.source_not_null_northwind_products_product_id.1bc1aa1d1c"
[0m15:11:52.656387 [debug] [Thread-1 (]: On test.dbt_exercise.source_not_null_northwind_products_product_id.1bc1aa1d1c: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "test.dbt_exercise.source_not_null_northwind_products_product_id.1bc1aa1d1c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select product_id
from `corded-sunlight-464012-e2`.`dbt_dw_raw`.`products`
where product_id is null



  
  
      
    ) dbt_internal_test
[0m15:11:52.656975 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:11:52.823419 [info ] [Thread-4 (]: 14 of 36 PASS source_not_null_northwind_orders_customer_id ..................... [[32mPASS[0m in 1.92s]
[0m15:11:52.824407 [debug] [Thread-4 (]: Finished running node test.dbt_exercise.source_not_null_northwind_orders_customer_id.3e09955b24
[0m15:11:52.824894 [debug] [Thread-4 (]: Began running node test.dbt_exercise.source_not_null_northwind_region_region_id.c95367d9e3
[0m15:11:52.825562 [info ] [Thread-4 (]: 18 of 36 START test source_not_null_northwind_region_region_id ................. [RUN]
[0m15:11:52.826299 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_exercise.source_not_null_northwind_orders_customer_id.3e09955b24, now test.dbt_exercise.source_not_null_northwind_region_region_id.c95367d9e3)
[0m15:11:52.826723 [debug] [Thread-4 (]: Began compiling node test.dbt_exercise.source_not_null_northwind_region_region_id.c95367d9e3
[0m15:11:52.830952 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_exercise.source_not_null_northwind_region_region_id.c95367d9e3"
[0m15:11:52.831972 [debug] [Thread-4 (]: Began executing node test.dbt_exercise.source_not_null_northwind_region_region_id.c95367d9e3
[0m15:11:52.834552 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_exercise.source_not_null_northwind_region_region_id.c95367d9e3"
[0m15:11:52.835441 [debug] [Thread-4 (]: On test.dbt_exercise.source_not_null_northwind_region_region_id.c95367d9e3: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "test.dbt_exercise.source_not_null_northwind_region_region_id.c95367d9e3"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select region_id
from `corded-sunlight-464012-e2`.`dbt_dw_raw`.`region`
where region_id is null



  
  
      
    ) dbt_internal_test
[0m15:11:52.835900 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m15:11:53.546094 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:8af83946-b683-4df5-bb57-aeafafd35c29&page=queryresults
[0m15:11:53.700395 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:62382906-1da4-4b56-b8c3-fb0b37f6ebc5&page=queryresults
[0m15:11:53.705688 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:d42221bd-2bc1-41b6-b3a4-3e9396231ef7&page=queryresults
[0m15:11:53.838640 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:76b49a95-b856-4c0e-a959-023c057489fe&page=queryresults
[0m15:11:54.360520 [info ] [Thread-2 (]: 15 of 36 PASS source_not_null_northwind_orders_employee_id ..................... [[32mPASS[0m in 1.86s]
[0m15:11:54.361268 [debug] [Thread-2 (]: Finished running node test.dbt_exercise.source_not_null_northwind_orders_employee_id.a8f4bf5ca3
[0m15:11:54.361764 [debug] [Thread-2 (]: Began running node test.dbt_exercise.source_not_null_northwind_shippers_shipper_id.45221752ca
[0m15:11:54.362415 [info ] [Thread-2 (]: 19 of 36 START test source_not_null_northwind_shippers_shipper_id .............. [RUN]
[0m15:11:54.363003 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_exercise.source_not_null_northwind_orders_employee_id.a8f4bf5ca3, now test.dbt_exercise.source_not_null_northwind_shippers_shipper_id.45221752ca)
[0m15:11:54.363388 [debug] [Thread-2 (]: Began compiling node test.dbt_exercise.source_not_null_northwind_shippers_shipper_id.45221752ca
[0m15:11:54.367684 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_exercise.source_not_null_northwind_shippers_shipper_id.45221752ca"
[0m15:11:54.371665 [debug] [Thread-2 (]: Began executing node test.dbt_exercise.source_not_null_northwind_shippers_shipper_id.45221752ca
[0m15:11:54.374662 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_exercise.source_not_null_northwind_shippers_shipper_id.45221752ca"
[0m15:11:54.375727 [debug] [Thread-2 (]: On test.dbt_exercise.source_not_null_northwind_shippers_shipper_id.45221752ca: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "test.dbt_exercise.source_not_null_northwind_shippers_shipper_id.45221752ca"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select shipper_id
from `corded-sunlight-464012-e2`.`dbt_dw_raw`.`shippers`
where shipper_id is null



  
  
      
    ) dbt_internal_test
[0m15:11:54.376268 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:11:54.455778 [info ] [Thread-1 (]: 17 of 36 PASS source_not_null_northwind_products_product_id .................... [[32mPASS[0m in 1.81s]
[0m15:11:54.456535 [debug] [Thread-1 (]: Finished running node test.dbt_exercise.source_not_null_northwind_products_product_id.1bc1aa1d1c
[0m15:11:54.456967 [debug] [Thread-1 (]: Began running node test.dbt_exercise.source_not_null_northwind_suppliers_supplier_id.de5c4d0062
[0m15:11:54.457531 [info ] [Thread-1 (]: 20 of 36 START test source_not_null_northwind_suppliers_supplier_id ............ [RUN]
[0m15:11:54.458085 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_exercise.source_not_null_northwind_products_product_id.1bc1aa1d1c, now test.dbt_exercise.source_not_null_northwind_suppliers_supplier_id.de5c4d0062)
[0m15:11:54.458476 [debug] [Thread-1 (]: Began compiling node test.dbt_exercise.source_not_null_northwind_suppliers_supplier_id.de5c4d0062
[0m15:11:54.462047 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_exercise.source_not_null_northwind_suppliers_supplier_id.de5c4d0062"
[0m15:11:54.463101 [debug] [Thread-1 (]: Began executing node test.dbt_exercise.source_not_null_northwind_suppliers_supplier_id.de5c4d0062
[0m15:11:54.465561 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_exercise.source_not_null_northwind_suppliers_supplier_id.de5c4d0062"
[0m15:11:54.466426 [debug] [Thread-1 (]: On test.dbt_exercise.source_not_null_northwind_suppliers_supplier_id.de5c4d0062: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "test.dbt_exercise.source_not_null_northwind_suppliers_supplier_id.de5c4d0062"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select supplier_id
from `corded-sunlight-464012-e2`.`dbt_dw_raw`.`suppliers`
where supplier_id is null



  
  
      
    ) dbt_internal_test
[0m15:11:54.467045 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:11:54.501536 [info ] [Thread-3 (]: 16 of 36 PASS source_not_null_northwind_orders_order_id ........................ [[32mPASS[0m in 1.87s]
[0m15:11:54.502286 [debug] [Thread-3 (]: Finished running node test.dbt_exercise.source_not_null_northwind_orders_order_id.5a7c008c6e
[0m15:11:54.502858 [debug] [Thread-3 (]: Began running node test.dbt_exercise.source_not_null_northwind_territories_region_id.5df71bcf81
[0m15:11:54.503808 [info ] [Thread-3 (]: 21 of 36 START test source_not_null_northwind_territories_region_id ............ [RUN]
[0m15:11:54.504690 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_exercise.source_not_null_northwind_orders_order_id.5a7c008c6e, now test.dbt_exercise.source_not_null_northwind_territories_region_id.5df71bcf81)
[0m15:11:54.505228 [debug] [Thread-3 (]: Began compiling node test.dbt_exercise.source_not_null_northwind_territories_region_id.5df71bcf81
[0m15:11:54.511466 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_exercise.source_not_null_northwind_territories_region_id.5df71bcf81"
[0m15:11:54.512615 [debug] [Thread-3 (]: Began executing node test.dbt_exercise.source_not_null_northwind_territories_region_id.5df71bcf81
[0m15:11:54.515389 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_exercise.source_not_null_northwind_territories_region_id.5df71bcf81"
[0m15:11:54.516691 [debug] [Thread-3 (]: On test.dbt_exercise.source_not_null_northwind_territories_region_id.5df71bcf81: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "test.dbt_exercise.source_not_null_northwind_territories_region_id.5df71bcf81"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select region_id
from `corded-sunlight-464012-e2`.`dbt_dw_raw`.`territories`
where region_id is null



  
  
      
    ) dbt_internal_test
[0m15:11:54.517399 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:11:54.723920 [info ] [Thread-4 (]: 18 of 36 PASS source_not_null_northwind_region_region_id ....................... [[32mPASS[0m in 1.90s]
[0m15:11:54.724643 [debug] [Thread-4 (]: Finished running node test.dbt_exercise.source_not_null_northwind_region_region_id.c95367d9e3
[0m15:11:54.725059 [debug] [Thread-4 (]: Began running node test.dbt_exercise.source_not_null_northwind_territories_territory_id.9b9655b8a9
[0m15:11:54.725844 [info ] [Thread-4 (]: 22 of 36 START test source_not_null_northwind_territories_territory_id ......... [RUN]
[0m15:11:54.726432 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_exercise.source_not_null_northwind_region_region_id.c95367d9e3, now test.dbt_exercise.source_not_null_northwind_territories_territory_id.9b9655b8a9)
[0m15:11:54.726821 [debug] [Thread-4 (]: Began compiling node test.dbt_exercise.source_not_null_northwind_territories_territory_id.9b9655b8a9
[0m15:11:54.730264 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_exercise.source_not_null_northwind_territories_territory_id.9b9655b8a9"
[0m15:11:54.730976 [debug] [Thread-4 (]: Began executing node test.dbt_exercise.source_not_null_northwind_territories_territory_id.9b9655b8a9
[0m15:11:54.733284 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_exercise.source_not_null_northwind_territories_territory_id.9b9655b8a9"
[0m15:11:54.734266 [debug] [Thread-4 (]: On test.dbt_exercise.source_not_null_northwind_territories_territory_id.9b9655b8a9: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "test.dbt_exercise.source_not_null_northwind_territories_territory_id.9b9655b8a9"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select territory_id
from `corded-sunlight-464012-e2`.`dbt_dw_raw`.`territories`
where territory_id is null



  
  
      
    ) dbt_internal_test
[0m15:11:54.734784 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m15:11:55.474955 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:7942857d-752d-4ae6-9ddb-e5800677de82&page=queryresults
[0m15:11:55.477870 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:c4b81118-581c-4d0b-9881-c893f0ae4a44&page=queryresults
[0m15:11:55.575748 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:9c4fbc10-617f-45bb-b8e6-de6c9dc7dadc&page=queryresults
[0m15:11:55.775258 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:c2e578b2-5944-4486-aad7-d64d46aad7ea&page=queryresults
[0m15:11:56.265432 [info ] [Thread-1 (]: 20 of 36 PASS source_not_null_northwind_suppliers_supplier_id .................. [[32mPASS[0m in 1.81s]
[0m15:11:56.266264 [debug] [Thread-1 (]: Finished running node test.dbt_exercise.source_not_null_northwind_suppliers_supplier_id.de5c4d0062
[0m15:11:56.266744 [debug] [Thread-1 (]: Began running node test.dbt_exercise.source_not_null_northwind_us_states_state_id.2e33a23d78
[0m15:11:56.267239 [info ] [Thread-1 (]: 23 of 36 START test source_not_null_northwind_us_states_state_id ............... [RUN]
[0m15:11:56.267837 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_exercise.source_not_null_northwind_suppliers_supplier_id.de5c4d0062, now test.dbt_exercise.source_not_null_northwind_us_states_state_id.2e33a23d78)
[0m15:11:56.268268 [debug] [Thread-1 (]: Began compiling node test.dbt_exercise.source_not_null_northwind_us_states_state_id.2e33a23d78
[0m15:11:56.272645 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_exercise.source_not_null_northwind_us_states_state_id.2e33a23d78"
[0m15:11:56.273431 [debug] [Thread-1 (]: Began executing node test.dbt_exercise.source_not_null_northwind_us_states_state_id.2e33a23d78
[0m15:11:56.276102 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_exercise.source_not_null_northwind_us_states_state_id.2e33a23d78"
[0m15:11:56.277001 [debug] [Thread-1 (]: On test.dbt_exercise.source_not_null_northwind_us_states_state_id.2e33a23d78: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "test.dbt_exercise.source_not_null_northwind_us_states_state_id.2e33a23d78"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select state_id
from `corded-sunlight-464012-e2`.`dbt_dw_raw`.`us_states`
where state_id is null



  
  
      
    ) dbt_internal_test
[0m15:11:56.277426 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:11:56.307398 [info ] [Thread-2 (]: 19 of 36 PASS source_not_null_northwind_shippers_shipper_id .................... [[32mPASS[0m in 1.94s]
[0m15:11:56.308208 [debug] [Thread-2 (]: Finished running node test.dbt_exercise.source_not_null_northwind_shippers_shipper_id.45221752ca
[0m15:11:56.308633 [debug] [Thread-2 (]: Began running node test.dbt_exercise.source_unique_northwind_categories_category_id.17d9baa2e0
[0m15:11:56.309355 [info ] [Thread-2 (]: 24 of 36 START test source_unique_northwind_categories_category_id ............. [RUN]
[0m15:11:56.310061 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_exercise.source_not_null_northwind_shippers_shipper_id.45221752ca, now test.dbt_exercise.source_unique_northwind_categories_category_id.17d9baa2e0)
[0m15:11:56.310608 [debug] [Thread-2 (]: Began compiling node test.dbt_exercise.source_unique_northwind_categories_category_id.17d9baa2e0
[0m15:11:56.316797 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_exercise.source_unique_northwind_categories_category_id.17d9baa2e0"
[0m15:11:56.317626 [debug] [Thread-2 (]: Began executing node test.dbt_exercise.source_unique_northwind_categories_category_id.17d9baa2e0
[0m15:11:56.319701 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_exercise.source_unique_northwind_categories_category_id.17d9baa2e0"
[0m15:11:56.320352 [debug] [Thread-2 (]: On test.dbt_exercise.source_unique_northwind_categories_category_id.17d9baa2e0: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "test.dbt_exercise.source_unique_northwind_categories_category_id.17d9baa2e0"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with dbt_test__target as (

  select category_id as unique_field
  from `corded-sunlight-464012-e2`.`dbt_dw_raw`.`categories`
  where category_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m15:11:56.320744 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:11:56.365612 [info ] [Thread-3 (]: 21 of 36 PASS source_not_null_northwind_territories_region_id .................. [[32mPASS[0m in 1.86s]
[0m15:11:56.366528 [debug] [Thread-3 (]: Finished running node test.dbt_exercise.source_not_null_northwind_territories_region_id.5df71bcf81
[0m15:11:56.367170 [debug] [Thread-3 (]: Began running node test.dbt_exercise.source_unique_northwind_country_codes_country_code.cf83d0431e
[0m15:11:56.368147 [info ] [Thread-3 (]: 25 of 36 START test source_unique_northwind_country_codes_country_code ......... [RUN]
[0m15:11:56.369039 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_exercise.source_not_null_northwind_territories_region_id.5df71bcf81, now test.dbt_exercise.source_unique_northwind_country_codes_country_code.cf83d0431e)
[0m15:11:56.369646 [debug] [Thread-3 (]: Began compiling node test.dbt_exercise.source_unique_northwind_country_codes_country_code.cf83d0431e
[0m15:11:56.374306 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_exercise.source_unique_northwind_country_codes_country_code.cf83d0431e"
[0m15:11:56.375320 [debug] [Thread-3 (]: Began executing node test.dbt_exercise.source_unique_northwind_country_codes_country_code.cf83d0431e
[0m15:11:56.379428 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_exercise.source_unique_northwind_country_codes_country_code.cf83d0431e"
[0m15:11:56.383845 [debug] [Thread-3 (]: On test.dbt_exercise.source_unique_northwind_country_codes_country_code.cf83d0431e: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "test.dbt_exercise.source_unique_northwind_country_codes_country_code.cf83d0431e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with dbt_test__target as (

  select country_code as unique_field
  from `corded-sunlight-464012-e2`.`dbt_dw_raw`.`country_codes`
  where country_code is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m15:11:56.384595 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:11:56.631093 [info ] [Thread-4 (]: 22 of 36 PASS source_not_null_northwind_territories_territory_id ............... [[32mPASS[0m in 1.90s]
[0m15:11:56.631882 [debug] [Thread-4 (]: Finished running node test.dbt_exercise.source_not_null_northwind_territories_territory_id.9b9655b8a9
[0m15:11:56.632297 [debug] [Thread-4 (]: Began running node test.dbt_exercise.source_unique_northwind_customers_customer_id.ff818c137b
[0m15:11:56.632765 [info ] [Thread-4 (]: 26 of 36 START test source_unique_northwind_customers_customer_id .............. [RUN]
[0m15:11:56.633296 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_exercise.source_not_null_northwind_territories_territory_id.9b9655b8a9, now test.dbt_exercise.source_unique_northwind_customers_customer_id.ff818c137b)
[0m15:11:56.633716 [debug] [Thread-4 (]: Began compiling node test.dbt_exercise.source_unique_northwind_customers_customer_id.ff818c137b
[0m15:11:56.637649 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_exercise.source_unique_northwind_customers_customer_id.ff818c137b"
[0m15:11:56.639117 [debug] [Thread-4 (]: Began executing node test.dbt_exercise.source_unique_northwind_customers_customer_id.ff818c137b
[0m15:11:56.642811 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_exercise.source_unique_northwind_customers_customer_id.ff818c137b"
[0m15:11:56.644036 [debug] [Thread-4 (]: On test.dbt_exercise.source_unique_northwind_customers_customer_id.ff818c137b: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "test.dbt_exercise.source_unique_northwind_customers_customer_id.ff818c137b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with dbt_test__target as (

  select customer_id as unique_field
  from `corded-sunlight-464012-e2`.`dbt_dw_raw`.`customers`
  where customer_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m15:11:56.644766 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m15:11:57.351148 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:f503bfb4-dacb-4521-8b43-3dc2accf2358&page=queryresults
[0m15:11:57.424394 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:8838ab10-72eb-4567-b108-d4570c44204e&page=queryresults
[0m15:11:57.531309 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:eca46bd6-3a6b-4e31-a353-038bbc17fa1f&page=queryresults
[0m15:11:57.730597 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:58a764bc-4998-4afd-b7ef-31e3300dbece&page=queryresults
[0m15:11:58.201890 [info ] [Thread-1 (]: 23 of 36 PASS source_not_null_northwind_us_states_state_id ..................... [[32mPASS[0m in 1.93s]
[0m15:11:58.202650 [debug] [Thread-1 (]: Finished running node test.dbt_exercise.source_not_null_northwind_us_states_state_id.2e33a23d78
[0m15:11:58.203149 [debug] [Thread-1 (]: Began running node test.dbt_exercise.source_unique_northwind_employees_employee_id.e63c624594
[0m15:11:58.203873 [info ] [Thread-1 (]: 27 of 36 START test source_unique_northwind_employees_employee_id .............. [RUN]
[0m15:11:58.204472 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_exercise.source_not_null_northwind_us_states_state_id.2e33a23d78, now test.dbt_exercise.source_unique_northwind_employees_employee_id.e63c624594)
[0m15:11:58.204889 [debug] [Thread-1 (]: Began compiling node test.dbt_exercise.source_unique_northwind_employees_employee_id.e63c624594
[0m15:11:58.209585 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_exercise.source_unique_northwind_employees_employee_id.e63c624594"
[0m15:11:58.210811 [debug] [Thread-1 (]: Began executing node test.dbt_exercise.source_unique_northwind_employees_employee_id.e63c624594
[0m15:11:58.214519 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_exercise.source_unique_northwind_employees_employee_id.e63c624594"
[0m15:11:58.215407 [debug] [Thread-1 (]: On test.dbt_exercise.source_unique_northwind_employees_employee_id.e63c624594: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "test.dbt_exercise.source_unique_northwind_employees_employee_id.e63c624594"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with dbt_test__target as (

  select employee_id as unique_field
  from `corded-sunlight-464012-e2`.`dbt_dw_raw`.`employees`
  where employee_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m15:11:58.215916 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:11:58.357654 [info ] [Thread-2 (]: 24 of 36 PASS source_unique_northwind_categories_category_id ................... [[32mPASS[0m in 2.05s]
[0m15:11:58.358723 [debug] [Thread-2 (]: Finished running node test.dbt_exercise.source_unique_northwind_categories_category_id.17d9baa2e0
[0m15:11:58.359170 [debug] [Thread-2 (]: Began running node test.dbt_exercise.source_unique_northwind_orders_order_id.4a8a4df128
[0m15:11:58.359939 [info ] [Thread-2 (]: 28 of 36 START test source_unique_northwind_orders_order_id .................... [RUN]
[0m15:11:58.360824 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_exercise.source_unique_northwind_categories_category_id.17d9baa2e0, now test.dbt_exercise.source_unique_northwind_orders_order_id.4a8a4df128)
[0m15:11:58.361197 [debug] [Thread-2 (]: Began compiling node test.dbt_exercise.source_unique_northwind_orders_order_id.4a8a4df128
[0m15:11:58.364825 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_exercise.source_unique_northwind_orders_order_id.4a8a4df128"
[0m15:11:58.365506 [debug] [Thread-2 (]: Began executing node test.dbt_exercise.source_unique_northwind_orders_order_id.4a8a4df128
[0m15:11:58.367729 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_exercise.source_unique_northwind_orders_order_id.4a8a4df128"
[0m15:11:58.368432 [debug] [Thread-2 (]: On test.dbt_exercise.source_unique_northwind_orders_order_id.4a8a4df128: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "test.dbt_exercise.source_unique_northwind_orders_order_id.4a8a4df128"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with dbt_test__target as (

  select order_id as unique_field
  from `corded-sunlight-464012-e2`.`dbt_dw_raw`.`orders`
  where order_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m15:11:58.368842 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:11:58.398293 [info ] [Thread-3 (]: 25 of 36 PASS source_unique_northwind_country_codes_country_code ............... [[32mPASS[0m in 2.03s]
[0m15:11:58.399170 [debug] [Thread-3 (]: Finished running node test.dbt_exercise.source_unique_northwind_country_codes_country_code.cf83d0431e
[0m15:11:58.399709 [debug] [Thread-3 (]: Began running node test.dbt_exercise.source_unique_northwind_products_product_id.740bf6f9a5
[0m15:11:58.400501 [info ] [Thread-3 (]: 29 of 36 START test source_unique_northwind_products_product_id ................ [RUN]
[0m15:11:58.401134 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_exercise.source_unique_northwind_country_codes_country_code.cf83d0431e, now test.dbt_exercise.source_unique_northwind_products_product_id.740bf6f9a5)
[0m15:11:58.401530 [debug] [Thread-3 (]: Began compiling node test.dbt_exercise.source_unique_northwind_products_product_id.740bf6f9a5
[0m15:11:58.405233 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_exercise.source_unique_northwind_products_product_id.740bf6f9a5"
[0m15:11:58.406011 [debug] [Thread-3 (]: Began executing node test.dbt_exercise.source_unique_northwind_products_product_id.740bf6f9a5
[0m15:11:58.408683 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_exercise.source_unique_northwind_products_product_id.740bf6f9a5"
[0m15:11:58.409368 [debug] [Thread-3 (]: On test.dbt_exercise.source_unique_northwind_products_product_id.740bf6f9a5: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "test.dbt_exercise.source_unique_northwind_products_product_id.740bf6f9a5"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with dbt_test__target as (

  select product_id as unique_field
  from `corded-sunlight-464012-e2`.`dbt_dw_raw`.`products`
  where product_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m15:11:58.409783 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:11:58.546696 [info ] [Thread-4 (]: 26 of 36 PASS source_unique_northwind_customers_customer_id .................... [[32mPASS[0m in 1.91s]
[0m15:11:58.547710 [debug] [Thread-4 (]: Finished running node test.dbt_exercise.source_unique_northwind_customers_customer_id.ff818c137b
[0m15:11:58.548242 [debug] [Thread-4 (]: Began running node test.dbt_exercise.source_unique_northwind_region_region_id.9688f1f5fd
[0m15:11:58.548870 [info ] [Thread-4 (]: 30 of 36 START test source_unique_northwind_region_region_id ................... [RUN]
[0m15:11:58.549465 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_exercise.source_unique_northwind_customers_customer_id.ff818c137b, now test.dbt_exercise.source_unique_northwind_region_region_id.9688f1f5fd)
[0m15:11:58.549870 [debug] [Thread-4 (]: Began compiling node test.dbt_exercise.source_unique_northwind_region_region_id.9688f1f5fd
[0m15:11:58.553191 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_exercise.source_unique_northwind_region_region_id.9688f1f5fd"
[0m15:11:58.554949 [debug] [Thread-4 (]: Began executing node test.dbt_exercise.source_unique_northwind_region_region_id.9688f1f5fd
[0m15:11:58.557471 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_exercise.source_unique_northwind_region_region_id.9688f1f5fd"
[0m15:11:58.558361 [debug] [Thread-4 (]: On test.dbt_exercise.source_unique_northwind_region_region_id.9688f1f5fd: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "test.dbt_exercise.source_unique_northwind_region_region_id.9688f1f5fd"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with dbt_test__target as (

  select region_id as unique_field
  from `corded-sunlight-464012-e2`.`dbt_dw_raw`.`region`
  where region_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m15:11:58.558804 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m15:11:59.305508 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:292ddbc2-e4ec-42f1-aa92-1e1ac91c2ba5&page=queryresults
[0m15:11:59.458946 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:288471fc-d2cb-4ae2-9c1a-c66b8015de73&page=queryresults
[0m15:11:59.478558 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:93b96153-fedc-4140-93c1-b4384d097968&page=queryresults
[0m15:11:59.593443 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:dfa6940e-31e8-4145-84a3-930f4f903576&page=queryresults
[0m15:12:00.108170 [info ] [Thread-1 (]: 27 of 36 PASS source_unique_northwind_employees_employee_id .................... [[32mPASS[0m in 1.90s]
[0m15:12:00.108913 [debug] [Thread-1 (]: Finished running node test.dbt_exercise.source_unique_northwind_employees_employee_id.e63c624594
[0m15:12:00.109352 [debug] [Thread-1 (]: Began running node test.dbt_exercise.source_unique_northwind_shippers_shipper_id.61edb3f736
[0m15:12:00.109952 [info ] [Thread-1 (]: 31 of 36 START test source_unique_northwind_shippers_shipper_id ................ [RUN]
[0m15:12:00.110905 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_exercise.source_unique_northwind_employees_employee_id.e63c624594, now test.dbt_exercise.source_unique_northwind_shippers_shipper_id.61edb3f736)
[0m15:12:00.111402 [debug] [Thread-1 (]: Began compiling node test.dbt_exercise.source_unique_northwind_shippers_shipper_id.61edb3f736
[0m15:12:00.115445 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_exercise.source_unique_northwind_shippers_shipper_id.61edb3f736"
[0m15:12:00.119961 [debug] [Thread-1 (]: Began executing node test.dbt_exercise.source_unique_northwind_shippers_shipper_id.61edb3f736
[0m15:12:00.122289 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_exercise.source_unique_northwind_shippers_shipper_id.61edb3f736"
[0m15:12:00.123066 [debug] [Thread-1 (]: On test.dbt_exercise.source_unique_northwind_shippers_shipper_id.61edb3f736: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "test.dbt_exercise.source_unique_northwind_shippers_shipper_id.61edb3f736"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with dbt_test__target as (

  select shipper_id as unique_field
  from `corded-sunlight-464012-e2`.`dbt_dw_raw`.`shippers`
  where shipper_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m15:12:00.123474 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:12:00.218872 [info ] [Thread-2 (]: 28 of 36 PASS source_unique_northwind_orders_order_id .......................... [[32mPASS[0m in 1.86s]
[0m15:12:00.219735 [debug] [Thread-2 (]: Finished running node test.dbt_exercise.source_unique_northwind_orders_order_id.4a8a4df128
[0m15:12:00.220381 [debug] [Thread-2 (]: Began running node test.dbt_exercise.source_unique_northwind_suppliers_supplier_id.aa7461739b
[0m15:12:00.221121 [info ] [Thread-2 (]: 32 of 36 START test source_unique_northwind_suppliers_supplier_id .............. [RUN]
[0m15:12:00.221808 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_exercise.source_unique_northwind_orders_order_id.4a8a4df128, now test.dbt_exercise.source_unique_northwind_suppliers_supplier_id.aa7461739b)
[0m15:12:00.222201 [debug] [Thread-2 (]: Began compiling node test.dbt_exercise.source_unique_northwind_suppliers_supplier_id.aa7461739b
[0m15:12:00.227433 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_exercise.source_unique_northwind_suppliers_supplier_id.aa7461739b"
[0m15:12:00.228691 [debug] [Thread-2 (]: Began executing node test.dbt_exercise.source_unique_northwind_suppliers_supplier_id.aa7461739b
[0m15:12:00.231477 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_exercise.source_unique_northwind_suppliers_supplier_id.aa7461739b"
[0m15:12:00.232287 [debug] [Thread-2 (]: On test.dbt_exercise.source_unique_northwind_suppliers_supplier_id.aa7461739b: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "test.dbt_exercise.source_unique_northwind_suppliers_supplier_id.aa7461739b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with dbt_test__target as (

  select supplier_id as unique_field
  from `corded-sunlight-464012-e2`.`dbt_dw_raw`.`suppliers`
  where supplier_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m15:12:00.232731 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:12:00.264037 [info ] [Thread-3 (]: 29 of 36 PASS source_unique_northwind_products_product_id ...................... [[32mPASS[0m in 1.86s]
[0m15:12:00.266028 [debug] [Thread-3 (]: Finished running node test.dbt_exercise.source_unique_northwind_products_product_id.740bf6f9a5
[0m15:12:00.266891 [debug] [Thread-3 (]: Began running node test.dbt_exercise.source_unique_northwind_territories_territory_id.08bc548860
[0m15:12:00.268359 [info ] [Thread-3 (]: 33 of 36 START test source_unique_northwind_territories_territory_id ........... [RUN]
[0m15:12:00.269192 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_exercise.source_unique_northwind_products_product_id.740bf6f9a5, now test.dbt_exercise.source_unique_northwind_territories_territory_id.08bc548860)
[0m15:12:00.269842 [debug] [Thread-3 (]: Began compiling node test.dbt_exercise.source_unique_northwind_territories_territory_id.08bc548860
[0m15:12:00.275124 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_exercise.source_unique_northwind_territories_territory_id.08bc548860"
[0m15:12:00.276587 [debug] [Thread-3 (]: Began executing node test.dbt_exercise.source_unique_northwind_territories_territory_id.08bc548860
[0m15:12:00.279024 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_exercise.source_unique_northwind_territories_territory_id.08bc548860"
[0m15:12:00.280007 [debug] [Thread-3 (]: On test.dbt_exercise.source_unique_northwind_territories_territory_id.08bc548860: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "test.dbt_exercise.source_unique_northwind_territories_territory_id.08bc548860"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with dbt_test__target as (

  select territory_id as unique_field
  from `corded-sunlight-464012-e2`.`dbt_dw_raw`.`territories`
  where territory_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m15:12:00.280484 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:12:00.370465 [info ] [Thread-4 (]: 30 of 36 PASS source_unique_northwind_region_region_id ......................... [[32mPASS[0m in 1.82s]
[0m15:12:00.371124 [debug] [Thread-4 (]: Finished running node test.dbt_exercise.source_unique_northwind_region_region_id.9688f1f5fd
[0m15:12:00.371559 [debug] [Thread-4 (]: Began running node test.dbt_exercise.source_unique_northwind_us_states_state_id.c374c85cda
[0m15:12:00.372216 [info ] [Thread-4 (]: 34 of 36 START test source_unique_northwind_us_states_state_id ................. [RUN]
[0m15:12:00.373676 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_exercise.source_unique_northwind_region_region_id.9688f1f5fd, now test.dbt_exercise.source_unique_northwind_us_states_state_id.c374c85cda)
[0m15:12:00.374217 [debug] [Thread-4 (]: Began compiling node test.dbt_exercise.source_unique_northwind_us_states_state_id.c374c85cda
[0m15:12:00.380813 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_exercise.source_unique_northwind_us_states_state_id.c374c85cda"
[0m15:12:00.381520 [debug] [Thread-4 (]: Began executing node test.dbt_exercise.source_unique_northwind_us_states_state_id.c374c85cda
[0m15:12:00.383729 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_exercise.source_unique_northwind_us_states_state_id.c374c85cda"
[0m15:12:00.384438 [debug] [Thread-4 (]: On test.dbt_exercise.source_unique_northwind_us_states_state_id.c374c85cda: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "test.dbt_exercise.source_unique_northwind_us_states_state_id.c374c85cda"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with dbt_test__target as (

  select state_id as unique_field
  from `corded-sunlight-464012-e2`.`dbt_dw_raw`.`us_states`
  where state_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m15:12:00.384823 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m15:12:01.233618 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:e24a7608-66a3-45cf-a716-104d1374ae17&page=queryresults
[0m15:12:01.334802 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:9f265fc0-fbcd-4276-8ec4-ae0a1fdf79d0&page=queryresults
[0m15:12:01.423306 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:9e3518e8-fa7d-4eb3-aa17-b4dff6b651bc&page=queryresults
[0m15:12:01.567807 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:dbf3559c-4b2a-41d0-8b63-21c77939ff81&page=queryresults
[0m15:12:02.012553 [info ] [Thread-1 (]: 31 of 36 PASS source_unique_northwind_shippers_shipper_id ...................... [[32mPASS[0m in 1.90s]
[0m15:12:02.013320 [debug] [Thread-1 (]: Finished running node test.dbt_exercise.source_unique_northwind_shippers_shipper_id.61edb3f736
[0m15:12:02.013855 [debug] [Thread-1 (]: Began running node test.dbt_exercise.unique_dim_products_product_id.ef7b2a9985
[0m15:12:02.014456 [info ] [Thread-1 (]: 35 of 36 START test unique_dim_products_product_id ............................. [RUN]
[0m15:12:02.014982 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_exercise.source_unique_northwind_shippers_shipper_id.61edb3f736, now test.dbt_exercise.unique_dim_products_product_id.ef7b2a9985)
[0m15:12:02.015355 [debug] [Thread-1 (]: Began compiling node test.dbt_exercise.unique_dim_products_product_id.ef7b2a9985
[0m15:12:02.019334 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_exercise.unique_dim_products_product_id.ef7b2a9985"
[0m15:12:02.020264 [debug] [Thread-1 (]: Began executing node test.dbt_exercise.unique_dim_products_product_id.ef7b2a9985
[0m15:12:02.022714 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_exercise.unique_dim_products_product_id.ef7b2a9985"
[0m15:12:02.023805 [debug] [Thread-1 (]: On test.dbt_exercise.unique_dim_products_product_id.ef7b2a9985: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "test.dbt_exercise.unique_dim_products_product_id.ef7b2a9985"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with dbt_test__target as (

  select product_id as unique_field
  from `corded-sunlight-464012-e2`.`dbt_dw_marts`.`dim_products`
  where product_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m15:12:02.024344 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:12:02.148425 [info ] [Thread-2 (]: 32 of 36 PASS source_unique_northwind_suppliers_supplier_id .................... [[32mPASS[0m in 1.93s]
[0m15:12:02.149796 [debug] [Thread-2 (]: Finished running node test.dbt_exercise.source_unique_northwind_suppliers_supplier_id.aa7461739b
[0m15:12:02.150888 [debug] [Thread-2 (]: Began running node test.dbt_exercise.unique_dim_products_product_sk.8f20ac7c5b
[0m15:12:02.151455 [info ] [Thread-2 (]: 36 of 36 START test unique_dim_products_product_sk ............................. [RUN]
[0m15:12:02.152073 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_exercise.source_unique_northwind_suppliers_supplier_id.aa7461739b, now test.dbt_exercise.unique_dim_products_product_sk.8f20ac7c5b)
[0m15:12:02.152512 [debug] [Thread-2 (]: Began compiling node test.dbt_exercise.unique_dim_products_product_sk.8f20ac7c5b
[0m15:12:02.157159 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_exercise.unique_dim_products_product_sk.8f20ac7c5b"
[0m15:12:02.158099 [debug] [Thread-2 (]: Began executing node test.dbt_exercise.unique_dim_products_product_sk.8f20ac7c5b
[0m15:12:02.160508 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_exercise.unique_dim_products_product_sk.8f20ac7c5b"
[0m15:12:02.161438 [debug] [Thread-2 (]: On test.dbt_exercise.unique_dim_products_product_sk.8f20ac7c5b: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "test.dbt_exercise.unique_dim_products_product_sk.8f20ac7c5b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with dbt_test__target as (

  select product_sk as unique_field
  from `corded-sunlight-464012-e2`.`dbt_dw_marts`.`dim_products`
  where product_sk is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m15:12:02.162159 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:12:02.233626 [info ] [Thread-3 (]: 33 of 36 PASS source_unique_northwind_territories_territory_id ................. [[32mPASS[0m in 1.96s]
[0m15:12:02.234326 [debug] [Thread-3 (]: Finished running node test.dbt_exercise.source_unique_northwind_territories_territory_id.08bc548860
[0m15:12:02.338589 [info ] [Thread-4 (]: 34 of 36 PASS source_unique_northwind_us_states_state_id ....................... [[32mPASS[0m in 1.96s]
[0m15:12:02.339448 [debug] [Thread-4 (]: Finished running node test.dbt_exercise.source_unique_northwind_us_states_state_id.c374c85cda
[0m15:12:03.026246 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:36bf32d9-e90d-4374-8065-6469112bd376&page=queryresults
[0m15:12:03.026841 [error] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:36bf32d9-e90d-4374-8065-6469112bd376&page=queryresults
[0m15:12:03.061632 [debug] [Thread-2 (]: Database Error in test unique_dim_products_product_sk (models/marts/dim_products.yml)
  Unrecognized name: product_sk; Did you mean product_id? at [18:9]
  compiled code at target/run/dbt_exercise/models/marts/dim_products.yml/unique_dim_products_product_sk.sql
[0m15:12:03.062239 [error] [Thread-2 (]: 36 of 36 ERROR unique_dim_products_product_sk .................................. [[31mERROR[0m in 0.91s]
[0m15:12:03.062736 [debug] [Thread-2 (]: Finished running node test.dbt_exercise.unique_dim_products_product_sk.8f20ac7c5b
[0m15:12:03.063687 [debug] [Thread-7 (]: Marking all children of 'test.dbt_exercise.unique_dim_products_product_sk.8f20ac7c5b' to be skipped because of status 'error'.  Reason: Database Error in test unique_dim_products_product_sk (models/marts/dim_products.yml)
  Unrecognized name: product_sk; Did you mean product_id? at [18:9]
  compiled code at target/run/dbt_exercise/models/marts/dim_products.yml/unique_dim_products_product_sk.sql.
[0m15:12:03.074528 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:e923664e-dc4c-4826-a643-88f6c3d76928&page=queryresults
[0m15:12:03.821911 [info ] [Thread-1 (]: 35 of 36 PASS unique_dim_products_product_id ................................... [[32mPASS[0m in 1.81s]
[0m15:12:03.822899 [debug] [Thread-1 (]: Finished running node test.dbt_exercise.unique_dim_products_product_id.ef7b2a9985
[0m15:12:03.826576 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:12:03.833921 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:12:03.834312 [debug] [MainThread]: Connection 'test.dbt_exercise.unique_dim_products_product_id.ef7b2a9985' was properly closed.
[0m15:12:03.834587 [debug] [MainThread]: Connection 'test.dbt_exercise.source_unique_northwind_us_states_state_id.c374c85cda' was properly closed.
[0m15:12:03.834826 [debug] [MainThread]: Connection 'test.dbt_exercise.source_unique_northwind_territories_territory_id.08bc548860' was properly closed.
[0m15:12:03.835077 [debug] [MainThread]: Connection 'test.dbt_exercise.unique_dim_products_product_sk.8f20ac7c5b' was properly closed.
[0m15:12:03.835458 [info ] [MainThread]: 
[0m15:12:03.836030 [info ] [MainThread]: Finished running 36 data tests in 0 hours 2 minutes and 54.26 seconds (174.26s).
[0m15:12:03.840989 [debug] [MainThread]: Command end result
[0m15:12:03.887806 [debug] [MainThread]: Wrote artifact WritableManifest to /home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/target/manifest.json
[0m15:12:03.900904 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/target/semantic_manifest.json
[0m15:12:03.909693 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/target/run_results.json
[0m15:12:03.910122 [info ] [MainThread]: 
[0m15:12:03.910775 [info ] [MainThread]: [31mCompleted with 3 errors, 0 partial successes, and 0 warnings:[0m
[0m15:12:03.911456 [info ] [MainThread]: 
[0m15:12:03.912089 [error] [MainThread]: [31mFailure in test accepted_values_dim_products_discontinued__True__False (models/marts/dim_products.yml)[0m
[0m15:12:03.912587 [error] [MainThread]:   Database Error in test accepted_values_dim_products_discontinued__True__False (models/marts/dim_products.yml)
  No matching signature for operator IN for argument types BOOL and {STRING} at [27:23]
  compiled code at target/run/dbt_exercise/models/marts/dim_products.yml/accepted_values_dim_products_discontinued__True__False.sql
[0m15:12:03.913087 [info ] [MainThread]: 
[0m15:12:03.913591 [info ] [MainThread]:   compiled code at target/compiled/dbt_exercise/models/marts/dim_products.yml/accepted_values_dim_products_discontinued__True__False.sql
[0m15:12:03.914048 [info ] [MainThread]: 
[0m15:12:03.914615 [error] [MainThread]: [31mFailure in test not_null_dim_products_product_sk (models/marts/dim_products.yml)[0m
[0m15:12:03.915046 [error] [MainThread]:   Database Error in test not_null_dim_products_product_sk (models/marts/dim_products.yml)
  Unrecognized name: product_sk; Did you mean product_id? at [18:7]
  compiled code at target/run/dbt_exercise/models/marts/dim_products.yml/not_null_dim_products_product_sk.sql
[0m15:12:03.915455 [info ] [MainThread]: 
[0m15:12:03.916098 [info ] [MainThread]:   compiled code at target/compiled/dbt_exercise/models/marts/dim_products.yml/not_null_dim_products_product_sk.sql
[0m15:12:03.916602 [info ] [MainThread]: 
[0m15:12:03.917074 [error] [MainThread]: [31mFailure in test unique_dim_products_product_sk (models/marts/dim_products.yml)[0m
[0m15:12:03.917533 [error] [MainThread]:   Database Error in test unique_dim_products_product_sk (models/marts/dim_products.yml)
  Unrecognized name: product_sk; Did you mean product_id? at [18:9]
  compiled code at target/run/dbt_exercise/models/marts/dim_products.yml/unique_dim_products_product_sk.sql
[0m15:12:03.917915 [info ] [MainThread]: 
[0m15:12:03.918318 [info ] [MainThread]:   compiled code at target/compiled/dbt_exercise/models/marts/dim_products.yml/unique_dim_products_product_sk.sql
[0m15:12:03.918822 [info ] [MainThread]: 
[0m15:12:03.919270 [info ] [MainThread]: Done. PASS=33 WARN=0 ERROR=3 SKIP=0 NO-OP=0 TOTAL=36
[0m15:12:03.920184 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- DuplicateYAMLKeysDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m15:12:03.923719 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": false, "command_wall_clock_time": 243.83936, "process_in_blocks": "123240", "process_kernel_time": 13.760423, "process_mem_max_rss": "371852", "process_out_blocks": "4384", "process_user_time": 12.375116}
[0m15:12:03.924321 [debug] [MainThread]: Command `dbt test` failed at 15:12:03.924230 after 243.84 seconds
[0m15:12:03.924725 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bbfd3261760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bbfd258ba10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bbfd21c92b0>]}
[0m15:12:03.925071 [debug] [MainThread]: Flushing usage events
[0m15:12:04.232208 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:17:20.414578 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d9329b8f920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d932b561cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d9329b61b50>]}


============================== 15:17:20.433903 | de326144-20de-465d-b57d-a5b09c4d9466 ==============================
[0m15:17:20.433903 [info ] [MainThread]: Running with dbt=1.10.2
[0m15:17:20.434667 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/logs', 'version_check': 'True', 'profiles_dir': '/home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run -s dim_products', 'send_anonymous_usage_stats': 'True'}
[0m15:18:07.377155 [warn ] [MainThread]: [[33mWARNING[0m][DuplicateYAMLKeysDeprecation]: Deprecated functionality
Duplicate key 'version' in "<unicode string>", line 4, column 1 in file
`/home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/dbt_project.yml`
[0m15:18:07.377880 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'de326144-20de-465d-b57d-a5b09c4d9466', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d92ebb52390>]}
[0m15:18:11.721103 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'de326144-20de-465d-b57d-a5b09c4d9466', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d92edda3ef0>]}
[0m15:18:11.781054 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'de326144-20de-465d-b57d-a5b09c4d9466', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d92ebe3fe30>]}
[0m15:18:11.784963 [info ] [MainThread]: Registered adapter: bigquery=1.9.2
[0m15:18:58.477923 [debug] [MainThread]: checksum: 1adc40777973ef30f45f80b3b6d04d5013c1edd53d96363881b3b199e612468b, vars: {}, profile: , target: , version: 1.10.2
[0m15:19:02.727157 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:19:02.727564 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:19:02.772439 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'de326144-20de-465d-b57d-a5b09c4d9466', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d92eba76ba0>]}
[0m15:19:03.018368 [debug] [MainThread]: Wrote artifact WritableManifest to /home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/target/manifest.json
[0m15:19:03.031775 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/target/semantic_manifest.json
[0m15:19:03.374631 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'de326144-20de-465d-b57d-a5b09c4d9466', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d92ebbdedb0>]}
[0m15:19:03.375238 [info ] [MainThread]: Found 14 seeds, 36 data tests, 19 models, 14 sources, 609 macros
[0m15:19:03.375624 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'de326144-20de-465d-b57d-a5b09c4d9466', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d92ebba2ab0>]}
[0m15:19:03.377457 [info ] [MainThread]: 
[0m15:19:03.377896 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:19:03.378213 [info ] [MainThread]: 
[0m15:19:03.378709 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m15:19:03.379997 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_corded-sunlight-464012-e2'
[0m15:19:03.380537 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:19:04.443157 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_corded-sunlight-464012-e2, now list_corded-sunlight-464012-e2_dbt_dw_intermediate)
[0m15:19:04.444341 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:19:04.445232 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_corded-sunlight-464012-e2_dbt_dw_raw'
[0m15:19:04.446585 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_corded-sunlight-464012-e2_dbt_dw_marts'
[0m15:19:04.447433 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:19:04.448053 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_corded-sunlight-464012-e2_dbt_dw_staging'
[0m15:19:04.449134 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:19:04.450140 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:19:05.415553 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'de326144-20de-465d-b57d-a5b09c4d9466', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d92eb7a8a10>]}
[0m15:19:05.416432 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:19:05.427162 [debug] [Thread-1 (]: Began running node model.dbt_exercise.dim_products
[0m15:19:05.427819 [info ] [Thread-1 (]: 1 of 1 START sql table model dbt_dw_marts.dim_products ......................... [RUN]
[0m15:19:05.428339 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_corded-sunlight-464012-e2_dbt_dw_staging, now model.dbt_exercise.dim_products)
[0m15:19:05.428709 [debug] [Thread-1 (]: Began compiling node model.dbt_exercise.dim_products
[0m15:19:05.450919 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_exercise.dim_products"
[0m15:19:05.452528 [debug] [Thread-1 (]: Began executing node model.dbt_exercise.dim_products
[0m15:19:05.466502 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:19:06.246722 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_exercise.dim_products"
[0m15:19:06.247553 [debug] [Thread-1 (]: On model.dbt_exercise.dim_products: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "model.dbt_exercise.dim_products"} */

  
    

    create or replace table `corded-sunlight-464012-e2`.`dbt_dw_marts`.`dim_products`
      
    
    

    OPTIONS()
    as (
      with int_products as (
    select *
    from `corded-sunlight-464012-e2`.`dbt_dw_intermediate`.`int_products_northwind`
)

, dim_products as (
    select
        to_hex(md5(cast(coalesce(cast(product_id as string), '_dbt_utils_surrogate_key_null_') as string))) as sk_product
        , product_id
        , product_name
        , quantity_per_unit
        , category_name
        , supplier_name
        , supplier_city
        , supplier_region
        , supplier_country
        , supplier_continent
        , discontinued
    from int_products
)

select *
from dim_products
    );
  
[0m15:19:06.957952 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:5f1f56f7-c2c3-42af-b04b-a41da96703ef&page=queryresults
[0m15:19:13.101163 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'de326144-20de-465d-b57d-a5b09c4d9466', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d92f482a420>]}
[0m15:19:13.102144 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dbt_dw_marts.dim_products .................... [[32mCREATE TABLE (77.0 rows, 6.6 KiB processed)[0m in 7.66s]
[0m15:19:13.102678 [debug] [Thread-1 (]: Finished running node model.dbt_exercise.dim_products
[0m15:19:13.105059 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:19:13.111306 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:19:13.111749 [debug] [MainThread]: Connection 'list_corded-sunlight-464012-e2_dbt_dw_intermediate' was properly closed.
[0m15:19:13.112057 [debug] [MainThread]: Connection 'list_corded-sunlight-464012-e2_dbt_dw_raw' was properly closed.
[0m15:19:13.112279 [debug] [MainThread]: Connection 'list_corded-sunlight-464012-e2_dbt_dw_marts' was properly closed.
[0m15:19:13.112512 [debug] [MainThread]: Connection 'model.dbt_exercise.dim_products' was properly closed.
[0m15:19:13.112788 [info ] [MainThread]: 
[0m15:19:13.113194 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 9.73 seconds (9.73s).
[0m15:19:13.114077 [debug] [MainThread]: Command end result
[0m15:19:13.157847 [debug] [MainThread]: Wrote artifact WritableManifest to /home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/target/manifest.json
[0m15:19:13.170147 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/target/semantic_manifest.json
[0m15:19:13.177771 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/target/run_results.json
[0m15:19:13.178629 [info ] [MainThread]: 
[0m15:19:13.179251 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:19:13.179791 [info ] [MainThread]: 
[0m15:19:13.180219 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m15:19:13.180789 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- DuplicateYAMLKeysDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m15:19:13.186900 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 102.06783, "process_in_blocks": "143984", "process_kernel_time": 13.838654, "process_mem_max_rss": "366756", "process_out_blocks": "3536", "process_user_time": 10.762902}
[0m15:19:13.187800 [debug] [MainThread]: Command `dbt run` succeeded at 15:19:13.187602 after 102.07 seconds
[0m15:19:13.188368 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d93295e2ff0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d92ebe9ff80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d92ec0f8fb0>]}
[0m15:19:13.189189 [debug] [MainThread]: Flushing usage events
[0m15:19:13.500228 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:20:05.896787 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x793ba7ab6810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x793ba7bf8260>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x793ba7ab4b30>]}


============================== 15:20:05.913696 | f2f3b78d-1bf9-46f0-b671-9cb9d56531e8 ==============================
[0m15:20:05.913696 [info ] [MainThread]: Running with dbt=1.10.2
[0m15:20:05.914160 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise', 'log_path': '/home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt run -s +dim_products', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:20:52.757286 [warn ] [MainThread]: [[33mWARNING[0m][DuplicateYAMLKeysDeprecation]: Deprecated functionality
Duplicate key 'version' in "<unicode string>", line 4, column 1 in file
`/home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/dbt_project.yml`
[0m15:20:52.757804 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'f2f3b78d-1bf9-46f0-b671-9cb9d56531e8', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x793ba717e390>]}
[0m15:20:53.321023 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f2f3b78d-1bf9-46f0-b671-9cb9d56531e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x793b6a45f860>]}
[0m15:20:53.374482 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f2f3b78d-1bf9-46f0-b671-9cb9d56531e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x793b6a305c40>]}
[0m15:20:53.379438 [info ] [MainThread]: Registered adapter: bigquery=1.9.2
[0m15:21:41.985866 [debug] [MainThread]: checksum: 1adc40777973ef30f45f80b3b6d04d5013c1edd53d96363881b3b199e612468b, vars: {}, profile: , target: , version: 1.10.2
[0m15:21:50.538710 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:21:50.539715 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:21:50.589974 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f2f3b78d-1bf9-46f0-b671-9cb9d56531e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x793ba7151010>]}
[0m15:21:50.840416 [debug] [MainThread]: Wrote artifact WritableManifest to /home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/target/manifest.json
[0m15:21:50.852022 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/target/semantic_manifest.json
[0m15:21:51.208822 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f2f3b78d-1bf9-46f0-b671-9cb9d56531e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x793b6a14f8c0>]}
[0m15:21:51.209355 [info ] [MainThread]: Found 14 seeds, 36 data tests, 19 models, 14 sources, 609 macros
[0m15:21:51.209695 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f2f3b78d-1bf9-46f0-b671-9cb9d56531e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x793b69c08a70>]}
[0m15:21:51.211539 [info ] [MainThread]: 
[0m15:21:51.212047 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:21:51.212337 [info ] [MainThread]: 
[0m15:21:51.212842 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m15:21:51.216736 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_corded-sunlight-464012-e2'
[0m15:21:51.218107 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:21:51.219247 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_corded-sunlight-464012-e2'
[0m15:21:51.221217 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_corded-sunlight-464012-e2'
[0m15:21:51.221999 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:21:51.222644 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:21:52.353044 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_corded-sunlight-464012-e2, now list_corded-sunlight-464012-e2_dbt_dw_marts)
[0m15:21:52.354426 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_corded-sunlight-464012-e2, now list_corded-sunlight-464012-e2_dbt_dw_intermediate)
[0m15:21:52.355176 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:21:52.356288 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_corded-sunlight-464012-e2, now list_corded-sunlight-464012-e2_dbt_dw_raw)
[0m15:21:52.357441 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_corded-sunlight-464012-e2_dbt_dw_staging'
[0m15:21:52.357874 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:21:52.358724 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:21:52.359404 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:21:53.302442 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f2f3b78d-1bf9-46f0-b671-9cb9d56531e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x793ba98878f0>]}
[0m15:21:53.303140 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:21:53.313354 [debug] [Thread-1 (]: Began running node model.dbt_exercise.stg_categories_northwind
[0m15:21:53.313932 [debug] [Thread-2 (]: Began running node model.dbt_exercise.stg_products_northwind
[0m15:21:53.314500 [debug] [Thread-3 (]: Began running node model.dbt_exercise.stg_suppliers_northwind
[0m15:21:53.315373 [info ] [Thread-1 (]: 1 of 5 START sql view model dbt_dw_staging.stg_categories_northwind ............ [RUN]
[0m15:21:53.316254 [info ] [Thread-2 (]: 2 of 5 START sql view model dbt_dw_staging.stg_products_northwind .............. [RUN]
[0m15:21:53.317100 [info ] [Thread-3 (]: 3 of 5 START sql view model dbt_dw_staging.stg_suppliers_northwind ............. [RUN]
[0m15:21:53.317957 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_corded-sunlight-464012-e2_dbt_dw_staging, now model.dbt_exercise.stg_categories_northwind)
[0m15:21:53.318579 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_corded-sunlight-464012-e2_dbt_dw_marts, now model.dbt_exercise.stg_products_northwind)
[0m15:21:53.319354 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_corded-sunlight-464012-e2_dbt_dw_intermediate, now model.dbt_exercise.stg_suppliers_northwind)
[0m15:21:53.320300 [debug] [Thread-1 (]: Began compiling node model.dbt_exercise.stg_categories_northwind
[0m15:21:53.320820 [debug] [Thread-2 (]: Began compiling node model.dbt_exercise.stg_products_northwind
[0m15:21:53.321254 [debug] [Thread-3 (]: Began compiling node model.dbt_exercise.stg_suppliers_northwind
[0m15:21:53.328603 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_exercise.stg_categories_northwind"
[0m15:21:53.332422 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_exercise.stg_products_northwind"
[0m15:21:53.336047 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_exercise.stg_suppliers_northwind"
[0m15:21:53.338904 [debug] [Thread-3 (]: Began executing node model.dbt_exercise.stg_suppliers_northwind
[0m15:21:53.339782 [debug] [Thread-2 (]: Began executing node model.dbt_exercise.stg_products_northwind
[0m15:21:53.340249 [debug] [Thread-1 (]: Began executing node model.dbt_exercise.stg_categories_northwind
[0m15:21:53.391490 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_exercise.stg_suppliers_northwind"
[0m15:21:53.388677 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_exercise.stg_products_northwind"
[0m15:21:53.394584 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_exercise.stg_categories_northwind"
[0m15:21:53.397078 [debug] [Thread-2 (]: On model.dbt_exercise.stg_products_northwind: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "model.dbt_exercise.stg_products_northwind"} */


  create or replace view `corded-sunlight-464012-e2`.`dbt_dw_staging`.`stg_products_northwind`
  OPTIONS()
  as with products as (
    select *
    from `corded-sunlight-464012-e2`.`dbt_dw_raw`.`products`
)

select
    cast(product_id as string) as product_id
    , cast(product_name as string) as product_name
    , cast(supplier_id as string) as supplier_id
    , cast(category_id as string) as category_id
    , cast(quantity_per_unit as string) as quantity_per_unit
    , cast(unit_price as numeric) as unit_price
    , cast(units_in_stock as numeric) as units_in_stock
    , cast(units_on_order as numeric) as units_on_order
    , cast(reorder_level as numeric) as reorder_level
    , cast(discontinued as boolean) as discontinued
from products;


[0m15:21:53.397705 [debug] [Thread-3 (]: On model.dbt_exercise.stg_suppliers_northwind: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "model.dbt_exercise.stg_suppliers_northwind"} */


  create or replace view `corded-sunlight-464012-e2`.`dbt_dw_staging`.`stg_suppliers_northwind`
  OPTIONS()
  as with suppliers as (
    select *
    from `corded-sunlight-464012-e2`.`dbt_dw_raw`.`suppliers`
)

select 
    cast(supplier_id as string) as supplier_id
    , cast(company_name as string) as company_name
    , cast(contact_name as string) as contact_name
    , cast(contact_title as string) as contact_title
    , cast(address as string) as address
    , cast(city as string) as city
    , cast(region as string) as region
    , cast(postal_code as string) as postal_code
    , cast(country as string) as country
    , cast(phone as string) as phone
    , cast(fax as string) as fax
    , cast(homepage as string) as home_page
from suppliers;


[0m15:21:53.398228 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:21:53.398819 [debug] [Thread-1 (]: On model.dbt_exercise.stg_categories_northwind: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "model.dbt_exercise.stg_categories_northwind"} */


  create or replace view `corded-sunlight-464012-e2`.`dbt_dw_staging`.`stg_categories_northwind`
  OPTIONS()
  as with categories as (
    select *
    from `corded-sunlight-464012-e2`.`dbt_dw_raw`.`categories`
)

/* Ao construir a staging não vamos trazer a coluna picture, pois ela não traz informação relevante */
select
    cast(category_id as string) as category_id
    , cast(category_name as string) as category_name
    , cast(description as string) as description
from categories;


[0m15:21:53.399586 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:21:53.400937 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:21:54.372670 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:f1173108-9701-405e-85da-c8b447df3395&page=queryresults
[0m15:21:54.375604 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:0b56e245-35cc-4edc-9f94-d1bd2ba751e4&page=queryresults
[0m15:21:54.376499 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:afb9f59c-15c0-416d-bf4d-2d8746700151&page=queryresults
[0m15:21:58.865383 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f2f3b78d-1bf9-46f0-b671-9cb9d56531e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x793b69e41ca0>]}
[0m15:21:58.866173 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f2f3b78d-1bf9-46f0-b671-9cb9d56531e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x793b6a376420>]}
[0m15:21:58.867708 [info ] [Thread-3 (]: 3 of 5 OK created sql view model dbt_dw_staging.stg_suppliers_northwind ........ [[32mCREATE VIEW (0 processed)[0m in 5.53s]
[0m15:21:58.868216 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f2f3b78d-1bf9-46f0-b671-9cb9d56531e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x793b6ecd2240>]}
[0m15:21:58.869063 [info ] [Thread-2 (]: 2 of 5 OK created sql view model dbt_dw_staging.stg_products_northwind ......... [[32mCREATE VIEW (0 processed)[0m in 5.54s]
[0m15:21:58.870230 [debug] [Thread-3 (]: Finished running node model.dbt_exercise.stg_suppliers_northwind
[0m15:21:58.871343 [info ] [Thread-1 (]: 1 of 5 OK created sql view model dbt_dw_staging.stg_categories_northwind ....... [[32mCREATE VIEW (0 processed)[0m in 5.54s]
[0m15:21:58.872465 [debug] [Thread-2 (]: Finished running node model.dbt_exercise.stg_products_northwind
[0m15:21:58.874146 [debug] [Thread-1 (]: Finished running node model.dbt_exercise.stg_categories_northwind
[0m15:21:58.876723 [debug] [Thread-4 (]: Began running node model.dbt_exercise.int_products_northwind
[0m15:21:58.877533 [info ] [Thread-4 (]: 4 of 5 START sql view model dbt_dw_intermediate.int_products_northwind ......... [RUN]
[0m15:21:58.878177 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly list_corded-sunlight-464012-e2_dbt_dw_raw, now model.dbt_exercise.int_products_northwind)
[0m15:21:58.878642 [debug] [Thread-4 (]: Began compiling node model.dbt_exercise.int_products_northwind
[0m15:21:58.883133 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_exercise.int_products_northwind"
[0m15:21:58.884521 [debug] [Thread-4 (]: Began executing node model.dbt_exercise.int_products_northwind
[0m15:21:58.887424 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_exercise.int_products_northwind"
[0m15:21:58.888213 [debug] [Thread-4 (]: On model.dbt_exercise.int_products_northwind: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "model.dbt_exercise.int_products_northwind"} */


  create or replace view `corded-sunlight-464012-e2`.`dbt_dw_intermediate`.`int_products_northwind`
  OPTIONS()
  as with products as (
    select *
    from `corded-sunlight-464012-e2`.`dbt_dw_staging`.`stg_products_northwind`
)

, categories as (
    select *
    from `corded-sunlight-464012-e2`.`dbt_dw_staging`.`stg_categories_northwind`
)

, suppliers as (
    select *
    from `corded-sunlight-464012-e2`.`dbt_dw_staging`.`stg_suppliers_northwind`
)

, final_table as (
    select
        products.product_id
        , products.product_name
        , products.quantity_per_unit
        , categories.category_name
        , suppliers.company_name as supplier_name
        , suppliers.city as supplier_city
        , suppliers.region as supplier_region
        , suppliers.country as supplier_country
        , case
            when suppliers.country in ('USA', 'Canada') then 'North America'
            when suppliers.country in ('Brazil') then 'South America'
            when suppliers.country in ('UK', 'Germany', 'Netherlands', 'Spain', 'France', 'Norway', 'Italy', 'Denmark', 'Sweden', 'Finland') then 'Europe'
            when suppliers.country in ('Singapore', 'Japan') then 'Asia'
            when suppliers.country in ('Australia') then 'Oceania'
            else 'Other'
          end as supplier_continent
        , products.discontinued
    from products
    left join categories
        on products.category_id = categories.category_id
    left join suppliers
        on products.supplier_id = suppliers.supplier_id
)

select * 
from final_table;


[0m15:21:58.888631 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m15:21:59.964418 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:c64746bd-b459-43b8-b779-d832fa530b43&page=queryresults
[0m15:22:00.511897 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f2f3b78d-1bf9-46f0-b671-9cb9d56531e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x793b69a2f980>]}
[0m15:22:00.512660 [info ] [Thread-4 (]: 4 of 5 OK created sql view model dbt_dw_intermediate.int_products_northwind .... [[32mCREATE VIEW (0 processed)[0m in 1.63s]
[0m15:22:00.513572 [debug] [Thread-4 (]: Finished running node model.dbt_exercise.int_products_northwind
[0m15:22:00.514966 [debug] [Thread-2 (]: Began running node model.dbt_exercise.dim_products
[0m15:22:00.516065 [info ] [Thread-2 (]: 5 of 5 START sql table model dbt_dw_marts.dim_products ......................... [RUN]
[0m15:22:00.516719 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_exercise.stg_products_northwind, now model.dbt_exercise.dim_products)
[0m15:22:00.517149 [debug] [Thread-2 (]: Began compiling node model.dbt_exercise.dim_products
[0m15:22:00.549528 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_exercise.dim_products"
[0m15:22:00.554334 [debug] [Thread-2 (]: Began executing node model.dbt_exercise.dim_products
[0m15:22:00.564584 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:22:01.341903 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_exercise.dim_products"
[0m15:22:01.342688 [debug] [Thread-2 (]: On model.dbt_exercise.dim_products: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "model.dbt_exercise.dim_products"} */

  
    

    create or replace table `corded-sunlight-464012-e2`.`dbt_dw_marts`.`dim_products`
      
    
    

    OPTIONS()
    as (
      with int_products as (
    select *
    from `corded-sunlight-464012-e2`.`dbt_dw_intermediate`.`int_products_northwind`
)

, dim_products as (
    select
        to_hex(md5(cast(coalesce(cast(product_id as string), '_dbt_utils_surrogate_key_null_') as string))) as sk_product
        , product_id
        , product_name
        , quantity_per_unit
        , category_name
        , supplier_name
        , supplier_city
        , supplier_region
        , supplier_country
        , supplier_continent
        , discontinued
    from int_products
)

select *
from dim_products
    );
  
[0m15:22:01.990012 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:a0b6f99a-4690-420d-b12d-9de021a08ae6&page=queryresults
[0m15:22:04.759465 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f2f3b78d-1bf9-46f0-b671-9cb9d56531e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x793b59d129c0>]}
[0m15:22:04.760517 [info ] [Thread-2 (]: 5 of 5 OK created sql table model dbt_dw_marts.dim_products .................... [[32mCREATE TABLE (77.0 rows, 6.6 KiB processed)[0m in 4.24s]
[0m15:22:04.761240 [debug] [Thread-2 (]: Finished running node model.dbt_exercise.dim_products
[0m15:22:04.764599 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:22:04.771854 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:22:04.772260 [debug] [MainThread]: Connection 'model.dbt_exercise.stg_suppliers_northwind' was properly closed.
[0m15:22:04.772522 [debug] [MainThread]: Connection 'model.dbt_exercise.int_products_northwind' was properly closed.
[0m15:22:04.772758 [debug] [MainThread]: Connection 'model.dbt_exercise.dim_products' was properly closed.
[0m15:22:04.772999 [debug] [MainThread]: Connection 'model.dbt_exercise.stg_categories_northwind' was properly closed.
[0m15:22:04.773428 [info ] [MainThread]: 
[0m15:22:04.773882 [info ] [MainThread]: Finished running 1 table model, 4 view models in 0 hours 0 minutes and 13.56 seconds (13.56s).
[0m15:22:04.776113 [debug] [MainThread]: Command end result
[0m15:22:04.818692 [debug] [MainThread]: Wrote artifact WritableManifest to /home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/target/manifest.json
[0m15:22:04.830204 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/target/semantic_manifest.json
[0m15:22:04.835550 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/target/run_results.json
[0m15:22:04.836188 [info ] [MainThread]: 
[0m15:22:04.836725 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:22:04.837051 [info ] [MainThread]: 
[0m15:22:04.837380 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=5
[0m15:22:04.837978 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- DuplicateYAMLKeysDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m15:22:04.843501 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 108.2571, "process_in_blocks": "144104", "process_kernel_time": 14.810688, "process_mem_max_rss": "367188", "process_out_blocks": "3648", "process_user_time": 10.535934}
[0m15:22:04.844328 [debug] [MainThread]: Command `dbt run` succeeded at 15:22:04.844146 after 108.26 seconds
[0m15:22:04.844807 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x793ba81abf50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x793b6a7656a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x793b6a195940>]}
[0m15:22:04.845207 [debug] [MainThread]: Flushing usage events
[0m15:22:05.232165 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:46:56.340735 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7399e88994f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7399e6b56ba0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7399e6b54e60>]}


============================== 15:46:56.359146 | 46803c96-9ffa-4228-9bde-4d9dcc1a77fe ==============================
[0m15:46:56.359146 [info ] [MainThread]: Running with dbt=1.10.2
[0m15:46:56.359804 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/logs', 'debug': 'False', 'profiles_dir': '/home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run -s +int_products_northwind', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:47:42.481565 [warn ] [MainThread]: [[33mWARNING[0m][DuplicateYAMLKeysDeprecation]: Deprecated functionality
Duplicate key 'version' in "<unicode string>", line 4, column 1 in file
`/home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/dbt_project.yml`
[0m15:47:42.482280 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '46803c96-9ffa-4228-9bde-4d9dcc1a77fe', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7399a90105c0>]}
[0m15:47:43.166962 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '46803c96-9ffa-4228-9bde-4d9dcc1a77fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7399a9b77830>]}
[0m15:47:43.218245 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '46803c96-9ffa-4228-9bde-4d9dcc1a77fe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7399ada29c10>]}
[0m15:47:43.222970 [info ] [MainThread]: Registered adapter: bigquery=1.9.2
[0m15:48:32.537993 [debug] [MainThread]: checksum: 1adc40777973ef30f45f80b3b6d04d5013c1edd53d96363881b3b199e612468b, vars: {}, profile: , target: , version: 1.10.2
[0m15:48:37.655341 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 4 files changed.
[0m15:48:37.656283 [debug] [MainThread]: Partial parsing: updated file: dbt_exercise://models/intermediate/int_orders_northwind.sql
[0m15:48:37.656689 [debug] [MainThread]: Partial parsing: updated file: dbt_exercise://models/intermediate/int_products_northwind.sql
[0m15:48:37.657042 [debug] [MainThread]: Partial parsing: updated file: dbt_exercise://models/intermediate/int_shippers_northwind.sql
[0m15:48:37.657363 [debug] [MainThread]: Partial parsing: updated file: dbt_exercise://models/intermediate/int_customers_northwind.sql
[0m15:48:38.110761 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.dbt_exercise.int_orders_northwind' (models/intermediate/int_orders_northwind.sql) depends on a node named 'stg_stg_order_details_northwind_northwind' which was not found
[0m15:48:38.111752 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- DuplicateYAMLKeysDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m15:48:38.117031 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 99.20588, "process_in_blocks": "143216", "process_kernel_time": 13.574908, "process_mem_max_rss": "359912", "process_out_blocks": "32", "process_user_time": 10.926356}
[0m15:48:38.117932 [debug] [MainThread]: Command `dbt run` failed at 15:48:38.117768 after 99.21 seconds
[0m15:48:38.118444 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7399e6515a00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7399a8df2480>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7399a89d1910>]}
[0m15:48:38.118885 [debug] [MainThread]: Flushing usage events
[0m15:48:38.477580 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:49:32.141899 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e268fa82960>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e2691aaa090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e268fde3b00>]}


============================== 15:49:32.159370 | 0bf7ddb9-a721-48e2-a21d-97c42909aa51 ==============================
[0m15:49:32.159370 [info ] [MainThread]: Running with dbt=1.10.2
[0m15:49:32.159913 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt run -s +int_products_northwind', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m15:50:19.844938 [warn ] [MainThread]: [[33mWARNING[0m][DuplicateYAMLKeysDeprecation]: Deprecated functionality
Duplicate key 'version' in "<unicode string>", line 4, column 1 in file
`/home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/dbt_project.yml`
[0m15:50:19.845608 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '0bf7ddb9-a721-48e2-a21d-97c42909aa51', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e2652016090>]}
[0m15:50:20.511113 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0bf7ddb9-a721-48e2-a21d-97c42909aa51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e268fdbf830>]}
[0m15:50:20.578287 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0bf7ddb9-a721-48e2-a21d-97c42909aa51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e2652014500>]}
[0m15:50:20.581900 [info ] [MainThread]: Registered adapter: bigquery=1.9.2
[0m15:51:09.014449 [debug] [MainThread]: checksum: 1adc40777973ef30f45f80b3b6d04d5013c1edd53d96363881b3b199e612468b, vars: {}, profile: , target: , version: 1.10.2
[0m15:51:14.144301 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:51:14.144966 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:51:14.205890 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0bf7ddb9-a721-48e2-a21d-97c42909aa51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e2651f68290>]}
[0m15:51:14.636859 [debug] [MainThread]: Wrote artifact WritableManifest to /home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/target/manifest.json
[0m15:51:14.652818 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/target/semantic_manifest.json
[0m15:51:15.394773 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0bf7ddb9-a721-48e2-a21d-97c42909aa51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e2652044710>]}
[0m15:51:15.395745 [info ] [MainThread]: Found 14 seeds, 36 data tests, 16 models, 14 sources, 609 macros
[0m15:51:15.396415 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0bf7ddb9-a721-48e2-a21d-97c42909aa51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e2651ab0e00>]}
[0m15:51:15.399519 [info ] [MainThread]: 
[0m15:51:15.400586 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:51:15.401284 [info ] [MainThread]: 
[0m15:51:15.402557 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m15:51:15.409496 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_corded-sunlight-464012-e2'
[0m15:51:15.411018 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_corded-sunlight-464012-e2'
[0m15:51:15.412411 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:51:15.414045 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:51:16.676698 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_corded-sunlight-464012-e2, now list_corded-sunlight-464012-e2_dbt_dw_marts)
[0m15:51:16.677657 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:51:16.678587 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_corded-sunlight-464012-e2, now list_corded-sunlight-464012-e2_dbt_dw_raw)
[0m15:51:16.680185 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_corded-sunlight-464012-e2_dbt_dw_staging'
[0m15:51:16.681753 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_corded-sunlight-464012-e2_dbt_dw_intermediate'
[0m15:51:16.683565 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:51:16.684826 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:51:16.686004 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:51:17.558709 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0bf7ddb9-a721-48e2-a21d-97c42909aa51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e2652094ec0>]}
[0m15:51:17.559420 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:51:17.573317 [debug] [Thread-1 (]: Began running node model.dbt_exercise.stg_categories_northwind
[0m15:51:17.574136 [debug] [Thread-2 (]: Began running node model.dbt_exercise.stg_products_northwind
[0m15:51:17.574878 [debug] [Thread-3 (]: Began running node model.dbt_exercise.stg_suppliers_northwind
[0m15:51:17.575931 [info ] [Thread-1 (]: 1 of 4 START sql view model dbt_dw_staging.stg_categories_northwind ............ [RUN]
[0m15:51:17.577295 [info ] [Thread-2 (]: 2 of 4 START sql view model dbt_dw_staging.stg_products_northwind .............. [RUN]
[0m15:51:17.578186 [info ] [Thread-3 (]: 3 of 4 START sql view model dbt_dw_staging.stg_suppliers_northwind ............. [RUN]
[0m15:51:17.579192 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_corded-sunlight-464012-e2_dbt_dw_raw, now model.dbt_exercise.stg_categories_northwind)
[0m15:51:17.579951 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_corded-sunlight-464012-e2_dbt_dw_staging, now model.dbt_exercise.stg_products_northwind)
[0m15:51:17.580510 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_corded-sunlight-464012-e2_dbt_dw_intermediate, now model.dbt_exercise.stg_suppliers_northwind)
[0m15:51:17.581095 [debug] [Thread-1 (]: Began compiling node model.dbt_exercise.stg_categories_northwind
[0m15:51:17.581552 [debug] [Thread-2 (]: Began compiling node model.dbt_exercise.stg_products_northwind
[0m15:51:17.582299 [debug] [Thread-3 (]: Began compiling node model.dbt_exercise.stg_suppliers_northwind
[0m15:51:17.589971 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_exercise.stg_categories_northwind"
[0m15:51:17.593778 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_exercise.stg_products_northwind"
[0m15:51:17.596823 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_exercise.stg_suppliers_northwind"
[0m15:51:17.599406 [debug] [Thread-3 (]: Began executing node model.dbt_exercise.stg_suppliers_northwind
[0m15:51:17.600369 [debug] [Thread-1 (]: Began executing node model.dbt_exercise.stg_categories_northwind
[0m15:51:17.611409 [debug] [Thread-2 (]: Began executing node model.dbt_exercise.stg_products_northwind
[0m15:51:17.655094 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_exercise.stg_suppliers_northwind"
[0m15:51:17.658125 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_exercise.stg_products_northwind"
[0m15:51:17.659046 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_exercise.stg_categories_northwind"
[0m15:51:17.661862 [debug] [Thread-2 (]: On model.dbt_exercise.stg_products_northwind: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "model.dbt_exercise.stg_products_northwind"} */


  create or replace view `corded-sunlight-464012-e2`.`dbt_dw_staging`.`stg_products_northwind`
  OPTIONS()
  as with raw_products as (
    select *
    from `corded-sunlight-464012-e2`.`dbt_dw_raw`.`products`
)

, stg_products_northwind as (
    select
        cast(product_id as string) as product_id
        , cast(product_name as string) as product_name
        , cast(supplier_id as string) as supplier_id
        , cast(category_id as string) as category_id
        , cast(quantity_per_unit as string) as quantity_per_unit
        , cast(unit_price as numeric) as unit_price
        , cast(units_in_stock as numeric) as units_in_stock
        , cast(units_on_order as numeric) as units_on_order
        , cast(reorder_level as numeric) as reorder_level
        , cast(discontinued as integer) as discontinued
    from products
)

select *
from stg_products_northwind;


[0m15:51:17.662461 [debug] [Thread-3 (]: On model.dbt_exercise.stg_suppliers_northwind: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "model.dbt_exercise.stg_suppliers_northwind"} */


  create or replace view `corded-sunlight-464012-e2`.`dbt_dw_staging`.`stg_suppliers_northwind`
  OPTIONS()
  as with suppliers as (
    select *
    from `corded-sunlight-464012-e2`.`dbt_dw_raw`.`suppliers`
)

select 
    cast(supplier_id as string) as supplier_id
    , cast(company_name as string) as company_name
    , cast(contact_name as string) as contact_name
    , cast(contact_title as string) as contact_title
    , cast(address as string) as address
    , cast(city as string) as city
    , cast(region as string) as region
    , cast(postal_code as string) as postal_code
    , cast(country as string) as country
    , cast(phone as string) as phone
    , cast(fax as string) as fax
    , cast(homepage as string) as home_page
from suppliers;


[0m15:51:17.663130 [debug] [Thread-1 (]: On model.dbt_exercise.stg_categories_northwind: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "model.dbt_exercise.stg_categories_northwind"} */


  create or replace view `corded-sunlight-464012-e2`.`dbt_dw_staging`.`stg_categories_northwind`
  OPTIONS()
  as with raw_categories as (
    select *
    from `corded-sunlight-464012-e2`.`dbt_dw_raw`.`categories`
)

/* Ao construir a staging não vamos trazer a coluna picture, pois ela não traz informação relevante */
, stg_categories_northwind as (
    select
        cast(category_id as string) as category_id
        , cast(category_name as string) as category_name
        , cast(description as string) as description
    from raw_categories
)

select *
from raw_categories;


[0m15:51:17.663870 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:51:17.664495 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:51:17.665337 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:51:18.585479 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:4363e992-a509-424a-adcf-7640aa38a8a6&page=queryresults
[0m15:51:18.586502 [error] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:4363e992-a509-424a-adcf-7640aa38a8a6&page=queryresults
[0m15:51:18.701089 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:16a6bb82-bc12-48f2-af96-974654197bbe&page=queryresults
[0m15:51:18.704704 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:813f8abc-e2b1-4cf8-8653-67367d9d0640&page=queryresults
[0m15:51:18.719962 [debug] [Thread-2 (]: Database Error in model stg_products_northwind (models/staging/stg_products_northwind.sql)
  Table "products" must be qualified with a dataset (e.g. dataset.table).
  compiled code at target/run/dbt_exercise/models/staging/stg_products_northwind.sql
[0m15:51:18.732952 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0bf7ddb9-a721-48e2-a21d-97c42909aa51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e26900f9f70>]}
[0m15:51:18.734107 [error] [Thread-2 (]: 2 of 4 ERROR creating sql view model dbt_dw_staging.stg_products_northwind ..... [[31mERROR[0m in 1.14s]
[0m15:51:18.735169 [debug] [Thread-2 (]: Finished running node model.dbt_exercise.stg_products_northwind
[0m15:51:18.736132 [debug] [Thread-7 (]: Marking all children of 'model.dbt_exercise.stg_products_northwind' to be skipped because of status 'error'.  Reason: Database Error in model stg_products_northwind (models/staging/stg_products_northwind.sql)
  Table "products" must be qualified with a dataset (e.g. dataset.table).
  compiled code at target/run/dbt_exercise/models/staging/stg_products_northwind.sql.
[0m15:51:23.798664 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0bf7ddb9-a721-48e2-a21d-97c42909aa51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e265191ade0>]}
[0m15:51:23.802049 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0bf7ddb9-a721-48e2-a21d-97c42909aa51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e265191a9f0>]}
[0m15:51:23.803705 [info ] [Thread-3 (]: 3 of 4 OK created sql view model dbt_dw_staging.stg_suppliers_northwind ........ [[32mCREATE VIEW (0 processed)[0m in 6.22s]
[0m15:51:23.804845 [info ] [Thread-1 (]: 1 of 4 OK created sql view model dbt_dw_staging.stg_categories_northwind ....... [[32mCREATE VIEW (0 processed)[0m in 6.22s]
[0m15:51:23.805980 [debug] [Thread-3 (]: Finished running node model.dbt_exercise.stg_suppliers_northwind
[0m15:51:23.807045 [debug] [Thread-1 (]: Finished running node model.dbt_exercise.stg_categories_northwind
[0m15:51:23.809522 [debug] [Thread-4 (]: Began running node model.dbt_exercise.int_products_northwind
[0m15:51:23.810113 [info ] [Thread-4 (]: 4 of 4 SKIP relation dbt_dw_intermediate.int_products_northwind ................ [[33mSKIP[0m]
[0m15:51:23.810686 [debug] [Thread-4 (]: Finished running node model.dbt_exercise.int_products_northwind
[0m15:51:23.813710 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:51:23.820139 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:51:23.820559 [debug] [MainThread]: Connection 'model.dbt_exercise.stg_categories_northwind' was properly closed.
[0m15:51:23.820876 [debug] [MainThread]: Connection 'list_corded-sunlight-464012-e2_dbt_dw_marts' was properly closed.
[0m15:51:23.821180 [debug] [MainThread]: Connection 'model.dbt_exercise.stg_products_northwind' was properly closed.
[0m15:51:23.821452 [debug] [MainThread]: Connection 'model.dbt_exercise.stg_suppliers_northwind' was properly closed.
[0m15:51:23.821878 [info ] [MainThread]: 
[0m15:51:23.822380 [info ] [MainThread]: Finished running 4 view models in 0 hours 0 minutes and 8.42 seconds (8.42s).
[0m15:51:23.823461 [debug] [MainThread]: Command end result
[0m15:51:23.866783 [debug] [MainThread]: Wrote artifact WritableManifest to /home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/target/manifest.json
[0m15:51:23.880787 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/target/semantic_manifest.json
[0m15:51:23.887901 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/target/run_results.json
[0m15:51:23.888323 [info ] [MainThread]: 
[0m15:51:23.888921 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m15:51:23.889365 [info ] [MainThread]: 
[0m15:51:23.889876 [error] [MainThread]: [31mFailure in model stg_products_northwind (models/staging/stg_products_northwind.sql)[0m
[0m15:51:23.890403 [error] [MainThread]:   Database Error in model stg_products_northwind (models/staging/stg_products_northwind.sql)
  Table "products" must be qualified with a dataset (e.g. dataset.table).
  compiled code at target/run/dbt_exercise/models/staging/stg_products_northwind.sql
[0m15:51:23.890883 [info ] [MainThread]: 
[0m15:51:23.891283 [info ] [MainThread]:   compiled code at target/compiled/dbt_exercise/models/staging/stg_products_northwind.sql
[0m15:51:23.891625 [info ] [MainThread]: 
[0m15:51:23.892002 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=1 NO-OP=0 TOTAL=4
[0m15:51:23.892708 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- DuplicateYAMLKeysDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m15:51:23.898893 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 109.20414, "process_in_blocks": "143888", "process_kernel_time": 14.276124, "process_mem_max_rss": "367792", "process_out_blocks": "3592", "process_user_time": 11.45647}
[0m15:51:23.899744 [debug] [MainThread]: Command `dbt run` failed at 15:51:23.899584 after 109.21 seconds
[0m15:51:23.900242 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e268f0513a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e2651f6b7a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e2641c022a0>]}
[0m15:51:23.900650 [debug] [MainThread]: Flushing usage events
[0m15:51:24.235786 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:52:23.737460 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73ce47aa10d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73ce47f12330>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73ce49055fa0>]}


============================== 15:52:23.755787 | 3d37fac2-4aac-4cad-b97d-e828cd137f3a ==============================
[0m15:52:23.755787 [info ] [MainThread]: Running with dbt=1.10.2
[0m15:52:23.756369 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/logs', 'fail_fast': 'False', 'profiles_dir': '/home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'invocation_command': 'dbt run -s +int_products_northwind', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m15:53:05.682627 [warn ] [MainThread]: [[33mWARNING[0m][DuplicateYAMLKeysDeprecation]: Deprecated functionality
Duplicate key 'version' in "<unicode string>", line 4, column 1 in file
`/home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/dbt_project.yml`
[0m15:53:05.683274 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '3d37fac2-4aac-4cad-b97d-e828cd137f3a', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73ce0a3fc230>]}
[0m15:53:06.286815 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3d37fac2-4aac-4cad-b97d-e828cd137f3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73ce482097f0>]}
[0m15:53:06.340733 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3d37fac2-4aac-4cad-b97d-e828cd137f3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73ce499984d0>]}
[0m15:53:06.345205 [info ] [MainThread]: Registered adapter: bigquery=1.9.2
[0m15:53:47.365083 [debug] [MainThread]: checksum: 1adc40777973ef30f45f80b3b6d04d5013c1edd53d96363881b3b199e612468b, vars: {}, profile: , target: , version: 1.10.2
[0m15:53:52.584786 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:53:52.585362 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:53:52.632224 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3d37fac2-4aac-4cad-b97d-e828cd137f3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73ce0a028170>]}
[0m15:53:52.898783 [debug] [MainThread]: Wrote artifact WritableManifest to /home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/target/manifest.json
[0m15:53:52.912530 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/target/semantic_manifest.json
[0m15:53:53.274004 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3d37fac2-4aac-4cad-b97d-e828cd137f3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73ce0ef2f710>]}
[0m15:53:53.274621 [info ] [MainThread]: Found 14 seeds, 36 data tests, 16 models, 14 sources, 609 macros
[0m15:53:53.275050 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3d37fac2-4aac-4cad-b97d-e828cd137f3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73ce0a273710>]}
[0m15:53:53.277286 [info ] [MainThread]: 
[0m15:53:53.277795 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:53:53.278111 [info ] [MainThread]: 
[0m15:53:53.278645 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m15:53:53.282491 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_corded-sunlight-464012-e2'
[0m15:53:53.283926 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:53:53.284929 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_corded-sunlight-464012-e2'
[0m15:53:53.286276 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:53:54.414548 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_corded-sunlight-464012-e2, now list_corded-sunlight-464012-e2_dbt_dw_staging)
[0m15:53:54.415670 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_corded-sunlight-464012-e2, now list_corded-sunlight-464012-e2_dbt_dw_intermediate)
[0m15:53:54.416948 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:53:54.418544 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_corded-sunlight-464012-e2_dbt_dw_raw'
[0m15:53:54.419201 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:53:54.420214 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_corded-sunlight-464012-e2_dbt_dw_marts'
[0m15:53:54.421479 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:53:54.422239 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:53:55.279575 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3d37fac2-4aac-4cad-b97d-e828cd137f3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73ce47359070>]}
[0m15:53:55.280272 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:53:55.295142 [debug] [Thread-1 (]: Began running node model.dbt_exercise.stg_categories_northwind
[0m15:53:55.295633 [debug] [Thread-2 (]: Began running node model.dbt_exercise.stg_products_northwind
[0m15:53:55.296229 [debug] [Thread-3 (]: Began running node model.dbt_exercise.stg_suppliers_northwind
[0m15:53:55.297077 [info ] [Thread-1 (]: 1 of 4 START sql view model dbt_dw_staging.stg_categories_northwind ............ [RUN]
[0m15:53:55.298086 [info ] [Thread-2 (]: 2 of 4 START sql view model dbt_dw_staging.stg_products_northwind .............. [RUN]
[0m15:53:55.298989 [info ] [Thread-3 (]: 3 of 4 START sql view model dbt_dw_staging.stg_suppliers_northwind ............. [RUN]
[0m15:53:55.299575 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_corded-sunlight-464012-e2_dbt_dw_staging, now model.dbt_exercise.stg_categories_northwind)
[0m15:53:55.300156 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_corded-sunlight-464012-e2_dbt_dw_intermediate, now model.dbt_exercise.stg_products_northwind)
[0m15:53:55.300872 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_corded-sunlight-464012-e2_dbt_dw_marts, now model.dbt_exercise.stg_suppliers_northwind)
[0m15:53:55.301433 [debug] [Thread-1 (]: Began compiling node model.dbt_exercise.stg_categories_northwind
[0m15:53:55.302163 [debug] [Thread-2 (]: Began compiling node model.dbt_exercise.stg_products_northwind
[0m15:53:55.303170 [debug] [Thread-3 (]: Began compiling node model.dbt_exercise.stg_suppliers_northwind
[0m15:53:55.311291 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_exercise.stg_categories_northwind"
[0m15:53:55.314916 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_exercise.stg_products_northwind"
[0m15:53:55.319668 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_exercise.stg_suppliers_northwind"
[0m15:53:55.322042 [debug] [Thread-3 (]: Began executing node model.dbt_exercise.stg_suppliers_northwind
[0m15:53:55.322802 [debug] [Thread-2 (]: Began executing node model.dbt_exercise.stg_products_northwind
[0m15:53:55.335878 [debug] [Thread-1 (]: Began executing node model.dbt_exercise.stg_categories_northwind
[0m15:53:55.367712 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_exercise.stg_suppliers_northwind"
[0m15:53:55.370966 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_exercise.stg_products_northwind"
[0m15:53:55.373822 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_exercise.stg_categories_northwind"
[0m15:53:55.375223 [debug] [Thread-3 (]: On model.dbt_exercise.stg_suppliers_northwind: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "model.dbt_exercise.stg_suppliers_northwind"} */


  create or replace view `corded-sunlight-464012-e2`.`dbt_dw_staging`.`stg_suppliers_northwind`
  OPTIONS()
  as with suppliers as (
    select *
    from `corded-sunlight-464012-e2`.`dbt_dw_raw`.`suppliers`
)

select 
    cast(supplier_id as string) as supplier_id
    , cast(company_name as string) as company_name
    , cast(contact_name as string) as contact_name
    , cast(contact_title as string) as contact_title
    , cast(address as string) as address
    , cast(city as string) as city
    , cast(region as string) as region
    , cast(postal_code as string) as postal_code
    , cast(country as string) as country
    , cast(phone as string) as phone
    , cast(fax as string) as fax
    , cast(homepage as string) as home_page
from suppliers;


[0m15:53:55.376115 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:53:55.376757 [debug] [Thread-2 (]: On model.dbt_exercise.stg_products_northwind: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "model.dbt_exercise.stg_products_northwind"} */


  create or replace view `corded-sunlight-464012-e2`.`dbt_dw_staging`.`stg_products_northwind`
  OPTIONS()
  as with raw_products as (
    select *
    from `corded-sunlight-464012-e2`.`dbt_dw_raw`.`products`
)

, stg_products_northwind as (
    select
        cast(product_id as string) as product_id
        , cast(product_name as string) as product_name
        , cast(supplier_id as string) as supplier_id
        , cast(category_id as string) as category_id
        , cast(quantity_per_unit as string) as quantity_per_unit
        , cast(unit_price as numeric) as unit_price
        , cast(units_in_stock as numeric) as units_in_stock
        , cast(units_on_order as numeric) as units_on_order
        , cast(reorder_level as numeric) as reorder_level
        , cast(discontinued as integer) as discontinued
    from raw_products
)

select *
from stg_products_northwind;


[0m15:53:55.377708 [debug] [Thread-1 (]: On model.dbt_exercise.stg_categories_northwind: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "model.dbt_exercise.stg_categories_northwind"} */


  create or replace view `corded-sunlight-464012-e2`.`dbt_dw_staging`.`stg_categories_northwind`
  OPTIONS()
  as with raw_categories as (
    select *
    from `corded-sunlight-464012-e2`.`dbt_dw_raw`.`categories`
)

/* Ao construir a staging não vamos trazer a coluna picture, pois ela não traz informação relevante */
, stg_categories_northwind as (
    select
        cast(category_id as string) as category_id
        , cast(category_name as string) as category_name
        , cast(description as string) as description
    from raw_categories
)

select *
from raw_categories;


[0m15:53:55.378627 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:53:55.379690 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:53:56.439580 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:56b8c8d6-962f-4e47-9272-4c5841e919dc&page=queryresults
[0m15:53:56.445401 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:b8acd94d-a2c4-43ce-95f7-e04e3fbef027&page=queryresults
[0m15:53:56.467979 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:e3d98309-3d68-4897-bacb-c60036966d5f&page=queryresults
[0m15:54:00.586747 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3d37fac2-4aac-4cad-b97d-e828cd137f3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73ce09fcc200>]}
[0m15:54:00.587296 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3d37fac2-4aac-4cad-b97d-e828cd137f3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73ce0ee4e630>]}
[0m15:54:00.588394 [info ] [Thread-1 (]: 1 of 4 OK created sql view model dbt_dw_staging.stg_categories_northwind ....... [[32mCREATE VIEW (0 processed)[0m in 5.27s]
[0m15:54:00.589372 [info ] [Thread-3 (]: 3 of 4 OK created sql view model dbt_dw_staging.stg_suppliers_northwind ........ [[32mCREATE VIEW (0 processed)[0m in 5.28s]
[0m15:54:00.590156 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3d37fac2-4aac-4cad-b97d-e828cd137f3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73ce09eacb90>]}
[0m15:54:00.590803 [debug] [Thread-1 (]: Finished running node model.dbt_exercise.stg_categories_northwind
[0m15:54:00.591716 [debug] [Thread-3 (]: Finished running node model.dbt_exercise.stg_suppliers_northwind
[0m15:54:00.593059 [info ] [Thread-2 (]: 2 of 4 OK created sql view model dbt_dw_staging.stg_products_northwind ......... [[32mCREATE VIEW (0 processed)[0m in 5.28s]
[0m15:54:00.594627 [debug] [Thread-2 (]: Finished running node model.dbt_exercise.stg_products_northwind
[0m15:54:00.596428 [debug] [Thread-4 (]: Began running node model.dbt_exercise.int_products_northwind
[0m15:54:00.597247 [info ] [Thread-4 (]: 4 of 4 START sql view model dbt_dw_intermediate.int_products_northwind ......... [RUN]
[0m15:54:00.597988 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly list_corded-sunlight-464012-e2_dbt_dw_raw, now model.dbt_exercise.int_products_northwind)
[0m15:54:00.598521 [debug] [Thread-4 (]: Began compiling node model.dbt_exercise.int_products_northwind
[0m15:54:00.601983 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_exercise.int_products_northwind"
[0m15:54:00.605887 [debug] [Thread-4 (]: Began executing node model.dbt_exercise.int_products_northwind
[0m15:54:00.609327 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_exercise.int_products_northwind"
[0m15:54:00.610874 [debug] [Thread-4 (]: On model.dbt_exercise.int_products_northwind: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "model.dbt_exercise.int_products_northwind"} */


  create or replace view `corded-sunlight-464012-e2`.`dbt_dw_intermediate`.`int_products_northwind`
  OPTIONS()
  as with stg_products_northwind as (
    select *
    from `corded-sunlight-464012-e2`.`dbt_dw_staging`.`stg_products_northwind`
)

, stg_categories_northwind as (
    select *
    from `corded-sunlight-464012-e2`.`dbt_dw_staging`.`stg_categories_northwind`
)

, stg_suppliers_northwind as (
    select *
    from `corded-sunlight-464012-e2`.`dbt_dw_staging`.`stg_suppliers_northwind`
)

, final_table as (
    select
        stg_products_northwind.product_id
        , stg_products_northwind.product_name
        , stg_products_northwind.quantity_per_unit
        , stg_categories_northwind.category_name
        , stg_suppliers_northwind.company_name as supplier_name
        , stg_suppliers_northwind.city as supplier_city
        , stg_suppliers_northwind.region as supplier_region
        , stg_suppliers_northwind.country as supplier_country
        , case
            when stg_suppliers_northwind.country in ('USA', 'Canada') then 'North America'
            when stg_suppliers_northwind.country in ('Brazil') then 'South America'
            when stg_suppliers_northwind.country in ('UK', 'Germany', 'Netherlands', 'Spain', 'France', 'Norway', 'Italy', 'Denmark', 'Sweden', 'Finland') then 'Europe'
            when stg_suppliers_northwind.country in ('Singapore', 'Japan') then 'Asia'
            when stg_suppliers_northwind.country in ('Australia') then 'Oceania'
            else 'Other'
          end as supplier_continent
        , stg_products_northwind.discontinued
    from stg_products_northwind
    left join stg_categories_northwind
        on stg_products_northwind.category_id = stg_categories_northwind.category_id
    left join stg_suppliers_northwind
        on stg_products_northwind.supplier_id = stg_suppliers_northwind.supplier_id
)

desc table final_table
;


[0m15:54:00.612050 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m15:54:01.418755 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:bc8887bb-112f-440b-aedd-db9007740a86&page=queryresults
[0m15:54:01.419433 [error] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:bc8887bb-112f-440b-aedd-db9007740a86&page=queryresults
[0m15:54:01.511173 [debug] [Thread-4 (]: Database Error in model int_products_northwind (models/intermediate/int_products_northwind.sql)
  Syntax error: Unexpected keyword DESC at [47:1]
  compiled code at target/run/dbt_exercise/models/intermediate/int_products_northwind.sql
[0m15:54:01.511846 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3d37fac2-4aac-4cad-b97d-e828cd137f3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73ce080451c0>]}
[0m15:54:01.512620 [error] [Thread-4 (]: 4 of 4 ERROR creating sql view model dbt_dw_intermediate.int_products_northwind  [[31mERROR[0m in 0.91s]
[0m15:54:01.513255 [debug] [Thread-4 (]: Finished running node model.dbt_exercise.int_products_northwind
[0m15:54:01.514087 [debug] [Thread-7 (]: Marking all children of 'model.dbt_exercise.int_products_northwind' to be skipped because of status 'error'.  Reason: Database Error in model int_products_northwind (models/intermediate/int_products_northwind.sql)
  Syntax error: Unexpected keyword DESC at [47:1]
  compiled code at target/run/dbt_exercise/models/intermediate/int_products_northwind.sql.
[0m15:54:01.517379 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:54:01.522969 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:54:01.523413 [debug] [MainThread]: Connection 'model.dbt_exercise.stg_categories_northwind' was properly closed.
[0m15:54:01.523771 [debug] [MainThread]: Connection 'model.dbt_exercise.stg_products_northwind' was properly closed.
[0m15:54:01.524158 [debug] [MainThread]: Connection 'model.dbt_exercise.int_products_northwind' was properly closed.
[0m15:54:01.524645 [debug] [MainThread]: Connection 'model.dbt_exercise.stg_suppliers_northwind' was properly closed.
[0m15:54:01.525064 [info ] [MainThread]: 
[0m15:54:01.525528 [info ] [MainThread]: Finished running 4 view models in 0 hours 0 minutes and 8.25 seconds (8.25s).
[0m15:54:01.526580 [debug] [MainThread]: Command end result
[0m15:54:01.565618 [debug] [MainThread]: Wrote artifact WritableManifest to /home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/target/manifest.json
[0m15:54:01.576678 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/target/semantic_manifest.json
[0m15:54:01.581766 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/target/run_results.json
[0m15:54:01.582197 [info ] [MainThread]: 
[0m15:54:01.582615 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m15:54:01.582995 [info ] [MainThread]: 
[0m15:54:01.583410 [error] [MainThread]: [31mFailure in model int_products_northwind (models/intermediate/int_products_northwind.sql)[0m
[0m15:54:01.583804 [error] [MainThread]:   Database Error in model int_products_northwind (models/intermediate/int_products_northwind.sql)
  Syntax error: Unexpected keyword DESC at [47:1]
  compiled code at target/run/dbt_exercise/models/intermediate/int_products_northwind.sql
[0m15:54:01.584168 [info ] [MainThread]: 
[0m15:54:01.584628 [info ] [MainThread]:   compiled code at target/compiled/dbt_exercise/models/intermediate/int_products_northwind.sql
[0m15:54:01.584995 [info ] [MainThread]: 
[0m15:54:01.585367 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=4
[0m15:54:01.585885 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- DuplicateYAMLKeysDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m15:54:01.590893 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 95.315506, "process_in_blocks": "144744", "process_kernel_time": 12.332537, "process_mem_max_rss": "368052", "process_out_blocks": "3608", "process_user_time": 9.578466}
[0m15:54:01.591409 [debug] [MainThread]: Command `dbt run` failed at 15:54:01.591322 after 95.32 seconds
[0m15:54:01.592715 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73ce4820a180>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73ce483420f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73ce47791130>]}
[0m15:54:01.593098 [debug] [MainThread]: Flushing usage events
[0m15:54:02.101057 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:09:32.177067 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f075f1d5370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f075d07ad20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f075d0798e0>]}


============================== 16:09:32.196268 | 3f7e4363-bc80-4cda-9f6d-1e26cabe7e2b ==============================
[0m16:09:32.196268 [info ] [MainThread]: Running with dbt=1.10.2
[0m16:09:32.196913 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:10:14.825695 [warn ] [MainThread]: [[33mWARNING[0m][DuplicateYAMLKeysDeprecation]: Deprecated functionality
Duplicate key 'version' in "<unicode string>", line 4, column 1 in file
`/home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/dbt_project.yml`
[0m16:10:14.826364 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '3f7e4363-bc80-4cda-9f6d-1e26cabe7e2b', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f071f99e5d0>]}
[0m16:10:15.421663 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3f7e4363-bc80-4cda-9f6d-1e26cabe7e2b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f071fb1fe00>]}
[0m16:10:15.475751 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3f7e4363-bc80-4cda-9f6d-1e26cabe7e2b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f071faa48f0>]}
[0m16:10:15.480284 [info ] [MainThread]: Registered adapter: bigquery=1.9.2
[0m16:11:02.107655 [debug] [MainThread]: checksum: 1adc40777973ef30f45f80b3b6d04d5013c1edd53d96363881b3b199e612468b, vars: {}, profile: , target: , version: 1.10.2
[0m16:11:06.987016 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:11:06.987615 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:11:07.040061 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3f7e4363-bc80-4cda-9f6d-1e26cabe7e2b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f071f88bfe0>]}
[0m16:11:07.379596 [debug] [MainThread]: Wrote artifact WritableManifest to /home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/target/manifest.json
[0m16:11:07.395861 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/target/semantic_manifest.json
[0m16:11:07.783898 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3f7e4363-bc80-4cda-9f6d-1e26cabe7e2b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f071f366390>]}
[0m16:11:07.784520 [info ] [MainThread]: Found 14 seeds, 36 data tests, 16 models, 14 sources, 609 macros
[0m16:11:07.784933 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3f7e4363-bc80-4cda-9f6d-1e26cabe7e2b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f071f968cb0>]}
[0m16:11:07.787587 [info ] [MainThread]: 
[0m16:11:07.788118 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:11:07.788414 [info ] [MainThread]: 
[0m16:11:07.789084 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m16:11:07.794117 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_corded-sunlight-464012-e2'
[0m16:11:07.795314 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:11:07.795928 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_corded-sunlight-464012-e2'
[0m16:11:07.797311 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_corded-sunlight-464012-e2'
[0m16:11:07.798286 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:11:07.799370 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:11:09.063181 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_corded-sunlight-464012-e2, now list_corded-sunlight-464012-e2_dbt_dw_raw)
[0m16:11:09.065144 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_corded-sunlight-464012-e2, now list_corded-sunlight-464012-e2_dbt_dw_intermediate)
[0m16:11:09.066610 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_corded-sunlight-464012-e2, now list_corded-sunlight-464012-e2_dbt_dw_marts)
[0m16:11:09.067304 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:11:09.069014 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_corded-sunlight-464012-e2_dbt_dw_staging'
[0m16:11:09.070127 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:11:09.070946 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:11:09.071790 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:11:10.062263 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3f7e4363-bc80-4cda-9f6d-1e26cabe7e2b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f075ccdd4f0>]}
[0m16:11:10.063016 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:11:10.078440 [debug] [Thread-1 (]: Began running node model.dbt_exercise.stg_categories_northwind
[0m16:11:10.079136 [debug] [Thread-2 (]: Began running node model.dbt_exercise.stg_customers_northwind
[0m16:11:10.079941 [debug] [Thread-3 (]: Began running node model.dbt_exercise.stg_employee_territories
[0m16:11:10.081661 [debug] [Thread-4 (]: Began running node model.dbt_exercise.stg_employees_northwind
[0m16:11:10.081025 [info ] [Thread-1 (]: 1 of 15 START sql view model dbt_dw_staging.stg_categories_northwind ........... [RUN]
[0m16:11:10.082713 [info ] [Thread-2 (]: 2 of 15 START sql view model dbt_dw_staging.stg_customers_northwind ............ [RUN]
[0m16:11:10.083793 [info ] [Thread-3 (]: 3 of 15 START sql view model dbt_dw_staging.stg_employee_territories ........... [RUN]
[0m16:11:10.084986 [info ] [Thread-4 (]: 4 of 15 START sql view model dbt_dw_staging.stg_employees_northwind ............ [RUN]
[0m16:11:10.086010 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_corded-sunlight-464012-e2_dbt_dw_marts, now model.dbt_exercise.stg_categories_northwind)
[0m16:11:10.086757 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_corded-sunlight-464012-e2_dbt_dw_staging, now model.dbt_exercise.stg_customers_northwind)
[0m16:11:10.087352 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_corded-sunlight-464012-e2_dbt_dw_intermediate, now model.dbt_exercise.stg_employee_territories)
[0m16:11:10.088133 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly list_corded-sunlight-464012-e2_dbt_dw_raw, now model.dbt_exercise.stg_employees_northwind)
[0m16:11:10.088831 [debug] [Thread-1 (]: Began compiling node model.dbt_exercise.stg_categories_northwind
[0m16:11:10.089460 [debug] [Thread-2 (]: Began compiling node model.dbt_exercise.stg_customers_northwind
[0m16:11:10.090024 [debug] [Thread-3 (]: Began compiling node model.dbt_exercise.stg_employee_territories
[0m16:11:10.090802 [debug] [Thread-4 (]: Began compiling node model.dbt_exercise.stg_employees_northwind
[0m16:11:10.100404 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_exercise.stg_categories_northwind"
[0m16:11:10.104595 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_exercise.stg_customers_northwind"
[0m16:11:10.109320 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_exercise.stg_employee_territories"
[0m16:11:10.115464 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_exercise.stg_employees_northwind"
[0m16:11:10.118384 [debug] [Thread-1 (]: Began executing node model.dbt_exercise.stg_categories_northwind
[0m16:11:10.136472 [debug] [Thread-4 (]: Began executing node model.dbt_exercise.stg_employees_northwind
[0m16:11:10.153561 [debug] [Thread-2 (]: Began executing node model.dbt_exercise.stg_customers_northwind
[0m16:11:10.157994 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_exercise.stg_employees_northwind"
[0m16:11:10.160187 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_exercise.stg_categories_northwind"
[0m16:11:10.163659 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_exercise.stg_customers_northwind"
[0m16:11:10.165988 [debug] [Thread-3 (]: Began executing node model.dbt_exercise.stg_employee_territories
[0m16:11:10.168159 [debug] [Thread-4 (]: On model.dbt_exercise.stg_employees_northwind: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "model.dbt_exercise.stg_employees_northwind"} */


  create or replace view `corded-sunlight-464012-e2`.`dbt_dw_staging`.`stg_employees_northwind`
  OPTIONS()
  as with raw_employees as (
    select *
    from `corded-sunlight-464012-e2`.`dbt_dw_raw`.`employees`
)

/* Os campos photo, notes e reports_to e photo_path não são carregadas na staging */

, stg_employees_northwind as (
    select
        cast(employee_id as string) as employee_id
        , cast(first_name as string) as first_name
        , cast(last_name as string) as last_name
        , cast(title as string) as title
        , cast(title_of_courtesy as string) as title_of_courtesy
        , cast(birth_date as date) as birth_date
        , cast(hire_date as date) as hire_date
        , cast(address as string) as address
        , cast(city as string) as city
        , cast(region as string) as region
        , cast(postal_code as string) as postal_code
        , cast(country as string) as country
        , cast(home_phone as string) as home_phone
        , cast(extension as string) as extension
    from raw_employees
)

select *
from stg_employees_northwind;


[0m16:11:10.168919 [debug] [Thread-1 (]: On model.dbt_exercise.stg_categories_northwind: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "model.dbt_exercise.stg_categories_northwind"} */


  create or replace view `corded-sunlight-464012-e2`.`dbt_dw_staging`.`stg_categories_northwind`
  OPTIONS()
  as with raw_categories as (
    select *
    from `corded-sunlight-464012-e2`.`dbt_dw_raw`.`categories`
)

/* Ao construir a staging não vamos trazer a coluna picture, pois ela não traz informação relevante */
, stg_categories_northwind as (
    select
        cast(category_id as string) as category_id
        , cast(category_name as string) as category_name
        , cast(description as string) as description
    from raw_categories
)

select *
from raw_categories;


[0m16:11:10.171808 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_exercise.stg_employee_territories"
[0m16:11:10.172626 [debug] [Thread-2 (]: On model.dbt_exercise.stg_customers_northwind: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "model.dbt_exercise.stg_customers_northwind"} */


  create or replace view `corded-sunlight-464012-e2`.`dbt_dw_staging`.`stg_customers_northwind`
  OPTIONS()
  as with raw_customers as (
    select *
    from `corded-sunlight-464012-e2`.`dbt_dw_raw`.`customers`
)

, stg_customers_northwind as (
    select
        cast(customer_id as string) as customer_id
        , cast(company_name as string) as company_name
        , cast(contact_name as string) as contact_name
        , cast(contact_title as string) as contact_title
        , cast(address as string) as address
        , cast(city as string) as city
        , cast(region as string) as region
        , cast(postal_code as string) as postal_code
        , cast(country as string) as country
        , cast(phone as string) as phone
        , cast(fax as string) as fax
    from raw_customerscustomers
)

select *
from stg_customers_northwind;


[0m16:11:10.173982 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:11:10.175218 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:11:10.176456 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:11:10.178228 [debug] [Thread-3 (]: On model.dbt_exercise.stg_employee_territories: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "model.dbt_exercise.stg_employee_territories"} */


  create or replace view `corded-sunlight-464012-e2`.`dbt_dw_staging`.`stg_employee_territories`
  OPTIONS()
  as with raw_employee_territories as (
    select *
    from `corded-sunlight-464012-e2`.`dbt_dw_raw`.`employee_territories`
)

, stg_employee_territories as (
    select
        cast(employee_id as string) as employee_id
        , cast(territory_id as string) as territory_id
    from raw_employee_territories
)

select *
from stg_employee_territories;


[0m16:11:10.180086 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:11:11.156637 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:e8065717-296c-49ba-8df1-53a3b167705d&page=queryresults
[0m16:11:11.157923 [error] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:e8065717-296c-49ba-8df1-53a3b167705d&page=queryresults
[0m16:11:11.253386 [debug] [Thread-2 (]: Database Error in model stg_customers_northwind (models/staging/stg_customers_northwind.sql)
  Table "raw_customerscustomers" must be qualified with a dataset (e.g. dataset.table).
  compiled code at target/run/dbt_exercise/models/staging/stg_customers_northwind.sql
[0m16:11:11.268023 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3f7e4363-bc80-4cda-9f6d-1e26cabe7e2b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f071f680170>]}
[0m16:11:11.268961 [error] [Thread-2 (]: 2 of 15 ERROR creating sql view model dbt_dw_staging.stg_customers_northwind ... [[31mERROR[0m in 1.17s]
[0m16:11:11.269723 [debug] [Thread-2 (]: Finished running node model.dbt_exercise.stg_customers_northwind
[0m16:11:11.270299 [debug] [Thread-2 (]: Began running node model.dbt_exercise.stg_order_details_northwind
[0m16:11:11.270932 [debug] [Thread-7 (]: Marking all children of 'model.dbt_exercise.stg_customers_northwind' to be skipped because of status 'error'.  Reason: Database Error in model stg_customers_northwind (models/staging/stg_customers_northwind.sql)
  Table "raw_customerscustomers" must be qualified with a dataset (e.g. dataset.table).
  compiled code at target/run/dbt_exercise/models/staging/stg_customers_northwind.sql.
[0m16:11:11.271507 [info ] [Thread-2 (]: 5 of 15 START sql view model dbt_dw_staging.stg_order_details_northwind ........ [RUN]
[0m16:11:11.273404 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_exercise.stg_customers_northwind, now model.dbt_exercise.stg_order_details_northwind)
[0m16:11:11.274262 [debug] [Thread-2 (]: Began compiling node model.dbt_exercise.stg_order_details_northwind
[0m16:11:11.277284 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_exercise.stg_order_details_northwind"
[0m16:11:11.278429 [debug] [Thread-2 (]: Began executing node model.dbt_exercise.stg_order_details_northwind
[0m16:11:11.283855 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_exercise.stg_order_details_northwind"
[0m16:11:11.284688 [debug] [Thread-2 (]: On model.dbt_exercise.stg_order_details_northwind: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "model.dbt_exercise.stg_order_details_northwind"} */


  create or replace view `corded-sunlight-464012-e2`.`dbt_dw_staging`.`stg_order_details_northwind`
  OPTIONS()
  as with raw_order_details as (
    select *
    from `corded-sunlight-464012-e2`.`dbt_dw_raw`.`order_details`
)

, stg_order_details_northwind as (
    select
        cast(order_id as string) as order_id
        , cast(product_id as string) as product_id
        , cast(unit_price as numeric) as unit_price
        , cast(quantity as integer) as quantity
        , cast(discount as numeric) as discount
    from raw_order_details
)

select *
from stg_order_details_northwind;


[0m16:11:11.285183 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:11:11.316924 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:b7913a1b-4bdf-411f-a956-ffcaa1189d66&page=queryresults
[0m16:11:11.320107 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:9ff34dcf-1651-4a8b-a4b1-fefbb8d437e0&page=queryresults
[0m16:11:11.324939 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:86e603b6-3a3b-4d46-9dbf-25e92bd0d34d&page=queryresults
[0m16:11:12.334902 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:4e644b27-cb71-4c29-aa0e-69542ec215bf&page=queryresults
[0m16:11:16.153555 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3f7e4363-bc80-4cda-9f6d-1e26cabe7e2b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f07077bb4a0>]}
[0m16:11:16.155505 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3f7e4363-bc80-4cda-9f6d-1e26cabe7e2b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f071f99f290>]}
[0m16:11:16.160656 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3f7e4363-bc80-4cda-9f6d-1e26cabe7e2b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f071f263d40>]}
[0m16:11:16.161587 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3f7e4363-bc80-4cda-9f6d-1e26cabe7e2b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f072845a270>]}
[0m16:11:16.163405 [info ] [Thread-4 (]: 4 of 15 OK created sql view model dbt_dw_staging.stg_employees_northwind ....... [[32mCREATE VIEW (0 processed)[0m in 6.07s]
[0m16:11:16.165316 [info ] [Thread-1 (]: 1 of 15 OK created sql view model dbt_dw_staging.stg_categories_northwind ...... [[32mCREATE VIEW (0 processed)[0m in 6.07s]
[0m16:11:16.166755 [info ] [Thread-3 (]: 3 of 15 OK created sql view model dbt_dw_staging.stg_employee_territories ...... [[32mCREATE VIEW (0 processed)[0m in 6.07s]
[0m16:11:16.167664 [info ] [Thread-2 (]: 5 of 15 OK created sql view model dbt_dw_staging.stg_order_details_northwind ... [[32mCREATE VIEW (0 processed)[0m in 4.89s]
[0m16:11:16.168784 [debug] [Thread-4 (]: Finished running node model.dbt_exercise.stg_employees_northwind
[0m16:11:16.169729 [debug] [Thread-1 (]: Finished running node model.dbt_exercise.stg_categories_northwind
[0m16:11:16.170797 [debug] [Thread-3 (]: Finished running node model.dbt_exercise.stg_employee_territories
[0m16:11:16.171649 [debug] [Thread-2 (]: Finished running node model.dbt_exercise.stg_order_details_northwind
[0m16:11:16.172464 [debug] [Thread-4 (]: Began running node model.dbt_exercise.stg_orders_northwind
[0m16:11:16.173423 [debug] [Thread-1 (]: Began running node model.dbt_exercise.stg_products_northwind
[0m16:11:16.174619 [debug] [Thread-3 (]: Began running node model.dbt_exercise.stg_shippers_northwind
[0m16:11:16.175540 [debug] [Thread-2 (]: Began running node model.dbt_exercise.stg_suppliers_northwind
[0m16:11:16.176734 [info ] [Thread-4 (]: 6 of 15 START sql view model dbt_dw_staging.stg_orders_northwind ............... [RUN]
[0m16:11:16.179170 [info ] [Thread-1 (]: 7 of 15 START sql view model dbt_dw_staging.stg_products_northwind ............. [RUN]
[0m16:11:16.180643 [info ] [Thread-3 (]: 8 of 15 START sql view model dbt_dw_staging.stg_shippers_northwind ............. [RUN]
[0m16:11:16.182341 [info ] [Thread-2 (]: 9 of 15 START sql view model dbt_dw_staging.stg_suppliers_northwind ............ [RUN]
[0m16:11:16.183481 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.dbt_exercise.stg_employees_northwind, now model.dbt_exercise.stg_orders_northwind)
[0m16:11:16.184227 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_exercise.stg_categories_northwind, now model.dbt_exercise.stg_products_northwind)
[0m16:11:16.185042 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_exercise.stg_employee_territories, now model.dbt_exercise.stg_shippers_northwind)
[0m16:11:16.186113 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_exercise.stg_order_details_northwind, now model.dbt_exercise.stg_suppliers_northwind)
[0m16:11:16.187290 [debug] [Thread-4 (]: Began compiling node model.dbt_exercise.stg_orders_northwind
[0m16:11:16.188310 [debug] [Thread-1 (]: Began compiling node model.dbt_exercise.stg_products_northwind
[0m16:11:16.188954 [debug] [Thread-3 (]: Began compiling node model.dbt_exercise.stg_shippers_northwind
[0m16:11:16.190169 [debug] [Thread-2 (]: Began compiling node model.dbt_exercise.stg_suppliers_northwind
[0m16:11:16.196550 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_exercise.stg_orders_northwind"
[0m16:11:16.201129 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_exercise.stg_products_northwind"
[0m16:11:16.204630 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_exercise.stg_shippers_northwind"
[0m16:11:16.210481 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_exercise.stg_suppliers_northwind"
[0m16:11:16.214202 [debug] [Thread-4 (]: Began executing node model.dbt_exercise.stg_orders_northwind
[0m16:11:16.218388 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_exercise.stg_orders_northwind"
[0m16:11:16.219478 [debug] [Thread-3 (]: Began executing node model.dbt_exercise.stg_shippers_northwind
[0m16:11:16.220599 [debug] [Thread-2 (]: Began executing node model.dbt_exercise.stg_suppliers_northwind
[0m16:11:16.221581 [debug] [Thread-1 (]: Began executing node model.dbt_exercise.stg_products_northwind
[0m16:11:16.224875 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_exercise.stg_shippers_northwind"
[0m16:11:16.225838 [debug] [Thread-4 (]: On model.dbt_exercise.stg_orders_northwind: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "model.dbt_exercise.stg_orders_northwind"} */


  create or replace view `corded-sunlight-464012-e2`.`dbt_dw_staging`.`stg_orders_northwind`
  OPTIONS()
  as with raw_orders as (
    select *
    from `corded-sunlight-464012-e2`.`dbt_dw_raw`.`orders`
)

, stg_orders_northwind as (
    select
        cast(order_id as string) as order_id
        , cast(customer_id as string) as customer_id
        , cast(employee_id as string) as employee_id
        , cast(order_date as timestamp) as order_date
        , cast(required_date as timestamp) as required_date
        , cast(shipped_date as timestamp) as shipped_date
        , cast(ship_via as string) as ship_via
        , cast(freight as numeric) as freight
        , cast(ship_name as string) as ship_name
        , cast(ship_address as string) as ship_address
        , cast(ship_city as string) as ship_city
        , cast(ship_region as string) as ship_region
        , cast(ship_postal_code as string) as ship_postal_code
        , cast(ship_country as string) as ship_country
    from raw_orders
)

select *
from stg_orders_northwind;


[0m16:11:16.228863 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_exercise.stg_suppliers_northwind"
[0m16:11:16.232718 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_exercise.stg_products_northwind"
[0m16:11:16.234213 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:11:16.235091 [debug] [Thread-3 (]: On model.dbt_exercise.stg_shippers_northwind: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "model.dbt_exercise.stg_shippers_northwind"} */


  create or replace view `corded-sunlight-464012-e2`.`dbt_dw_staging`.`stg_shippers_northwind`
  OPTIONS()
  as with raw_shippers as (
    select *
    from `corded-sunlight-464012-e2`.`dbt_dw_raw`.`shippers`
)

, stg_shippers_northwind as (
    select
        cast(shipper_id as string) as shipper_id
        , cast(company_name as string) as company_name
        , cast(phone as string) as phone
    from raw_shippers
)

select *
from stg_shippers_northwind;


[0m16:11:16.237058 [debug] [Thread-2 (]: On model.dbt_exercise.stg_suppliers_northwind: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "model.dbt_exercise.stg_suppliers_northwind"} */


  create or replace view `corded-sunlight-464012-e2`.`dbt_dw_staging`.`stg_suppliers_northwind`
  OPTIONS()
  as with suppliers as (
    select *
    from `corded-sunlight-464012-e2`.`dbt_dw_raw`.`suppliers`
)

select 
    cast(supplier_id as string) as supplier_id
    , cast(company_name as string) as company_name
    , cast(contact_name as string) as contact_name
    , cast(contact_title as string) as contact_title
    , cast(address as string) as address
    , cast(city as string) as city
    , cast(region as string) as region
    , cast(postal_code as string) as postal_code
    , cast(country as string) as country
    , cast(phone as string) as phone
    , cast(fax as string) as fax
    , cast(homepage as string) as home_page
from suppliers;


[0m16:11:16.238177 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:11:16.239415 [debug] [Thread-1 (]: On model.dbt_exercise.stg_products_northwind: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "model.dbt_exercise.stg_products_northwind"} */


  create or replace view `corded-sunlight-464012-e2`.`dbt_dw_staging`.`stg_products_northwind`
  OPTIONS()
  as with raw_products as (
    select *
    from `corded-sunlight-464012-e2`.`dbt_dw_raw`.`products`
)

, stg_products_northwind as (
    select
        cast(product_id as string) as product_id
        , cast(product_name as string) as product_name
        , cast(supplier_id as string) as supplier_id
        , cast(category_id as string) as category_id
        , cast(quantity_per_unit as string) as quantity_per_unit
        , cast(unit_price as numeric) as unit_price
        , cast(units_in_stock as numeric) as units_in_stock
        , cast(units_on_order as numeric) as units_on_order
        , cast(reorder_level as numeric) as reorder_level
        , cast(discontinued as integer) as discontinued
    from raw_products
)

select *
from stg_products_northwind;


[0m16:11:16.240056 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:11:16.241229 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:11:17.317089 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:79b50430-0e33-41ff-977e-a5f155bce54c&page=queryresults
[0m16:11:17.334220 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:32d8d0ce-189b-4def-89cf-06237c093669&page=queryresults
[0m16:11:17.367864 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:a4dfc098-9978-4d86-979a-687df09950aa&page=queryresults
[0m16:11:17.371349 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:2b98a456-14ed-4946-a6de-73b8b99c424c&page=queryresults
[0m16:11:17.877691 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3f7e4363-bc80-4cda-9f6d-1e26cabe7e2b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f071c0e8aa0>]}
[0m16:11:17.879080 [info ] [Thread-1 (]: 7 of 15 OK created sql view model dbt_dw_staging.stg_products_northwind ........ [[32mCREATE VIEW (0 processed)[0m in 1.69s]
[0m16:11:17.880737 [debug] [Thread-1 (]: Finished running node model.dbt_exercise.stg_products_northwind
[0m16:11:17.883199 [debug] [Thread-1 (]: Began running node model.dbt_exercise.int_customers_northwind
[0m16:11:17.887486 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3f7e4363-bc80-4cda-9f6d-1e26cabe7e2b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f07075a6420>]}
[0m16:11:17.888285 [info ] [Thread-1 (]: 10 of 15 SKIP relation dbt_dw_intermediate.int_customers_northwind ............. [[33mSKIP[0m]
[0m16:11:17.889682 [info ] [Thread-3 (]: 8 of 15 OK created sql view model dbt_dw_staging.stg_shippers_northwind ........ [[32mCREATE VIEW (0 processed)[0m in 1.70s]
[0m16:11:17.890617 [debug] [Thread-1 (]: Finished running node model.dbt_exercise.int_customers_northwind
[0m16:11:17.891401 [debug] [Thread-3 (]: Finished running node model.dbt_exercise.stg_shippers_northwind
[0m16:11:17.901913 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3f7e4363-bc80-4cda-9f6d-1e26cabe7e2b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f071f9e9b50>]}
[0m16:11:17.902828 [info ] [Thread-4 (]: 6 of 15 OK created sql view model dbt_dw_staging.stg_orders_northwind .......... [[32mCREATE VIEW (0 processed)[0m in 1.72s]
[0m16:11:17.903549 [debug] [Thread-4 (]: Finished running node model.dbt_exercise.stg_orders_northwind
[0m16:11:17.904613 [debug] [Thread-1 (]: Began running node model.dbt_exercise.int_employees_northwind
[0m16:11:17.905396 [debug] [Thread-3 (]: Began running node model.dbt_exercise.int_orders_northwind
[0m16:11:17.906333 [info ] [Thread-1 (]: 11 of 15 START sql view model dbt_dw_intermediate.int_employees_northwind ...... [RUN]
[0m16:11:17.907377 [debug] [Thread-4 (]: Began running node model.dbt_exercise.int_shippers_northwind
[0m16:11:17.908309 [info ] [Thread-3 (]: 12 of 15 START sql view model dbt_dw_intermediate.int_orders_northwind ......... [RUN]
[0m16:11:17.909514 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_exercise.stg_products_northwind, now model.dbt_exercise.int_employees_northwind)
[0m16:11:17.910850 [info ] [Thread-4 (]: 13 of 15 START sql view model dbt_dw_intermediate.int_shippers_northwind ....... [RUN]
[0m16:11:17.913018 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_exercise.stg_shippers_northwind, now model.dbt_exercise.int_orders_northwind)
[0m16:11:17.914750 [debug] [Thread-1 (]: Began compiling node model.dbt_exercise.int_employees_northwind
[0m16:11:17.915835 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.dbt_exercise.stg_orders_northwind, now model.dbt_exercise.int_shippers_northwind)
[0m16:11:17.917047 [debug] [Thread-3 (]: Began compiling node model.dbt_exercise.int_orders_northwind
[0m16:11:17.922188 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_exercise.int_employees_northwind"
[0m16:11:17.922956 [debug] [Thread-4 (]: Began compiling node model.dbt_exercise.int_shippers_northwind
[0m16:11:17.927318 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_exercise.int_orders_northwind"
[0m16:11:17.934087 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_exercise.int_shippers_northwind"
[0m16:11:17.937423 [debug] [Thread-1 (]: Began executing node model.dbt_exercise.int_employees_northwind
[0m16:11:17.943601 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_exercise.int_employees_northwind"
[0m16:11:17.945322 [debug] [Thread-3 (]: Began executing node model.dbt_exercise.int_orders_northwind
[0m16:11:17.949731 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_exercise.int_orders_northwind"
[0m16:11:17.951528 [debug] [Thread-4 (]: Began executing node model.dbt_exercise.int_shippers_northwind
[0m16:11:17.952676 [debug] [Thread-1 (]: On model.dbt_exercise.int_employees_northwind: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "model.dbt_exercise.int_employees_northwind"} */


  create or replace view `corded-sunlight-464012-e2`.`dbt_dw_intermediate`.`int_employees_northwind`
  OPTIONS()
  as with employees as (
    select *
    from `corded-sunlight-464012-e2`.`dbt_dw_staging`.`stg_employees_northwind`
)

, max_fact_date as (
    select 
        case 
            when max(order_date) >= max(shipped_date) then max(order_date)
            else max(shipped_date)
        end as max_date
    from `corded-sunlight-464012-e2`.`dbt_dw_staging`.`stg_orders_northwind`
)

, final_table as (
    select
        employee_id
        , concat(first_name, ' ', last_name) as employee_name
        , title
        , birth_date
        , date_diff((select * from max_fact_date), birth_date, year) as age
        , hire_date
        , date_diff((select * from max_fact_date), hire_date, year) as years_hired
        , address
        , city
        , region
        , country
    from employees
)

select *
from final_table;


[0m16:11:17.957531 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3f7e4363-bc80-4cda-9f6d-1e26cabe7e2b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f07075c49e0>]}
[0m16:11:17.960237 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_exercise.int_shippers_northwind"
[0m16:11:17.961453 [debug] [Thread-3 (]: On model.dbt_exercise.int_orders_northwind: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "model.dbt_exercise.int_orders_northwind"} */


  create or replace view `corded-sunlight-464012-e2`.`dbt_dw_intermediate`.`int_orders_northwind`
  OPTIONS()
  as with stg_orders_northwind as (
    select *
    from `corded-sunlight-464012-e2`.`dbt_dw_staging`.`stg_orders_northwind`
)

, stg_order_details_northwind as (
    select *
    from `corded-sunlight-464012-e2`.`dbt_dw_staging`.`stg_order_details_northwind`
)

, stg_shippers_northwind as (
    select *
    from `corded-sunlight-464012-e2`.`dbt_dw_staging`.`stg_shippers_northwind`
)

, transformed_table as (    
    select
        stg_stg_orders_northwind_northwind.order_id 
        , stg_stg_orders_northwind_northwind.customer_id
        , stg_stg_orders_northwind_northwind.employee_id
        , stg_stg_orders_northwind_northwind.order_date
        , stg_orders_northwind.required_date
        , stg_orders_northwind.shipped_date
        , date_diff(stg_orders_northwind.shipped_date, stg_orders_northwind.order_date, day) as days_to_ship
        , concat(
            coalesce(stg_orders_northwind.ship_via, '')
            , '-'
            , coalesce(stg_shippers_northwind.company_name, '')
            , '-'
            , coalesce(stg_orders_northwind.ship_address, '')
        ) as ship_id
        , stg_orders_northwind.ship_via      
        , stg_shippers_northwind.company_name as shipper_name
        , sum(stg_order_details_northwind.unit_price * stg_order_details_northwind.quantity * (1 - stg_order_details_northwind.discount)) as total_order_amount
        , stg_orders_northwind.freight
        , stg_orders_northwind.ship_name
        , stg_orders_northwind.ship_address
        , stg_orders_northwind.ship_city
        , stg_orders_northwind.ship_region
        , stg_orders_northwind.ship_country
        , case
            when stg_orders_northwind.ship_country in ('USA', 'Canada', 'Mexico') then 'North America'
            when stg_orders_northwind.ship_country in ('UK', 'France', 'Germany', 'Austria', 'Belgium', 
            'Denmark', 'Ireland', 'Finland', 'Italy', 'Norway', 'Poland', 'Portugal', 'Spain', 'Sweden', 'Switzerland') then 'Europe'
            when stg_orders_northwind.ship_country in ('Brazil', 'Argentina', 'Venezuela') then 'South America'
            else 'Other'
        end as ship_continent
    from stg_orders_northwind
    left join stg_order_details_northwind
        on stg_orders_northwind.order_id = stg_order_details_northwind.order_id
    left join stg_shippers_northwind
        on stg_orders_northwind.ship_via = stg_shippers_northwind.shipper_id
    group by 
        stg_orders_northwind.order_id
        , stg_orders_northwind.customer_id
        , stg_orders_northwind.employee_id
        , stg_orders_northwind.order_date
        , stg_orders_northwind.required_date
        , stg_orders_northwind.shipped_date
        , stg_orders_northwind.ship_via
        , stg_shippers_northwind.company_name
        , stg_orders_northwind.freight
        , stg_orders_northwind.ship_name
        , stg_orders_northwind.ship_address
        , stg_orders_northwind.ship_city
        , stg_orders_northwind.ship_region
        , stg_orders_northwind.ship_country
)

, final_table as (
    select
        transformed_table.order_id
        , transformed_table.customer_id
        , transformed_table.employee_id
        , transformed_table.order_date
        , transformed_table.required_date
        , transformed_table.shipped_date
        , transformed_table.days_to_ship
        , transformed_table.ship_id
        , transformed_table.ship_via
        , transformed_table.shipper_name
        , transformed_table.total_order_amount
        , transformed_table.freight
        , transformed_table.ship_name
        , transformed_table.ship_address
        , transformed_table.ship_city
        , transformed_table.ship_region
        , transformed_table.ship_country
        , transformed_table.ship_continent
        , case 
            when transformed_table.days_to_ship is null then False
            else True
          end as is_shipped
    from transformed_table
)

select *
from final_table;


[0m16:11:17.963553 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:11:17.965117 [info ] [Thread-2 (]: 9 of 15 OK created sql view model dbt_dw_staging.stg_suppliers_northwind ....... [[32mCREATE VIEW (0 processed)[0m in 1.77s]
[0m16:11:17.966321 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:11:17.967519 [debug] [Thread-2 (]: Finished running node model.dbt_exercise.stg_suppliers_northwind
[0m16:11:17.968289 [debug] [Thread-4 (]: On model.dbt_exercise.int_shippers_northwind: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "model.dbt_exercise.int_shippers_northwind"} */


  create or replace view `corded-sunlight-464012-e2`.`dbt_dw_intermediate`.`int_shippers_northwind`
  OPTIONS()
  as with stg_shippers_northwind as (
    select *
    from `corded-sunlight-464012-e2`.`dbt_dw_staging`.`stg_shippers_northwind`
)

, stg_orders_northwind as (
    select *
    from `corded-sunlight-464012-e2`.`dbt_dw_staging`.`stg_orders_northwind`
)

, transformed_table as (
    select
        concat(
            coalesce(stg_shippers_northwind.shipper_id, '')
            , '-'
            , coalesce(stg_shippers_northwind.company_name, '')
            , '-'
            , coalesce(stg_orders_northwind.ship_address, '')
        ) as ship_id
        , stg_shippers_northwind.shipper_id
        , stg_shippers_northwind.company_name
        , stg_orders_northwind.ship_address
        , stg_orders_northwind.ship_city
        , stg_orders_northwind.ship_region
        , stg_orders_northwind.ship_country
    from stg_shippers_northwind
    left join stg_orders_northwind
        on stg_shippers_northwind.shipper_id = stg_orders_northwind.ship_via
)

/* Aqui é feita a deduplicação da transformed_table */
, dedup_table as (
    select distinct *
    from transformed_table
)

, final_table as (
    select 
        *
        , case
            when dedup_table.ship_country in ('USA', 'Canada', 'Mexico') then 'North America'
            when dedup_table.ship_country in ('UK', 'France', 'Germany', 'Austria', 'Belgium', 
            'Denmark', 'Ireland', 'Finland', 'Italy', 'Norway', 'Poland', 'Portugal', 'Spain', 'Sweden', 'Switzerland') then 'Europe'
            when dedup_table.ship_country in ('Brazil', 'Argentina', 'Venezuela') then 'South America'
            else 'Other'
        end as ship_continent
    from dedup_table
)

select *
from final_table;


[0m16:11:17.970139 [debug] [Thread-2 (]: Began running node model.dbt_exercise.int_products_northwind
[0m16:11:17.970695 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:11:17.971904 [info ] [Thread-2 (]: 14 of 15 START sql view model dbt_dw_intermediate.int_products_northwind ....... [RUN]
[0m16:11:17.999645 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_exercise.stg_suppliers_northwind, now model.dbt_exercise.int_products_northwind)
[0m16:11:18.024809 [debug] [Thread-2 (]: Began compiling node model.dbt_exercise.int_products_northwind
[0m16:11:18.030366 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_exercise.int_products_northwind"
[0m16:11:18.031649 [debug] [Thread-2 (]: Began executing node model.dbt_exercise.int_products_northwind
[0m16:11:18.036428 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_exercise.int_products_northwind"
[0m16:11:18.061961 [debug] [Thread-2 (]: On model.dbt_exercise.int_products_northwind: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "model.dbt_exercise.int_products_northwind"} */


  create or replace view `corded-sunlight-464012-e2`.`dbt_dw_intermediate`.`int_products_northwind`
  OPTIONS()
  as with stg_products_northwind as (
    select *
    from `corded-sunlight-464012-e2`.`dbt_dw_staging`.`stg_products_northwind`
)

, stg_categories_northwind as (
    select *
    from `corded-sunlight-464012-e2`.`dbt_dw_staging`.`stg_categories_northwind`
)

, stg_suppliers_northwind as (
    select *
    from `corded-sunlight-464012-e2`.`dbt_dw_staging`.`stg_suppliers_northwind`
)

, final_table as (
    select
        stg_products_northwind.product_id
        , stg_products_northwind.product_name
        , stg_products_northwind.quantity_per_unit
        , stg_categories_northwind.category_name
        , stg_suppliers_northwind.company_name as supplier_name
        , stg_suppliers_northwind.city as supplier_city
        , stg_suppliers_northwind.region as supplier_region
        , stg_suppliers_northwind.country as supplier_country
        , case
            when stg_suppliers_northwind.country in ('USA', 'Canada') then 'North America'
            when stg_suppliers_northwind.country in ('Brazil') then 'South America'
            when stg_suppliers_northwind.country in ('UK', 'Germany', 'Netherlands', 'Spain', 'France', 'Norway', 'Italy', 'Denmark', 'Sweden', 'Finland') then 'Europe'
            when stg_suppliers_northwind.country in ('Singapore', 'Japan') then 'Asia'
            when stg_suppliers_northwind.country in ('Australia') then 'Oceania'
            else 'Other'
          end as supplier_continent
        , stg_products_northwind.discontinued
    from stg_products_northwind
    left join stg_categories_northwind
        on stg_products_northwind.category_id = stg_categories_northwind.category_id
    left join stg_suppliers_northwind
        on stg_products_northwind.supplier_id = stg_suppliers_northwind.supplier_id
)

desc table final_table
;


[0m16:11:18.062761 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:11:18.914836 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:c045bec2-5f64-4faf-94cc-13a18067d8a4&page=queryresults
[0m16:11:18.915666 [error] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:c045bec2-5f64-4faf-94cc-13a18067d8a4&page=queryresults
[0m16:11:18.950338 [debug] [Thread-2 (]: Database Error in model int_products_northwind (models/intermediate/int_products_northwind.sql)
  Syntax error: Unexpected keyword DESC at [47:1]
  compiled code at target/run/dbt_exercise/models/intermediate/int_products_northwind.sql
[0m16:11:18.951029 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3f7e4363-bc80-4cda-9f6d-1e26cabe7e2b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f07075c6480>]}
[0m16:11:18.951701 [error] [Thread-2 (]: 14 of 15 ERROR creating sql view model dbt_dw_intermediate.int_products_northwind  [[31mERROR[0m in 0.95s]
[0m16:11:18.952293 [debug] [Thread-2 (]: Finished running node model.dbt_exercise.int_products_northwind
[0m16:11:18.952966 [debug] [Thread-7 (]: Marking all children of 'model.dbt_exercise.int_products_northwind' to be skipped because of status 'error'.  Reason: Database Error in model int_products_northwind (models/intermediate/int_products_northwind.sql)
  Syntax error: Unexpected keyword DESC at [47:1]
  compiled code at target/run/dbt_exercise/models/intermediate/int_products_northwind.sql.
[0m16:11:18.954096 [debug] [Thread-2 (]: Began running node model.dbt_exercise.dim_products
[0m16:11:18.954644 [info ] [Thread-2 (]: 15 of 15 SKIP relation dbt_dw_marts.dim_products ............................... [[33mSKIP[0m]
[0m16:11:18.955257 [debug] [Thread-2 (]: Finished running node model.dbt_exercise.dim_products
[0m16:11:19.040534 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:86b2273a-0d15-41c6-866a-b7856c77d1de&page=queryresults
[0m16:11:19.190963 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:4d771909-5cc6-4ad1-b49b-a9f0cee9732d&page=queryresults
[0m16:11:19.443955 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:86b2273a-0d15-41c6-866a-b7856c77d1de&page=queryresults
[0m16:11:19.482941 [debug] [Thread-1 (]: Database Error in model int_employees_northwind (models/intermediate/int_employees_northwind.sql)
  DATE_DIFF does not support the YEAR date part when the argument is TIMESTAMP type at [26:11]
  compiled code at target/run/dbt_exercise/models/intermediate/int_employees_northwind.sql
[0m16:11:19.483587 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3f7e4363-bc80-4cda-9f6d-1e26cabe7e2b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f071c0eade0>]}
[0m16:11:19.484166 [error] [Thread-1 (]: 11 of 15 ERROR creating sql view model dbt_dw_intermediate.int_employees_northwind  [[31mERROR[0m in 1.57s]
[0m16:11:19.484716 [debug] [Thread-1 (]: Finished running node model.dbt_exercise.int_employees_northwind
[0m16:11:19.485449 [debug] [Thread-7 (]: Marking all children of 'model.dbt_exercise.int_employees_northwind' to be skipped because of status 'error'.  Reason: Database Error in model int_employees_northwind (models/intermediate/int_employees_northwind.sql)
  DATE_DIFF does not support the YEAR date part when the argument is TIMESTAMP type at [26:11]
  compiled code at target/run/dbt_exercise/models/intermediate/int_employees_northwind.sql.
[0m16:11:19.796011 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3f7e4363-bc80-4cda-9f6d-1e26cabe7e2b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0707400710>]}
[0m16:11:19.796752 [info ] [Thread-4 (]: 13 of 15 OK created sql view model dbt_dw_intermediate.int_shippers_northwind .. [[32mCREATE VIEW (0 processed)[0m in 1.88s]
[0m16:11:19.797312 [debug] [Thread-4 (]: Finished running node model.dbt_exercise.int_shippers_northwind
[0m16:12:19.303514 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:c21fdeac-17ae-499b-888b-3f77d4bac1a1&page=queryresults
[0m16:12:19.597545 [error] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:c21fdeac-17ae-499b-888b-3f77d4bac1a1&page=queryresults
[0m16:12:19.631747 [debug] [Thread-3 (]: Database Error in model int_orders_northwind (models/intermediate/int_orders_northwind.sql)
  Unrecognized name: stg_stg_orders_northwind_northwind at [23:9]
  compiled code at target/run/dbt_exercise/models/intermediate/int_orders_northwind.sql
[0m16:12:19.632657 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3f7e4363-bc80-4cda-9f6d-1e26cabe7e2b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f07077c6a20>]}
[0m16:12:19.634145 [error] [Thread-3 (]: 12 of 15 ERROR creating sql view model dbt_dw_intermediate.int_orders_northwind  [[31mERROR[0m in 61.72s]
[0m16:12:19.635390 [debug] [Thread-3 (]: Finished running node model.dbt_exercise.int_orders_northwind
[0m16:12:19.636833 [debug] [Thread-7 (]: Marking all children of 'model.dbt_exercise.int_orders_northwind' to be skipped because of status 'error'.  Reason: Database Error in model int_orders_northwind (models/intermediate/int_orders_northwind.sql)
  Unrecognized name: stg_stg_orders_northwind_northwind at [23:9]
  compiled code at target/run/dbt_exercise/models/intermediate/int_orders_northwind.sql.
[0m16:12:19.641629 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:12:19.648813 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:12:19.649284 [debug] [MainThread]: Connection 'model.dbt_exercise.int_orders_northwind' was properly closed.
[0m16:12:19.649597 [debug] [MainThread]: Connection 'model.dbt_exercise.int_employees_northwind' was properly closed.
[0m16:12:19.650335 [debug] [MainThread]: Connection 'model.dbt_exercise.int_shippers_northwind' was properly closed.
[0m16:12:19.650979 [debug] [MainThread]: Connection 'model.dbt_exercise.int_products_northwind' was properly closed.
[0m16:12:19.651804 [info ] [MainThread]: 
[0m16:12:19.652476 [info ] [MainThread]: Finished running 1 table model, 14 view models in 0 hours 1 minutes and 11.86 seconds (71.86s).
[0m16:12:19.655892 [debug] [MainThread]: Command end result
[0m16:12:19.708666 [debug] [MainThread]: Wrote artifact WritableManifest to /home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/target/manifest.json
[0m16:12:19.723688 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/target/semantic_manifest.json
[0m16:12:19.732102 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/target/run_results.json
[0m16:12:19.732759 [info ] [MainThread]: 
[0m16:12:19.733169 [info ] [MainThread]: [31mCompleted with 4 errors, 0 partial successes, and 0 warnings:[0m
[0m16:12:19.733713 [info ] [MainThread]: 
[0m16:12:19.734568 [error] [MainThread]: [31mFailure in model stg_customers_northwind (models/staging/stg_customers_northwind.sql)[0m
[0m16:12:19.735200 [error] [MainThread]:   Database Error in model stg_customers_northwind (models/staging/stg_customers_northwind.sql)
  Table "raw_customerscustomers" must be qualified with a dataset (e.g. dataset.table).
  compiled code at target/run/dbt_exercise/models/staging/stg_customers_northwind.sql
[0m16:12:19.735656 [info ] [MainThread]: 
[0m16:12:19.736136 [info ] [MainThread]:   compiled code at target/compiled/dbt_exercise/models/staging/stg_customers_northwind.sql
[0m16:12:19.736614 [info ] [MainThread]: 
[0m16:12:19.737115 [error] [MainThread]: [31mFailure in model int_products_northwind (models/intermediate/int_products_northwind.sql)[0m
[0m16:12:19.737563 [error] [MainThread]:   Database Error in model int_products_northwind (models/intermediate/int_products_northwind.sql)
  Syntax error: Unexpected keyword DESC at [47:1]
  compiled code at target/run/dbt_exercise/models/intermediate/int_products_northwind.sql
[0m16:12:19.738021 [info ] [MainThread]: 
[0m16:12:19.738507 [info ] [MainThread]:   compiled code at target/compiled/dbt_exercise/models/intermediate/int_products_northwind.sql
[0m16:12:19.738999 [info ] [MainThread]: 
[0m16:12:19.739461 [error] [MainThread]: [31mFailure in model int_employees_northwind (models/intermediate/int_employees_northwind.sql)[0m
[0m16:12:19.740029 [error] [MainThread]:   Database Error in model int_employees_northwind (models/intermediate/int_employees_northwind.sql)
  DATE_DIFF does not support the YEAR date part when the argument is TIMESTAMP type at [26:11]
  compiled code at target/run/dbt_exercise/models/intermediate/int_employees_northwind.sql
[0m16:12:19.740537 [info ] [MainThread]: 
[0m16:12:19.741155 [info ] [MainThread]:   compiled code at target/compiled/dbt_exercise/models/intermediate/int_employees_northwind.sql
[0m16:12:19.741930 [info ] [MainThread]: 
[0m16:12:19.742556 [error] [MainThread]: [31mFailure in model int_orders_northwind (models/intermediate/int_orders_northwind.sql)[0m
[0m16:12:19.743210 [error] [MainThread]:   Database Error in model int_orders_northwind (models/intermediate/int_orders_northwind.sql)
  Unrecognized name: stg_stg_orders_northwind_northwind at [23:9]
  compiled code at target/run/dbt_exercise/models/intermediate/int_orders_northwind.sql
[0m16:12:19.743807 [info ] [MainThread]: 
[0m16:12:19.744387 [info ] [MainThread]:   compiled code at target/compiled/dbt_exercise/models/intermediate/int_orders_northwind.sql
[0m16:12:19.744897 [info ] [MainThread]: 
[0m16:12:19.745359 [info ] [MainThread]: Done. PASS=9 WARN=0 ERROR=4 SKIP=2 NO-OP=0 TOTAL=15
[0m16:12:19.746318 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- DuplicateYAMLKeysDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m16:12:19.754899 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 167.641, "process_in_blocks": "145216", "process_kernel_time": 12.663838, "process_mem_max_rss": "368020", "process_out_blocks": "3880", "process_user_time": 11.853138}
[0m16:12:19.755910 [debug] [MainThread]: Command `dbt run` failed at 16:12:19.755782 after 167.64 seconds
[0m16:12:19.756286 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f075cd2fc50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f075c8d4620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f071f8d7ce0>]}
[0m16:12:19.756648 [debug] [MainThread]: Flushing usage events
[0m16:12:20.180171 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:13:50.358246 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73aaf087cec0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73aaefcdaea0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73aaef907290>]}


============================== 16:13:50.376455 | 6eff5d96-4763-47b3-92bf-c68e4792e4ec ==============================
[0m16:13:50.376455 [info ] [MainThread]: Running with dbt=1.10.2
[0m16:13:50.377018 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m16:14:36.926717 [warn ] [MainThread]: [[33mWARNING[0m][DuplicateYAMLKeysDeprecation]: Deprecated functionality
Duplicate key 'version' in "<unicode string>", line 4, column 1 in file
`/home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/dbt_project.yml`
[0m16:14:36.927629 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '6eff5d96-4763-47b3-92bf-c68e4792e4ec', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73aab28fedb0>]}
[0m16:14:37.629008 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6eff5d96-4763-47b3-92bf-c68e4792e4ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73aaf087d4f0>]}
[0m16:14:37.690648 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6eff5d96-4763-47b3-92bf-c68e4792e4ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73aaf09bb4d0>]}
[0m16:14:37.694377 [info ] [MainThread]: Registered adapter: bigquery=1.9.2
[0m16:15:24.754114 [debug] [MainThread]: checksum: 1adc40777973ef30f45f80b3b6d04d5013c1edd53d96363881b3b199e612468b, vars: {}, profile: , target: , version: 1.10.2
[0m16:15:29.532169 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:15:29.532659 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:15:29.581617 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6eff5d96-4763-47b3-92bf-c68e4792e4ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73aab27d7620>]}
[0m16:15:29.879290 [debug] [MainThread]: Wrote artifact WritableManifest to /home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/target/manifest.json
[0m16:15:29.894167 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/target/semantic_manifest.json
[0m16:15:30.295461 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6eff5d96-4763-47b3-92bf-c68e4792e4ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73aab2889640>]}
[0m16:15:30.296062 [info ] [MainThread]: Found 14 seeds, 36 data tests, 16 models, 14 sources, 609 macros
[0m16:15:30.296504 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6eff5d96-4763-47b3-92bf-c68e4792e4ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73aab285eae0>]}
[0m16:15:30.299124 [info ] [MainThread]: 
[0m16:15:30.299654 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:15:30.299990 [info ] [MainThread]: 
[0m16:15:30.300589 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m16:15:30.305318 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_corded-sunlight-464012-e2'
[0m16:15:30.306609 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:15:30.307989 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_corded-sunlight-464012-e2'
[0m16:15:30.309573 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_corded-sunlight-464012-e2'
[0m16:15:30.310226 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:15:30.311145 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:15:31.540877 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_corded-sunlight-464012-e2, now list_corded-sunlight-464012-e2_dbt_dw_marts)
[0m16:15:31.542352 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_corded-sunlight-464012-e2, now list_corded-sunlight-464012-e2_dbt_dw_raw)
[0m16:15:31.543014 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:15:31.543658 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_corded-sunlight-464012-e2, now list_corded-sunlight-464012-e2_dbt_dw_intermediate)
[0m16:15:31.544582 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:15:31.545498 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_corded-sunlight-464012-e2_dbt_dw_staging'
[0m16:15:31.546494 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:15:31.547511 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:15:32.442161 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6eff5d96-4763-47b3-92bf-c68e4792e4ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73aaf0272120>]}
[0m16:15:32.442879 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:15:32.458404 [debug] [Thread-1 (]: Began running node model.dbt_exercise.stg_categories_northwind
[0m16:15:32.459094 [debug] [Thread-2 (]: Began running node model.dbt_exercise.stg_customers_northwind
[0m16:15:32.460515 [debug] [Thread-3 (]: Began running node model.dbt_exercise.stg_employee_territories
[0m16:15:32.461666 [debug] [Thread-4 (]: Began running node model.dbt_exercise.stg_employees_northwind
[0m16:15:32.459807 [info ] [Thread-1 (]: 1 of 15 START sql view model dbt_dw_staging.stg_categories_northwind ........... [RUN]
[0m16:15:32.462926 [info ] [Thread-2 (]: 2 of 15 START sql view model dbt_dw_staging.stg_customers_northwind ............ [RUN]
[0m16:15:32.464418 [info ] [Thread-3 (]: 3 of 15 START sql view model dbt_dw_staging.stg_employee_territories ........... [RUN]
[0m16:15:32.465469 [info ] [Thread-4 (]: 4 of 15 START sql view model dbt_dw_staging.stg_employees_northwind ............ [RUN]
[0m16:15:32.466513 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_corded-sunlight-464012-e2_dbt_dw_marts, now model.dbt_exercise.stg_categories_northwind)
[0m16:15:32.467370 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_corded-sunlight-464012-e2_dbt_dw_staging, now model.dbt_exercise.stg_customers_northwind)
[0m16:15:32.468470 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_corded-sunlight-464012-e2_dbt_dw_raw, now model.dbt_exercise.stg_employee_territories)
[0m16:15:32.469484 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly list_corded-sunlight-464012-e2_dbt_dw_intermediate, now model.dbt_exercise.stg_employees_northwind)
[0m16:15:32.470155 [debug] [Thread-1 (]: Began compiling node model.dbt_exercise.stg_categories_northwind
[0m16:15:32.470615 [debug] [Thread-2 (]: Began compiling node model.dbt_exercise.stg_customers_northwind
[0m16:15:32.471163 [debug] [Thread-3 (]: Began compiling node model.dbt_exercise.stg_employee_territories
[0m16:15:32.471723 [debug] [Thread-4 (]: Began compiling node model.dbt_exercise.stg_employees_northwind
[0m16:15:32.481485 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_exercise.stg_categories_northwind"
[0m16:15:32.485196 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_exercise.stg_customers_northwind"
[0m16:15:32.490121 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_exercise.stg_employee_territories"
[0m16:15:32.495794 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_exercise.stg_employees_northwind"
[0m16:15:32.498722 [debug] [Thread-1 (]: Began executing node model.dbt_exercise.stg_categories_northwind
[0m16:15:32.499473 [debug] [Thread-2 (]: Began executing node model.dbt_exercise.stg_customers_northwind
[0m16:15:32.505778 [debug] [Thread-3 (]: Began executing node model.dbt_exercise.stg_employee_territories
[0m16:15:32.506542 [debug] [Thread-4 (]: Began executing node model.dbt_exercise.stg_employees_northwind
[0m16:15:32.616103 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_exercise.stg_categories_northwind"
[0m16:15:32.617044 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_exercise.stg_customers_northwind"
[0m16:15:32.619951 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_exercise.stg_employee_territories"
[0m16:15:32.624062 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_exercise.stg_employees_northwind"
[0m16:15:32.633045 [debug] [Thread-1 (]: On model.dbt_exercise.stg_categories_northwind: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "model.dbt_exercise.stg_categories_northwind"} */


  create or replace view `corded-sunlight-464012-e2`.`dbt_dw_staging`.`stg_categories_northwind`
  OPTIONS()
  as with raw_categories as (
    select *
    from `corded-sunlight-464012-e2`.`dbt_dw_raw`.`categories`
)

/* Ao construir a staging não vamos trazer a coluna picture, pois ela não traz informação relevante */
, stg_categories_northwind as (
    select
        cast(category_id as string) as category_id
        , cast(category_name as string) as category_name
        , cast(description as string) as description
    from raw_categories
)

select *
from raw_categories;


[0m16:15:32.636553 [debug] [Thread-2 (]: On model.dbt_exercise.stg_customers_northwind: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "model.dbt_exercise.stg_customers_northwind"} */


  create or replace view `corded-sunlight-464012-e2`.`dbt_dw_staging`.`stg_customers_northwind`
  OPTIONS()
  as with raw_customers as (
    select *
    from `corded-sunlight-464012-e2`.`dbt_dw_raw`.`customers`
)

, stg_customers_northwind as (
    select
        cast(customer_id as string) as customer_id
        , cast(company_name as string) as company_name
        , cast(contact_name as string) as contact_name
        , cast(contact_title as string) as contact_title
        , cast(address as string) as address
        , cast(city as string) as city
        , cast(region as string) as region
        , cast(postal_code as string) as postal_code
        , cast(country as string) as country
        , cast(phone as string) as phone
        , cast(fax as string) as fax
    from raw_customers
)

select *
from stg_customers_northwind;


[0m16:15:32.640910 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:15:32.643417 [debug] [Thread-4 (]: On model.dbt_exercise.stg_employees_northwind: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "model.dbt_exercise.stg_employees_northwind"} */


  create or replace view `corded-sunlight-464012-e2`.`dbt_dw_staging`.`stg_employees_northwind`
  OPTIONS()
  as with raw_employees as (
    select *
    from `corded-sunlight-464012-e2`.`dbt_dw_raw`.`employees`
)

/* Os campos photo, notes e reports_to e photo_path não são carregadas na staging */

, stg_employees_northwind as (
    select
        cast(employee_id as string) as employee_id
        , cast(first_name as string) as first_name
        , cast(last_name as string) as last_name
        , cast(title as string) as title
        , cast(title_of_courtesy as string) as title_of_courtesy
        , cast(birth_date as date) as birth_date
        , cast(hire_date as date) as hire_date
        , cast(address as string) as address
        , cast(city as string) as city
        , cast(region as string) as region
        , cast(postal_code as string) as postal_code
        , cast(country as string) as country
        , cast(home_phone as string) as home_phone
        , cast(extension as string) as extension
    from raw_employees
)

select *
from stg_employees_northwind;


[0m16:15:32.645667 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:15:32.646710 [debug] [Thread-3 (]: On model.dbt_exercise.stg_employee_territories: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "model.dbt_exercise.stg_employee_territories"} */


  create or replace view `corded-sunlight-464012-e2`.`dbt_dw_staging`.`stg_employee_territories`
  OPTIONS()
  as with raw_employee_territories as (
    select *
    from `corded-sunlight-464012-e2`.`dbt_dw_raw`.`employee_territories`
)

, stg_employee_territories as (
    select
        cast(employee_id as string) as employee_id
        , cast(territory_id as string) as territory_id
    from raw_employee_territories
)

select *
from stg_employee_territories;


[0m16:15:32.648355 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:15:32.650138 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:15:33.775227 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:b5bb45c1-1a3e-4bb3-a8dd-b3535294551c&page=queryresults
[0m16:15:33.777828 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:9d49a3d8-aac1-4af5-b8a1-0fe06d47d3ef&page=queryresults
[0m16:15:33.805361 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:ea5a65af-58c0-45b6-8737-64bc6f8d58cc&page=queryresults
[0m16:15:38.645593 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6eff5d96-4763-47b3-92bf-c68e4792e4ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73aab73fe570>]}
[0m16:15:38.646349 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6eff5d96-4763-47b3-92bf-c68e4792e4ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73aaa25151f0>]}
[0m16:15:38.647404 [info ] [Thread-2 (]: 2 of 15 OK created sql view model dbt_dw_staging.stg_customers_northwind ....... [[32mCREATE VIEW (0 processed)[0m in 6.16s]
[0m16:15:38.648866 [info ] [Thread-3 (]: 3 of 15 OK created sql view model dbt_dw_staging.stg_employee_territories ...... [[32mCREATE VIEW (0 processed)[0m in 6.16s]
[0m16:15:38.649643 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6eff5d96-4763-47b3-92bf-c68e4792e4ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73aab22135f0>]}
[0m16:15:38.650618 [debug] [Thread-2 (]: Finished running node model.dbt_exercise.stg_customers_northwind
[0m16:15:38.651391 [debug] [Thread-3 (]: Finished running node model.dbt_exercise.stg_employee_territories
[0m16:15:38.652346 [info ] [Thread-4 (]: 4 of 15 OK created sql view model dbt_dw_staging.stg_employees_northwind ....... [[32mCREATE VIEW (0 processed)[0m in 6.16s]
[0m16:15:38.653330 [debug] [Thread-2 (]: Began running node model.dbt_exercise.stg_order_details_northwind
[0m16:15:38.654664 [debug] [Thread-3 (]: Began running node model.dbt_exercise.stg_orders_northwind
[0m16:15:38.655469 [debug] [Thread-4 (]: Finished running node model.dbt_exercise.stg_employees_northwind
[0m16:15:38.656496 [info ] [Thread-2 (]: 5 of 15 START sql view model dbt_dw_staging.stg_order_details_northwind ........ [RUN]
[0m16:15:38.657424 [info ] [Thread-3 (]: 6 of 15 START sql view model dbt_dw_staging.stg_orders_northwind ............... [RUN]
[0m16:15:38.658403 [debug] [Thread-4 (]: Began running node model.dbt_exercise.stg_products_northwind
[0m16:15:38.659544 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_exercise.stg_customers_northwind, now model.dbt_exercise.stg_order_details_northwind)
[0m16:15:38.660547 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_exercise.stg_employee_territories, now model.dbt_exercise.stg_orders_northwind)
[0m16:15:38.661756 [info ] [Thread-4 (]: 7 of 15 START sql view model dbt_dw_staging.stg_products_northwind ............. [RUN]
[0m16:15:38.663018 [debug] [Thread-2 (]: Began compiling node model.dbt_exercise.stg_order_details_northwind
[0m16:15:38.663780 [debug] [Thread-3 (]: Began compiling node model.dbt_exercise.stg_orders_northwind
[0m16:15:38.664699 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.dbt_exercise.stg_employees_northwind, now model.dbt_exercise.stg_products_northwind)
[0m16:15:38.669703 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_exercise.stg_order_details_northwind"
[0m16:15:38.673808 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_exercise.stg_orders_northwind"
[0m16:15:38.674818 [debug] [Thread-4 (]: Began compiling node model.dbt_exercise.stg_products_northwind
[0m16:15:38.681437 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_exercise.stg_products_northwind"
[0m16:15:38.682895 [debug] [Thread-3 (]: Began executing node model.dbt_exercise.stg_orders_northwind
[0m16:15:38.684125 [debug] [Thread-2 (]: Began executing node model.dbt_exercise.stg_order_details_northwind
[0m16:15:38.687022 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_exercise.stg_orders_northwind"
[0m16:15:38.687881 [debug] [Thread-4 (]: Began executing node model.dbt_exercise.stg_products_northwind
[0m16:15:38.691356 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_exercise.stg_order_details_northwind"
[0m16:15:38.698106 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_exercise.stg_products_northwind"
[0m16:15:38.699870 [debug] [Thread-3 (]: On model.dbt_exercise.stg_orders_northwind: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "model.dbt_exercise.stg_orders_northwind"} */


  create or replace view `corded-sunlight-464012-e2`.`dbt_dw_staging`.`stg_orders_northwind`
  OPTIONS()
  as with raw_orders as (
    select *
    from `corded-sunlight-464012-e2`.`dbt_dw_raw`.`orders`
)

, stg_orders_northwind as (
    select
        cast(order_id as string) as order_id
        , cast(customer_id as string) as customer_id
        , cast(employee_id as string) as employee_id
        , cast(order_date as timestamp) as order_date
        , cast(required_date as timestamp) as required_date
        , cast(shipped_date as timestamp) as shipped_date
        , cast(ship_via as string) as ship_via
        , cast(freight as numeric) as freight
        , cast(ship_name as string) as ship_name
        , cast(ship_address as string) as ship_address
        , cast(ship_city as string) as ship_city
        , cast(ship_region as string) as ship_region
        , cast(ship_postal_code as string) as ship_postal_code
        , cast(ship_country as string) as ship_country
    from raw_orders
)

select *
from stg_orders_northwind;


[0m16:15:38.700666 [debug] [Thread-4 (]: On model.dbt_exercise.stg_products_northwind: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "model.dbt_exercise.stg_products_northwind"} */


  create or replace view `corded-sunlight-464012-e2`.`dbt_dw_staging`.`stg_products_northwind`
  OPTIONS()
  as with raw_products as (
    select *
    from `corded-sunlight-464012-e2`.`dbt_dw_raw`.`products`
)

, stg_products_northwind as (
    select
        cast(product_id as string) as product_id
        , cast(product_name as string) as product_name
        , cast(supplier_id as string) as supplier_id
        , cast(category_id as string) as category_id
        , cast(quantity_per_unit as string) as quantity_per_unit
        , cast(unit_price as numeric) as unit_price
        , cast(units_in_stock as numeric) as units_in_stock
        , cast(units_on_order as numeric) as units_on_order
        , cast(reorder_level as numeric) as reorder_level
        , cast(discontinued as integer) as discontinued
    from raw_products
)

select *
from stg_products_northwind;


[0m16:15:38.701232 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:15:38.701807 [debug] [Thread-2 (]: On model.dbt_exercise.stg_order_details_northwind: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "model.dbt_exercise.stg_order_details_northwind"} */


  create or replace view `corded-sunlight-464012-e2`.`dbt_dw_staging`.`stg_order_details_northwind`
  OPTIONS()
  as with raw_order_details as (
    select *
    from `corded-sunlight-464012-e2`.`dbt_dw_raw`.`order_details`
)

, stg_order_details_northwind as (
    select
        cast(order_id as string) as order_id
        , cast(product_id as string) as product_id
        , cast(unit_price as numeric) as unit_price
        , cast(quantity as integer) as quantity
        , cast(discount as numeric) as discount
    from raw_order_details
)

select *
from stg_order_details_northwind;


[0m16:15:38.702399 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:15:38.704554 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:15:39.712791 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:d7475bd2-8786-45d5-a766-9f6851ab7bb9&page=queryresults
[0m16:15:39.755843 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:69dc13ce-2e11-4bc7-8cbe-02cb716ad4cd&page=queryresults
[0m16:15:39.873318 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:8a04b9f8-d77e-4416-a7f6-f61847932875&page=queryresults
[0m16:15:40.305288 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6eff5d96-4763-47b3-92bf-c68e4792e4ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73aaa2448cb0>]}
[0m16:15:40.306364 [info ] [Thread-4 (]: 7 of 15 OK created sql view model dbt_dw_staging.stg_products_northwind ........ [[32mCREATE VIEW (0 processed)[0m in 1.64s]
[0m16:15:40.307190 [debug] [Thread-4 (]: Finished running node model.dbt_exercise.stg_products_northwind
[0m16:15:40.307690 [debug] [Thread-4 (]: Began running node model.dbt_exercise.stg_shippers_northwind
[0m16:15:40.308899 [info ] [Thread-4 (]: 8 of 15 START sql view model dbt_dw_staging.stg_shippers_northwind ............. [RUN]
[0m16:15:40.310378 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.dbt_exercise.stg_products_northwind, now model.dbt_exercise.stg_shippers_northwind)
[0m16:15:40.311010 [debug] [Thread-4 (]: Began compiling node model.dbt_exercise.stg_shippers_northwind
[0m16:15:40.314263 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_exercise.stg_shippers_northwind"
[0m16:15:40.316331 [debug] [Thread-4 (]: Began executing node model.dbt_exercise.stg_shippers_northwind
[0m16:15:40.320299 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_exercise.stg_shippers_northwind"
[0m16:15:40.324961 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6eff5d96-4763-47b3-92bf-c68e4792e4ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73aaa2438320>]}
[0m16:15:40.325735 [debug] [Thread-4 (]: On model.dbt_exercise.stg_shippers_northwind: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "model.dbt_exercise.stg_shippers_northwind"} */


  create or replace view `corded-sunlight-464012-e2`.`dbt_dw_staging`.`stg_shippers_northwind`
  OPTIONS()
  as with raw_shippers as (
    select *
    from `corded-sunlight-464012-e2`.`dbt_dw_raw`.`shippers`
)

, stg_shippers_northwind as (
    select
        cast(shipper_id as string) as shipper_id
        , cast(company_name as string) as company_name
        , cast(phone as string) as phone
    from raw_shippers
)

select *
from stg_shippers_northwind;


[0m16:15:40.327389 [info ] [Thread-2 (]: 5 of 15 OK created sql view model dbt_dw_staging.stg_order_details_northwind ... [[32mCREATE VIEW (0 processed)[0m in 1.67s]
[0m16:15:40.328199 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:15:40.328956 [debug] [Thread-2 (]: Finished running node model.dbt_exercise.stg_order_details_northwind
[0m16:15:40.329960 [debug] [Thread-2 (]: Began running node model.dbt_exercise.stg_suppliers_northwind
[0m16:15:40.330691 [info ] [Thread-2 (]: 9 of 15 START sql view model dbt_dw_staging.stg_suppliers_northwind ............ [RUN]
[0m16:15:40.331276 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_exercise.stg_order_details_northwind, now model.dbt_exercise.stg_suppliers_northwind)
[0m16:15:40.331678 [debug] [Thread-2 (]: Began compiling node model.dbt_exercise.stg_suppliers_northwind
[0m16:15:40.334615 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_exercise.stg_suppliers_northwind"
[0m16:15:40.335941 [debug] [Thread-2 (]: Began executing node model.dbt_exercise.stg_suppliers_northwind
[0m16:15:40.341153 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_exercise.stg_suppliers_northwind"
[0m16:15:40.342055 [debug] [Thread-2 (]: On model.dbt_exercise.stg_suppliers_northwind: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "model.dbt_exercise.stg_suppliers_northwind"} */


  create or replace view `corded-sunlight-464012-e2`.`dbt_dw_staging`.`stg_suppliers_northwind`
  OPTIONS()
  as with suppliers as (
    select *
    from `corded-sunlight-464012-e2`.`dbt_dw_raw`.`suppliers`
)

select 
    cast(supplier_id as string) as supplier_id
    , cast(company_name as string) as company_name
    , cast(contact_name as string) as contact_name
    , cast(contact_title as string) as contact_title
    , cast(address as string) as address
    , cast(city as string) as city
    , cast(region as string) as region
    , cast(postal_code as string) as postal_code
    , cast(country as string) as country
    , cast(phone as string) as phone
    , cast(fax as string) as fax
    , cast(homepage as string) as home_page
from suppliers;


[0m16:15:40.342583 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:15:40.442044 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6eff5d96-4763-47b3-92bf-c68e4792e4ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73aaa246b800>]}
[0m16:15:40.442755 [info ] [Thread-3 (]: 6 of 15 OK created sql view model dbt_dw_staging.stg_orders_northwind .......... [[32mCREATE VIEW (0 processed)[0m in 1.78s]
[0m16:15:40.443309 [debug] [Thread-3 (]: Finished running node model.dbt_exercise.stg_orders_northwind
[0m16:15:40.443754 [debug] [Thread-3 (]: Began running node model.dbt_exercise.int_customers_northwind
[0m16:15:40.444809 [info ] [Thread-3 (]: 10 of 15 START sql view model dbt_dw_intermediate.int_customers_northwind ...... [RUN]
[0m16:15:40.445444 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_exercise.stg_orders_northwind, now model.dbt_exercise.int_customers_northwind)
[0m16:15:40.445886 [debug] [Thread-3 (]: Began compiling node model.dbt_exercise.int_customers_northwind
[0m16:15:40.448540 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_exercise.int_customers_northwind"
[0m16:15:40.450329 [debug] [Thread-3 (]: Began executing node model.dbt_exercise.int_customers_northwind
[0m16:15:40.453335 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_exercise.int_customers_northwind"
[0m16:15:40.454596 [debug] [Thread-3 (]: On model.dbt_exercise.int_customers_northwind: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "model.dbt_exercise.int_customers_northwind"} */


  create or replace view `corded-sunlight-464012-e2`.`dbt_dw_intermediate`.`int_customers_northwind`
  OPTIONS()
  as with stg_customers_northwind as (
    select *
    from `corded-sunlight-464012-e2`.`dbt_dw_staging`.`stg_customers_northwind`
)

, final_table as (
    select 
        customer_id
        , company_name
        , contact_name
        , contact_title
        , address
        , city
        , region
        , country
        , case 
            when country in ('USA', 'Canada', 'Mexico') then 'North America'
            when country in ('UK', 'France', 'Germany', 'Austria', 'Belgium', 'Denmark', 'Ireland'
            , 'Finland', 'Italy', 'Norway', 'Poland', 'Portugal', 'Spain', 'Sweden', 'Switzerland') then 'Europe'
            when country in ('Brazil', 'Argentina', 'Venezuela') then 'South America'
            else 'Other'
        end as continent
    from stg_customers_northwind
)

select *
from final_table;


[0m16:15:40.455330 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:15:41.385573 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:b69a3540-9d8a-449f-bda9-f604e5275edf&page=queryresults
[0m16:15:41.517810 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:1844094a-3f64-46da-999a-205f55c1f9e4&page=queryresults
[0m16:15:41.646921 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:a7d0f28f-257c-41b0-86c3-e421445ffd0f&page=queryresults
[0m16:15:41.945185 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6eff5d96-4763-47b3-92bf-c68e4792e4ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73aaa24a3980>]}
[0m16:15:41.946169 [info ] [Thread-2 (]: 9 of 15 OK created sql view model dbt_dw_staging.stg_suppliers_northwind ....... [[32mCREATE VIEW (0 processed)[0m in 1.61s]
[0m16:15:41.947038 [debug] [Thread-2 (]: Finished running node model.dbt_exercise.stg_suppliers_northwind
[0m16:15:41.947616 [debug] [Thread-2 (]: Began running node model.dbt_exercise.int_employees_northwind
[0m16:15:41.948583 [info ] [Thread-2 (]: 11 of 15 START sql view model dbt_dw_intermediate.int_employees_northwind ...... [RUN]
[0m16:15:41.949269 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_exercise.stg_suppliers_northwind, now model.dbt_exercise.int_employees_northwind)
[0m16:15:41.949692 [debug] [Thread-2 (]: Began compiling node model.dbt_exercise.int_employees_northwind
[0m16:15:41.953330 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_exercise.int_employees_northwind"
[0m16:15:41.954157 [debug] [Thread-2 (]: Began executing node model.dbt_exercise.int_employees_northwind
[0m16:15:41.958357 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_exercise.int_employees_northwind"
[0m16:15:41.959193 [debug] [Thread-2 (]: On model.dbt_exercise.int_employees_northwind: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "model.dbt_exercise.int_employees_northwind"} */


  create or replace view `corded-sunlight-464012-e2`.`dbt_dw_intermediate`.`int_employees_northwind`
  OPTIONS()
  as with employees as (
    select *
    from `corded-sunlight-464012-e2`.`dbt_dw_staging`.`stg_employees_northwind`
)

, max_fact_date as (
    select 
        case 
            when max(order_date) >= max(shipped_date) then max(order_date)
            else max(shipped_date)
        end as max_date
    from `corded-sunlight-464012-e2`.`dbt_dw_staging`.`stg_orders_northwind`
)

, final_table as (
    select
        employee_id
        , concat(first_name, ' ', last_name) as employee_name
        , title
        , birth_date
        , date_diff((select * from max_fact_date), birth_date, year) as age
        , hire_date
        , date_diff((select * from max_fact_date), hire_date, year) as years_hired
        , address
        , city
        , region
        , country
    from employees
)

select *
from final_table;


[0m16:15:41.959616 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:15:42.065303 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6eff5d96-4763-47b3-92bf-c68e4792e4ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73aaa2474800>]}
[0m16:15:42.066319 [info ] [Thread-4 (]: 8 of 15 OK created sql view model dbt_dw_staging.stg_shippers_northwind ........ [[32mCREATE VIEW (0 processed)[0m in 1.76s]
[0m16:15:42.067364 [debug] [Thread-4 (]: Finished running node model.dbt_exercise.stg_shippers_northwind
[0m16:15:42.068634 [debug] [Thread-4 (]: Began running node model.dbt_exercise.int_orders_northwind
[0m16:15:42.069603 [info ] [Thread-4 (]: 12 of 15 START sql view model dbt_dw_intermediate.int_orders_northwind ......... [RUN]
[0m16:15:42.070236 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.dbt_exercise.stg_shippers_northwind, now model.dbt_exercise.int_orders_northwind)
[0m16:15:42.070639 [debug] [Thread-4 (]: Began compiling node model.dbt_exercise.int_orders_northwind
[0m16:15:42.074313 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_exercise.int_orders_northwind"
[0m16:15:42.075389 [debug] [Thread-4 (]: Began executing node model.dbt_exercise.int_orders_northwind
[0m16:15:42.080132 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_exercise.int_orders_northwind"
[0m16:15:42.081748 [debug] [Thread-4 (]: On model.dbt_exercise.int_orders_northwind: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "model.dbt_exercise.int_orders_northwind"} */


  create or replace view `corded-sunlight-464012-e2`.`dbt_dw_intermediate`.`int_orders_northwind`
  OPTIONS()
  as with stg_orders_northwind as (
    select *
    from `corded-sunlight-464012-e2`.`dbt_dw_staging`.`stg_orders_northwind`
)

, stg_order_details_northwind as (
    select *
    from `corded-sunlight-464012-e2`.`dbt_dw_staging`.`stg_order_details_northwind`
)

, stg_shippers_northwind as (
    select *
    from `corded-sunlight-464012-e2`.`dbt_dw_staging`.`stg_shippers_northwind`
)

, transformed_table as (    
    select
        stg_stg_orders_northwind_northwind.order_id 
        , stg_stg_orders_northwind_northwind.customer_id
        , stg_stg_orders_northwind_northwind.employee_id
        , stg_stg_orders_northwind_northwind.order_date
        , stg_orders_northwind.required_date
        , stg_orders_northwind.shipped_date
        , date_diff(stg_orders_northwind.shipped_date, stg_orders_northwind.order_date, day) as days_to_ship
        , concat(
            coalesce(stg_orders_northwind.ship_via, '')
            , '-'
            , coalesce(stg_shippers_northwind.company_name, '')
            , '-'
            , coalesce(stg_orders_northwind.ship_address, '')
        ) as ship_id
        , stg_orders_northwind.ship_via      
        , stg_shippers_northwind.company_name as shipper_name
        , sum(stg_order_details_northwind.unit_price * stg_order_details_northwind.quantity * (1 - stg_order_details_northwind.discount)) as total_order_amount
        , stg_orders_northwind.freight
        , stg_orders_northwind.ship_name
        , stg_orders_northwind.ship_address
        , stg_orders_northwind.ship_city
        , stg_orders_northwind.ship_region
        , stg_orders_northwind.ship_country
        , case
            when stg_orders_northwind.ship_country in ('USA', 'Canada', 'Mexico') then 'North America'
            when stg_orders_northwind.ship_country in ('UK', 'France', 'Germany', 'Austria', 'Belgium', 
            'Denmark', 'Ireland', 'Finland', 'Italy', 'Norway', 'Poland', 'Portugal', 'Spain', 'Sweden', 'Switzerland') then 'Europe'
            when stg_orders_northwind.ship_country in ('Brazil', 'Argentina', 'Venezuela') then 'South America'
            else 'Other'
        end as ship_continent
    from stg_orders_northwind
    left join stg_order_details_northwind
        on stg_orders_northwind.order_id = stg_order_details_northwind.order_id
    left join stg_shippers_northwind
        on stg_orders_northwind.ship_via = stg_shippers_northwind.shipper_id
    group by 
        stg_orders_northwind.order_id
        , stg_orders_northwind.customer_id
        , stg_orders_northwind.employee_id
        , stg_orders_northwind.order_date
        , stg_orders_northwind.required_date
        , stg_orders_northwind.shipped_date
        , stg_orders_northwind.ship_via
        , stg_shippers_northwind.company_name
        , stg_orders_northwind.freight
        , stg_orders_northwind.ship_name
        , stg_orders_northwind.ship_address
        , stg_orders_northwind.ship_city
        , stg_orders_northwind.ship_region
        , stg_orders_northwind.ship_country
)

, final_table as (
    select
        transformed_table.order_id
        , transformed_table.customer_id
        , transformed_table.employee_id
        , transformed_table.order_date
        , transformed_table.required_date
        , transformed_table.shipped_date
        , transformed_table.days_to_ship
        , transformed_table.ship_id
        , transformed_table.ship_via
        , transformed_table.shipper_name
        , transformed_table.total_order_amount
        , transformed_table.freight
        , transformed_table.ship_name
        , transformed_table.ship_address
        , transformed_table.ship_city
        , transformed_table.ship_region
        , transformed_table.ship_country
        , transformed_table.ship_continent
        , case 
            when transformed_table.days_to_ship is null then False
            else True
          end as is_shipped
    from transformed_table
)

select *
from final_table;


[0m16:15:42.083435 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:15:42.250006 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6eff5d96-4763-47b3-92bf-c68e4792e4ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73aaa2462c90>]}
[0m16:15:42.251011 [info ] [Thread-3 (]: 10 of 15 OK created sql view model dbt_dw_intermediate.int_customers_northwind . [[32mCREATE VIEW (0 processed)[0m in 1.80s]
[0m16:15:42.251798 [debug] [Thread-3 (]: Finished running node model.dbt_exercise.int_customers_northwind
[0m16:15:42.252271 [debug] [Thread-3 (]: Began running node model.dbt_exercise.int_shippers_northwind
[0m16:15:42.252984 [info ] [Thread-3 (]: 13 of 15 START sql view model dbt_dw_intermediate.int_shippers_northwind ....... [RUN]
[0m16:15:42.253520 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_exercise.int_customers_northwind, now model.dbt_exercise.int_shippers_northwind)
[0m16:15:42.253943 [debug] [Thread-3 (]: Began compiling node model.dbt_exercise.int_shippers_northwind
[0m16:15:42.256788 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_exercise.int_shippers_northwind"
[0m16:15:42.258944 [debug] [Thread-3 (]: Began executing node model.dbt_exercise.int_shippers_northwind
[0m16:15:42.262158 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_exercise.int_shippers_northwind"
[0m16:15:42.265104 [debug] [Thread-3 (]: On model.dbt_exercise.int_shippers_northwind: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "model.dbt_exercise.int_shippers_northwind"} */


  create or replace view `corded-sunlight-464012-e2`.`dbt_dw_intermediate`.`int_shippers_northwind`
  OPTIONS()
  as with stg_shippers_northwind as (
    select *
    from `corded-sunlight-464012-e2`.`dbt_dw_staging`.`stg_shippers_northwind`
)

, stg_orders_northwind as (
    select *
    from `corded-sunlight-464012-e2`.`dbt_dw_staging`.`stg_orders_northwind`
)

, transformed_table as (
    select
        concat(
            coalesce(stg_shippers_northwind.shipper_id, '')
            , '-'
            , coalesce(stg_shippers_northwind.company_name, '')
            , '-'
            , coalesce(stg_orders_northwind.ship_address, '')
        ) as ship_id
        , stg_shippers_northwind.shipper_id
        , stg_shippers_northwind.company_name
        , stg_orders_northwind.ship_address
        , stg_orders_northwind.ship_city
        , stg_orders_northwind.ship_region
        , stg_orders_northwind.ship_country
    from stg_shippers_northwind
    left join stg_orders_northwind
        on stg_shippers_northwind.shipper_id = stg_orders_northwind.ship_via
)

/* Aqui é feita a deduplicação da transformed_table */
, dedup_table as (
    select distinct *
    from transformed_table
)

, final_table as (
    select 
        *
        , case
            when dedup_table.ship_country in ('USA', 'Canada', 'Mexico') then 'North America'
            when dedup_table.ship_country in ('UK', 'France', 'Germany', 'Austria', 'Belgium', 
            'Denmark', 'Ireland', 'Finland', 'Italy', 'Norway', 'Poland', 'Portugal', 'Spain', 'Sweden', 'Switzerland') then 'Europe'
            when dedup_table.ship_country in ('Brazil', 'Argentina', 'Venezuela') then 'South America'
            else 'Other'
        end as ship_continent
    from dedup_table
)

select *
from final_table;


[0m16:15:42.266383 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:15:43.021325 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:04690ab3-a0e0-45ea-89b0-a567031aa6e6&page=queryresults
[0m16:15:43.133489 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:bca00ce2-3d06-450b-b76c-83a6b7d57f03&page=queryresults
[0m16:15:43.308360 [error] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:04690ab3-a0e0-45ea-89b0-a567031aa6e6&page=queryresults
[0m16:15:43.344754 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:b39a74b7-54f3-44ae-8a0c-ca9ac579dead&page=queryresults
[0m16:15:43.394627 [debug] [Thread-2 (]: Database Error in model int_employees_northwind (models/intermediate/int_employees_northwind.sql)
  DATE_DIFF does not support the YEAR date part when the argument is TIMESTAMP type at [26:11]
  compiled code at target/run/dbt_exercise/models/intermediate/int_employees_northwind.sql
[0m16:15:43.395670 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6eff5d96-4763-47b3-92bf-c68e4792e4ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73aaa255be60>]}
[0m16:15:43.396678 [error] [Thread-2 (]: 11 of 15 ERROR creating sql view model dbt_dw_intermediate.int_employees_northwind  [[31mERROR[0m in 1.45s]
[0m16:15:43.397380 [debug] [Thread-2 (]: Finished running node model.dbt_exercise.int_employees_northwind
[0m16:15:43.398037 [debug] [Thread-7 (]: Marking all children of 'model.dbt_exercise.int_employees_northwind' to be skipped because of status 'error'.  Reason: Database Error in model int_employees_northwind (models/intermediate/int_employees_northwind.sql)
  DATE_DIFF does not support the YEAR date part when the argument is TIMESTAMP type at [26:11]
  compiled code at target/run/dbt_exercise/models/intermediate/int_employees_northwind.sql.
[0m16:15:43.416197 [error] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:bca00ce2-3d06-450b-b76c-83a6b7d57f03&page=queryresults
[0m16:15:43.448317 [debug] [Thread-4 (]: Database Error in model int_orders_northwind (models/intermediate/int_orders_northwind.sql)
  Unrecognized name: stg_stg_orders_northwind_northwind at [23:9]
  compiled code at target/run/dbt_exercise/models/intermediate/int_orders_northwind.sql
[0m16:15:43.449005 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6eff5d96-4763-47b3-92bf-c68e4792e4ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73aaa2438cb0>]}
[0m16:15:43.449769 [error] [Thread-4 (]: 12 of 15 ERROR creating sql view model dbt_dw_intermediate.int_orders_northwind  [[31mERROR[0m in 1.38s]
[0m16:15:43.450539 [debug] [Thread-4 (]: Finished running node model.dbt_exercise.int_orders_northwind
[0m16:15:43.451538 [debug] [Thread-7 (]: Marking all children of 'model.dbt_exercise.int_orders_northwind' to be skipped because of status 'error'.  Reason: Database Error in model int_orders_northwind (models/intermediate/int_orders_northwind.sql)
  Unrecognized name: stg_stg_orders_northwind_northwind at [23:9]
  compiled code at target/run/dbt_exercise/models/intermediate/int_orders_northwind.sql.
[0m16:15:43.872217 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6eff5d96-4763-47b3-92bf-c68e4792e4ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73aaa2474e90>]}
[0m16:15:43.873032 [info ] [Thread-3 (]: 13 of 15 OK created sql view model dbt_dw_intermediate.int_shippers_northwind .. [[32mCREATE VIEW (0 processed)[0m in 1.62s]
[0m16:15:43.873732 [debug] [Thread-3 (]: Finished running node model.dbt_exercise.int_shippers_northwind
[0m16:16:33.811319 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:72f6e4f5-a295-4452-868b-023896658b80&page=queryresults
[0m16:16:34.419957 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6eff5d96-4763-47b3-92bf-c68e4792e4ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73aaa2370d40>]}
[0m16:16:34.420817 [info ] [Thread-1 (]: 1 of 15 OK created sql view model dbt_dw_staging.stg_categories_northwind ...... [[32mCREATE VIEW (0 processed)[0m in 61.95s]
[0m16:16:34.421583 [debug] [Thread-1 (]: Finished running node model.dbt_exercise.stg_categories_northwind
[0m16:16:34.423312 [debug] [Thread-2 (]: Began running node model.dbt_exercise.int_products_northwind
[0m16:16:34.424172 [info ] [Thread-2 (]: 14 of 15 START sql view model dbt_dw_intermediate.int_products_northwind ....... [RUN]
[0m16:16:34.425426 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_exercise.int_employees_northwind, now model.dbt_exercise.int_products_northwind)
[0m16:16:34.425958 [debug] [Thread-2 (]: Began compiling node model.dbt_exercise.int_products_northwind
[0m16:16:34.430741 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_exercise.int_products_northwind"
[0m16:16:34.431784 [debug] [Thread-2 (]: Began executing node model.dbt_exercise.int_products_northwind
[0m16:16:34.434810 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_exercise.int_products_northwind"
[0m16:16:34.435704 [debug] [Thread-2 (]: On model.dbt_exercise.int_products_northwind: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "model.dbt_exercise.int_products_northwind"} */


  create or replace view `corded-sunlight-464012-e2`.`dbt_dw_intermediate`.`int_products_northwind`
  OPTIONS()
  as with stg_products_northwind as (
    select *
    from `corded-sunlight-464012-e2`.`dbt_dw_staging`.`stg_products_northwind`
)

, stg_categories_northwind as (
    select *
    from `corded-sunlight-464012-e2`.`dbt_dw_staging`.`stg_categories_northwind`
)

, stg_suppliers_northwind as (
    select *
    from `corded-sunlight-464012-e2`.`dbt_dw_staging`.`stg_suppliers_northwind`
)

, final_table as (
    select
        stg_products_northwind.product_id
        , stg_products_northwind.product_name
        , stg_products_northwind.quantity_per_unit
        , stg_categories_northwind.category_name
        , stg_suppliers_northwind.company_name as supplier_name
        , stg_suppliers_northwind.city as supplier_city
        , stg_suppliers_northwind.region as supplier_region
        , stg_suppliers_northwind.country as supplier_country
        , case
            when stg_suppliers_northwind.country in ('USA', 'Canada') then 'North America'
            when stg_suppliers_northwind.country in ('Brazil') then 'South America'
            when stg_suppliers_northwind.country in ('UK', 'Germany', 'Netherlands', 'Spain', 'France', 'Norway', 'Italy', 'Denmark', 'Sweden', 'Finland') then 'Europe'
            when stg_suppliers_northwind.country in ('Singapore', 'Japan') then 'Asia'
            when stg_suppliers_northwind.country in ('Australia') then 'Oceania'
            else 'Other'
          end as supplier_continent
        , stg_products_northwind.discontinued
    from stg_products_northwind
    left join stg_categories_northwind
        on stg_products_northwind.category_id = stg_categories_northwind.category_id
    left join stg_suppliers_northwind
        on stg_products_northwind.supplier_id = stg_suppliers_northwind.supplier_id
)

desc table final_table
;


[0m16:16:34.436207 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:16:35.262057 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:39cb079e-8044-4b68-940a-0840c3602041&page=queryresults
[0m16:16:35.262752 [error] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:39cb079e-8044-4b68-940a-0840c3602041&page=queryresults
[0m16:16:35.299141 [debug] [Thread-2 (]: Database Error in model int_products_northwind (models/intermediate/int_products_northwind.sql)
  Syntax error: Unexpected keyword DESC at [47:1]
  compiled code at target/run/dbt_exercise/models/intermediate/int_products_northwind.sql
[0m16:16:35.299796 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6eff5d96-4763-47b3-92bf-c68e4792e4ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73aaa2391be0>]}
[0m16:16:35.300436 [error] [Thread-2 (]: 14 of 15 ERROR creating sql view model dbt_dw_intermediate.int_products_northwind  [[31mERROR[0m in 0.87s]
[0m16:16:35.301001 [debug] [Thread-2 (]: Finished running node model.dbt_exercise.int_products_northwind
[0m16:16:35.301697 [debug] [Thread-7 (]: Marking all children of 'model.dbt_exercise.int_products_northwind' to be skipped because of status 'error'.  Reason: Database Error in model int_products_northwind (models/intermediate/int_products_northwind.sql)
  Syntax error: Unexpected keyword DESC at [47:1]
  compiled code at target/run/dbt_exercise/models/intermediate/int_products_northwind.sql.
[0m16:16:35.303130 [debug] [Thread-3 (]: Began running node model.dbt_exercise.dim_products
[0m16:16:35.303898 [info ] [Thread-3 (]: 15 of 15 SKIP relation dbt_dw_marts.dim_products ............................... [[33mSKIP[0m]
[0m16:16:35.304805 [debug] [Thread-3 (]: Finished running node model.dbt_exercise.dim_products
[0m16:16:35.308359 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:16:35.314960 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:16:35.315428 [debug] [MainThread]: Connection 'model.dbt_exercise.int_shippers_northwind' was properly closed.
[0m16:16:35.315726 [debug] [MainThread]: Connection 'model.dbt_exercise.stg_categories_northwind' was properly closed.
[0m16:16:35.316000 [debug] [MainThread]: Connection 'model.dbt_exercise.int_orders_northwind' was properly closed.
[0m16:16:35.316285 [debug] [MainThread]: Connection 'model.dbt_exercise.int_products_northwind' was properly closed.
[0m16:16:35.316819 [info ] [MainThread]: 
[0m16:16:35.317430 [info ] [MainThread]: Finished running 1 table model, 14 view models in 0 hours 1 minutes and 5.02 seconds (65.02s).
[0m16:16:35.320369 [debug] [MainThread]: Command end result
[0m16:16:35.366495 [debug] [MainThread]: Wrote artifact WritableManifest to /home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/target/manifest.json
[0m16:16:35.378521 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/target/semantic_manifest.json
[0m16:16:35.384622 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/target/run_results.json
[0m16:16:35.385073 [info ] [MainThread]: 
[0m16:16:35.385463 [info ] [MainThread]: [31mCompleted with 3 errors, 0 partial successes, and 0 warnings:[0m
[0m16:16:35.385825 [info ] [MainThread]: 
[0m16:16:35.386300 [error] [MainThread]: [31mFailure in model int_employees_northwind (models/intermediate/int_employees_northwind.sql)[0m
[0m16:16:35.386686 [error] [MainThread]:   Database Error in model int_employees_northwind (models/intermediate/int_employees_northwind.sql)
  DATE_DIFF does not support the YEAR date part when the argument is TIMESTAMP type at [26:11]
  compiled code at target/run/dbt_exercise/models/intermediate/int_employees_northwind.sql
[0m16:16:35.387046 [info ] [MainThread]: 
[0m16:16:35.387454 [info ] [MainThread]:   compiled code at target/compiled/dbt_exercise/models/intermediate/int_employees_northwind.sql
[0m16:16:35.387814 [info ] [MainThread]: 
[0m16:16:35.388233 [error] [MainThread]: [31mFailure in model int_orders_northwind (models/intermediate/int_orders_northwind.sql)[0m
[0m16:16:35.388591 [error] [MainThread]:   Database Error in model int_orders_northwind (models/intermediate/int_orders_northwind.sql)
  Unrecognized name: stg_stg_orders_northwind_northwind at [23:9]
  compiled code at target/run/dbt_exercise/models/intermediate/int_orders_northwind.sql
[0m16:16:35.388894 [info ] [MainThread]: 
[0m16:16:35.389235 [info ] [MainThread]:   compiled code at target/compiled/dbt_exercise/models/intermediate/int_orders_northwind.sql
[0m16:16:35.389533 [info ] [MainThread]: 
[0m16:16:35.389963 [error] [MainThread]: [31mFailure in model int_products_northwind (models/intermediate/int_products_northwind.sql)[0m
[0m16:16:35.390347 [error] [MainThread]:   Database Error in model int_products_northwind (models/intermediate/int_products_northwind.sql)
  Syntax error: Unexpected keyword DESC at [47:1]
  compiled code at target/run/dbt_exercise/models/intermediate/int_products_northwind.sql
[0m16:16:35.390644 [info ] [MainThread]: 
[0m16:16:35.390990 [info ] [MainThread]:   compiled code at target/compiled/dbt_exercise/models/intermediate/int_products_northwind.sql
[0m16:16:35.391300 [info ] [MainThread]: 
[0m16:16:35.391634 [info ] [MainThread]: Done. PASS=11 WARN=0 ERROR=3 SKIP=1 NO-OP=0 TOTAL=15
[0m16:16:35.392216 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- DuplicateYAMLKeysDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m16:16:35.397511 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 165.09587, "process_in_blocks": "144488", "process_kernel_time": 12.831725, "process_mem_max_rss": "367468", "process_out_blocks": "3904", "process_user_time": 12.431289}
[0m16:16:35.398660 [debug] [MainThread]: Command `dbt run` failed at 16:16:35.398445 after 165.10 seconds
[0m16:16:35.399298 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73aaf2359df0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73aab2a08b30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73aaa2490da0>]}
[0m16:16:35.400040 [debug] [MainThread]: Flushing usage events
[0m16:16:35.819518 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:19:24.129999 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71d130bde5a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71d1329f5760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71d130912360>]}


============================== 16:19:24.144452 | d31a8d98-bfc4-4be4-be4e-0e548436043c ==============================
[0m16:19:24.144452 [info ] [MainThread]: Running with dbt=1.10.2
[0m16:19:24.145017 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m16:20:09.963750 [warn ] [MainThread]: [[33mWARNING[0m][DuplicateYAMLKeysDeprecation]: Deprecated functionality
Duplicate key 'version' in "<unicode string>", line 4, column 1 in file
`/home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/dbt_project.yml`
[0m16:20:09.964344 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'd31a8d98-bfc4-4be4-be4e-0e548436043c', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71d0f2f866f0>]}
[0m16:20:10.580253 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd31a8d98-bfc4-4be4-be4e-0e548436043c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71d0f31dff20>]}
[0m16:20:10.635416 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd31a8d98-bfc4-4be4-be4e-0e548436043c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71d1300c55e0>]}
[0m16:20:10.641621 [info ] [MainThread]: Registered adapter: bigquery=1.9.2
[0m16:20:55.508825 [debug] [MainThread]: checksum: 1adc40777973ef30f45f80b3b6d04d5013c1edd53d96363881b3b199e612468b, vars: {}, profile: , target: , version: 1.10.2
[0m16:21:00.109790 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:21:00.110313 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:21:00.158487 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd31a8d98-bfc4-4be4-be4e-0e548436043c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71d0f2fb2120>]}
[0m16:21:00.517370 [debug] [MainThread]: Wrote artifact WritableManifest to /home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/target/manifest.json
[0m16:21:00.544042 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/target/semantic_manifest.json
[0m16:21:00.941681 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd31a8d98-bfc4-4be4-be4e-0e548436043c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71d0f2b0d4c0>]}
[0m16:21:00.942348 [info ] [MainThread]: Found 14 seeds, 36 data tests, 16 models, 14 sources, 609 macros
[0m16:21:00.942746 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd31a8d98-bfc4-4be4-be4e-0e548436043c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71d0f2d02e40>]}
[0m16:21:00.945226 [info ] [MainThread]: 
[0m16:21:00.945769 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:21:00.946134 [info ] [MainThread]: 
[0m16:21:00.946741 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m16:21:00.952392 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_corded-sunlight-464012-e2'
[0m16:21:00.953408 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:21:00.954173 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_corded-sunlight-464012-e2'
[0m16:21:00.955232 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_corded-sunlight-464012-e2'
[0m16:21:00.956830 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:21:00.958005 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:21:02.281193 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_corded-sunlight-464012-e2, now list_corded-sunlight-464012-e2_dbt_dw_staging)
[0m16:21:02.283066 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_corded-sunlight-464012-e2, now list_corded-sunlight-464012-e2_dbt_dw_intermediate)
[0m16:21:02.284077 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:21:02.284865 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_corded-sunlight-464012-e2, now list_corded-sunlight-464012-e2_dbt_dw_marts)
[0m16:21:02.285985 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:21:02.287155 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_corded-sunlight-464012-e2_dbt_dw_raw'
[0m16:21:02.288007 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:21:02.289152 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:21:03.354631 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd31a8d98-bfc4-4be4-be4e-0e548436043c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71d0f305b8c0>]}
[0m16:21:03.355512 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:21:03.367852 [debug] [Thread-1 (]: Began running node model.dbt_exercise.stg_categories_northwind
[0m16:21:03.368613 [debug] [Thread-2 (]: Began running node model.dbt_exercise.stg_customers_northwind
[0m16:21:03.370043 [debug] [Thread-3 (]: Began running node model.dbt_exercise.stg_employee_territories
[0m16:21:03.370930 [debug] [Thread-4 (]: Began running node model.dbt_exercise.stg_employees_northwind
[0m16:21:03.369506 [info ] [Thread-1 (]: 1 of 15 START sql view model dbt_dw_staging.stg_categories_northwind ........... [RUN]
[0m16:21:03.372175 [info ] [Thread-2 (]: 2 of 15 START sql view model dbt_dw_staging.stg_customers_northwind ............ [RUN]
[0m16:21:03.373172 [info ] [Thread-3 (]: 3 of 15 START sql view model dbt_dw_staging.stg_employee_territories ........... [RUN]
[0m16:21:03.374530 [info ] [Thread-4 (]: 4 of 15 START sql view model dbt_dw_staging.stg_employees_northwind ............ [RUN]
[0m16:21:03.375501 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_corded-sunlight-464012-e2_dbt_dw_raw, now model.dbt_exercise.stg_categories_northwind)
[0m16:21:03.377127 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_corded-sunlight-464012-e2_dbt_dw_staging, now model.dbt_exercise.stg_customers_northwind)
[0m16:21:03.377955 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_corded-sunlight-464012-e2_dbt_dw_intermediate, now model.dbt_exercise.stg_employee_territories)
[0m16:21:03.378610 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly list_corded-sunlight-464012-e2_dbt_dw_marts, now model.dbt_exercise.stg_employees_northwind)
[0m16:21:03.379179 [debug] [Thread-1 (]: Began compiling node model.dbt_exercise.stg_categories_northwind
[0m16:21:03.379795 [debug] [Thread-2 (]: Began compiling node model.dbt_exercise.stg_customers_northwind
[0m16:21:03.380364 [debug] [Thread-3 (]: Began compiling node model.dbt_exercise.stg_employee_territories
[0m16:21:03.381143 [debug] [Thread-4 (]: Began compiling node model.dbt_exercise.stg_employees_northwind
[0m16:21:03.391351 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_exercise.stg_categories_northwind"
[0m16:21:03.396247 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_exercise.stg_customers_northwind"
[0m16:21:03.400310 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_exercise.stg_employee_territories"
[0m16:21:03.405489 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_exercise.stg_employees_northwind"
[0m16:21:03.407211 [debug] [Thread-1 (]: Began executing node model.dbt_exercise.stg_categories_northwind
[0m16:21:03.408595 [debug] [Thread-2 (]: Began executing node model.dbt_exercise.stg_customers_northwind
[0m16:21:03.415927 [debug] [Thread-4 (]: Began executing node model.dbt_exercise.stg_employees_northwind
[0m16:21:03.423118 [debug] [Thread-3 (]: Began executing node model.dbt_exercise.stg_employee_territories
[0m16:21:03.466721 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_exercise.stg_customers_northwind"
[0m16:21:03.467841 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_exercise.stg_categories_northwind"
[0m16:21:03.471338 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_exercise.stg_employees_northwind"
[0m16:21:03.474692 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_exercise.stg_employee_territories"
[0m16:21:03.477451 [debug] [Thread-2 (]: On model.dbt_exercise.stg_customers_northwind: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "model.dbt_exercise.stg_customers_northwind"} */


  create or replace view `corded-sunlight-464012-e2`.`dbt_dw_staging`.`stg_customers_northwind`
  OPTIONS()
  as with raw_customers as (
    select *
    from `corded-sunlight-464012-e2`.`dbt_dw_raw`.`customers`
)

, stg_customers_northwind as (
    select
        cast(customer_id as string) as customer_id
        , cast(company_name as string) as company_name
        , cast(contact_name as string) as contact_name
        , cast(contact_title as string) as contact_title
        , cast(address as string) as address
        , cast(city as string) as city
        , cast(region as string) as region
        , cast(postal_code as string) as postal_code
        , cast(country as string) as country
        , cast(phone as string) as phone
        , cast(fax as string) as fax
    from raw_customers
)

select *
from stg_customers_northwind;


[0m16:21:03.478770 [debug] [Thread-4 (]: On model.dbt_exercise.stg_employees_northwind: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "model.dbt_exercise.stg_employees_northwind"} */


  create or replace view `corded-sunlight-464012-e2`.`dbt_dw_staging`.`stg_employees_northwind`
  OPTIONS()
  as with raw_employees as (
    select *
    from `corded-sunlight-464012-e2`.`dbt_dw_raw`.`employees`
)

/* Os campos photo, notes e reports_to e photo_path não são carregadas na staging */

, stg_employees_northwind as (
    select
        cast(employee_id as string) as employee_id
        , cast(first_name as string) as first_name
        , cast(last_name as string) as last_name
        , cast(title as string) as title
        , cast(title_of_courtesy as string) as title_of_courtesy
        , cast(birth_date as date) as birth_date
        , cast(hire_date as date) as hire_date
        , cast(address as string) as address
        , cast(city as string) as city
        , cast(region as string) as region
        , cast(postal_code as string) as postal_code
        , cast(country as string) as country
        , cast(home_phone as string) as home_phone
        , cast(extension as string) as extension
    from raw_employees
)

select *
from stg_employees_northwind;


[0m16:21:03.479451 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:21:03.480658 [debug] [Thread-3 (]: On model.dbt_exercise.stg_employee_territories: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "model.dbt_exercise.stg_employee_territories"} */


  create or replace view `corded-sunlight-464012-e2`.`dbt_dw_staging`.`stg_employee_territories`
  OPTIONS()
  as with raw_employee_territories as (
    select *
    from `corded-sunlight-464012-e2`.`dbt_dw_raw`.`employee_territories`
)

, stg_employee_territories as (
    select
        cast(employee_id as string) as employee_id
        , cast(territory_id as string) as territory_id
    from raw_employee_territories
)

select *
from stg_employee_territories;


[0m16:21:03.481696 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:21:03.482449 [debug] [Thread-1 (]: On model.dbt_exercise.stg_categories_northwind: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "model.dbt_exercise.stg_categories_northwind"} */


  create or replace view `corded-sunlight-464012-e2`.`dbt_dw_staging`.`stg_categories_northwind`
  OPTIONS()
  as with raw_categories as (
    select *
    from `corded-sunlight-464012-e2`.`dbt_dw_raw`.`categories`
)

/* Ao construir a staging não vamos trazer a coluna picture, pois ela não traz informação relevante */
, stg_categories_northwind as (
    select
        cast(category_id as string) as category_id
        , cast(category_name as string) as category_name
        , cast(description as string) as description
    from raw_categories
)

select *
from raw_categories;


[0m16:21:03.483643 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:21:03.485155 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:21:04.591314 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:7598f3d3-015c-46de-8e6c-3fb27c9766bb&page=queryresults
[0m16:21:04.594077 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:c65348e1-4d5e-410e-a25a-9411e30e5df3&page=queryresults
[0m16:21:04.622412 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:08e13cd4-d478-44ab-8d71-f857d0b21c81&page=queryresults
[0m16:21:04.669802 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:664bf4e1-2faa-4a7f-b7ce-2916ab9c2096&page=queryresults
[0m16:21:09.306972 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd31a8d98-bfc4-4be4-be4e-0e548436043c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71d0f7b424e0>]}
[0m16:21:09.307898 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd31a8d98-bfc4-4be4-be4e-0e548436043c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71d12fff4830>]}
[0m16:21:09.309522 [info ] [Thread-3 (]: 3 of 15 OK created sql view model dbt_dw_staging.stg_employee_territories ...... [[32mCREATE VIEW (0 processed)[0m in 5.91s]
[0m16:21:09.310563 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd31a8d98-bfc4-4be4-be4e-0e548436043c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71d0f0562360>]}
[0m16:21:09.311328 [info ] [Thread-2 (]: 2 of 15 OK created sql view model dbt_dw_staging.stg_customers_northwind ....... [[32mCREATE VIEW (0 processed)[0m in 5.92s]
[0m16:21:09.311995 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd31a8d98-bfc4-4be4-be4e-0e548436043c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71d0f28f8560>]}
[0m16:21:09.312842 [debug] [Thread-3 (]: Finished running node model.dbt_exercise.stg_employee_territories
[0m16:21:09.313521 [info ] [Thread-4 (]: 4 of 15 OK created sql view model dbt_dw_staging.stg_employees_northwind ....... [[32mCREATE VIEW (0 processed)[0m in 5.92s]
[0m16:21:09.314783 [debug] [Thread-2 (]: Finished running node model.dbt_exercise.stg_customers_northwind
[0m16:21:09.315461 [info ] [Thread-1 (]: 1 of 15 OK created sql view model dbt_dw_staging.stg_categories_northwind ...... [[32mCREATE VIEW (0 processed)[0m in 5.92s]
[0m16:21:09.316251 [debug] [Thread-3 (]: Began running node model.dbt_exercise.stg_order_details_northwind
[0m16:21:09.317665 [debug] [Thread-4 (]: Finished running node model.dbt_exercise.stg_employees_northwind
[0m16:21:09.318588 [debug] [Thread-2 (]: Began running node model.dbt_exercise.stg_orders_northwind
[0m16:21:09.319741 [debug] [Thread-1 (]: Finished running node model.dbt_exercise.stg_categories_northwind
[0m16:21:09.321487 [debug] [Thread-4 (]: Began running node model.dbt_exercise.stg_products_northwind
[0m16:21:09.320828 [info ] [Thread-3 (]: 5 of 15 START sql view model dbt_dw_staging.stg_order_details_northwind ........ [RUN]
[0m16:21:09.322793 [info ] [Thread-2 (]: 6 of 15 START sql view model dbt_dw_staging.stg_orders_northwind ............... [RUN]
[0m16:21:09.323909 [debug] [Thread-1 (]: Began running node model.dbt_exercise.stg_shippers_northwind
[0m16:21:09.325040 [info ] [Thread-4 (]: 7 of 15 START sql view model dbt_dw_staging.stg_products_northwind ............. [RUN]
[0m16:21:09.326022 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_exercise.stg_employee_territories, now model.dbt_exercise.stg_order_details_northwind)
[0m16:21:09.326903 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_exercise.stg_customers_northwind, now model.dbt_exercise.stg_orders_northwind)
[0m16:21:09.328097 [info ] [Thread-1 (]: 8 of 15 START sql view model dbt_dw_staging.stg_shippers_northwind ............. [RUN]
[0m16:21:09.329474 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.dbt_exercise.stg_employees_northwind, now model.dbt_exercise.stg_products_northwind)
[0m16:21:09.330396 [debug] [Thread-3 (]: Began compiling node model.dbt_exercise.stg_order_details_northwind
[0m16:21:09.331316 [debug] [Thread-2 (]: Began compiling node model.dbt_exercise.stg_orders_northwind
[0m16:21:09.332587 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_exercise.stg_categories_northwind, now model.dbt_exercise.stg_shippers_northwind)
[0m16:21:09.333213 [debug] [Thread-4 (]: Began compiling node model.dbt_exercise.stg_products_northwind
[0m16:21:09.337248 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_exercise.stg_order_details_northwind"
[0m16:21:09.340285 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_exercise.stg_orders_northwind"
[0m16:21:09.341736 [debug] [Thread-1 (]: Began compiling node model.dbt_exercise.stg_shippers_northwind
[0m16:21:09.346364 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_exercise.stg_products_northwind"
[0m16:21:09.350332 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_exercise.stg_shippers_northwind"
[0m16:21:09.351232 [debug] [Thread-3 (]: Began executing node model.dbt_exercise.stg_order_details_northwind
[0m16:21:09.351929 [debug] [Thread-2 (]: Began executing node model.dbt_exercise.stg_orders_northwind
[0m16:21:09.354372 [debug] [Thread-4 (]: Began executing node model.dbt_exercise.stg_products_northwind
[0m16:21:09.357128 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_exercise.stg_order_details_northwind"
[0m16:21:09.357823 [debug] [Thread-1 (]: Began executing node model.dbt_exercise.stg_shippers_northwind
[0m16:21:09.362722 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_exercise.stg_orders_northwind"
[0m16:21:09.369787 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_exercise.stg_products_northwind"
[0m16:21:09.374174 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_exercise.stg_shippers_northwind"
[0m16:21:09.375540 [debug] [Thread-3 (]: On model.dbt_exercise.stg_order_details_northwind: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "model.dbt_exercise.stg_order_details_northwind"} */


  create or replace view `corded-sunlight-464012-e2`.`dbt_dw_staging`.`stg_order_details_northwind`
  OPTIONS()
  as with raw_order_details as (
    select *
    from `corded-sunlight-464012-e2`.`dbt_dw_raw`.`order_details`
)

, stg_order_details_northwind as (
    select
        cast(order_id as string) as order_id
        , cast(product_id as string) as product_id
        , cast(unit_price as numeric) as unit_price
        , cast(quantity as integer) as quantity
        , cast(discount as numeric) as discount
    from raw_order_details
)

select *
from stg_order_details_northwind;


[0m16:21:09.378405 [debug] [Thread-2 (]: On model.dbt_exercise.stg_orders_northwind: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "model.dbt_exercise.stg_orders_northwind"} */


  create or replace view `corded-sunlight-464012-e2`.`dbt_dw_staging`.`stg_orders_northwind`
  OPTIONS()
  as with raw_orders as (
    select *
    from `corded-sunlight-464012-e2`.`dbt_dw_raw`.`orders`
)

, stg_orders_northwind as (
    select
        cast(order_id as string) as order_id
        , cast(customer_id as string) as customer_id
        , cast(employee_id as string) as employee_id
        , cast(order_date as timestamp) as order_date
        , cast(required_date as timestamp) as required_date
        , cast(shipped_date as timestamp) as shipped_date
        , cast(ship_via as string) as ship_via
        , cast(freight as numeric) as freight
        , cast(ship_name as string) as ship_name
        , cast(ship_address as string) as ship_address
        , cast(ship_city as string) as ship_city
        , cast(ship_region as string) as ship_region
        , cast(ship_postal_code as string) as ship_postal_code
        , cast(ship_country as string) as ship_country
    from raw_orders
)

select *
from stg_orders_northwind;


[0m16:21:09.379223 [debug] [Thread-4 (]: On model.dbt_exercise.stg_products_northwind: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "model.dbt_exercise.stg_products_northwind"} */


  create or replace view `corded-sunlight-464012-e2`.`dbt_dw_staging`.`stg_products_northwind`
  OPTIONS()
  as with raw_products as (
    select *
    from `corded-sunlight-464012-e2`.`dbt_dw_raw`.`products`
)

, stg_products_northwind as (
    select
        cast(product_id as string) as product_id
        , cast(product_name as string) as product_name
        , cast(supplier_id as string) as supplier_id
        , cast(category_id as string) as category_id
        , cast(quantity_per_unit as string) as quantity_per_unit
        , cast(unit_price as numeric) as unit_price
        , cast(units_in_stock as numeric) as units_in_stock
        , cast(units_on_order as numeric) as units_on_order
        , cast(reorder_level as numeric) as reorder_level
        , cast(discontinued as integer) as discontinued
    from raw_products
)

select *
from stg_products_northwind;


[0m16:21:09.380611 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:21:09.381147 [debug] [Thread-1 (]: On model.dbt_exercise.stg_shippers_northwind: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "model.dbt_exercise.stg_shippers_northwind"} */


  create or replace view `corded-sunlight-464012-e2`.`dbt_dw_staging`.`stg_shippers_northwind`
  OPTIONS()
  as with raw_shippers as (
    select *
    from `corded-sunlight-464012-e2`.`dbt_dw_raw`.`shippers`
)

, stg_shippers_northwind as (
    select
        cast(shipper_id as string) as shipper_id
        , cast(company_name as string) as company_name
        , cast(phone as string) as phone
    from raw_shippers
)

select *
from stg_shippers_northwind;


[0m16:21:09.382389 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:21:09.383243 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:21:09.384346 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:21:10.450504 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:6ce83716-a0a3-4f3a-9992-89c456468b91&page=queryresults
[0m16:21:10.465119 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:ae683c82-a66b-4f3e-bf0b-623f32293d30&page=queryresults
[0m16:21:10.606599 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:2aa6881e-7c5e-47ca-96ec-83f0efb76aad&page=queryresults
[0m16:21:10.639587 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:62fa48ac-80fa-44a2-abbc-4328b5140cb9&page=queryresults
[0m16:21:11.012864 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd31a8d98-bfc4-4be4-be4e-0e548436043c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71d0f0642030>]}
[0m16:21:11.013681 [info ] [Thread-2 (]: 6 of 15 OK created sql view model dbt_dw_staging.stg_orders_northwind .......... [[32mCREATE VIEW (0 processed)[0m in 1.69s]
[0m16:21:11.014414 [debug] [Thread-2 (]: Finished running node model.dbt_exercise.stg_orders_northwind
[0m16:21:11.014856 [debug] [Thread-2 (]: Began running node model.dbt_exercise.stg_suppliers_northwind
[0m16:21:11.015979 [info ] [Thread-2 (]: 9 of 15 START sql view model dbt_dw_staging.stg_suppliers_northwind ............ [RUN]
[0m16:21:11.016654 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_exercise.stg_orders_northwind, now model.dbt_exercise.stg_suppliers_northwind)
[0m16:21:11.017129 [debug] [Thread-2 (]: Began compiling node model.dbt_exercise.stg_suppliers_northwind
[0m16:21:11.020202 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_exercise.stg_suppliers_northwind"
[0m16:21:11.021049 [debug] [Thread-2 (]: Began executing node model.dbt_exercise.stg_suppliers_northwind
[0m16:21:11.024122 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_exercise.stg_suppliers_northwind"
[0m16:21:11.025195 [debug] [Thread-2 (]: On model.dbt_exercise.stg_suppliers_northwind: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "model.dbt_exercise.stg_suppliers_northwind"} */


  create or replace view `corded-sunlight-464012-e2`.`dbt_dw_staging`.`stg_suppliers_northwind`
  OPTIONS()
  as with suppliers as (
    select *
    from `corded-sunlight-464012-e2`.`dbt_dw_raw`.`suppliers`
)

select 
    cast(supplier_id as string) as supplier_id
    , cast(company_name as string) as company_name
    , cast(contact_name as string) as contact_name
    , cast(contact_title as string) as contact_title
    , cast(address as string) as address
    , cast(city as string) as city
    , cast(region as string) as region
    , cast(postal_code as string) as postal_code
    , cast(country as string) as country
    , cast(phone as string) as phone
    , cast(fax as string) as fax
    , cast(homepage as string) as home_page
from suppliers;


[0m16:21:11.025811 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:21:11.147808 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd31a8d98-bfc4-4be4-be4e-0e548436043c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71d0f041a780>]}
[0m16:21:11.148572 [info ] [Thread-4 (]: 7 of 15 OK created sql view model dbt_dw_staging.stg_products_northwind ........ [[32mCREATE VIEW (0 processed)[0m in 1.82s]
[0m16:21:11.149279 [debug] [Thread-4 (]: Finished running node model.dbt_exercise.stg_products_northwind
[0m16:21:11.149802 [debug] [Thread-4 (]: Began running node model.dbt_exercise.int_customers_northwind
[0m16:21:11.150727 [info ] [Thread-4 (]: 10 of 15 START sql view model dbt_dw_intermediate.int_customers_northwind ...... [RUN]
[0m16:21:11.151353 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.dbt_exercise.stg_products_northwind, now model.dbt_exercise.int_customers_northwind)
[0m16:21:11.151803 [debug] [Thread-4 (]: Began compiling node model.dbt_exercise.int_customers_northwind
[0m16:21:11.155007 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_exercise.int_customers_northwind"
[0m16:21:11.156416 [debug] [Thread-4 (]: Began executing node model.dbt_exercise.int_customers_northwind
[0m16:21:11.160193 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_exercise.int_customers_northwind"
[0m16:21:11.161393 [debug] [Thread-4 (]: On model.dbt_exercise.int_customers_northwind: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "model.dbt_exercise.int_customers_northwind"} */


  create or replace view `corded-sunlight-464012-e2`.`dbt_dw_intermediate`.`int_customers_northwind`
  OPTIONS()
  as with stg_customers_northwind as (
    select *
    from `corded-sunlight-464012-e2`.`dbt_dw_staging`.`stg_customers_northwind`
)

, final_table as (
    select 
        customer_id
        , company_name
        , contact_name
        , contact_title
        , address
        , city
        , region
        , country
        , case 
            when country in ('USA', 'Canada', 'Mexico') then 'North America'
            when country in ('UK', 'France', 'Germany', 'Austria', 'Belgium', 'Denmark', 'Ireland'
            , 'Finland', 'Italy', 'Norway', 'Poland', 'Portugal', 'Spain', 'Sweden', 'Switzerland') then 'Europe'
            when country in ('Brazil', 'Argentina', 'Venezuela') then 'South America'
            else 'Other'
        end as continent
    from stg_customers_northwind
)

select *
from final_table;


[0m16:21:11.161923 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:21:11.228648 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd31a8d98-bfc4-4be4-be4e-0e548436043c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71d0f28915b0>]}
[0m16:21:11.229591 [info ] [Thread-1 (]: 8 of 15 OK created sql view model dbt_dw_staging.stg_shippers_northwind ........ [[32mCREATE VIEW (0 processed)[0m in 1.90s]
[0m16:21:11.230299 [debug] [Thread-1 (]: Finished running node model.dbt_exercise.stg_shippers_northwind
[0m16:21:11.231666 [debug] [Thread-1 (]: Began running node model.dbt_exercise.int_employees_northwind
[0m16:21:11.232860 [info ] [Thread-1 (]: 11 of 15 START sql view model dbt_dw_intermediate.int_employees_northwind ...... [RUN]
[0m16:21:11.236729 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd31a8d98-bfc4-4be4-be4e-0e548436043c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71d0f040c1a0>]}
[0m16:21:11.237927 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_exercise.stg_shippers_northwind, now model.dbt_exercise.int_employees_northwind)
[0m16:21:11.239215 [info ] [Thread-3 (]: 5 of 15 OK created sql view model dbt_dw_staging.stg_order_details_northwind ... [[32mCREATE VIEW (0 processed)[0m in 1.91s]
[0m16:21:11.240087 [debug] [Thread-1 (]: Began compiling node model.dbt_exercise.int_employees_northwind
[0m16:21:11.240864 [debug] [Thread-3 (]: Finished running node model.dbt_exercise.stg_order_details_northwind
[0m16:21:11.244215 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_exercise.int_employees_northwind"
[0m16:21:11.245293 [debug] [Thread-3 (]: Began running node model.dbt_exercise.int_shippers_northwind
[0m16:21:11.247498 [info ] [Thread-3 (]: 12 of 15 START sql view model dbt_dw_intermediate.int_shippers_northwind ....... [RUN]
[0m16:21:11.248776 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_exercise.stg_order_details_northwind, now model.dbt_exercise.int_shippers_northwind)
[0m16:21:11.249927 [debug] [Thread-1 (]: Began executing node model.dbt_exercise.int_employees_northwind
[0m16:21:11.250610 [debug] [Thread-3 (]: Began compiling node model.dbt_exercise.int_shippers_northwind
[0m16:21:11.253479 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_exercise.int_employees_northwind"
[0m16:21:11.259477 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_exercise.int_shippers_northwind"
[0m16:21:11.261473 [debug] [Thread-1 (]: On model.dbt_exercise.int_employees_northwind: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "model.dbt_exercise.int_employees_northwind"} */


  create or replace view `corded-sunlight-464012-e2`.`dbt_dw_intermediate`.`int_employees_northwind`
  OPTIONS()
  as with employees as (
    select *
    from `corded-sunlight-464012-e2`.`dbt_dw_staging`.`stg_employees_northwind`
)

, max_fact_date as (
    select 
        case 
            when max(order_date) >= max(shipped_date) then max(order_date)
            else max(shipped_date)
        end as max_date
    from `corded-sunlight-464012-e2`.`dbt_dw_staging`.`stg_orders_northwind`
)

, final_table as (
    select
        employee_id
        , concat(first_name, ' ', last_name) as employee_name
        , title
        , birth_date
        , date_diff((select * from max_fact_date), birth_date, year) as age
        , hire_date
        , date_diff((select * from max_fact_date), hire_date, year) as years_hired
        , address
        , city
        , region
        , country
    from employees
)

select *
from final_table;


[0m16:21:11.262449 [debug] [Thread-3 (]: Began executing node model.dbt_exercise.int_shippers_northwind
[0m16:21:11.263245 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:21:11.266889 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_exercise.int_shippers_northwind"
[0m16:21:11.268857 [debug] [Thread-3 (]: On model.dbt_exercise.int_shippers_northwind: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "model.dbt_exercise.int_shippers_northwind"} */


  create or replace view `corded-sunlight-464012-e2`.`dbt_dw_intermediate`.`int_shippers_northwind`
  OPTIONS()
  as with stg_shippers_northwind as (
    select *
    from `corded-sunlight-464012-e2`.`dbt_dw_staging`.`stg_shippers_northwind`
)

, stg_orders_northwind as (
    select *
    from `corded-sunlight-464012-e2`.`dbt_dw_staging`.`stg_orders_northwind`
)

, transformed_table as (
    select
        concat(
            coalesce(stg_shippers_northwind.shipper_id, '')
            , '-'
            , coalesce(stg_shippers_northwind.company_name, '')
            , '-'
            , coalesce(stg_orders_northwind.ship_address, '')
        ) as ship_id
        , stg_shippers_northwind.shipper_id
        , stg_shippers_northwind.company_name
        , stg_orders_northwind.ship_address
        , stg_orders_northwind.ship_city
        , stg_orders_northwind.ship_region
        , stg_orders_northwind.ship_country
    from stg_shippers_northwind
    left join stg_orders_northwind
        on stg_shippers_northwind.shipper_id = stg_orders_northwind.ship_via
)

/* Aqui é feita a deduplicação da transformed_table */
, dedup_table as (
    select distinct *
    from transformed_table
)

, final_table as (
    select 
        *
        , case
            when dedup_table.ship_country in ('USA', 'Canada', 'Mexico') then 'North America'
            when dedup_table.ship_country in ('UK', 'France', 'Germany', 'Austria', 'Belgium', 
            'Denmark', 'Ireland', 'Finland', 'Italy', 'Norway', 'Poland', 'Portugal', 'Spain', 'Sweden', 'Switzerland') then 'Europe'
            when dedup_table.ship_country in ('Brazil', 'Argentina', 'Venezuela') then 'South America'
            else 'Other'
        end as ship_continent
    from dedup_table
)

select *
from final_table;


[0m16:21:11.269962 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:21:12.015914 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:0c9820f6-944b-4a9e-8b34-610682b65e9e&page=queryresults
[0m16:21:12.334890 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:2822d69d-e866-492c-a523-65722c21b910&page=queryresults
[0m16:21:12.521673 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:84abf679-2280-4098-a453-26bd43e0d55c&page=queryresults
[0m16:21:12.600109 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd31a8d98-bfc4-4be4-be4e-0e548436043c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71d0f04abfb0>]}
[0m16:21:12.601910 [info ] [Thread-2 (]: 9 of 15 OK created sql view model dbt_dw_staging.stg_suppliers_northwind ....... [[32mCREATE VIEW (0 processed)[0m in 1.58s]
[0m16:21:12.604363 [debug] [Thread-2 (]: Finished running node model.dbt_exercise.stg_suppliers_northwind
[0m16:21:12.605406 [debug] [Thread-2 (]: Began running node model.dbt_exercise.int_orders_northwind
[0m16:21:12.606893 [info ] [Thread-2 (]: 13 of 15 START sql view model dbt_dw_intermediate.int_orders_northwind ......... [RUN]
[0m16:21:12.607554 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_exercise.stg_suppliers_northwind, now model.dbt_exercise.int_orders_northwind)
[0m16:21:12.607980 [debug] [Thread-2 (]: Began compiling node model.dbt_exercise.int_orders_northwind
[0m16:21:12.612090 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_exercise.int_orders_northwind"
[0m16:21:12.612838 [debug] [Thread-2 (]: Began executing node model.dbt_exercise.int_orders_northwind
[0m16:21:12.615322 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_exercise.int_orders_northwind"
[0m16:21:12.616211 [debug] [Thread-2 (]: On model.dbt_exercise.int_orders_northwind: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "model.dbt_exercise.int_orders_northwind"} */


  create or replace view `corded-sunlight-464012-e2`.`dbt_dw_intermediate`.`int_orders_northwind`
  OPTIONS()
  as with stg_orders_northwind as (
    select *
    from `corded-sunlight-464012-e2`.`dbt_dw_staging`.`stg_orders_northwind`
)

, stg_order_details_northwind as (
    select *
    from `corded-sunlight-464012-e2`.`dbt_dw_staging`.`stg_order_details_northwind`
)

, stg_shippers_northwind as (
    select *
    from `corded-sunlight-464012-e2`.`dbt_dw_staging`.`stg_shippers_northwind`
)

, transformed_table as (    
    select
        stg_orders_northwind_northwind.order_id 
        , stg_orders_northwind_northwind.customer_id
        , stg_orders_northwind_northwind.employee_id
        , stg_orders_northwind_northwind.order_date
        , stg_orders_northwind.required_date
        , stg_orders_northwind.shipped_date
        , date_diff(stg_orders_northwind.shipped_date, stg_orders_northwind.order_date, day) as days_to_ship
        , concat(
            coalesce(stg_orders_northwind.ship_via, '')
            , '-'
            , coalesce(stg_shippers_northwind.company_name, '')
            , '-'
            , coalesce(stg_orders_northwind.ship_address, '')
        ) as ship_id
        , stg_orders_northwind.ship_via      
        , stg_shippers_northwind.company_name as shipper_name
        , sum(stg_order_details_northwind.unit_price * stg_order_details_northwind.quantity * (1 - stg_order_details_northwind.discount)) as total_order_amount
        , stg_orders_northwind.freight
        , stg_orders_northwind.ship_name
        , stg_orders_northwind.ship_address
        , stg_orders_northwind.ship_city
        , stg_orders_northwind.ship_region
        , stg_orders_northwind.ship_country
        , case
            when stg_orders_northwind.ship_country in ('USA', 'Canada', 'Mexico') then 'North America'
            when stg_orders_northwind.ship_country in ('UK', 'France', 'Germany', 'Austria', 'Belgium', 
            'Denmark', 'Ireland', 'Finland', 'Italy', 'Norway', 'Poland', 'Portugal', 'Spain', 'Sweden', 'Switzerland') then 'Europe'
            when stg_orders_northwind.ship_country in ('Brazil', 'Argentina', 'Venezuela') then 'South America'
            else 'Other'
        end as ship_continent
    from stg_orders_northwind
    left join stg_order_details_northwind
        on stg_orders_northwind.order_id = stg_order_details_northwind.order_id
    left join stg_shippers_northwind
        on stg_orders_northwind.ship_via = stg_shippers_northwind.shipper_id
    group by 
        stg_orders_northwind.order_id
        , stg_orders_northwind.customer_id
        , stg_orders_northwind.employee_id
        , stg_orders_northwind.order_date
        , stg_orders_northwind.required_date
        , stg_orders_northwind.shipped_date
        , stg_orders_northwind.ship_via
        , stg_shippers_northwind.company_name
        , stg_orders_northwind.freight
        , stg_orders_northwind.ship_name
        , stg_orders_northwind.ship_address
        , stg_orders_northwind.ship_city
        , stg_orders_northwind.ship_region
        , stg_orders_northwind.ship_country
)

, final_table as (
    select
        transformed_table.order_id
        , transformed_table.customer_id
        , transformed_table.employee_id
        , transformed_table.order_date
        , transformed_table.required_date
        , transformed_table.shipped_date
        , transformed_table.days_to_ship
        , transformed_table.ship_id
        , transformed_table.ship_via
        , transformed_table.shipper_name
        , transformed_table.total_order_amount
        , transformed_table.freight
        , transformed_table.ship_name
        , transformed_table.ship_address
        , transformed_table.ship_city
        , transformed_table.ship_region
        , transformed_table.ship_country
        , transformed_table.ship_continent
        , case 
            when transformed_table.days_to_ship is null then False
            else True
          end as is_shipped
    from transformed_table
)

select *
from final_table;


[0m16:21:12.616846 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:21:12.891784 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd31a8d98-bfc4-4be4-be4e-0e548436043c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71d0f04608c0>]}
[0m16:21:12.892641 [info ] [Thread-4 (]: 10 of 15 OK created sql view model dbt_dw_intermediate.int_customers_northwind . [[32mCREATE VIEW (0 processed)[0m in 1.74s]
[0m16:21:12.893480 [debug] [Thread-4 (]: Finished running node model.dbt_exercise.int_customers_northwind
[0m16:21:12.894100 [debug] [Thread-4 (]: Began running node model.dbt_exercise.int_products_northwind
[0m16:21:12.894854 [info ] [Thread-4 (]: 14 of 15 START sql view model dbt_dw_intermediate.int_products_northwind ....... [RUN]
[0m16:21:12.895490 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.dbt_exercise.int_customers_northwind, now model.dbt_exercise.int_products_northwind)
[0m16:21:12.896058 [debug] [Thread-4 (]: Began compiling node model.dbt_exercise.int_products_northwind
[0m16:21:12.900114 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_exercise.int_products_northwind"
[0m16:21:12.901140 [debug] [Thread-4 (]: Began executing node model.dbt_exercise.int_products_northwind
[0m16:21:12.904103 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_exercise.int_products_northwind"
[0m16:21:12.905297 [debug] [Thread-4 (]: On model.dbt_exercise.int_products_northwind: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "model.dbt_exercise.int_products_northwind"} */


  create or replace view `corded-sunlight-464012-e2`.`dbt_dw_intermediate`.`int_products_northwind`
  OPTIONS()
  as with stg_products_northwind as (
    select *
    from `corded-sunlight-464012-e2`.`dbt_dw_staging`.`stg_products_northwind`
)

, stg_categories_northwind as (
    select *
    from `corded-sunlight-464012-e2`.`dbt_dw_staging`.`stg_categories_northwind`
)

, stg_suppliers_northwind as (
    select *
    from `corded-sunlight-464012-e2`.`dbt_dw_staging`.`stg_suppliers_northwind`
)

, final_table as (
    select
        stg_products_northwind.product_id
        , stg_products_northwind.product_name
        , stg_products_northwind.quantity_per_unit
        , stg_categories_northwind.category_name
        , stg_suppliers_northwind.company_name as supplier_name
        , stg_suppliers_northwind.city as supplier_city
        , stg_suppliers_northwind.region as supplier_region
        , stg_suppliers_northwind.country as supplier_country
        , case
            when stg_suppliers_northwind.country in ('USA', 'Canada') then 'North America'
            when stg_suppliers_northwind.country in ('Brazil') then 'South America'
            when stg_suppliers_northwind.country in ('UK', 'Germany', 'Netherlands', 'Spain', 'France', 'Norway', 'Italy', 'Denmark', 'Sweden', 'Finland') then 'Europe'
            when stg_suppliers_northwind.country in ('Singapore', 'Japan') then 'Asia'
            when stg_suppliers_northwind.country in ('Australia') then 'Oceania'
            else 'Other'
          end as supplier_continent
        , case 
            when stg_products_northwind.discontinued = 1 then True
            else False
        end as is_discontinued
    from stg_products_northwind
    left join stg_categories_northwind
        on stg_products_northwind.category_id = stg_categories_northwind.category_id
    left join stg_suppliers_northwind
        on stg_products_northwind.supplier_id = stg_suppliers_northwind.supplier_id
)

select * 
from final_table;


[0m16:21:12.906045 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:21:13.266744 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd31a8d98-bfc4-4be4-be4e-0e548436043c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71d0f28ace60>]}
[0m16:21:13.267696 [info ] [Thread-3 (]: 12 of 15 OK created sql view model dbt_dw_intermediate.int_shippers_northwind .. [[32mCREATE VIEW (0 processed)[0m in 2.02s]
[0m16:21:13.268621 [debug] [Thread-3 (]: Finished running node model.dbt_exercise.int_shippers_northwind
[0m16:21:13.986174 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:535f5ef1-71ca-4765-a934-ad34d170f2ec&page=queryresults
[0m16:21:14.007345 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:b7663523-c63d-4aa0-9e60-217bd432bd2a&page=queryresults
[0m16:21:14.255714 [error] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:535f5ef1-71ca-4765-a934-ad34d170f2ec&page=queryresults
[0m16:21:14.258799 [error] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:b7663523-c63d-4aa0-9e60-217bd432bd2a&page=queryresults
[0m16:21:14.317469 [debug] [Thread-4 (]: Database Error in model int_products_northwind (models/intermediate/int_products_northwind.sql)
  No matching signature for operator = for argument types: STRING, INT64
    Signature: T1 = T1
      Unable to find common supertype for templated argument <T1>
        Input types for <T1>: {INT64, STRING} at [45:12]
  compiled code at target/run/dbt_exercise/models/intermediate/int_products_northwind.sql
[0m16:21:14.318938 [debug] [Thread-2 (]: Database Error in model int_orders_northwind (models/intermediate/int_orders_northwind.sql)
  Unrecognized name: stg_orders_northwind_northwind; Did you mean stg_order_details_northwind? at [23:9]
  compiled code at target/run/dbt_exercise/models/intermediate/int_orders_northwind.sql
[0m16:21:14.319869 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd31a8d98-bfc4-4be4-be4e-0e548436043c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71d0f0643e30>]}
[0m16:21:14.320740 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd31a8d98-bfc4-4be4-be4e-0e548436043c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71d0f2836cf0>]}
[0m16:21:14.321506 [error] [Thread-4 (]: 14 of 15 ERROR creating sql view model dbt_dw_intermediate.int_products_northwind  [[31mERROR[0m in 1.42s]
[0m16:21:14.322451 [error] [Thread-2 (]: 13 of 15 ERROR creating sql view model dbt_dw_intermediate.int_orders_northwind  [[31mERROR[0m in 1.71s]
[0m16:21:14.323417 [debug] [Thread-4 (]: Finished running node model.dbt_exercise.int_products_northwind
[0m16:21:14.324321 [debug] [Thread-2 (]: Finished running node model.dbt_exercise.int_orders_northwind
[0m16:21:14.326275 [debug] [Thread-7 (]: Marking all children of 'model.dbt_exercise.int_products_northwind' to be skipped because of status 'error'.  Reason: Database Error in model int_products_northwind (models/intermediate/int_products_northwind.sql)
  No matching signature for operator = for argument types: STRING, INT64
    Signature: T1 = T1
      Unable to find common supertype for templated argument <T1>
        Input types for <T1>: {INT64, STRING} at [45:12]
  compiled code at target/run/dbt_exercise/models/intermediate/int_products_northwind.sql.
[0m16:21:14.328666 [debug] [Thread-7 (]: Marking all children of 'model.dbt_exercise.int_orders_northwind' to be skipped because of status 'error'.  Reason: Database Error in model int_orders_northwind (models/intermediate/int_orders_northwind.sql)
  Unrecognized name: stg_orders_northwind_northwind; Did you mean stg_order_details_northwind? at [23:9]
  compiled code at target/run/dbt_exercise/models/intermediate/int_orders_northwind.sql.
[0m16:21:14.330187 [debug] [Thread-3 (]: Began running node model.dbt_exercise.dim_products
[0m16:21:14.330892 [info ] [Thread-3 (]: 15 of 15 SKIP relation dbt_dw_marts.dim_products ............................... [[33mSKIP[0m]
[0m16:21:14.331515 [debug] [Thread-3 (]: Finished running node model.dbt_exercise.dim_products
[0m16:22:13.360586 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:fe28c57f-085c-4474-9d8d-6e2bfa06056f&page=queryresults
[0m16:22:13.641499 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:fe28c57f-085c-4474-9d8d-6e2bfa06056f&page=queryresults
[0m16:22:13.681449 [debug] [Thread-1 (]: Database Error in model int_employees_northwind (models/intermediate/int_employees_northwind.sql)
  DATE_DIFF does not support the YEAR date part when the argument is TIMESTAMP type at [26:11]
  compiled code at target/run/dbt_exercise/models/intermediate/int_employees_northwind.sql
[0m16:22:13.682338 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd31a8d98-bfc4-4be4-be4e-0e548436043c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71d0f28ad400>]}
[0m16:22:13.683157 [error] [Thread-1 (]: 11 of 15 ERROR creating sql view model dbt_dw_intermediate.int_employees_northwind  [[31mERROR[0m in 62.44s]
[0m16:22:13.683824 [debug] [Thread-1 (]: Finished running node model.dbt_exercise.int_employees_northwind
[0m16:22:13.684752 [debug] [Thread-7 (]: Marking all children of 'model.dbt_exercise.int_employees_northwind' to be skipped because of status 'error'.  Reason: Database Error in model int_employees_northwind (models/intermediate/int_employees_northwind.sql)
  DATE_DIFF does not support the YEAR date part when the argument is TIMESTAMP type at [26:11]
  compiled code at target/run/dbt_exercise/models/intermediate/int_employees_northwind.sql.
[0m16:22:13.689216 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:22:13.696566 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:22:13.697406 [debug] [MainThread]: Connection 'model.dbt_exercise.int_shippers_northwind' was properly closed.
[0m16:22:13.698220 [debug] [MainThread]: Connection 'model.dbt_exercise.int_products_northwind' was properly closed.
[0m16:22:13.698520 [debug] [MainThread]: Connection 'model.dbt_exercise.int_orders_northwind' was properly closed.
[0m16:22:13.698783 [debug] [MainThread]: Connection 'model.dbt_exercise.int_employees_northwind' was properly closed.
[0m16:22:13.699346 [info ] [MainThread]: 
[0m16:22:13.699794 [info ] [MainThread]: Finished running 1 table model, 14 view models in 0 hours 1 minutes and 12.75 seconds (72.75s).
[0m16:22:13.702129 [debug] [MainThread]: Command end result
[0m16:22:13.750169 [debug] [MainThread]: Wrote artifact WritableManifest to /home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/target/manifest.json
[0m16:22:13.764875 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/target/semantic_manifest.json
[0m16:22:13.771915 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/target/run_results.json
[0m16:22:13.772450 [info ] [MainThread]: 
[0m16:22:13.772961 [info ] [MainThread]: [31mCompleted with 3 errors, 0 partial successes, and 0 warnings:[0m
[0m16:22:13.773372 [info ] [MainThread]: 
[0m16:22:13.773855 [error] [MainThread]: [31mFailure in model int_products_northwind (models/intermediate/int_products_northwind.sql)[0m
[0m16:22:13.774288 [error] [MainThread]:   Database Error in model int_products_northwind (models/intermediate/int_products_northwind.sql)
  No matching signature for operator = for argument types: STRING, INT64
    Signature: T1 = T1
      Unable to find common supertype for templated argument <T1>
        Input types for <T1>: {INT64, STRING} at [45:12]
  compiled code at target/run/dbt_exercise/models/intermediate/int_products_northwind.sql
[0m16:22:13.774672 [info ] [MainThread]: 
[0m16:22:13.775071 [info ] [MainThread]:   compiled code at target/compiled/dbt_exercise/models/intermediate/int_products_northwind.sql
[0m16:22:13.775433 [info ] [MainThread]: 
[0m16:22:13.775876 [error] [MainThread]: [31mFailure in model int_orders_northwind (models/intermediate/int_orders_northwind.sql)[0m
[0m16:22:13.776286 [error] [MainThread]:   Database Error in model int_orders_northwind (models/intermediate/int_orders_northwind.sql)
  Unrecognized name: stg_orders_northwind_northwind; Did you mean stg_order_details_northwind? at [23:9]
  compiled code at target/run/dbt_exercise/models/intermediate/int_orders_northwind.sql
[0m16:22:13.776648 [info ] [MainThread]: 
[0m16:22:13.777048 [info ] [MainThread]:   compiled code at target/compiled/dbt_exercise/models/intermediate/int_orders_northwind.sql
[0m16:22:13.777413 [info ] [MainThread]: 
[0m16:22:13.777875 [error] [MainThread]: [31mFailure in model int_employees_northwind (models/intermediate/int_employees_northwind.sql)[0m
[0m16:22:13.778398 [error] [MainThread]:   Database Error in model int_employees_northwind (models/intermediate/int_employees_northwind.sql)
  DATE_DIFF does not support the YEAR date part when the argument is TIMESTAMP type at [26:11]
  compiled code at target/run/dbt_exercise/models/intermediate/int_employees_northwind.sql
[0m16:22:13.778831 [info ] [MainThread]: 
[0m16:22:13.779239 [info ] [MainThread]:   compiled code at target/compiled/dbt_exercise/models/intermediate/int_employees_northwind.sql
[0m16:22:13.779699 [info ] [MainThread]: 
[0m16:22:13.780238 [info ] [MainThread]: Done. PASS=11 WARN=0 ERROR=3 SKIP=1 NO-OP=0 TOTAL=15
[0m16:22:13.781027 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- DuplicateYAMLKeysDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m16:22:13.785686 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 169.71072, "process_in_blocks": "122928", "process_kernel_time": 12.120844, "process_mem_max_rss": "368080", "process_out_blocks": "3904", "process_user_time": 11.31691}
[0m16:22:13.786484 [debug] [MainThread]: Command `dbt run` failed at 16:22:13.786359 after 169.71 seconds
[0m16:22:13.786886 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71d130613800>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71d0f2d03980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71d0f2d00fb0>]}
[0m16:22:13.787303 [debug] [MainThread]: Flushing usage events
[0m16:22:14.208136 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:25:10.067486 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7224b96078c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7224b9f22de0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7224b9f20d40>]}


============================== 16:25:10.087328 | 9fef3aba-8201-4e67-baad-c2730a2360f8 ==============================
[0m16:25:10.087328 [info ] [MainThread]: Running with dbt=1.10.2
[0m16:25:10.088017 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/logs', 'profiles_dir': '/home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'invocation_command': 'dbt run', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m16:25:51.826333 [warn ] [MainThread]: [[33mWARNING[0m][DuplicateYAMLKeysDeprecation]: Deprecated functionality
Duplicate key 'version' in "<unicode string>", line 4, column 1 in file
`/home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/dbt_project.yml`
[0m16:25:51.826983 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '9fef3aba-8201-4e67-baad-c2730a2360f8', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7224b8c6e4b0>]}
[0m16:25:52.426765 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9fef3aba-8201-4e67-baad-c2730a2360f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72247bcb3d40>]}
[0m16:25:52.479988 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9fef3aba-8201-4e67-baad-c2730a2360f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7224b8c4bf20>]}
[0m16:25:52.484196 [info ] [MainThread]: Registered adapter: bigquery=1.9.2
[0m16:26:32.489782 [debug] [MainThread]: checksum: 1adc40777973ef30f45f80b3b6d04d5013c1edd53d96363881b3b199e612468b, vars: {}, profile: , target: , version: 1.10.2
[0m16:26:37.062041 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:26:37.062543 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:26:37.110398 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9fef3aba-8201-4e67-baad-c2730a2360f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72247bc01ac0>]}
[0m16:26:37.372525 [debug] [MainThread]: Wrote artifact WritableManifest to /home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/target/manifest.json
[0m16:26:37.385552 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/target/semantic_manifest.json
[0m16:26:37.769528 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9fef3aba-8201-4e67-baad-c2730a2360f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72247bc3be30>]}
[0m16:26:37.770194 [info ] [MainThread]: Found 14 seeds, 36 data tests, 16 models, 14 sources, 609 macros
[0m16:26:37.770662 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9fef3aba-8201-4e67-baad-c2730a2360f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7224b8c99ca0>]}
[0m16:26:37.773131 [info ] [MainThread]: 
[0m16:26:37.773652 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:26:37.774115 [info ] [MainThread]: 
[0m16:26:37.774718 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m16:26:37.779955 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_corded-sunlight-464012-e2'
[0m16:26:37.781357 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_corded-sunlight-464012-e2'
[0m16:26:37.782701 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:26:37.783499 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_corded-sunlight-464012-e2'
[0m16:26:37.784913 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:26:37.786191 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:26:39.101479 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_corded-sunlight-464012-e2, now list_corded-sunlight-464012-e2_dbt_dw_marts)
[0m16:26:39.102871 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:26:39.103808 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_corded-sunlight-464012-e2, now list_corded-sunlight-464012-e2_dbt_dw_staging)
[0m16:26:39.105477 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_corded-sunlight-464012-e2, now list_corded-sunlight-464012-e2_dbt_dw_intermediate)
[0m16:26:39.107436 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_corded-sunlight-464012-e2_dbt_dw_raw'
[0m16:26:39.107884 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:26:39.108884 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:26:39.110074 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:26:40.028883 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9fef3aba-8201-4e67-baad-c2730a2360f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7224b9b4f050>]}
[0m16:26:40.029563 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:26:40.046854 [debug] [Thread-1 (]: Began running node model.dbt_exercise.stg_categories_northwind
[0m16:26:40.047483 [debug] [Thread-2 (]: Began running node model.dbt_exercise.stg_customers_northwind
[0m16:26:40.048543 [debug] [Thread-3 (]: Began running node model.dbt_exercise.stg_employee_territories
[0m16:26:40.048092 [info ] [Thread-1 (]: 1 of 15 START sql view model dbt_dw_staging.stg_categories_northwind ........... [RUN]
[0m16:26:40.049580 [debug] [Thread-4 (]: Began running node model.dbt_exercise.stg_employees_northwind
[0m16:26:40.050507 [info ] [Thread-2 (]: 2 of 15 START sql view model dbt_dw_staging.stg_customers_northwind ............ [RUN]
[0m16:26:40.051611 [info ] [Thread-3 (]: 3 of 15 START sql view model dbt_dw_staging.stg_employee_territories ........... [RUN]
[0m16:26:40.052525 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_corded-sunlight-464012-e2_dbt_dw_raw, now model.dbt_exercise.stg_categories_northwind)
[0m16:26:40.053948 [info ] [Thread-4 (]: 4 of 15 START sql view model dbt_dw_staging.stg_employees_northwind ............ [RUN]
[0m16:26:40.055115 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_corded-sunlight-464012-e2_dbt_dw_marts, now model.dbt_exercise.stg_customers_northwind)
[0m16:26:40.056018 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_corded-sunlight-464012-e2_dbt_dw_intermediate, now model.dbt_exercise.stg_employee_territories)
[0m16:26:40.056762 [debug] [Thread-1 (]: Began compiling node model.dbt_exercise.stg_categories_northwind
[0m16:26:40.057487 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly list_corded-sunlight-464012-e2_dbt_dw_staging, now model.dbt_exercise.stg_employees_northwind)
[0m16:26:40.058303 [debug] [Thread-2 (]: Began compiling node model.dbt_exercise.stg_customers_northwind
[0m16:26:40.058982 [debug] [Thread-3 (]: Began compiling node model.dbt_exercise.stg_employee_territories
[0m16:26:40.068092 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_exercise.stg_categories_northwind"
[0m16:26:40.069040 [debug] [Thread-4 (]: Began compiling node model.dbt_exercise.stg_employees_northwind
[0m16:26:40.073226 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_exercise.stg_customers_northwind"
[0m16:26:40.077426 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_exercise.stg_employee_territories"
[0m16:26:40.082750 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_exercise.stg_employees_northwind"
[0m16:26:40.084437 [debug] [Thread-1 (]: Began executing node model.dbt_exercise.stg_categories_northwind
[0m16:26:40.086218 [debug] [Thread-2 (]: Began executing node model.dbt_exercise.stg_customers_northwind
[0m16:26:40.098515 [debug] [Thread-4 (]: Began executing node model.dbt_exercise.stg_employees_northwind
[0m16:26:40.108819 [debug] [Thread-3 (]: Began executing node model.dbt_exercise.stg_employee_territories
[0m16:26:40.123665 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_exercise.stg_categories_northwind"
[0m16:26:40.126973 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_exercise.stg_customers_northwind"
[0m16:26:40.130760 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_exercise.stg_employees_northwind"
[0m16:26:40.134192 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_exercise.stg_employee_territories"
[0m16:26:40.136635 [debug] [Thread-1 (]: On model.dbt_exercise.stg_categories_northwind: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "model.dbt_exercise.stg_categories_northwind"} */


  create or replace view `corded-sunlight-464012-e2`.`dbt_dw_staging`.`stg_categories_northwind`
  OPTIONS()
  as with raw_categories as (
    select *
    from `corded-sunlight-464012-e2`.`dbt_dw_raw`.`categories`
)

/* Ao construir a staging não vamos trazer a coluna picture, pois ela não traz informação relevante */
, stg_categories_northwind as (
    select
        cast(category_id as string) as category_id
        , cast(category_name as string) as category_name
        , cast(description as string) as description
    from raw_categories
)

select *
from raw_categories;


[0m16:26:40.137419 [debug] [Thread-2 (]: On model.dbt_exercise.stg_customers_northwind: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "model.dbt_exercise.stg_customers_northwind"} */


  create or replace view `corded-sunlight-464012-e2`.`dbt_dw_staging`.`stg_customers_northwind`
  OPTIONS()
  as with raw_customers as (
    select *
    from `corded-sunlight-464012-e2`.`dbt_dw_raw`.`customers`
)

, stg_customers_northwind as (
    select
        cast(customer_id as string) as customer_id
        , cast(company_name as string) as company_name
        , cast(contact_name as string) as contact_name
        , cast(contact_title as string) as contact_title
        , cast(address as string) as address
        , cast(city as string) as city
        , cast(region as string) as region
        , cast(postal_code as string) as postal_code
        , cast(country as string) as country
        , cast(phone as string) as phone
        , cast(fax as string) as fax
    from raw_customers
)

select *
from stg_customers_northwind;


[0m16:26:40.138303 [debug] [Thread-4 (]: On model.dbt_exercise.stg_employees_northwind: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "model.dbt_exercise.stg_employees_northwind"} */


  create or replace view `corded-sunlight-464012-e2`.`dbt_dw_staging`.`stg_employees_northwind`
  OPTIONS()
  as with raw_employees as (
    select *
    from `corded-sunlight-464012-e2`.`dbt_dw_raw`.`employees`
)

/* Os campos photo, notes e reports_to e photo_path não são carregadas na staging */

, stg_employees_northwind as (
    select
        cast(employee_id as string) as employee_id
        , cast(first_name as string) as first_name
        , cast(last_name as string) as last_name
        , cast(title as string) as title
        , cast(title_of_courtesy as string) as title_of_courtesy
        , cast(birth_date as date) as birth_date
        , cast(hire_date as date) as hire_date
        , cast(address as string) as address
        , cast(city as string) as city
        , cast(region as string) as region
        , cast(postal_code as string) as postal_code
        , cast(country as string) as country
        , cast(home_phone as string) as home_phone
        , cast(extension as string) as extension
    from raw_employees
)

select *
from stg_employees_northwind;


[0m16:26:40.139437 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:26:40.140011 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:26:40.140744 [debug] [Thread-3 (]: On model.dbt_exercise.stg_employee_territories: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "model.dbt_exercise.stg_employee_territories"} */


  create or replace view `corded-sunlight-464012-e2`.`dbt_dw_staging`.`stg_employee_territories`
  OPTIONS()
  as with raw_employee_territories as (
    select *
    from `corded-sunlight-464012-e2`.`dbt_dw_raw`.`employee_territories`
)

, stg_employee_territories as (
    select
        cast(employee_id as string) as employee_id
        , cast(territory_id as string) as territory_id
    from raw_employee_territories
)

select *
from stg_employee_territories;


[0m16:26:40.141614 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:26:40.143154 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:26:41.233407 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:c9a67c4f-912c-4fb2-8913-efaaadececf0&page=queryresults
[0m16:26:41.256205 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:49f3bf92-d6bf-416c-98bd-1ce7b48abb38&page=queryresults
[0m16:26:41.273277 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:d7e503c5-d5a7-40bf-a7ac-bf2c8533c142&page=queryresults
[0m16:26:41.276233 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:38600f5c-e8b3-4369-8340-9dc01d6e97e2&page=queryresults
[0m16:26:45.699539 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9fef3aba-8201-4e67-baad-c2730a2360f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72247b6871d0>]}
[0m16:26:45.700026 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9fef3aba-8201-4e67-baad-c2730a2360f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72247b53f9b0>]}
[0m16:26:45.700513 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9fef3aba-8201-4e67-baad-c2730a2360f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72247840f770>]}
[0m16:26:45.702127 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9fef3aba-8201-4e67-baad-c2730a2360f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72247b53f470>]}
[0m16:26:45.701317 [info ] [Thread-2 (]: 2 of 15 OK created sql view model dbt_dw_staging.stg_customers_northwind ....... [[32mCREATE VIEW (0 processed)[0m in 5.63s]
[0m16:26:45.703330 [info ] [Thread-1 (]: 1 of 15 OK created sql view model dbt_dw_staging.stg_categories_northwind ...... [[32mCREATE VIEW (0 processed)[0m in 5.64s]
[0m16:26:45.704589 [info ] [Thread-3 (]: 3 of 15 OK created sql view model dbt_dw_staging.stg_employee_territories ...... [[32mCREATE VIEW (0 processed)[0m in 5.63s]
[0m16:26:45.705975 [info ] [Thread-4 (]: 4 of 15 OK created sql view model dbt_dw_staging.stg_employees_northwind ....... [[32mCREATE VIEW (0 processed)[0m in 5.63s]
[0m16:26:45.707130 [debug] [Thread-2 (]: Finished running node model.dbt_exercise.stg_customers_northwind
[0m16:26:45.707785 [debug] [Thread-1 (]: Finished running node model.dbt_exercise.stg_categories_northwind
[0m16:26:45.708975 [debug] [Thread-3 (]: Finished running node model.dbt_exercise.stg_employee_territories
[0m16:26:45.710137 [debug] [Thread-4 (]: Finished running node model.dbt_exercise.stg_employees_northwind
[0m16:26:45.710993 [debug] [Thread-2 (]: Began running node model.dbt_exercise.stg_order_details_northwind
[0m16:26:45.711710 [debug] [Thread-1 (]: Began running node model.dbt_exercise.stg_orders_northwind
[0m16:26:45.713277 [debug] [Thread-3 (]: Began running node model.dbt_exercise.stg_products_northwind
[0m16:26:45.714543 [debug] [Thread-4 (]: Began running node model.dbt_exercise.stg_shippers_northwind
[0m16:26:45.715751 [info ] [Thread-2 (]: 5 of 15 START sql view model dbt_dw_staging.stg_order_details_northwind ........ [RUN]
[0m16:26:45.716724 [info ] [Thread-1 (]: 6 of 15 START sql view model dbt_dw_staging.stg_orders_northwind ............... [RUN]
[0m16:26:45.718215 [info ] [Thread-3 (]: 7 of 15 START sql view model dbt_dw_staging.stg_products_northwind ............. [RUN]
[0m16:26:45.719647 [info ] [Thread-4 (]: 8 of 15 START sql view model dbt_dw_staging.stg_shippers_northwind ............. [RUN]
[0m16:26:45.720712 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_exercise.stg_customers_northwind, now model.dbt_exercise.stg_order_details_northwind)
[0m16:26:45.721498 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_exercise.stg_categories_northwind, now model.dbt_exercise.stg_orders_northwind)
[0m16:26:45.722575 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_exercise.stg_employee_territories, now model.dbt_exercise.stg_products_northwind)
[0m16:26:45.723458 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.dbt_exercise.stg_employees_northwind, now model.dbt_exercise.stg_shippers_northwind)
[0m16:26:45.724250 [debug] [Thread-2 (]: Began compiling node model.dbt_exercise.stg_order_details_northwind
[0m16:26:45.725079 [debug] [Thread-1 (]: Began compiling node model.dbt_exercise.stg_orders_northwind
[0m16:26:45.725980 [debug] [Thread-3 (]: Began compiling node model.dbt_exercise.stg_products_northwind
[0m16:26:45.726815 [debug] [Thread-4 (]: Began compiling node model.dbt_exercise.stg_shippers_northwind
[0m16:26:45.730577 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_exercise.stg_order_details_northwind"
[0m16:26:45.733459 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_exercise.stg_orders_northwind"
[0m16:26:45.736485 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_exercise.stg_products_northwind"
[0m16:26:45.740447 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_exercise.stg_shippers_northwind"
[0m16:26:45.743764 [debug] [Thread-4 (]: Began executing node model.dbt_exercise.stg_shippers_northwind
[0m16:26:45.745259 [debug] [Thread-1 (]: Began executing node model.dbt_exercise.stg_orders_northwind
[0m16:26:45.746368 [debug] [Thread-2 (]: Began executing node model.dbt_exercise.stg_order_details_northwind
[0m16:26:45.747358 [debug] [Thread-3 (]: Began executing node model.dbt_exercise.stg_products_northwind
[0m16:26:45.753652 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_exercise.stg_shippers_northwind"
[0m16:26:45.758263 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_exercise.stg_orders_northwind"
[0m16:26:45.761133 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_exercise.stg_order_details_northwind"
[0m16:26:45.763745 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_exercise.stg_products_northwind"
[0m16:26:45.765264 [debug] [Thread-4 (]: On model.dbt_exercise.stg_shippers_northwind: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "model.dbt_exercise.stg_shippers_northwind"} */


  create or replace view `corded-sunlight-464012-e2`.`dbt_dw_staging`.`stg_shippers_northwind`
  OPTIONS()
  as with raw_shippers as (
    select *
    from `corded-sunlight-464012-e2`.`dbt_dw_raw`.`shippers`
)

, stg_shippers_northwind as (
    select
        cast(shipper_id as string) as shipper_id
        , cast(company_name as string) as company_name
        , cast(phone as string) as phone
    from raw_shippers
)

select *
from stg_shippers_northwind;


[0m16:26:45.768643 [debug] [Thread-1 (]: On model.dbt_exercise.stg_orders_northwind: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "model.dbt_exercise.stg_orders_northwind"} */


  create or replace view `corded-sunlight-464012-e2`.`dbt_dw_staging`.`stg_orders_northwind`
  OPTIONS()
  as with raw_orders as (
    select *
    from `corded-sunlight-464012-e2`.`dbt_dw_raw`.`orders`
)

, stg_orders_northwind as (
    select
        cast(order_id as string) as order_id
        , cast(customer_id as string) as customer_id
        , cast(employee_id as string) as employee_id
        , cast(order_date as timestamp) as order_date
        , cast(required_date as timestamp) as required_date
        , cast(shipped_date as timestamp) as shipped_date
        , cast(ship_via as string) as ship_via
        , cast(freight as numeric) as freight
        , cast(ship_name as string) as ship_name
        , cast(ship_address as string) as ship_address
        , cast(ship_city as string) as ship_city
        , cast(ship_region as string) as ship_region
        , cast(ship_postal_code as string) as ship_postal_code
        , cast(ship_country as string) as ship_country
    from raw_orders
)

select *
from stg_orders_northwind;


[0m16:26:45.769422 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:26:45.770182 [debug] [Thread-2 (]: On model.dbt_exercise.stg_order_details_northwind: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "model.dbt_exercise.stg_order_details_northwind"} */


  create or replace view `corded-sunlight-464012-e2`.`dbt_dw_staging`.`stg_order_details_northwind`
  OPTIONS()
  as with raw_order_details as (
    select *
    from `corded-sunlight-464012-e2`.`dbt_dw_raw`.`order_details`
)

, stg_order_details_northwind as (
    select
        cast(order_id as string) as order_id
        , cast(product_id as string) as product_id
        , cast(unit_price as numeric) as unit_price
        , cast(quantity as integer) as quantity
        , cast(discount as numeric) as discount
    from raw_order_details
)

select *
from stg_order_details_northwind;


[0m16:26:45.770955 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:26:45.772375 [debug] [Thread-3 (]: On model.dbt_exercise.stg_products_northwind: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "model.dbt_exercise.stg_products_northwind"} */


  create or replace view `corded-sunlight-464012-e2`.`dbt_dw_staging`.`stg_products_northwind`
  OPTIONS()
  as with raw_products as (
    select *
    from `corded-sunlight-464012-e2`.`dbt_dw_raw`.`products`
)

, stg_products_northwind as (
    select
        cast(product_id as string) as product_id
        , cast(product_name as string) as product_name
        , cast(supplier_id as string) as supplier_id
        , cast(category_id as string) as category_id
        , cast(quantity_per_unit as string) as quantity_per_unit
        , cast(unit_price as numeric) as unit_price
        , cast(units_in_stock as numeric) as units_in_stock
        , cast(units_on_order as numeric) as units_on_order
        , cast(reorder_level as numeric) as reorder_level
        , cast(discontinued as integer) as discontinued
    from raw_products
)

select *
from stg_products_northwind;


[0m16:26:45.774325 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:26:45.775514 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:26:46.872969 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:81b3495b-eab1-46c4-9a4c-e9dd8427eb57&page=queryresults
[0m16:26:46.875610 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:d5786750-d2c1-4df9-910a-3022e473231b&page=queryresults
[0m16:26:46.878541 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:de6f0fe4-701a-4df6-8199-74cf8de3e19f&page=queryresults
[0m16:26:46.882738 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:d06e8257-10a7-45c4-9d31-09efba42dded&page=queryresults
[0m16:26:47.439867 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9fef3aba-8201-4e67-baad-c2730a2360f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72247b660e60>]}
[0m16:26:47.440782 [info ] [Thread-4 (]: 8 of 15 OK created sql view model dbt_dw_staging.stg_shippers_northwind ........ [[32mCREATE VIEW (0 processed)[0m in 1.72s]
[0m16:26:47.445172 [debug] [Thread-4 (]: Finished running node model.dbt_exercise.stg_shippers_northwind
[0m16:26:47.448299 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9fef3aba-8201-4e67-baad-c2730a2360f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7224782af3b0>]}
[0m16:26:47.449118 [debug] [Thread-4 (]: Began running node model.dbt_exercise.stg_suppliers_northwind
[0m16:26:47.453824 [info ] [Thread-1 (]: 6 of 15 OK created sql view model dbt_dw_staging.stg_orders_northwind .......... [[32mCREATE VIEW (0 processed)[0m in 1.73s]
[0m16:26:47.455288 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9fef3aba-8201-4e67-baad-c2730a2360f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7224782b4c80>]}
[0m16:26:47.456173 [info ] [Thread-4 (]: 9 of 15 START sql view model dbt_dw_staging.stg_suppliers_northwind ............ [RUN]
[0m16:26:47.457442 [debug] [Thread-1 (]: Finished running node model.dbt_exercise.stg_orders_northwind
[0m16:26:47.458585 [info ] [Thread-3 (]: 7 of 15 OK created sql view model dbt_dw_staging.stg_products_northwind ........ [[32mCREATE VIEW (0 processed)[0m in 1.73s]
[0m16:26:47.459940 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.dbt_exercise.stg_shippers_northwind, now model.dbt_exercise.stg_suppliers_northwind)
[0m16:26:47.460903 [debug] [Thread-1 (]: Began running node model.dbt_exercise.int_customers_northwind
[0m16:26:47.462659 [debug] [Thread-3 (]: Finished running node model.dbt_exercise.stg_products_northwind
[0m16:26:47.463803 [debug] [Thread-4 (]: Began compiling node model.dbt_exercise.stg_suppliers_northwind
[0m16:26:47.464939 [info ] [Thread-1 (]: 10 of 15 START sql view model dbt_dw_intermediate.int_customers_northwind ...... [RUN]
[0m16:26:47.466179 [debug] [Thread-3 (]: Began running node model.dbt_exercise.int_employees_northwind
[0m16:26:47.469934 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_exercise.stg_suppliers_northwind"
[0m16:26:47.470976 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_exercise.stg_orders_northwind, now model.dbt_exercise.int_customers_northwind)
[0m16:26:47.472560 [info ] [Thread-3 (]: 11 of 15 START sql view model dbt_dw_intermediate.int_employees_northwind ...... [RUN]
[0m16:26:47.473609 [debug] [Thread-1 (]: Began compiling node model.dbt_exercise.int_customers_northwind
[0m16:26:47.474360 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_exercise.stg_products_northwind, now model.dbt_exercise.int_employees_northwind)
[0m16:26:47.475012 [debug] [Thread-4 (]: Began executing node model.dbt_exercise.stg_suppliers_northwind
[0m16:26:47.478474 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_exercise.int_customers_northwind"
[0m16:26:47.482332 [debug] [Thread-3 (]: Began compiling node model.dbt_exercise.int_employees_northwind
[0m16:26:47.483649 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9fef3aba-8201-4e67-baad-c2730a2360f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7224782afb00>]}
[0m16:26:47.487386 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_exercise.stg_suppliers_northwind"
[0m16:26:47.492072 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_exercise.int_employees_northwind"
[0m16:26:47.493237 [info ] [Thread-2 (]: 5 of 15 OK created sql view model dbt_dw_staging.stg_order_details_northwind ... [[32mCREATE VIEW (0 processed)[0m in 1.76s]
[0m16:26:47.494171 [debug] [Thread-1 (]: Began executing node model.dbt_exercise.int_customers_northwind
[0m16:26:47.495480 [debug] [Thread-2 (]: Finished running node model.dbt_exercise.stg_order_details_northwind
[0m16:26:47.495998 [debug] [Thread-4 (]: On model.dbt_exercise.stg_suppliers_northwind: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "model.dbt_exercise.stg_suppliers_northwind"} */


  create or replace view `corded-sunlight-464012-e2`.`dbt_dw_staging`.`stg_suppliers_northwind`
  OPTIONS()
  as with suppliers as (
    select *
    from `corded-sunlight-464012-e2`.`dbt_dw_raw`.`suppliers`
)

select 
    cast(supplier_id as string) as supplier_id
    , cast(company_name as string) as company_name
    , cast(contact_name as string) as contact_name
    , cast(contact_title as string) as contact_title
    , cast(address as string) as address
    , cast(city as string) as city
    , cast(region as string) as region
    , cast(postal_code as string) as postal_code
    , cast(country as string) as country
    , cast(phone as string) as phone
    , cast(fax as string) as fax
    , cast(homepage as string) as home_page
from suppliers;


[0m16:26:47.500442 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_exercise.int_customers_northwind"
[0m16:26:47.501260 [debug] [Thread-3 (]: Began executing node model.dbt_exercise.int_employees_northwind
[0m16:26:47.502362 [debug] [Thread-2 (]: Began running node model.dbt_exercise.int_shippers_northwind
[0m16:26:47.504287 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:26:47.508380 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_exercise.int_employees_northwind"
[0m16:26:47.510775 [debug] [Thread-1 (]: On model.dbt_exercise.int_customers_northwind: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "model.dbt_exercise.int_customers_northwind"} */


  create or replace view `corded-sunlight-464012-e2`.`dbt_dw_intermediate`.`int_customers_northwind`
  OPTIONS()
  as with stg_customers_northwind as (
    select *
    from `corded-sunlight-464012-e2`.`dbt_dw_staging`.`stg_customers_northwind`
)

, final_table as (
    select 
        customer_id
        , company_name
        , contact_name
        , contact_title
        , address
        , city
        , region
        , country
        , case 
            when country in ('USA', 'Canada', 'Mexico') then 'North America'
            when country in ('UK', 'France', 'Germany', 'Austria', 'Belgium', 'Denmark', 'Ireland'
            , 'Finland', 'Italy', 'Norway', 'Poland', 'Portugal', 'Spain', 'Sweden', 'Switzerland') then 'Europe'
            when country in ('Brazil', 'Argentina', 'Venezuela') then 'South America'
            else 'Other'
        end as continent
    from stg_customers_northwind
)

select *
from final_table;


[0m16:26:47.509518 [info ] [Thread-2 (]: 12 of 15 START sql view model dbt_dw_intermediate.int_shippers_northwind ....... [RUN]
[0m16:26:47.512258 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:26:47.513103 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_exercise.stg_order_details_northwind, now model.dbt_exercise.int_shippers_northwind)
[0m16:26:47.513821 [debug] [Thread-3 (]: On model.dbt_exercise.int_employees_northwind: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "model.dbt_exercise.int_employees_northwind"} */


  create or replace view `corded-sunlight-464012-e2`.`dbt_dw_intermediate`.`int_employees_northwind`
  OPTIONS()
  as with employees as (
    select *
    from `corded-sunlight-464012-e2`.`dbt_dw_staging`.`stg_employees_northwind`
)

, max_fact_date as (
    select 
        case 
            when max(order_date) >= max(shipped_date) then max(order_date)
            else max(shipped_date)
        end as max_date
    from `corded-sunlight-464012-e2`.`dbt_dw_staging`.`stg_orders_northwind`
)

, final_table as (
    select
        employee_id
        , concat(first_name, ' ', last_name) as employee_name
        , title
        , birth_date
        , date_diff((select * from max_fact_date), birth_date, year) as age
        , hire_date
        , date_diff((select * from max_fact_date), hire_date, year) as years_hired
        , address
        , city
        , region
        , country
    from employees
)

select *
from final_table;


[0m16:26:47.514928 [debug] [Thread-2 (]: Began compiling node model.dbt_exercise.int_shippers_northwind
[0m16:26:47.516105 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:26:47.519963 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_exercise.int_shippers_northwind"
[0m16:26:47.573661 [debug] [Thread-2 (]: Began executing node model.dbt_exercise.int_shippers_northwind
[0m16:26:47.576508 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_exercise.int_shippers_northwind"
[0m16:26:47.579883 [debug] [Thread-2 (]: On model.dbt_exercise.int_shippers_northwind: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "model.dbt_exercise.int_shippers_northwind"} */


  create or replace view `corded-sunlight-464012-e2`.`dbt_dw_intermediate`.`int_shippers_northwind`
  OPTIONS()
  as with stg_shippers_northwind as (
    select *
    from `corded-sunlight-464012-e2`.`dbt_dw_staging`.`stg_shippers_northwind`
)

, stg_orders_northwind as (
    select *
    from `corded-sunlight-464012-e2`.`dbt_dw_staging`.`stg_orders_northwind`
)

, transformed_table as (
    select
        concat(
            coalesce(stg_shippers_northwind.shipper_id, '')
            , '-'
            , coalesce(stg_shippers_northwind.company_name, '')
            , '-'
            , coalesce(stg_orders_northwind.ship_address, '')
        ) as ship_id
        , stg_shippers_northwind.shipper_id
        , stg_shippers_northwind.company_name
        , stg_orders_northwind.ship_address
        , stg_orders_northwind.ship_city
        , stg_orders_northwind.ship_region
        , stg_orders_northwind.ship_country
    from stg_shippers_northwind
    left join stg_orders_northwind
        on stg_shippers_northwind.shipper_id = stg_orders_northwind.ship_via
)

/* Aqui é feita a deduplicação da transformed_table */
, dedup_table as (
    select distinct *
    from transformed_table
)

, final_table as (
    select 
        *
        , case
            when dedup_table.ship_country in ('USA', 'Canada', 'Mexico') then 'North America'
            when dedup_table.ship_country in ('UK', 'France', 'Germany', 'Austria', 'Belgium', 
            'Denmark', 'Ireland', 'Finland', 'Italy', 'Norway', 'Poland', 'Portugal', 'Spain', 'Sweden', 'Switzerland') then 'Europe'
            when dedup_table.ship_country in ('Brazil', 'Argentina', 'Venezuela') then 'South America'
            else 'Other'
        end as ship_continent
    from dedup_table
)

select *
from final_table;


[0m16:26:47.603674 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:26:48.526646 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:edd1093c-cd28-4d8d-b476-260cd71eb1ac&page=queryresults
[0m16:26:48.558345 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:78a8a369-64d1-4b63-907b-bf9668167f4a&page=queryresults
[0m16:26:48.657705 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:df27b581-845d-4f04-ac0e-1c78ac7fe0d5&page=queryresults
[0m16:26:48.697308 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:65a5a0c6-5c09-4cea-ac34-977828d766a6&page=queryresults
[0m16:26:48.927775 [error] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:df27b581-845d-4f04-ac0e-1c78ac7fe0d5&page=queryresults
[0m16:26:49.019334 [debug] [Thread-3 (]: Database Error in model int_employees_northwind (models/intermediate/int_employees_northwind.sql)
  DATE_DIFF does not support the YEAR date part when the argument is TIMESTAMP type at [26:11]
  compiled code at target/run/dbt_exercise/models/intermediate/int_employees_northwind.sql
[0m16:26:49.020138 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9fef3aba-8201-4e67-baad-c2730a2360f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72247837d040>]}
[0m16:26:49.020824 [error] [Thread-3 (]: 11 of 15 ERROR creating sql view model dbt_dw_intermediate.int_employees_northwind  [[31mERROR[0m in 1.55s]
[0m16:26:49.021496 [debug] [Thread-3 (]: Finished running node model.dbt_exercise.int_employees_northwind
[0m16:26:49.021977 [debug] [Thread-3 (]: Began running node model.dbt_exercise.int_orders_northwind
[0m16:26:49.022855 [debug] [Thread-7 (]: Marking all children of 'model.dbt_exercise.int_employees_northwind' to be skipped because of status 'error'.  Reason: Database Error in model int_employees_northwind (models/intermediate/int_employees_northwind.sql)
  DATE_DIFF does not support the YEAR date part when the argument is TIMESTAMP type at [26:11]
  compiled code at target/run/dbt_exercise/models/intermediate/int_employees_northwind.sql.
[0m16:26:49.023448 [info ] [Thread-3 (]: 13 of 15 START sql view model dbt_dw_intermediate.int_orders_northwind ......... [RUN]
[0m16:26:49.026176 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_exercise.int_employees_northwind, now model.dbt_exercise.int_orders_northwind)
[0m16:26:49.026742 [debug] [Thread-3 (]: Began compiling node model.dbt_exercise.int_orders_northwind
[0m16:26:49.030547 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_exercise.int_orders_northwind"
[0m16:26:49.031361 [debug] [Thread-3 (]: Began executing node model.dbt_exercise.int_orders_northwind
[0m16:26:49.033810 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_exercise.int_orders_northwind"
[0m16:26:49.034711 [debug] [Thread-3 (]: On model.dbt_exercise.int_orders_northwind: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "model.dbt_exercise.int_orders_northwind"} */


  create or replace view `corded-sunlight-464012-e2`.`dbt_dw_intermediate`.`int_orders_northwind`
  OPTIONS()
  as with stg_orders_northwind as (
    select *
    from `corded-sunlight-464012-e2`.`dbt_dw_staging`.`stg_orders_northwind`
)

, stg_order_details_northwind as (
    select *
    from `corded-sunlight-464012-e2`.`dbt_dw_staging`.`stg_order_details_northwind`
)

, stg_shippers_northwind as (
    select *
    from `corded-sunlight-464012-e2`.`dbt_dw_staging`.`stg_shippers_northwind`
)

, transformed_table as (    
    select
        stg_orders_northwind.order_id 
        , stg_orders_northwind.customer_id
        , stg_orders_northwind.employee_id
        , stg_orders_northwind.order_date
        , stg_orders_northwind.required_date
        , stg_orders_northwind.shipped_date
        , date_diff(stg_orders_northwind.shipped_date, stg_orders_northwind.order_date, day) as days_to_ship
        , concat(
            coalesce(stg_orders_northwind.ship_via, '')
            , '-'
            , coalesce(stg_shippers_northwind.company_name, '')
            , '-'
            , coalesce(stg_orders_northwind.ship_address, '')
        ) as ship_id
        , stg_orders_northwind.ship_via      
        , stg_shippers_northwind.company_name as shipper_name
        , sum(stg_order_details_northwind.unit_price * stg_order_details_northwind.quantity * (1 - stg_order_details_northwind.discount)) as total_order_amount
        , stg_orders_northwind.freight
        , stg_orders_northwind.ship_name
        , stg_orders_northwind.ship_address
        , stg_orders_northwind.ship_city
        , stg_orders_northwind.ship_region
        , stg_orders_northwind.ship_country
        , case
            when stg_orders_northwind.ship_country in ('USA', 'Canada', 'Mexico') then 'North America'
            when stg_orders_northwind.ship_country in ('UK', 'France', 'Germany', 'Austria', 'Belgium', 
            'Denmark', 'Ireland', 'Finland', 'Italy', 'Norway', 'Poland', 'Portugal', 'Spain', 'Sweden', 'Switzerland') then 'Europe'
            when stg_orders_northwind.ship_country in ('Brazil', 'Argentina', 'Venezuela') then 'South America'
            else 'Other'
        end as ship_continent
    from stg_orders_northwind
    left join stg_order_details_northwind
        on stg_orders_northwind.order_id = stg_order_details_northwind.order_id
    left join stg_shippers_northwind
        on stg_orders_northwind.ship_via = stg_shippers_northwind.shipper_id
    group by 
        stg_orders_northwind.order_id
        , stg_orders_northwind.customer_id
        , stg_orders_northwind.employee_id
        , stg_orders_northwind.order_date
        , stg_orders_northwind.required_date
        , stg_orders_northwind.shipped_date
        , stg_orders_northwind.ship_via
        , stg_shippers_northwind.company_name
        , stg_orders_northwind.freight
        , stg_orders_northwind.ship_name
        , stg_orders_northwind.ship_address
        , stg_orders_northwind.ship_city
        , stg_orders_northwind.ship_region
        , stg_orders_northwind.ship_country
)

, final_table as (
    select
        transformed_table.order_id
        , transformed_table.customer_id
        , transformed_table.employee_id
        , transformed_table.order_date
        , transformed_table.required_date
        , transformed_table.shipped_date
        , transformed_table.days_to_ship
        , transformed_table.ship_id
        , transformed_table.ship_via
        , transformed_table.shipper_name
        , transformed_table.total_order_amount
        , transformed_table.freight
        , transformed_table.ship_name
        , transformed_table.ship_address
        , transformed_table.ship_city
        , transformed_table.ship_region
        , transformed_table.ship_country
        , transformed_table.ship_continent
        , case 
            when transformed_table.days_to_ship is null then False
            else True
          end as is_shipped
    from transformed_table
)

select *
from final_table;


[0m16:26:49.035264 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:26:49.045367 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9fef3aba-8201-4e67-baad-c2730a2360f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7224781d3c80>]}
[0m16:26:49.070247 [info ] [Thread-4 (]: 9 of 15 OK created sql view model dbt_dw_staging.stg_suppliers_northwind ....... [[32mCREATE VIEW (0 processed)[0m in 1.59s]
[0m16:26:49.071162 [debug] [Thread-4 (]: Finished running node model.dbt_exercise.stg_suppliers_northwind
[0m16:26:49.072369 [debug] [Thread-4 (]: Began running node model.dbt_exercise.int_products_northwind
[0m16:26:49.072959 [info ] [Thread-4 (]: 14 of 15 START sql view model dbt_dw_intermediate.int_products_northwind ....... [RUN]
[0m16:26:49.073427 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.dbt_exercise.stg_suppliers_northwind, now model.dbt_exercise.int_products_northwind)
[0m16:26:49.073756 [debug] [Thread-4 (]: Began compiling node model.dbt_exercise.int_products_northwind
[0m16:26:49.077179 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_exercise.int_products_northwind"
[0m16:26:49.078160 [debug] [Thread-4 (]: Began executing node model.dbt_exercise.int_products_northwind
[0m16:26:49.080944 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_exercise.int_products_northwind"
[0m16:26:49.081724 [debug] [Thread-4 (]: On model.dbt_exercise.int_products_northwind: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "model.dbt_exercise.int_products_northwind"} */


  create or replace view `corded-sunlight-464012-e2`.`dbt_dw_intermediate`.`int_products_northwind`
  OPTIONS()
  as with stg_products_northwind as (
    select *
    from `corded-sunlight-464012-e2`.`dbt_dw_staging`.`stg_products_northwind`
)

, stg_categories_northwind as (
    select *
    from `corded-sunlight-464012-e2`.`dbt_dw_staging`.`stg_categories_northwind`
)

, stg_suppliers_northwind as (
    select *
    from `corded-sunlight-464012-e2`.`dbt_dw_staging`.`stg_suppliers_northwind`
)

, final_table as (
    select
        stg_products_northwind.product_id
        , stg_products_northwind.product_name
        , stg_products_northwind.quantity_per_unit
        , stg_categories_northwind.category_name
        , stg_suppliers_northwind.company_name as supplier_name
        , stg_suppliers_northwind.city as supplier_city
        , stg_suppliers_northwind.region as supplier_region
        , stg_suppliers_northwind.country as supplier_country
        , case
            when stg_suppliers_northwind.country in ('USA', 'Canada') then 'North America'
            when stg_suppliers_northwind.country in ('Brazil') then 'South America'
            when stg_suppliers_northwind.country in ('UK', 'Germany', 'Netherlands', 'Spain', 'France', 'Norway', 'Italy', 'Denmark', 'Sweden', 'Finland') then 'Europe'
            when stg_suppliers_northwind.country in ('Singapore', 'Japan') then 'Asia'
            when stg_suppliers_northwind.country in ('Australia') then 'Oceania'
            else 'Other'
          end as supplier_continent
        , case 
            when stg_products_northwind.discontinued = 1 then True
            else False
        end as is_discontinued
    from stg_products_northwind
    left join stg_categories_northwind
        on stg_products_northwind.category_id = stg_categories_northwind.category_id
    left join stg_suppliers_northwind
        on stg_products_northwind.supplier_id = stg_suppliers_northwind.supplier_id
)

select * 
from final_table;


[0m16:26:49.082261 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:26:49.115077 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9fef3aba-8201-4e67-baad-c2730a2360f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72247837cda0>]}
[0m16:26:49.116730 [info ] [Thread-1 (]: 10 of 15 OK created sql view model dbt_dw_intermediate.int_customers_northwind . [[32mCREATE VIEW (0 processed)[0m in 1.64s]
[0m16:26:49.117471 [debug] [Thread-1 (]: Finished running node model.dbt_exercise.int_customers_northwind
[0m16:26:49.221319 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9fef3aba-8201-4e67-baad-c2730a2360f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x722478130cb0>]}
[0m16:26:49.222528 [info ] [Thread-2 (]: 12 of 15 OK created sql view model dbt_dw_intermediate.int_shippers_northwind .. [[32mCREATE VIEW (0 processed)[0m in 1.71s]
[0m16:26:49.223344 [debug] [Thread-2 (]: Finished running node model.dbt_exercise.int_shippers_northwind
[0m16:26:50.156872 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:0f236f1a-a326-4159-a408-71230b74b91a&page=queryresults
[0m16:26:50.220116 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:cbf41a50-d355-41f7-a18c-93046c7b7958&page=queryresults
[0m16:26:50.488059 [error] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:cbf41a50-d355-41f7-a18c-93046c7b7958&page=queryresults
[0m16:26:50.525285 [debug] [Thread-4 (]: Database Error in model int_products_northwind (models/intermediate/int_products_northwind.sql)
  No matching signature for operator = for argument types: STRING, INT64
    Signature: T1 = T1
      Unable to find common supertype for templated argument <T1>
        Input types for <T1>: {INT64, STRING} at [45:12]
  compiled code at target/run/dbt_exercise/models/intermediate/int_products_northwind.sql
[0m16:26:50.525959 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9fef3aba-8201-4e67-baad-c2730a2360f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72247b687fe0>]}
[0m16:26:50.526619 [error] [Thread-4 (]: 14 of 15 ERROR creating sql view model dbt_dw_intermediate.int_products_northwind  [[31mERROR[0m in 1.45s]
[0m16:26:50.527184 [debug] [Thread-4 (]: Finished running node model.dbt_exercise.int_products_northwind
[0m16:26:50.527740 [debug] [Thread-7 (]: Marking all children of 'model.dbt_exercise.int_products_northwind' to be skipped because of status 'error'.  Reason: Database Error in model int_products_northwind (models/intermediate/int_products_northwind.sql)
  No matching signature for operator = for argument types: STRING, INT64
    Signature: T1 = T1
      Unable to find common supertype for templated argument <T1>
        Input types for <T1>: {INT64, STRING} at [45:12]
  compiled code at target/run/dbt_exercise/models/intermediate/int_products_northwind.sql.
[0m16:26:50.528686 [debug] [Thread-1 (]: Began running node model.dbt_exercise.dim_products
[0m16:26:50.529106 [info ] [Thread-1 (]: 15 of 15 SKIP relation dbt_dw_marts.dim_products ............................... [[33mSKIP[0m]
[0m16:26:50.529543 [debug] [Thread-1 (]: Finished running node model.dbt_exercise.dim_products
[0m16:26:50.697674 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9fef3aba-8201-4e67-baad-c2730a2360f8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x722463706840>]}
[0m16:26:50.698620 [info ] [Thread-3 (]: 13 of 15 OK created sql view model dbt_dw_intermediate.int_orders_northwind .... [[32mCREATE VIEW (0 processed)[0m in 1.67s]
[0m16:26:50.699317 [debug] [Thread-3 (]: Finished running node model.dbt_exercise.int_orders_northwind
[0m16:26:50.703189 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:26:50.711170 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:26:50.711676 [debug] [MainThread]: Connection 'model.dbt_exercise.int_orders_northwind' was properly closed.
[0m16:26:50.712037 [debug] [MainThread]: Connection 'model.dbt_exercise.int_shippers_northwind' was properly closed.
[0m16:26:50.712348 [debug] [MainThread]: Connection 'model.dbt_exercise.int_products_northwind' was properly closed.
[0m16:26:50.712660 [debug] [MainThread]: Connection 'model.dbt_exercise.int_customers_northwind' was properly closed.
[0m16:26:50.713130 [info ] [MainThread]: 
[0m16:26:50.713612 [info ] [MainThread]: Finished running 1 table model, 14 view models in 0 hours 0 minutes and 12.94 seconds (12.94s).
[0m16:26:50.716300 [debug] [MainThread]: Command end result
[0m16:26:50.759328 [debug] [MainThread]: Wrote artifact WritableManifest to /home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/target/manifest.json
[0m16:26:50.771079 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/target/semantic_manifest.json
[0m16:26:50.777125 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/target/run_results.json
[0m16:26:50.777631 [info ] [MainThread]: 
[0m16:26:50.778170 [info ] [MainThread]: [31mCompleted with 2 errors, 0 partial successes, and 0 warnings:[0m
[0m16:26:50.778576 [info ] [MainThread]: 
[0m16:26:50.779040 [error] [MainThread]: [31mFailure in model int_employees_northwind (models/intermediate/int_employees_northwind.sql)[0m
[0m16:26:50.779463 [error] [MainThread]:   Database Error in model int_employees_northwind (models/intermediate/int_employees_northwind.sql)
  DATE_DIFF does not support the YEAR date part when the argument is TIMESTAMP type at [26:11]
  compiled code at target/run/dbt_exercise/models/intermediate/int_employees_northwind.sql
[0m16:26:50.779800 [info ] [MainThread]: 
[0m16:26:50.780219 [info ] [MainThread]:   compiled code at target/compiled/dbt_exercise/models/intermediate/int_employees_northwind.sql
[0m16:26:50.780629 [info ] [MainThread]: 
[0m16:26:50.781055 [error] [MainThread]: [31mFailure in model int_products_northwind (models/intermediate/int_products_northwind.sql)[0m
[0m16:26:50.781475 [error] [MainThread]:   Database Error in model int_products_northwind (models/intermediate/int_products_northwind.sql)
  No matching signature for operator = for argument types: STRING, INT64
    Signature: T1 = T1
      Unable to find common supertype for templated argument <T1>
        Input types for <T1>: {INT64, STRING} at [45:12]
  compiled code at target/run/dbt_exercise/models/intermediate/int_products_northwind.sql
[0m16:26:50.781820 [info ] [MainThread]: 
[0m16:26:50.782291 [info ] [MainThread]:   compiled code at target/compiled/dbt_exercise/models/intermediate/int_products_northwind.sql
[0m16:26:50.782662 [info ] [MainThread]: 
[0m16:26:50.783063 [info ] [MainThread]: Done. PASS=12 WARN=0 ERROR=2 SKIP=1 NO-OP=0 TOTAL=15
[0m16:26:50.783758 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- DuplicateYAMLKeysDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m16:26:50.788903 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 100.77578, "process_in_blocks": "144888", "process_kernel_time": 11.434484, "process_mem_max_rss": "367864", "process_out_blocks": "3888", "process_user_time": 10.784748}
[0m16:26:50.789493 [debug] [MainThread]: Command `dbt run` failed at 16:26:50.789359 after 100.78 seconds
[0m16:26:50.789905 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7224b9442c60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7224b9b4c830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7224b9b4cce0>]}
[0m16:26:50.790293 [debug] [MainThread]: Flushing usage events
[0m16:26:51.214246 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:38:22.658050 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7850c3cbcb60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7850c5484410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7850c70d9190>]}


============================== 16:38:22.677040 | 13d187ff-21d5-417b-8771-fd0346022909 ==============================
[0m16:38:22.677040 [info ] [MainThread]: Running with dbt=1.10.2
[0m16:38:22.677762 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt run -s +int_products_northwind', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m16:39:05.928130 [warn ] [MainThread]: [[33mWARNING[0m][DuplicateYAMLKeysDeprecation]: Deprecated functionality
Duplicate key 'version' in "<unicode string>", line 4, column 1 in file
`/home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/dbt_project.yml`
[0m16:39:05.928783 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '13d187ff-21d5-417b-8771-fd0346022909', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7850c3254d70>]}
[0m16:39:06.528410 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '13d187ff-21d5-417b-8771-fd0346022909', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78508adc9fa0>]}
[0m16:39:06.595080 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '13d187ff-21d5-417b-8771-fd0346022909', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x785086594b00>]}
[0m16:39:06.598596 [info ] [MainThread]: Registered adapter: bigquery=1.9.2
[0m16:39:52.910509 [debug] [MainThread]: checksum: 1adc40777973ef30f45f80b3b6d04d5013c1edd53d96363881b3b199e612468b, vars: {}, profile: , target: , version: 1.10.2
[0m16:39:57.570572 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:39:57.571141 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:39:57.622013 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '13d187ff-21d5-417b-8771-fd0346022909', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x785085f41c70>]}
[0m16:39:57.898891 [debug] [MainThread]: Wrote artifact WritableManifest to /home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/target/manifest.json
[0m16:39:57.911756 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/target/semantic_manifest.json
[0m16:39:58.348494 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '13d187ff-21d5-417b-8771-fd0346022909', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x785086226180>]}
[0m16:39:58.349080 [info ] [MainThread]: Found 14 seeds, 36 data tests, 16 models, 14 sources, 609 macros
[0m16:39:58.349552 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '13d187ff-21d5-417b-8771-fd0346022909', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7850861484d0>]}
[0m16:39:58.351723 [info ] [MainThread]: 
[0m16:39:58.352238 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:39:58.352631 [info ] [MainThread]: 
[0m16:39:58.353281 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m16:39:58.358070 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_corded-sunlight-464012-e2'
[0m16:39:58.359150 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:39:58.360000 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_corded-sunlight-464012-e2'
[0m16:39:58.361015 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:39:59.662818 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_corded-sunlight-464012-e2, now list_corded-sunlight-464012-e2_dbt_dw_marts)
[0m16:39:59.663908 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_corded-sunlight-464012-e2, now list_corded-sunlight-464012-e2_dbt_dw_staging)
[0m16:39:59.665545 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_corded-sunlight-464012-e2_dbt_dw_raw'
[0m16:39:59.665985 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:39:59.667184 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_corded-sunlight-464012-e2_dbt_dw_intermediate'
[0m16:39:59.668483 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:39:59.669559 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:39:59.670769 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:40:00.715876 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '13d187ff-21d5-417b-8771-fd0346022909', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x785085cc09e0>]}
[0m16:40:00.717159 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:40:00.734969 [debug] [Thread-1 (]: Began running node model.dbt_exercise.stg_categories_northwind
[0m16:40:00.736348 [debug] [Thread-2 (]: Began running node model.dbt_exercise.stg_products_northwind
[0m16:40:00.737232 [debug] [Thread-3 (]: Began running node model.dbt_exercise.stg_suppliers_northwind
[0m16:40:00.738412 [info ] [Thread-1 (]: 1 of 4 START sql view model dbt_dw_staging.stg_categories_northwind ............ [RUN]
[0m16:40:00.739700 [info ] [Thread-2 (]: 2 of 4 START sql view model dbt_dw_staging.stg_products_northwind .............. [RUN]
[0m16:40:00.740422 [info ] [Thread-3 (]: 3 of 4 START sql view model dbt_dw_staging.stg_suppliers_northwind ............. [RUN]
[0m16:40:00.741265 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_corded-sunlight-464012-e2_dbt_dw_intermediate, now model.dbt_exercise.stg_categories_northwind)
[0m16:40:00.742176 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_corded-sunlight-464012-e2_dbt_dw_raw, now model.dbt_exercise.stg_products_northwind)
[0m16:40:00.743258 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_corded-sunlight-464012-e2_dbt_dw_marts, now model.dbt_exercise.stg_suppliers_northwind)
[0m16:40:00.744286 [debug] [Thread-1 (]: Began compiling node model.dbt_exercise.stg_categories_northwind
[0m16:40:00.745066 [debug] [Thread-2 (]: Began compiling node model.dbt_exercise.stg_products_northwind
[0m16:40:00.745985 [debug] [Thread-3 (]: Began compiling node model.dbt_exercise.stg_suppliers_northwind
[0m16:40:00.760587 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_exercise.stg_categories_northwind"
[0m16:40:00.765582 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_exercise.stg_products_northwind"
[0m16:40:00.771941 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_exercise.stg_suppliers_northwind"
[0m16:40:00.774160 [debug] [Thread-2 (]: Began executing node model.dbt_exercise.stg_products_northwind
[0m16:40:00.785642 [debug] [Thread-1 (]: Began executing node model.dbt_exercise.stg_categories_northwind
[0m16:40:00.822021 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_exercise.stg_products_northwind"
[0m16:40:00.823331 [debug] [Thread-3 (]: Began executing node model.dbt_exercise.stg_suppliers_northwind
[0m16:40:00.826909 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_exercise.stg_categories_northwind"
[0m16:40:00.831091 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_exercise.stg_suppliers_northwind"
[0m16:40:00.832837 [debug] [Thread-2 (]: On model.dbt_exercise.stg_products_northwind: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "model.dbt_exercise.stg_products_northwind"} */


  create or replace view `corded-sunlight-464012-e2`.`dbt_dw_staging`.`stg_products_northwind`
  OPTIONS()
  as with raw_products as (
    select *
    from `corded-sunlight-464012-e2`.`dbt_dw_raw`.`products`
)

, stg_products_northwind as (
    select
        cast(product_id as string) as product_id
        , cast(product_name as string) as product_name
        , cast(supplier_id as string) as supplier_id
        , cast(category_id as string) as category_id
        , cast(quantity_per_unit as string) as quantity_per_unit
        , cast(unit_price as numeric) as unit_price
        , cast(units_in_stock as numeric) as units_in_stock
        , cast(units_on_order as numeric) as units_on_order
        , cast(reorder_level as numeric) as reorder_level
        , cast(discontinued as integer) as discontinued
    from raw_products
)

select *
from stg_products_northwind;


[0m16:40:00.834759 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:40:00.835285 [debug] [Thread-1 (]: On model.dbt_exercise.stg_categories_northwind: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "model.dbt_exercise.stg_categories_northwind"} */


  create or replace view `corded-sunlight-464012-e2`.`dbt_dw_staging`.`stg_categories_northwind`
  OPTIONS()
  as with raw_categories as (
    select *
    from `corded-sunlight-464012-e2`.`dbt_dw_raw`.`categories`
)

/* Ao construir a staging não vamos trazer a coluna picture, pois ela não traz informação relevante */
, stg_categories_northwind as (
    select
        cast(category_id as string) as category_id
        , cast(category_name as string) as category_name
        , cast(description as string) as description
    from raw_categories
)

select *
from raw_categories;


[0m16:40:00.836056 [debug] [Thread-3 (]: On model.dbt_exercise.stg_suppliers_northwind: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "model.dbt_exercise.stg_suppliers_northwind"} */


  create or replace view `corded-sunlight-464012-e2`.`dbt_dw_staging`.`stg_suppliers_northwind`
  OPTIONS()
  as with suppliers as (
    select *
    from `corded-sunlight-464012-e2`.`dbt_dw_raw`.`suppliers`
)

select 
    cast(supplier_id as string) as supplier_id
    , cast(company_name as string) as company_name
    , cast(contact_name as string) as contact_name
    , cast(contact_title as string) as contact_title
    , cast(address as string) as address
    , cast(city as string) as city
    , cast(region as string) as region
    , cast(postal_code as string) as postal_code
    , cast(country as string) as country
    , cast(phone as string) as phone
    , cast(fax as string) as fax
    , cast(homepage as string) as home_page
from suppliers;


[0m16:40:00.836692 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:40:00.837379 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:40:01.916820 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:8819bec2-4326-401f-b081-a9be4892f215&page=queryresults
[0m16:40:01.978392 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:8aa7e128-85df-49f7-b610-c1c6cb763922&page=queryresults
[0m16:40:02.028377 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:73511521-21b6-432c-9835-dd8896ed5846&page=queryresults
[0m16:40:06.802916 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '13d187ff-21d5-417b-8771-fd0346022909', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7850c4109ee0>]}
[0m16:40:06.803414 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '13d187ff-21d5-417b-8771-fd0346022909', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78508adca8d0>]}
[0m16:40:06.803888 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '13d187ff-21d5-417b-8771-fd0346022909', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x785085da6480>]}
[0m16:40:06.805130 [info ] [Thread-3 (]: 3 of 4 OK created sql view model dbt_dw_staging.stg_suppliers_northwind ........ [[32mCREATE VIEW (0 processed)[0m in 6.04s]
[0m16:40:06.806497 [info ] [Thread-1 (]: 1 of 4 OK created sql view model dbt_dw_staging.stg_categories_northwind ....... [[32mCREATE VIEW (0 processed)[0m in 6.05s]
[0m16:40:06.808530 [debug] [Thread-3 (]: Finished running node model.dbt_exercise.stg_suppliers_northwind
[0m16:40:06.807618 [info ] [Thread-2 (]: 2 of 4 OK created sql view model dbt_dw_staging.stg_products_northwind ......... [[32mCREATE VIEW (0 processed)[0m in 6.05s]
[0m16:40:06.810493 [debug] [Thread-1 (]: Finished running node model.dbt_exercise.stg_categories_northwind
[0m16:40:06.811851 [debug] [Thread-2 (]: Finished running node model.dbt_exercise.stg_products_northwind
[0m16:40:06.813973 [debug] [Thread-4 (]: Began running node model.dbt_exercise.int_products_northwind
[0m16:40:06.815329 [info ] [Thread-4 (]: 4 of 4 START sql view model dbt_dw_intermediate.int_products_northwind ......... [RUN]
[0m16:40:06.816346 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly list_corded-sunlight-464012-e2_dbt_dw_staging, now model.dbt_exercise.int_products_northwind)
[0m16:40:06.816973 [debug] [Thread-4 (]: Began compiling node model.dbt_exercise.int_products_northwind
[0m16:40:06.821513 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_exercise.int_products_northwind"
[0m16:40:06.823233 [debug] [Thread-4 (]: Began executing node model.dbt_exercise.int_products_northwind
[0m16:40:06.827706 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_exercise.int_products_northwind"
[0m16:40:06.828987 [debug] [Thread-4 (]: On model.dbt_exercise.int_products_northwind: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "model.dbt_exercise.int_products_northwind"} */


  create or replace view `corded-sunlight-464012-e2`.`dbt_dw_intermediate`.`int_products_northwind`
  OPTIONS()
  as with stg_products_northwind as (
    select *
    from `corded-sunlight-464012-e2`.`dbt_dw_staging`.`stg_products_northwind`
)

, stg_categories_northwind as (
    select *
    from `corded-sunlight-464012-e2`.`dbt_dw_staging`.`stg_categories_northwind`
)

, stg_suppliers_northwind as (
    select *
    from `corded-sunlight-464012-e2`.`dbt_dw_staging`.`stg_suppliers_northwind`
)

, final_table as (
    select
        stg_products_northwind.product_id
        , stg_products_northwind.product_name
        , stg_products_northwind.quantity_per_unit
        , stg_categories_northwind.category_name
        , stg_suppliers_northwind.company_name as supplier_name
        , stg_suppliers_northwind.city as supplier_city
        , stg_suppliers_northwind.region as supplier_region
        , stg_suppliers_northwind.country as supplier_country
        , case
            when stg_suppliers_northwind.country in ('USA', 'Canada') then 'North America'
            when stg_suppliers_northwind.country in ('Brazil') then 'South America'
            when stg_suppliers_northwind.country in ('UK', 'Germany', 'Netherlands', 'Spain', 'France', 'Norway', 'Italy', 'Denmark', 'Sweden', 'Finland') then 'Europe'
            when stg_suppliers_northwind.country in ('Singapore', 'Japan') then 'Asia'
            when stg_suppliers_northwind.country in ('Australia') then 'Oceania'
            else 'Other'
          end as supplier_continent
        , case 
            when stg_products_northwind.discontinued = 1 then True
            else False
        end as is_discontinued
    from stg_products_northwind
    left join stg_categories_northwind
        on stg_products_northwind.category_id = stg_categories_northwind.category_id
    left join stg_suppliers_northwind
        on stg_products_northwind.supplier_id = stg_suppliers_northwind.supplier_id
)

select * 
from final_table;


[0m16:40:06.830030 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:40:08.197770 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:41abb6ba-8b1c-4369-8d48-6922ae9044ef&page=queryresults
[0m16:40:08.487660 [error] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:41abb6ba-8b1c-4369-8d48-6922ae9044ef&page=queryresults
[0m16:40:08.577202 [debug] [Thread-4 (]: Database Error in model int_products_northwind (models/intermediate/int_products_northwind.sql)
  No matching signature for operator = for argument types: STRING, INT64
    Signature: T1 = T1
      Unable to find common supertype for templated argument <T1>
        Input types for <T1>: {INT64, STRING} at [45:12]
  compiled code at target/run/dbt_exercise/models/intermediate/int_products_northwind.sql
[0m16:40:08.577887 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '13d187ff-21d5-417b-8771-fd0346022909', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x785075f2d340>]}
[0m16:40:08.578692 [error] [Thread-4 (]: 4 of 4 ERROR creating sql view model dbt_dw_intermediate.int_products_northwind  [[31mERROR[0m in 1.76s]
[0m16:40:08.579296 [debug] [Thread-4 (]: Finished running node model.dbt_exercise.int_products_northwind
[0m16:40:08.580373 [debug] [Thread-7 (]: Marking all children of 'model.dbt_exercise.int_products_northwind' to be skipped because of status 'error'.  Reason: Database Error in model int_products_northwind (models/intermediate/int_products_northwind.sql)
  No matching signature for operator = for argument types: STRING, INT64
    Signature: T1 = T1
      Unable to find common supertype for templated argument <T1>
        Input types for <T1>: {INT64, STRING} at [45:12]
  compiled code at target/run/dbt_exercise/models/intermediate/int_products_northwind.sql.
[0m16:40:08.584934 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:40:08.592619 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:40:08.593044 [debug] [MainThread]: Connection 'model.dbt_exercise.int_products_northwind' was properly closed.
[0m16:40:08.593324 [debug] [MainThread]: Connection 'model.dbt_exercise.stg_suppliers_northwind' was properly closed.
[0m16:40:08.593592 [debug] [MainThread]: Connection 'model.dbt_exercise.stg_products_northwind' was properly closed.
[0m16:40:08.593956 [debug] [MainThread]: Connection 'model.dbt_exercise.stg_categories_northwind' was properly closed.
[0m16:40:08.594482 [info ] [MainThread]: 
[0m16:40:08.595160 [info ] [MainThread]: Finished running 4 view models in 0 hours 0 minutes and 10.24 seconds (10.24s).
[0m16:40:08.596564 [debug] [MainThread]: Command end result
[0m16:40:08.640744 [debug] [MainThread]: Wrote artifact WritableManifest to /home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/target/manifest.json
[0m16:40:08.652885 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/target/semantic_manifest.json
[0m16:40:08.659336 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/target/run_results.json
[0m16:40:08.659814 [info ] [MainThread]: 
[0m16:40:08.660246 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m16:40:08.660638 [info ] [MainThread]: 
[0m16:40:08.661121 [error] [MainThread]: [31mFailure in model int_products_northwind (models/intermediate/int_products_northwind.sql)[0m
[0m16:40:08.661613 [error] [MainThread]:   Database Error in model int_products_northwind (models/intermediate/int_products_northwind.sql)
  No matching signature for operator = for argument types: STRING, INT64
    Signature: T1 = T1
      Unable to find common supertype for templated argument <T1>
        Input types for <T1>: {INT64, STRING} at [45:12]
  compiled code at target/run/dbt_exercise/models/intermediate/int_products_northwind.sql
[0m16:40:08.662073 [info ] [MainThread]: 
[0m16:40:08.662494 [info ] [MainThread]:   compiled code at target/compiled/dbt_exercise/models/intermediate/int_products_northwind.sql
[0m16:40:08.662948 [info ] [MainThread]: 
[0m16:40:08.663292 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=4
[0m16:40:08.664103 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- DuplicateYAMLKeysDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m16:40:08.669953 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 106.074814, "process_in_blocks": "123608", "process_kernel_time": 12.319949, "process_mem_max_rss": "368500", "process_out_blocks": "3608", "process_user_time": 11.062269}
[0m16:40:08.670807 [debug] [MainThread]: Command `dbt run` failed at 16:40:08.670635 after 106.08 seconds
[0m16:40:08.672616 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7850c75b73e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x785084087d10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7850c3a29b50>]}
[0m16:40:08.673179 [debug] [MainThread]: Flushing usage events
[0m16:40:09.096129 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:45:44.929702 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7527ad4d9d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7527abb353d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7527ab751100>]}


============================== 16:45:44.947745 | e2b4c2e0-a7c8-47fa-b240-fc861c37338b ==============================
[0m16:45:44.947745 [info ] [MainThread]: Running with dbt=1.10.2
[0m16:45:44.948301 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt run -s stg_categories_northwind', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m16:46:29.899657 [warn ] [MainThread]: [[33mWARNING[0m][DuplicateYAMLKeysDeprecation]: Deprecated functionality
Duplicate key 'version' in "<unicode string>", line 4, column 1 in file
`/home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/dbt_project.yml`
[0m16:46:29.900219 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'e2b4c2e0-a7c8-47fa-b240-fc861c37338b', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75276dc2b440>]}
[0m16:46:30.600148 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e2b4c2e0-a7c8-47fa-b240-fc861c37338b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75276db57260>]}
[0m16:46:30.656781 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e2b4c2e0-a7c8-47fa-b240-fc861c37338b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7527abc46f00>]}
[0m16:46:30.660132 [info ] [MainThread]: Registered adapter: bigquery=1.9.2
[0m16:47:17.281769 [debug] [MainThread]: checksum: 1adc40777973ef30f45f80b3b6d04d5013c1edd53d96363881b3b199e612468b, vars: {}, profile: , target: , version: 1.10.2
[0m16:47:22.239582 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:47:22.240344 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:47:22.313209 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e2b4c2e0-a7c8-47fa-b240-fc861c37338b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75276d8793d0>]}
[0m16:47:22.661428 [debug] [MainThread]: Wrote artifact WritableManifest to /home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/target/manifest.json
[0m16:47:22.674729 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/target/semantic_manifest.json
[0m16:47:23.136560 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e2b4c2e0-a7c8-47fa-b240-fc861c37338b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75276d89ae40>]}
[0m16:47:23.137230 [info ] [MainThread]: Found 14 seeds, 36 data tests, 16 models, 14 sources, 609 macros
[0m16:47:23.137657 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e2b4c2e0-a7c8-47fa-b240-fc861c37338b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75276da70e00>]}
[0m16:47:23.139672 [info ] [MainThread]: 
[0m16:47:23.140373 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:47:23.140864 [info ] [MainThread]: 
[0m16:47:23.141544 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m16:47:23.142779 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_corded-sunlight-464012-e2'
[0m16:47:23.143606 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:47:24.073653 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_corded-sunlight-464012-e2, now list_corded-sunlight-464012-e2_dbt_dw_intermediate)
[0m16:47:24.074921 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_corded-sunlight-464012-e2_dbt_dw_raw'
[0m16:47:24.075439 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:47:24.076748 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_corded-sunlight-464012-e2_dbt_dw_marts'
[0m16:47:24.077348 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:47:24.078748 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_corded-sunlight-464012-e2_dbt_dw_staging'
[0m16:47:24.080288 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:47:24.081748 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:49:39.467659 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e2b4c2e0-a7c8-47fa-b240-fc861c37338b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75276dac5ca0>]}
[0m16:49:39.468941 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:49:39.488739 [debug] [Thread-1 (]: Began running node model.dbt_exercise.stg_categories_northwind
[0m16:49:39.489494 [info ] [Thread-1 (]: 1 of 1 START sql view model dbt_dw_staging.stg_categories_northwind ............ [RUN]
[0m16:49:39.490261 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_corded-sunlight-464012-e2_dbt_dw_marts, now model.dbt_exercise.stg_categories_northwind)
[0m16:49:39.490867 [debug] [Thread-1 (]: Began compiling node model.dbt_exercise.stg_categories_northwind
[0m16:49:39.502472 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_exercise.stg_categories_northwind"
[0m16:49:39.505296 [debug] [Thread-1 (]: Began executing node model.dbt_exercise.stg_categories_northwind
[0m16:49:39.540695 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_exercise.stg_categories_northwind"
[0m16:49:39.541616 [debug] [Thread-1 (]: On model.dbt_exercise.stg_categories_northwind: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "model.dbt_exercise.stg_categories_northwind"} */


  create or replace view `corded-sunlight-464012-e2`.`dbt_dw_staging`.`stg_categories_northwind`
  OPTIONS()
  as with raw_categories as (
    select *
    from `corded-sunlight-464012-e2`.`dbt_dw_raw`.`categories`
)

/* Ao construir a staging não vamos trazer a coluna picture, pois ela não traz informação relevante */
, stg_categories_northwind as (
    select
        cast(category_id as string) as category_id
        , cast(category_name as string) as category_name
        , cast(description as string) as description
    from raw_categories
)

select *
from raw_categories;


[0m16:49:39.542450 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:49:40.681978 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:3039b1d0-f730-47ba-9aa8-989f361dc060&page=queryresults
[0m16:49:45.888572 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e2b4c2e0-a7c8-47fa-b240-fc861c37338b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x752772702600>]}
[0m16:49:45.889571 [info ] [Thread-1 (]: 1 of 1 OK created sql view model dbt_dw_staging.stg_categories_northwind ....... [[32mCREATE VIEW (0 processed)[0m in 6.38s]
[0m16:49:45.890273 [debug] [Thread-1 (]: Finished running node model.dbt_exercise.stg_categories_northwind
[0m16:49:45.893117 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:49:45.898823 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:49:45.899299 [debug] [MainThread]: Connection 'list_corded-sunlight-464012-e2_dbt_dw_intermediate' was properly closed.
[0m16:49:45.899581 [debug] [MainThread]: Connection 'list_corded-sunlight-464012-e2_dbt_dw_raw' was properly closed.
[0m16:49:45.899838 [debug] [MainThread]: Connection 'model.dbt_exercise.stg_categories_northwind' was properly closed.
[0m16:49:45.900094 [debug] [MainThread]: Connection 'list_corded-sunlight-464012-e2_dbt_dw_staging' was properly closed.
[0m16:49:45.900458 [info ] [MainThread]: 
[0m16:49:45.901011 [info ] [MainThread]: Finished running 1 view model in 0 hours 2 minutes and 22.76 seconds (142.76s).
[0m16:49:45.902487 [debug] [MainThread]: Command end result
[0m16:49:45.958578 [debug] [MainThread]: Wrote artifact WritableManifest to /home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/target/manifest.json
[0m16:49:45.974846 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/target/semantic_manifest.json
[0m16:49:45.981742 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/target/run_results.json
[0m16:49:45.982220 [info ] [MainThread]: 
[0m16:49:45.982659 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:49:45.983025 [info ] [MainThread]: 
[0m16:49:45.983435 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m16:49:45.984105 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- DuplicateYAMLKeysDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m16:49:45.992801 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 241.11455, "process_in_blocks": "127040", "process_kernel_time": 12.924168, "process_mem_max_rss": "367020", "process_out_blocks": "3520", "process_user_time": 10.543052}
[0m16:49:45.993584 [debug] [MainThread]: Command `dbt run` succeeded at 16:49:45.993377 after 241.12 seconds
[0m16:49:45.994293 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7527aba287d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75276dec7f80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75276daa8b60>]}
[0m16:49:45.994800 [debug] [MainThread]: Flushing usage events
[0m16:49:46.341450 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:50:26.751610 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc87d1b7da0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc87c5e0d40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc87d125a60>]}


============================== 16:50:26.770197 | 0d5bd2e1-ed6e-4828-b705-4caffd74e3ba ==============================
[0m16:50:26.770197 [info ] [MainThread]: Running with dbt=1.10.2
[0m16:50:26.770810 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/logs', 'version_check': 'True', 'profiles_dir': '/home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run -s stg_suppliers_northwind', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m16:51:14.044104 [warn ] [MainThread]: [[33mWARNING[0m][DuplicateYAMLKeysDeprecation]: Deprecated functionality
Duplicate key 'version' in "<unicode string>", line 4, column 1 in file
`/home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/dbt_project.yml`
[0m16:51:14.044692 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '0d5bd2e1-ed6e-4828-b705-4caffd74e3ba', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc83f150e00>]}
[0m16:51:14.739113 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0d5bd2e1-ed6e-4828-b705-4caffd74e3ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc83f3b2420>]}
[0m16:51:14.799295 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0d5bd2e1-ed6e-4828-b705-4caffd74e3ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc87ea57f50>]}
[0m16:51:14.802453 [info ] [MainThread]: Registered adapter: bigquery=1.9.2
[0m16:52:03.950517 [debug] [MainThread]: checksum: 1adc40777973ef30f45f80b3b6d04d5013c1edd53d96363881b3b199e612468b, vars: {}, profile: , target: , version: 1.10.2
[0m16:52:09.030026 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:52:09.030632 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:52:09.083485 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0d5bd2e1-ed6e-4828-b705-4caffd74e3ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc83ee69ac0>]}
[0m16:52:09.366501 [debug] [MainThread]: Wrote artifact WritableManifest to /home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/target/manifest.json
[0m16:52:09.380907 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/target/semantic_manifest.json
[0m16:52:09.779208 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0d5bd2e1-ed6e-4828-b705-4caffd74e3ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc83f153770>]}
[0m16:52:09.779781 [info ] [MainThread]: Found 14 seeds, 36 data tests, 16 models, 14 sources, 609 macros
[0m16:52:09.780214 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0d5bd2e1-ed6e-4828-b705-4caffd74e3ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc83ec4b9b0>]}
[0m16:52:09.782171 [info ] [MainThread]: 
[0m16:52:09.782665 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:52:09.782946 [info ] [MainThread]: 
[0m16:52:09.783448 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m16:52:09.784785 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_corded-sunlight-464012-e2'
[0m16:52:09.785485 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:52:10.797988 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_corded-sunlight-464012-e2, now list_corded-sunlight-464012-e2_dbt_dw_raw)
[0m16:52:10.799204 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_corded-sunlight-464012-e2_dbt_dw_staging'
[0m16:52:10.799701 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:52:10.801101 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_corded-sunlight-464012-e2_dbt_dw_intermediate'
[0m16:52:10.802698 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:52:10.804004 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_corded-sunlight-464012-e2_dbt_dw_marts'
[0m16:52:10.805072 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:52:10.806093 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:52:11.741949 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0d5bd2e1-ed6e-4828-b705-4caffd74e3ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc83f11aea0>]}
[0m16:52:11.742576 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:52:11.758523 [debug] [Thread-1 (]: Began running node model.dbt_exercise.stg_suppliers_northwind
[0m16:52:11.759441 [info ] [Thread-1 (]: 1 of 1 START sql view model dbt_dw_staging.stg_suppliers_northwind ............. [RUN]
[0m16:52:11.759998 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_corded-sunlight-464012-e2_dbt_dw_marts, now model.dbt_exercise.stg_suppliers_northwind)
[0m16:52:11.760428 [debug] [Thread-1 (]: Began compiling node model.dbt_exercise.stg_suppliers_northwind
[0m16:52:11.769533 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_exercise.stg_suppliers_northwind"
[0m16:52:11.771820 [debug] [Thread-1 (]: Began executing node model.dbt_exercise.stg_suppliers_northwind
[0m16:52:11.804588 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_exercise.stg_suppliers_northwind"
[0m16:52:11.805538 [debug] [Thread-1 (]: On model.dbt_exercise.stg_suppliers_northwind: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "model.dbt_exercise.stg_suppliers_northwind"} */


  create or replace view `corded-sunlight-464012-e2`.`dbt_dw_staging`.`stg_suppliers_northwind`
  OPTIONS()
  as with suppliers as (
    select *
    from `corded-sunlight-464012-e2`.`dbt_dw_raw`.`suppliers`
)

select 
    cast(supplier_id as string) as supplier_id
    , cast(company_name as string) as company_name
    , cast(contact_name as string) as contact_name
    , cast(contact_title as string) as contact_title
    , cast(address as string) as address
    , cast(city as string) as city
    , cast(region as string) as region
    , cast(postal_code as string) as postal_code
    , cast(country as string) as country
    , cast(phone as string) as phone
    , cast(fax as string) as fax
    , cast(homepage as string) as home_page
from suppliers;


[0m16:52:11.806121 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:52:12.974959 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:a957eb8a-e8ea-44ec-9c18-44170e4cd71b&page=queryresults
[0m16:52:17.777721 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0d5bd2e1-ed6e-4828-b705-4caffd74e3ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc843c266f0>]}
[0m16:52:17.779256 [info ] [Thread-1 (]: 1 of 1 OK created sql view model dbt_dw_staging.stg_suppliers_northwind ........ [[32mCREATE VIEW (0 processed)[0m in 6.00s]
[0m16:52:17.780384 [debug] [Thread-1 (]: Finished running node model.dbt_exercise.stg_suppliers_northwind
[0m16:52:17.783372 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:52:17.790358 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:52:17.790892 [debug] [MainThread]: Connection 'list_corded-sunlight-464012-e2_dbt_dw_raw' was properly closed.
[0m16:52:17.791242 [debug] [MainThread]: Connection 'list_corded-sunlight-464012-e2_dbt_dw_staging' was properly closed.
[0m16:52:17.791571 [debug] [MainThread]: Connection 'list_corded-sunlight-464012-e2_dbt_dw_intermediate' was properly closed.
[0m16:52:17.791890 [debug] [MainThread]: Connection 'model.dbt_exercise.stg_suppliers_northwind' was properly closed.
[0m16:52:17.792285 [info ] [MainThread]: 
[0m16:52:17.792771 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 8.01 seconds (8.01s).
[0m16:52:17.793628 [debug] [MainThread]: Command end result
[0m16:52:17.839343 [debug] [MainThread]: Wrote artifact WritableManifest to /home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/target/manifest.json
[0m16:52:17.854578 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/target/semantic_manifest.json
[0m16:52:17.860591 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/target/run_results.json
[0m16:52:17.861028 [info ] [MainThread]: 
[0m16:52:17.861576 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:52:17.862768 [info ] [MainThread]: 
[0m16:52:17.864305 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m16:52:17.866294 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- DuplicateYAMLKeysDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m16:52:17.871856 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 111.17724, "process_in_blocks": "143576", "process_kernel_time": 13.386237, "process_mem_max_rss": "366188", "process_out_blocks": "3504", "process_user_time": 10.986402}
[0m16:52:17.872694 [debug] [MainThread]: Command `dbt run` succeeded at 16:52:17.872505 after 111.18 seconds
[0m16:52:17.873256 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc87cba78c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc83f226270>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc87d043e30>]}
[0m16:52:17.873805 [debug] [MainThread]: Flushing usage events
[0m16:52:18.216317 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:52:54.955613 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70c708cebbc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70c708785160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70c708ceae40>]}


============================== 16:52:54.973167 | 3f9a25a0-23c4-4752-a78d-6d500f004ee4 ==============================
[0m16:52:54.973167 [info ] [MainThread]: Running with dbt=1.10.2
[0m16:52:54.973897 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/logs', 'fail_fast': 'False', 'profiles_dir': '/home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run -s stg_products_northwind', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m16:53:41.109267 [warn ] [MainThread]: [[33mWARNING[0m][DuplicateYAMLKeysDeprecation]: Deprecated functionality
Duplicate key 'version' in "<unicode string>", line 4, column 1 in file
`/home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/dbt_project.yml`
[0m16:53:41.110044 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '3f9a25a0-23c4-4752-a78d-6d500f004ee4', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70c6cb599250>]}
[0m16:53:41.781784 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3f9a25a0-23c4-4752-a78d-6d500f004ee4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70c70ab92720>]}
[0m16:53:41.845658 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3f9a25a0-23c4-4752-a78d-6d500f004ee4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70c6cb3668a0>]}
[0m16:53:41.849654 [info ] [MainThread]: Registered adapter: bigquery=1.9.2
[0m16:54:29.751646 [debug] [MainThread]: checksum: 1adc40777973ef30f45f80b3b6d04d5013c1edd53d96363881b3b199e612468b, vars: {}, profile: , target: , version: 1.10.2
[0m16:54:34.714315 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:54:34.715061 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:54:34.765935 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3f9a25a0-23c4-4752-a78d-6d500f004ee4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70c6cb36eed0>]}
[0m16:54:35.068130 [debug] [MainThread]: Wrote artifact WritableManifest to /home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/target/manifest.json
[0m16:54:35.085790 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/target/semantic_manifest.json
[0m16:54:35.522914 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3f9a25a0-23c4-4752-a78d-6d500f004ee4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70c6cb31f2c0>]}
[0m16:54:35.523541 [info ] [MainThread]: Found 14 seeds, 36 data tests, 16 models, 14 sources, 609 macros
[0m16:54:35.523922 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3f9a25a0-23c4-4752-a78d-6d500f004ee4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70c6cafe5700>]}
[0m16:54:35.526036 [info ] [MainThread]: 
[0m16:54:35.526618 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:54:35.526923 [info ] [MainThread]: 
[0m16:54:35.527423 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m16:54:35.528959 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_corded-sunlight-464012-e2'
[0m16:54:35.530034 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:54:36.474854 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_corded-sunlight-464012-e2, now list_corded-sunlight-464012-e2_dbt_dw_staging)
[0m16:54:36.476015 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:54:36.476857 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_corded-sunlight-464012-e2_dbt_dw_intermediate'
[0m16:54:36.478222 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_corded-sunlight-464012-e2_dbt_dw_raw'
[0m16:54:36.479027 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:54:36.480420 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_corded-sunlight-464012-e2_dbt_dw_marts'
[0m16:54:36.481273 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:54:36.483007 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:54:37.407448 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3f9a25a0-23c4-4752-a78d-6d500f004ee4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70c709751ee0>]}
[0m16:54:37.408285 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:54:37.422505 [debug] [Thread-1 (]: Began running node model.dbt_exercise.stg_products_northwind
[0m16:54:37.423187 [info ] [Thread-1 (]: 1 of 1 START sql view model dbt_dw_staging.stg_products_northwind .............. [RUN]
[0m16:54:37.423756 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_corded-sunlight-464012-e2_dbt_dw_raw, now model.dbt_exercise.stg_products_northwind)
[0m16:54:37.424178 [debug] [Thread-1 (]: Began compiling node model.dbt_exercise.stg_products_northwind
[0m16:54:37.433214 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_exercise.stg_products_northwind"
[0m16:54:37.435369 [debug] [Thread-1 (]: Began executing node model.dbt_exercise.stg_products_northwind
[0m16:54:37.468614 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_exercise.stg_products_northwind"
[0m16:54:37.469768 [debug] [Thread-1 (]: On model.dbt_exercise.stg_products_northwind: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "model.dbt_exercise.stg_products_northwind"} */


  create or replace view `corded-sunlight-464012-e2`.`dbt_dw_staging`.`stg_products_northwind`
  OPTIONS()
  as with raw_products as (
    select *
    from `corded-sunlight-464012-e2`.`dbt_dw_raw`.`products`
)

, stg_products_northwind as (
    select
        cast(product_id as string) as product_id
        , cast(product_name as string) as product_name
        , cast(supplier_id as string) as supplier_id
        , cast(category_id as string) as category_id
        , cast(quantity_per_unit as string) as quantity_per_unit
        , cast(unit_price as numeric) as unit_price
        , cast(units_in_stock as numeric) as units_in_stock
        , cast(units_on_order as numeric) as units_on_order
        , cast(reorder_level as numeric) as reorder_level
        , cast(discontinued as integer) as discontinued
    from raw_products
)

select *
from stg_products_northwind;


[0m16:54:37.471005 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:54:38.556368 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:67d066aa-6074-4ac0-9675-b65c1e87fca1&page=queryresults
[0m16:54:43.521047 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3f9a25a0-23c4-4752-a78d-6d500f004ee4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70c6cffce240>]}
[0m16:54:43.522881 [info ] [Thread-1 (]: 1 of 1 OK created sql view model dbt_dw_staging.stg_products_northwind ......... [[32mCREATE VIEW (0 processed)[0m in 6.08s]
[0m16:54:43.523547 [debug] [Thread-1 (]: Finished running node model.dbt_exercise.stg_products_northwind
[0m16:54:43.526701 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:54:43.534330 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:54:43.534919 [debug] [MainThread]: Connection 'list_corded-sunlight-464012-e2_dbt_dw_staging' was properly closed.
[0m16:54:43.535342 [debug] [MainThread]: Connection 'list_corded-sunlight-464012-e2_dbt_dw_intermediate' was properly closed.
[0m16:54:43.535704 [debug] [MainThread]: Connection 'model.dbt_exercise.stg_products_northwind' was properly closed.
[0m16:54:43.536071 [debug] [MainThread]: Connection 'list_corded-sunlight-464012-e2_dbt_dw_marts' was properly closed.
[0m16:54:43.536522 [info ] [MainThread]: 
[0m16:54:43.537045 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 8.01 seconds (8.01s).
[0m16:54:43.537804 [debug] [MainThread]: Command end result
[0m16:54:43.584650 [debug] [MainThread]: Wrote artifact WritableManifest to /home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/target/manifest.json
[0m16:54:43.598566 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/target/semantic_manifest.json
[0m16:54:43.605460 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/target/run_results.json
[0m16:54:43.606130 [info ] [MainThread]: 
[0m16:54:43.606693 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:54:43.607134 [info ] [MainThread]: 
[0m16:54:43.607640 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m16:54:43.608363 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- DuplicateYAMLKeysDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m16:54:43.613764 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 108.72626, "process_in_blocks": "143584", "process_kernel_time": 13.508113, "process_mem_max_rss": "366636", "process_out_blocks": "3504", "process_user_time": 10.953836}
[0m16:54:43.614457 [debug] [MainThread]: Command `dbt run` succeeded at 16:54:43.614314 after 108.73 seconds
[0m16:54:43.614969 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70c7093d37a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70c6cb42ff80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70c709230d10>]}
[0m16:54:43.615440 [debug] [MainThread]: Flushing usage events
[0m16:54:43.963661 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:55:18.368143 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f22b6469e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f22b6c09250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f22b66c9910>]}


============================== 16:55:18.385056 | e8294ced-6f57-4b78-817e-104f0c0cd787 ==============================
[0m16:55:18.385056 [info ] [MainThread]: Running with dbt=1.10.2
[0m16:55:18.385766 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run -s int_products_northwind', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m16:56:04.402640 [warn ] [MainThread]: [[33mWARNING[0m][DuplicateYAMLKeysDeprecation]: Deprecated functionality
Duplicate key 'version' in "<unicode string>", line 4, column 1 in file
`/home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/dbt_project.yml`
[0m16:56:04.403262 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'e8294ced-6f57-4b78-817e-104f0c0cd787', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f22b5c94440>]}
[0m16:56:05.009628 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e8294ced-6f57-4b78-817e-104f0c0cd787', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f22b6ba40e0>]}
[0m16:56:05.065094 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e8294ced-6f57-4b78-817e-104f0c0cd787', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2278d7a330>]}
[0m16:56:05.068545 [info ] [MainThread]: Registered adapter: bigquery=1.9.2
[0m16:56:53.729927 [debug] [MainThread]: checksum: 1adc40777973ef30f45f80b3b6d04d5013c1edd53d96363881b3b199e612468b, vars: {}, profile: , target: , version: 1.10.2
[0m16:56:58.597960 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:56:58.598508 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:56:58.652322 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e8294ced-6f57-4b78-817e-104f0c0cd787', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2278b25910>]}
[0m16:56:58.967268 [debug] [MainThread]: Wrote artifact WritableManifest to /home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/target/manifest.json
[0m16:56:58.980746 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/target/semantic_manifest.json
[0m16:56:59.394431 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e8294ced-6f57-4b78-817e-104f0c0cd787', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f22789ed610>]}
[0m16:56:59.395085 [info ] [MainThread]: Found 14 seeds, 36 data tests, 16 models, 14 sources, 609 macros
[0m16:56:59.395509 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e8294ced-6f57-4b78-817e-104f0c0cd787', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f22b5c973b0>]}
[0m16:56:59.397414 [info ] [MainThread]: 
[0m16:56:59.397984 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:56:59.398353 [info ] [MainThread]: 
[0m16:56:59.399016 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m16:56:59.400516 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_corded-sunlight-464012-e2'
[0m16:56:59.401299 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:57:00.308597 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_corded-sunlight-464012-e2, now list_corded-sunlight-464012-e2_dbt_dw_marts)
[0m16:57:00.309959 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_corded-sunlight-464012-e2_dbt_dw_raw'
[0m16:57:00.310628 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:57:00.312060 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_corded-sunlight-464012-e2_dbt_dw_staging'
[0m16:57:00.313260 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:57:00.314120 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_corded-sunlight-464012-e2_dbt_dw_intermediate'
[0m16:57:00.315342 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:57:00.316609 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:57:01.214370 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e8294ced-6f57-4b78-817e-104f0c0cd787', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f22787b43b0>]}
[0m16:57:01.214951 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:57:01.227464 [debug] [Thread-1 (]: Began running node model.dbt_exercise.int_products_northwind
[0m16:57:01.228700 [info ] [Thread-1 (]: 1 of 1 START sql view model dbt_dw_intermediate.int_products_northwind ......... [RUN]
[0m16:57:01.229464 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_corded-sunlight-464012-e2_dbt_dw_staging, now model.dbt_exercise.int_products_northwind)
[0m16:57:01.229927 [debug] [Thread-1 (]: Began compiling node model.dbt_exercise.int_products_northwind
[0m16:57:01.240635 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_exercise.int_products_northwind"
[0m16:57:01.243072 [debug] [Thread-1 (]: Began executing node model.dbt_exercise.int_products_northwind
[0m16:57:01.276742 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_exercise.int_products_northwind"
[0m16:57:01.277629 [debug] [Thread-1 (]: On model.dbt_exercise.int_products_northwind: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "model.dbt_exercise.int_products_northwind"} */


  create or replace view `corded-sunlight-464012-e2`.`dbt_dw_intermediate`.`int_products_northwind`
  OPTIONS()
  as with stg_products_northwind as (
    select *
    from `corded-sunlight-464012-e2`.`dbt_dw_staging`.`stg_products_northwind`
)

, stg_categories_northwind as (
    select *
    from `corded-sunlight-464012-e2`.`dbt_dw_staging`.`stg_categories_northwind`
)

, stg_suppliers_northwind as (
    select *
    from `corded-sunlight-464012-e2`.`dbt_dw_staging`.`stg_suppliers_northwind`
)

, final_table as (
    select
        stg_products_northwind.product_id
        , stg_products_northwind.product_name
        , stg_products_northwind.quantity_per_unit
        , stg_categories_northwind.category_name
        , stg_suppliers_northwind.company_name as supplier_name
        , stg_suppliers_northwind.city as supplier_city
        , stg_suppliers_northwind.region as supplier_region
        , stg_suppliers_northwind.country as supplier_country
        , case
            when stg_suppliers_northwind.country in ('USA', 'Canada') then 'North America'
            when stg_suppliers_northwind.country in ('Brazil') then 'South America'
            when stg_suppliers_northwind.country in ('UK', 'Germany', 'Netherlands', 'Spain', 'France', 'Norway', 'Italy', 'Denmark', 'Sweden', 'Finland') then 'Europe'
            when stg_suppliers_northwind.country in ('Singapore', 'Japan') then 'Asia'
            when stg_suppliers_northwind.country in ('Australia') then 'Oceania'
            else 'Other'
          end as supplier_continent
        , case 
            when stg_products_northwind.discontinued = 1 then True
            else False
        end as is_discontinued
    from stg_products_northwind
    left join stg_categories_northwind
        on stg_products_northwind.category_id = stg_categories_northwind.category_id
    left join stg_suppliers_northwind
        on stg_products_northwind.supplier_id = stg_suppliers_northwind.supplier_id
)

select * 
from final_table;


[0m16:57:01.278205 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:57:02.432838 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:1a942534-9e78-449f-b654-10aae33a3c22&page=queryresults
[0m16:57:02.806878 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:1a942534-9e78-449f-b654-10aae33a3c22&page=queryresults
[0m16:57:02.911342 [debug] [Thread-1 (]: Database Error in model int_products_northwind (models/intermediate/int_products_northwind.sql)
  No matching signature for operator = for argument types: STRING, INT64
    Signature: T1 = T1
      Unable to find common supertype for templated argument <T1>
        Input types for <T1>: {INT64, STRING} at [45:12]
  compiled code at target/run/dbt_exercise/models/intermediate/int_products_northwind.sql
[0m16:57:02.925664 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e8294ced-6f57-4b78-817e-104f0c0cd787', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f22b5e6e6f0>]}
[0m16:57:02.927270 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model dbt_dw_intermediate.int_products_northwind  [[31mERROR[0m in 1.68s]
[0m16:57:02.928913 [debug] [Thread-1 (]: Finished running node model.dbt_exercise.int_products_northwind
[0m16:57:02.930033 [debug] [Thread-7 (]: Marking all children of 'model.dbt_exercise.int_products_northwind' to be skipped because of status 'error'.  Reason: Database Error in model int_products_northwind (models/intermediate/int_products_northwind.sql)
  No matching signature for operator = for argument types: STRING, INT64
    Signature: T1 = T1
      Unable to find common supertype for templated argument <T1>
        Input types for <T1>: {INT64, STRING} at [45:12]
  compiled code at target/run/dbt_exercise/models/intermediate/int_products_northwind.sql.
[0m16:57:02.934018 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:57:02.940693 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:57:02.941363 [debug] [MainThread]: Connection 'list_corded-sunlight-464012-e2_dbt_dw_marts' was properly closed.
[0m16:57:02.941701 [debug] [MainThread]: Connection 'list_corded-sunlight-464012-e2_dbt_dw_raw' was properly closed.
[0m16:57:02.942070 [debug] [MainThread]: Connection 'model.dbt_exercise.int_products_northwind' was properly closed.
[0m16:57:02.942433 [debug] [MainThread]: Connection 'list_corded-sunlight-464012-e2_dbt_dw_intermediate' was properly closed.
[0m16:57:02.942857 [info ] [MainThread]: 
[0m16:57:02.943403 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 3.54 seconds (3.54s).
[0m16:57:02.944472 [debug] [MainThread]: Command end result
[0m16:57:02.994882 [debug] [MainThread]: Wrote artifact WritableManifest to /home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/target/manifest.json
[0m16:57:03.007099 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/target/semantic_manifest.json
[0m16:57:03.013236 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/target/run_results.json
[0m16:57:03.013899 [info ] [MainThread]: 
[0m16:57:03.014650 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m16:57:03.015279 [info ] [MainThread]: 
[0m16:57:03.015995 [error] [MainThread]: [31mFailure in model int_products_northwind (models/intermediate/int_products_northwind.sql)[0m
[0m16:57:03.016860 [error] [MainThread]:   Database Error in model int_products_northwind (models/intermediate/int_products_northwind.sql)
  No matching signature for operator = for argument types: STRING, INT64
    Signature: T1 = T1
      Unable to find common supertype for templated argument <T1>
        Input types for <T1>: {INT64, STRING} at [45:12]
  compiled code at target/run/dbt_exercise/models/intermediate/int_products_northwind.sql
[0m16:57:03.017406 [info ] [MainThread]: 
[0m16:57:03.018031 [info ] [MainThread]:   compiled code at target/compiled/dbt_exercise/models/intermediate/int_products_northwind.sql
[0m16:57:03.018507 [info ] [MainThread]: 
[0m16:57:03.018893 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m16:57:03.019466 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- DuplicateYAMLKeysDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m16:57:03.025136 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 104.71369, "process_in_blocks": "143696", "process_kernel_time": 13.28577, "process_mem_max_rss": "362440", "process_out_blocks": "3528", "process_user_time": 10.962717}
[0m16:57:03.025861 [debug] [MainThread]: Command `dbt run` failed at 16:57:03.025688 after 104.71 seconds
[0m16:57:03.026365 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f22b6567410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f22b6b743e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f22b6b74410>]}
[0m16:57:03.026815 [debug] [MainThread]: Flushing usage events
[0m16:57:03.368936 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:44:02.636251 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78bef53b0ce0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78bef37eab10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78bef37eb8f0>]}


============================== 17:44:02.656966 | 51246473-9b22-483b-a42b-e655557ab8eb ==============================
[0m17:44:02.656966 [info ] [MainThread]: Running with dbt=1.10.2
[0m17:44:02.657867 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'invocation_command': 'dbt run -s stg_categories_northwind', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m17:44:52.251321 [warn ] [MainThread]: [[33mWARNING[0m][DuplicateYAMLKeysDeprecation]: Deprecated functionality
Duplicate key 'version' in "<unicode string>", line 4, column 1 in file
`/home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/dbt_project.yml`
[0m17:44:52.252259 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '51246473-9b22-483b-a42b-e655557ab8eb', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78beb59f7c20>]}
[0m17:44:52.917065 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '51246473-9b22-483b-a42b-e655557ab8eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78beba86f920>]}
[0m17:44:52.981350 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '51246473-9b22-483b-a42b-e655557ab8eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78beb62294c0>]}
[0m17:44:52.985377 [info ] [MainThread]: Registered adapter: bigquery=1.9.2
[0m17:45:39.249637 [debug] [MainThread]: checksum: 1adc40777973ef30f45f80b3b6d04d5013c1edd53d96363881b3b199e612468b, vars: {}, profile: , target: , version: 1.10.2
[0m17:45:44.253315 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:45:44.253763 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:45:44.306820 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '51246473-9b22-483b-a42b-e655557ab8eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78beb55c9220>]}
[0m17:45:44.606800 [debug] [MainThread]: Wrote artifact WritableManifest to /home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/target/manifest.json
[0m17:45:44.620205 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/target/semantic_manifest.json
[0m17:45:45.008493 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '51246473-9b22-483b-a42b-e655557ab8eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78beb58a5eb0>]}
[0m17:45:45.009182 [info ] [MainThread]: Found 14 seeds, 36 data tests, 16 models, 14 sources, 609 macros
[0m17:45:45.009663 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '51246473-9b22-483b-a42b-e655557ab8eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78bef2906a50>]}
[0m17:45:45.011998 [info ] [MainThread]: 
[0m17:45:45.012744 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m17:45:45.013186 [info ] [MainThread]: 
[0m17:45:45.013924 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m17:45:45.015367 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_corded-sunlight-464012-e2'
[0m17:45:45.015982 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:45:46.798155 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_corded-sunlight-464012-e2, now list_corded-sunlight-464012-e2_dbt_dw_intermediate)
[0m17:45:46.799730 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:45:46.800673 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_corded-sunlight-464012-e2_dbt_dw_staging'
[0m17:45:46.802311 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_corded-sunlight-464012-e2_dbt_dw_marts'
[0m17:45:46.803716 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_corded-sunlight-464012-e2_dbt_dw_raw'
[0m17:45:46.804382 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:45:46.805583 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:45:46.806278 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:45:47.752178 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '51246473-9b22-483b-a42b-e655557ab8eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78bef2906a50>]}
[0m17:45:47.753536 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:45:47.769294 [debug] [Thread-1 (]: Began running node model.dbt_exercise.stg_categories_northwind
[0m17:45:47.770281 [info ] [Thread-1 (]: 1 of 1 START sql view model dbt_dw_staging.stg_categories_northwind ............ [RUN]
[0m17:45:47.770773 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_corded-sunlight-464012-e2_dbt_dw_raw, now model.dbt_exercise.stg_categories_northwind)
[0m17:45:47.771092 [debug] [Thread-1 (]: Began compiling node model.dbt_exercise.stg_categories_northwind
[0m17:45:47.778879 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_exercise.stg_categories_northwind"
[0m17:45:47.779858 [debug] [Thread-1 (]: Began executing node model.dbt_exercise.stg_categories_northwind
[0m17:45:47.810834 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_exercise.stg_categories_northwind"
[0m17:45:47.811748 [debug] [Thread-1 (]: On model.dbt_exercise.stg_categories_northwind: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "model.dbt_exercise.stg_categories_northwind"} */


  create or replace view `corded-sunlight-464012-e2`.`dbt_dw_staging`.`stg_categories_northwind`
  OPTIONS()
  as with raw_categories as (
    select *
    from `corded-sunlight-464012-e2`.`dbt_dw_raw`.`categories`
)

/* Ao construir a staging não vamos trazer a coluna picture, pois ela não traz informação relevante */
, stg_categories_northwind as (
    select
        cast(category_id as string) as category_id
        , cast(category_name as string) as category_name
        , cast(description as string) as description
    from raw_categories
)

select *
from stg_categories_northwind;


[0m17:45:47.812355 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:45:48.884713 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:120609d9-1fe1-4d22-ade4-272bce55370a&page=queryresults
[0m17:45:53.835795 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '51246473-9b22-483b-a42b-e655557ab8eb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78beba656840>]}
[0m17:45:53.837254 [info ] [Thread-1 (]: 1 of 1 OK created sql view model dbt_dw_staging.stg_categories_northwind ....... [[32mCREATE VIEW (0 processed)[0m in 6.05s]
[0m17:45:53.838429 [debug] [Thread-1 (]: Finished running node model.dbt_exercise.stg_categories_northwind
[0m17:45:53.842635 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:45:53.849853 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:45:53.850537 [debug] [MainThread]: Connection 'list_corded-sunlight-464012-e2_dbt_dw_intermediate' was properly closed.
[0m17:45:53.851088 [debug] [MainThread]: Connection 'list_corded-sunlight-464012-e2_dbt_dw_staging' was properly closed.
[0m17:45:53.851541 [debug] [MainThread]: Connection 'list_corded-sunlight-464012-e2_dbt_dw_marts' was properly closed.
[0m17:45:53.852030 [debug] [MainThread]: Connection 'model.dbt_exercise.stg_categories_northwind' was properly closed.
[0m17:45:53.852628 [info ] [MainThread]: 
[0m17:45:53.853338 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 8.84 seconds (8.84s).
[0m17:45:53.854573 [debug] [MainThread]: Command end result
[0m17:45:53.899605 [debug] [MainThread]: Wrote artifact WritableManifest to /home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/target/manifest.json
[0m17:45:53.914481 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/target/semantic_manifest.json
[0m17:45:53.922652 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/target/run_results.json
[0m17:45:53.923320 [info ] [MainThread]: 
[0m17:45:53.923848 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:45:53.924267 [info ] [MainThread]: 
[0m17:45:53.924680 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m17:45:53.925447 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- DuplicateYAMLKeysDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m17:45:53.929804 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 108.22298, "process_in_blocks": "123272", "process_kernel_time": 13.5457, "process_mem_max_rss": "366400", "process_out_blocks": "3512", "process_user_time": 11.296936}
[0m17:45:53.930513 [debug] [MainThread]: Command `dbt run` succeeded at 17:45:53.930341 after 108.22 seconds
[0m17:45:53.931194 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78bef2d905c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78beb5977740>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78beb58d09e0>]}
[0m17:45:53.931711 [debug] [MainThread]: Flushing usage events
[0m17:45:54.264473 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:47:16.539745 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7453e0a2a120>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7453e0a29670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7453e1142c30>]}


============================== 17:47:16.561565 | e042f717-92d6-409f-8f69-e48c55baff3e ==============================
[0m17:47:16.561565 [info ] [MainThread]: Running with dbt=1.10.2
[0m17:47:16.562622 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/logs', 'fail_fast': 'False', 'profiles_dir': '/home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run -s +int_products_northwind', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m17:48:04.009481 [warn ] [MainThread]: [[33mWARNING[0m][DuplicateYAMLKeysDeprecation]: Deprecated functionality
Duplicate key 'version' in "<unicode string>", line 4, column 1 in file
`/home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/dbt_project.yml`
[0m17:48:04.010639 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'e042f717-92d6-409f-8f69-e48c55baff3e', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7453ac40e3f0>]}
[0m17:48:04.650317 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e042f717-92d6-409f-8f69-e48c55baff3e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7453e01d6db0>]}
[0m17:48:04.709140 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e042f717-92d6-409f-8f69-e48c55baff3e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7453a38ef980>]}
[0m17:48:04.713651 [info ] [MainThread]: Registered adapter: bigquery=1.9.2
[0m17:48:52.057661 [debug] [MainThread]: checksum: 1adc40777973ef30f45f80b3b6d04d5013c1edd53d96363881b3b199e612468b, vars: {}, profile: , target: , version: 1.10.2
[0m17:48:56.926551 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:48:56.927051 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:48:56.977052 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e042f717-92d6-409f-8f69-e48c55baff3e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7453a2e40ef0>]}
[0m17:48:57.279185 [debug] [MainThread]: Wrote artifact WritableManifest to /home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/target/manifest.json
[0m17:48:57.291285 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/target/semantic_manifest.json
[0m17:48:57.663722 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e042f717-92d6-409f-8f69-e48c55baff3e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7453a3129eb0>]}
[0m17:48:57.664461 [info ] [MainThread]: Found 14 seeds, 36 data tests, 16 models, 14 sources, 609 macros
[0m17:48:57.665083 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e042f717-92d6-409f-8f69-e48c55baff3e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7453a31a2f30>]}
[0m17:48:57.667378 [info ] [MainThread]: 
[0m17:48:57.668105 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m17:48:57.668543 [info ] [MainThread]: 
[0m17:48:57.669103 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m17:48:57.673524 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_corded-sunlight-464012-e2'
[0m17:48:57.674614 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:48:57.676075 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_corded-sunlight-464012-e2'
[0m17:48:57.676912 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:48:58.990751 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_corded-sunlight-464012-e2, now list_corded-sunlight-464012-e2_dbt_dw_raw)
[0m17:48:58.992080 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_corded-sunlight-464012-e2, now list_corded-sunlight-464012-e2_dbt_dw_staging)
[0m17:48:58.993315 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_corded-sunlight-464012-e2_dbt_dw_intermediate'
[0m17:48:58.994135 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:48:58.995378 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_corded-sunlight-464012-e2_dbt_dw_marts'
[0m17:48:58.996165 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:48:58.996835 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:48:58.997747 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:48:59.914420 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e042f717-92d6-409f-8f69-e48c55baff3e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7453a2db2e70>]}
[0m17:48:59.915167 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:48:59.926105 [debug] [Thread-1 (]: Began running node model.dbt_exercise.stg_categories_northwind
[0m17:48:59.926832 [debug] [Thread-2 (]: Began running node model.dbt_exercise.stg_products_northwind
[0m17:48:59.928402 [debug] [Thread-3 (]: Began running node model.dbt_exercise.stg_suppliers_northwind
[0m17:48:59.927974 [info ] [Thread-1 (]: 1 of 4 START sql view model dbt_dw_staging.stg_categories_northwind ............ [RUN]
[0m17:48:59.929469 [info ] [Thread-2 (]: 2 of 4 START sql view model dbt_dw_staging.stg_products_northwind .............. [RUN]
[0m17:48:59.930467 [info ] [Thread-3 (]: 3 of 4 START sql view model dbt_dw_staging.stg_suppliers_northwind ............. [RUN]
[0m17:48:59.931953 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_corded-sunlight-464012-e2_dbt_dw_marts, now model.dbt_exercise.stg_categories_northwind)
[0m17:48:59.932970 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_corded-sunlight-464012-e2_dbt_dw_raw, now model.dbt_exercise.stg_products_northwind)
[0m17:48:59.934032 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_corded-sunlight-464012-e2_dbt_dw_intermediate, now model.dbt_exercise.stg_suppliers_northwind)
[0m17:48:59.935003 [debug] [Thread-1 (]: Began compiling node model.dbt_exercise.stg_categories_northwind
[0m17:48:59.936161 [debug] [Thread-2 (]: Began compiling node model.dbt_exercise.stg_products_northwind
[0m17:48:59.936838 [debug] [Thread-3 (]: Began compiling node model.dbt_exercise.stg_suppliers_northwind
[0m17:48:59.945954 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_exercise.stg_categories_northwind"
[0m17:48:59.950190 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_exercise.stg_products_northwind"
[0m17:48:59.955698 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_exercise.stg_suppliers_northwind"
[0m17:48:59.957730 [debug] [Thread-2 (]: Began executing node model.dbt_exercise.stg_products_northwind
[0m17:48:59.958806 [debug] [Thread-1 (]: Began executing node model.dbt_exercise.stg_categories_northwind
[0m17:48:59.999633 [debug] [Thread-3 (]: Began executing node model.dbt_exercise.stg_suppliers_northwind
[0m17:49:00.000860 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_exercise.stg_products_northwind"
[0m17:49:00.003103 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_exercise.stg_categories_northwind"
[0m17:49:00.006556 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_exercise.stg_suppliers_northwind"
[0m17:49:00.008567 [debug] [Thread-2 (]: On model.dbt_exercise.stg_products_northwind: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "model.dbt_exercise.stg_products_northwind"} */


  create or replace view `corded-sunlight-464012-e2`.`dbt_dw_staging`.`stg_products_northwind`
  OPTIONS()
  as with raw_products as (
    select *
    from `corded-sunlight-464012-e2`.`dbt_dw_raw`.`products`
)

, stg_products_northwind as (
    select
        cast(product_id as string) as product_id
        , cast(product_name as string) as product_name
        , cast(supplier_id as string) as supplier_id
        , cast(category_id as string) as category_id
        , cast(quantity_per_unit as string) as quantity_per_unit
        , cast(unit_price as numeric) as unit_price
        , cast(units_in_stock as numeric) as units_in_stock
        , cast(units_on_order as numeric) as units_on_order
        , cast(reorder_level as numeric) as reorder_level
        , cast(discontinued as integer) as discontinued
    from raw_products
)

select *
from stg_products_northwind;


[0m17:49:00.010260 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:49:00.011078 [debug] [Thread-3 (]: On model.dbt_exercise.stg_suppliers_northwind: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "model.dbt_exercise.stg_suppliers_northwind"} */


  create or replace view `corded-sunlight-464012-e2`.`dbt_dw_staging`.`stg_suppliers_northwind`
  OPTIONS()
  as with suppliers as (
    select *
    from `corded-sunlight-464012-e2`.`dbt_dw_raw`.`suppliers`
)

select 
    cast(supplier_id as string) as supplier_id
    , cast(company_name as string) as company_name
    , cast(contact_name as string) as contact_name
    , cast(contact_title as string) as contact_title
    , cast(address as string) as address
    , cast(city as string) as city
    , cast(region as string) as region
    , cast(postal_code as string) as postal_code
    , cast(country as string) as country
    , cast(phone as string) as phone
    , cast(fax as string) as fax
    , cast(homepage as string) as home_page
from suppliers;


[0m17:49:00.012047 [debug] [Thread-1 (]: On model.dbt_exercise.stg_categories_northwind: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "model.dbt_exercise.stg_categories_northwind"} */


  create or replace view `corded-sunlight-464012-e2`.`dbt_dw_staging`.`stg_categories_northwind`
  OPTIONS()
  as with raw_categories as (
    select *
    from `corded-sunlight-464012-e2`.`dbt_dw_raw`.`categories`
)

/* Ao construir a staging não vamos trazer a coluna picture, pois ela não traz informação relevante */
, stg_categories_northwind as (
    select
        cast(category_id as string) as category_id
        , cast(category_name as string) as category_name
        , cast(description as string) as description
    from raw_categories
)

select *
from stg_categories_northwind;


[0m17:49:00.013579 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m17:49:00.014755 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:49:01.070606 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:ec190ce2-a71b-4b49-a955-0198385ca0a9&page=queryresults
[0m17:49:01.116126 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:1da3532c-d93d-41ab-a9cc-518f05ef0fa7&page=queryresults
[0m17:49:01.143340 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:42413b42-e5b5-47f9-b887-1c4fe4852999&page=queryresults
[0m17:49:06.928179 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e042f717-92d6-409f-8f69-e48c55baff3e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7453a01bc110>]}
[0m17:49:06.928931 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e042f717-92d6-409f-8f69-e48c55baff3e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7453a01bebd0>]}
[0m17:49:06.929649 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e042f717-92d6-409f-8f69-e48c55baff3e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7453e1171ee0>]}
[0m17:49:06.930900 [info ] [Thread-1 (]: 1 of 4 OK created sql view model dbt_dw_staging.stg_categories_northwind ....... [[32mCREATE VIEW (0 processed)[0m in 6.98s]
[0m17:49:06.931815 [info ] [Thread-2 (]: 2 of 4 OK created sql view model dbt_dw_staging.stg_products_northwind ......... [[32mCREATE VIEW (0 processed)[0m in 6.98s]
[0m17:49:06.932746 [info ] [Thread-3 (]: 3 of 4 OK created sql view model dbt_dw_staging.stg_suppliers_northwind ........ [[32mCREATE VIEW (0 processed)[0m in 6.98s]
[0m17:49:06.933578 [debug] [Thread-1 (]: Finished running node model.dbt_exercise.stg_categories_northwind
[0m17:49:06.934708 [debug] [Thread-2 (]: Finished running node model.dbt_exercise.stg_products_northwind
[0m17:49:06.935703 [debug] [Thread-3 (]: Finished running node model.dbt_exercise.stg_suppliers_northwind
[0m17:49:06.938568 [debug] [Thread-4 (]: Began running node model.dbt_exercise.int_products_northwind
[0m17:49:06.939612 [info ] [Thread-4 (]: 4 of 4 START sql view model dbt_dw_intermediate.int_products_northwind ......... [RUN]
[0m17:49:06.940348 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly list_corded-sunlight-464012-e2_dbt_dw_staging, now model.dbt_exercise.int_products_northwind)
[0m17:49:06.940888 [debug] [Thread-4 (]: Began compiling node model.dbt_exercise.int_products_northwind
[0m17:49:06.944343 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_exercise.int_products_northwind"
[0m17:49:06.945486 [debug] [Thread-4 (]: Began executing node model.dbt_exercise.int_products_northwind
[0m17:49:06.948288 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_exercise.int_products_northwind"
[0m17:49:06.949283 [debug] [Thread-4 (]: On model.dbt_exercise.int_products_northwind: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "model.dbt_exercise.int_products_northwind"} */


  create or replace view `corded-sunlight-464012-e2`.`dbt_dw_intermediate`.`int_products_northwind`
  OPTIONS()
  as with stg_products_northwind as (
    select *
    from `corded-sunlight-464012-e2`.`dbt_dw_staging`.`stg_products_northwind`
)

, stg_categories_northwind as (
    select *
    from `corded-sunlight-464012-e2`.`dbt_dw_staging`.`stg_categories_northwind`
)

, stg_suppliers_northwind as (
    select *
    from `corded-sunlight-464012-e2`.`dbt_dw_staging`.`stg_suppliers_northwind`
)

, final_table as (
    select
        stg_products_northwind.product_id
        , stg_products_northwind.product_name
        , stg_products_northwind.quantity_per_unit
        , stg_categories_northwind.category_name
        , stg_suppliers_northwind.company_name as supplier_name
        , stg_suppliers_northwind.city as supplier_city
        , stg_suppliers_northwind.region as supplier_region
        , stg_suppliers_northwind.country as supplier_country
        , case
            when stg_suppliers_northwind.country in ('USA', 'Canada') then 'North America'
            when stg_suppliers_northwind.country in ('Brazil') then 'South America'
            when stg_suppliers_northwind.country in ('UK', 'Germany', 'Netherlands', 'Spain', 'France', 'Norway', 'Italy', 'Denmark', 'Sweden', 'Finland') then 'Europe'
            when stg_suppliers_northwind.country in ('Singapore', 'Japan') then 'Asia'
            when stg_suppliers_northwind.country in ('Australia') then 'Oceania'
            else 'Other'
          end as supplier_continent
        , case 
            when stg_products_northwind.discontinued = 1 then True
            else False
        end as is_discontinued
    from stg_products_northwind
    left join stg_categories_northwind
        on cast(stg_products_northwind.category_id as integer) = stg_categories_northwind.category_id
    left join stg_suppliers_northwind
        on stg_products_northwind.supplier_id = stg_suppliers_northwind.supplier_id
)

select *
from final_table;


[0m17:49:06.949978 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m17:49:08.043519 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:dbc74011-2ecc-4607-9690-b9553cfed414&page=queryresults
[0m17:49:08.435002 [error] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:dbc74011-2ecc-4607-9690-b9553cfed414&page=queryresults
[0m17:49:08.539525 [debug] [Thread-4 (]: Database Error in model int_products_northwind (models/intermediate/int_products_northwind.sql)
  No matching signature for operator = for argument types: INT64, STRING
    Signature: T1 = T1
      Unable to find common supertype for templated argument <T1>
        Input types for <T1>: {INT64, STRING} at [45:12]
  compiled code at target/run/dbt_exercise/models/intermediate/int_products_northwind.sql
[0m17:49:08.540206 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e042f717-92d6-409f-8f69-e48c55baff3e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7453a2a204d0>]}
[0m17:49:08.540926 [error] [Thread-4 (]: 4 of 4 ERROR creating sql view model dbt_dw_intermediate.int_products_northwind  [[31mERROR[0m in 1.60s]
[0m17:49:08.541558 [debug] [Thread-4 (]: Finished running node model.dbt_exercise.int_products_northwind
[0m17:49:08.542422 [debug] [Thread-7 (]: Marking all children of 'model.dbt_exercise.int_products_northwind' to be skipped because of status 'error'.  Reason: Database Error in model int_products_northwind (models/intermediate/int_products_northwind.sql)
  No matching signature for operator = for argument types: INT64, STRING
    Signature: T1 = T1
      Unable to find common supertype for templated argument <T1>
        Input types for <T1>: {INT64, STRING} at [45:12]
  compiled code at target/run/dbt_exercise/models/intermediate/int_products_northwind.sql.
[0m17:49:08.546473 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:49:08.552328 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:49:08.552978 [debug] [MainThread]: Connection 'model.dbt_exercise.stg_products_northwind' was properly closed.
[0m17:49:08.553300 [debug] [MainThread]: Connection 'model.dbt_exercise.int_products_northwind' was properly closed.
[0m17:49:08.553557 [debug] [MainThread]: Connection 'model.dbt_exercise.stg_suppliers_northwind' was properly closed.
[0m17:49:08.553829 [debug] [MainThread]: Connection 'model.dbt_exercise.stg_categories_northwind' was properly closed.
[0m17:49:08.554208 [info ] [MainThread]: 
[0m17:49:08.554613 [info ] [MainThread]: Finished running 4 view models in 0 hours 0 minutes and 10.89 seconds (10.89s).
[0m17:49:08.555600 [debug] [MainThread]: Command end result
[0m17:49:08.601317 [debug] [MainThread]: Wrote artifact WritableManifest to /home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/target/manifest.json
[0m17:49:08.615454 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/target/semantic_manifest.json
[0m17:49:08.620920 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/target/run_results.json
[0m17:49:08.621476 [info ] [MainThread]: 
[0m17:49:08.622130 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m17:49:08.622832 [info ] [MainThread]: 
[0m17:49:08.623402 [error] [MainThread]: [31mFailure in model int_products_northwind (models/intermediate/int_products_northwind.sql)[0m
[0m17:49:08.623847 [error] [MainThread]:   Database Error in model int_products_northwind (models/intermediate/int_products_northwind.sql)
  No matching signature for operator = for argument types: INT64, STRING
    Signature: T1 = T1
      Unable to find common supertype for templated argument <T1>
        Input types for <T1>: {INT64, STRING} at [45:12]
  compiled code at target/run/dbt_exercise/models/intermediate/int_products_northwind.sql
[0m17:49:08.624209 [info ] [MainThread]: 
[0m17:49:08.624664 [info ] [MainThread]:   compiled code at target/compiled/dbt_exercise/models/intermediate/int_products_northwind.sql
[0m17:49:08.625117 [info ] [MainThread]: 
[0m17:49:08.625635 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=4
[0m17:49:08.626417 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- DuplicateYAMLKeysDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m17:49:08.631075 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 107.84596, "process_in_blocks": "122928", "process_kernel_time": 13.86306, "process_mem_max_rss": "368932", "process_out_blocks": "3600", "process_user_time": 10.955483}
[0m17:49:08.631826 [debug] [MainThread]: Command `dbt run` failed at 17:49:08.631673 after 107.85 seconds
[0m17:49:08.633530 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7453e0297e30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7453e02b8a40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7453e02bb3e0>]}
[0m17:49:08.633925 [debug] [MainThread]: Flushing usage events
[0m17:49:09.045077 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:51:16.335368 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7897ef380650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7897ef2fbc80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7897eeb7e5d0>]}


============================== 17:51:16.352225 | a7974f5b-dc76-40c5-b0cb-91f954df14a8 ==============================
[0m17:51:16.352225 [info ] [MainThread]: Running with dbt=1.10.2
[0m17:51:16.352878 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run -s +int_products_northwind', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m17:52:03.038917 [warn ] [MainThread]: [[33mWARNING[0m][DuplicateYAMLKeysDeprecation]: Deprecated functionality
Duplicate key 'version' in "<unicode string>", line 4, column 1 in file
`/home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/dbt_project.yml`
[0m17:52:03.039525 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'a7974f5b-dc76-40c5-b0cb-91f954df14a8', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7897b11e1af0>]}
[0m17:52:03.622936 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a7974f5b-dc76-40c5-b0cb-91f954df14a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7897f086a8a0>]}
[0m17:52:03.677439 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a7974f5b-dc76-40c5-b0cb-91f954df14a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7897ef104b30>]}
[0m17:52:03.680571 [info ] [MainThread]: Registered adapter: bigquery=1.9.2
[0m17:52:50.111516 [debug] [MainThread]: checksum: 1adc40777973ef30f45f80b3b6d04d5013c1edd53d96363881b3b199e612468b, vars: {}, profile: , target: , version: 1.10.2
[0m17:52:54.835871 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:52:54.836403 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:52:54.883578 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a7974f5b-dc76-40c5-b0cb-91f954df14a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7897b0f58650>]}
[0m17:52:55.167402 [debug] [MainThread]: Wrote artifact WritableManifest to /home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/target/manifest.json
[0m17:52:55.181079 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/target/semantic_manifest.json
[0m17:52:55.577645 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a7974f5b-dc76-40c5-b0cb-91f954df14a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7897b0d88ec0>]}
[0m17:52:55.578232 [info ] [MainThread]: Found 14 seeds, 36 data tests, 16 models, 14 sources, 609 macros
[0m17:52:55.578655 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a7974f5b-dc76-40c5-b0cb-91f954df14a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7897ee04e0f0>]}
[0m17:52:55.580712 [info ] [MainThread]: 
[0m17:52:55.581205 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m17:52:55.581563 [info ] [MainThread]: 
[0m17:52:55.582238 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m17:52:55.586431 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_corded-sunlight-464012-e2'
[0m17:52:55.587981 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:52:55.589047 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_corded-sunlight-464012-e2'
[0m17:52:55.590160 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:52:56.787276 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_corded-sunlight-464012-e2, now list_corded-sunlight-464012-e2_dbt_dw_marts)
[0m17:52:56.788507 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:52:56.789854 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_corded-sunlight-464012-e2, now list_corded-sunlight-464012-e2_dbt_dw_staging)
[0m17:52:56.792034 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_corded-sunlight-464012-e2_dbt_dw_raw'
[0m17:52:56.792689 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:52:56.794213 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_corded-sunlight-464012-e2_dbt_dw_intermediate'
[0m17:52:56.794965 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:52:56.796239 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:52:57.668750 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a7974f5b-dc76-40c5-b0cb-91f954df14a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7897ee4a6ed0>]}
[0m17:52:57.669409 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:52:57.682759 [debug] [Thread-1 (]: Began running node model.dbt_exercise.stg_categories_northwind
[0m17:52:57.683642 [debug] [Thread-2 (]: Began running node model.dbt_exercise.stg_products_northwind
[0m17:52:57.684901 [debug] [Thread-3 (]: Began running node model.dbt_exercise.stg_suppliers_northwind
[0m17:52:57.686129 [info ] [Thread-1 (]: 1 of 4 START sql view model dbt_dw_staging.stg_categories_northwind ............ [RUN]
[0m17:52:57.687613 [info ] [Thread-2 (]: 2 of 4 START sql view model dbt_dw_staging.stg_products_northwind .............. [RUN]
[0m17:52:57.689025 [info ] [Thread-3 (]: 3 of 4 START sql view model dbt_dw_staging.stg_suppliers_northwind ............. [RUN]
[0m17:52:57.690874 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_corded-sunlight-464012-e2_dbt_dw_raw, now model.dbt_exercise.stg_categories_northwind)
[0m17:52:57.692204 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_corded-sunlight-464012-e2_dbt_dw_intermediate, now model.dbt_exercise.stg_products_northwind)
[0m17:52:57.693217 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_corded-sunlight-464012-e2_dbt_dw_staging, now model.dbt_exercise.stg_suppliers_northwind)
[0m17:52:57.694570 [debug] [Thread-1 (]: Began compiling node model.dbt_exercise.stg_categories_northwind
[0m17:52:57.696223 [debug] [Thread-2 (]: Began compiling node model.dbt_exercise.stg_products_northwind
[0m17:52:57.697163 [debug] [Thread-3 (]: Began compiling node model.dbt_exercise.stg_suppliers_northwind
[0m17:52:57.708451 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_exercise.stg_categories_northwind"
[0m17:52:57.712886 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_exercise.stg_products_northwind"
[0m17:52:57.717090 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_exercise.stg_suppliers_northwind"
[0m17:52:57.719234 [debug] [Thread-1 (]: Began executing node model.dbt_exercise.stg_categories_northwind
[0m17:52:57.721371 [debug] [Thread-2 (]: Began executing node model.dbt_exercise.stg_products_northwind
[0m17:52:57.728212 [debug] [Thread-3 (]: Began executing node model.dbt_exercise.stg_suppliers_northwind
[0m17:52:57.785178 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_exercise.stg_products_northwind"
[0m17:52:57.788034 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_exercise.stg_suppliers_northwind"
[0m17:52:57.790249 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_exercise.stg_categories_northwind"
[0m17:52:57.793227 [debug] [Thread-2 (]: On model.dbt_exercise.stg_products_northwind: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "model.dbt_exercise.stg_products_northwind"} */


  create or replace view `corded-sunlight-464012-e2`.`dbt_dw_staging`.`stg_products_northwind`
  OPTIONS()
  as with raw_products as (
    select *
    from `corded-sunlight-464012-e2`.`dbt_dw_raw`.`products`
)

, stg_products_northwind as (
    select
        cast(product_id as string) as product_id
        , cast(product_name as string) as product_name
        , cast(supplier_id as string) as supplier_id
        , cast(category_id as string) as category_id
        , cast(quantity_per_unit as string) as quantity_per_unit
        , cast(unit_price as numeric) as unit_price
        , cast(units_in_stock as numeric) as units_in_stock
        , cast(units_on_order as numeric) as units_on_order
        , cast(reorder_level as numeric) as reorder_level
        , cast(discontinued as integer) as discontinued
    from raw_products
)

select *
from stg_products_northwind;


[0m17:52:57.794223 [debug] [Thread-3 (]: On model.dbt_exercise.stg_suppliers_northwind: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "model.dbt_exercise.stg_suppliers_northwind"} */


  create or replace view `corded-sunlight-464012-e2`.`dbt_dw_staging`.`stg_suppliers_northwind`
  OPTIONS()
  as with raw_suppliers as (
    select *
    from `corded-sunlight-464012-e2`.`dbt_dw_raw`.`suppliers`
)

, stg_suppliers_northwind as (
    select
        cast(supplier_id as string) as supplier_id
        , cast(company_name as string) as company_name
        , cast(contact_name as string) as contact_name
        , cast(contact_title as string) as contact_title
        , cast(address as string) as address
        , cast(city as string) as city
        , cast(region as string) as region
        , cast(postal_code as string) as postal_code
        , cast(country as string) as country
        , cast(phone as string) as phone
        , cast(fax as string) as fax
        , cast(homepage as string) as home_page
    from raw_suppliers
)

select *
from stg_suppliers_northwindsuppliers;


[0m17:52:57.795458 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:52:57.796597 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m17:52:57.797485 [debug] [Thread-1 (]: On model.dbt_exercise.stg_categories_northwind: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "model.dbt_exercise.stg_categories_northwind"} */


  create or replace view `corded-sunlight-464012-e2`.`dbt_dw_staging`.`stg_categories_northwind`
  OPTIONS()
  as with raw_categories as (
    select *
    from `corded-sunlight-464012-e2`.`dbt_dw_raw`.`categories`
)

/* Ao construir a staging não vamos trazer a coluna picture, pois ela não traz informação relevante */
, stg_categories_northwind as (
    select
        cast(category_id as string) as category_id
        , cast(category_name as string) as category_name
        , cast(description as string) as description
    from raw_categories
)

select *
from stg_categories_northwind;


[0m17:52:57.798647 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:52:58.677384 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:0a6e60f9-82b2-4714-854c-a484fe4ba6c7&page=queryresults
[0m17:52:58.678336 [error] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:0a6e60f9-82b2-4714-854c-a484fe4ba6c7&page=queryresults
[0m17:52:59.888513 [debug] [Thread-3 (]: Database Error in model stg_suppliers_northwind (models/staging/stg_suppliers_northwind.sql)
  Table "stg_suppliers_northwindsuppliers" must be qualified with a dataset (e.g. dataset.table).
  compiled code at target/run/dbt_exercise/models/staging/stg_suppliers_northwind.sql
[0m17:52:59.904100 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a7974f5b-dc76-40c5-b0cb-91f954df14a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7897b0a61160>]}
[0m17:52:59.904925 [error] [Thread-3 (]: 3 of 4 ERROR creating sql view model dbt_dw_staging.stg_suppliers_northwind .... [[31mERROR[0m in 2.20s]
[0m17:52:59.905611 [debug] [Thread-3 (]: Finished running node model.dbt_exercise.stg_suppliers_northwind
[0m17:52:59.906892 [debug] [Thread-7 (]: Marking all children of 'model.dbt_exercise.stg_suppliers_northwind' to be skipped because of status 'error'.  Reason: Database Error in model stg_suppliers_northwind (models/staging/stg_suppliers_northwind.sql)
  Table "stg_suppliers_northwindsuppliers" must be qualified with a dataset (e.g. dataset.table).
  compiled code at target/run/dbt_exercise/models/staging/stg_suppliers_northwind.sql.
[0m17:52:59.959198 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:b6b8c1b3-e075-4fb3-92b1-a6d006524def&page=queryresults
[0m17:53:00.200913 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:8c9470f8-5186-4d08-a11d-118771627fad&page=queryresults
[0m17:53:04.843701 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a7974f5b-dc76-40c5-b0cb-91f954df14a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7897b5db2810>]}
[0m17:53:04.844883 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a7974f5b-dc76-40c5-b0cb-91f954df14a8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7897b0ec7080>]}
[0m17:53:04.845637 [info ] [Thread-1 (]: 1 of 4 OK created sql view model dbt_dw_staging.stg_categories_northwind ....... [[32mCREATE VIEW (0 processed)[0m in 7.15s]
[0m17:53:04.846969 [info ] [Thread-2 (]: 2 of 4 OK created sql view model dbt_dw_staging.stg_products_northwind ......... [[32mCREATE VIEW (0 processed)[0m in 7.15s]
[0m17:53:04.848145 [debug] [Thread-1 (]: Finished running node model.dbt_exercise.stg_categories_northwind
[0m17:53:04.848921 [debug] [Thread-2 (]: Finished running node model.dbt_exercise.stg_products_northwind
[0m17:53:04.851331 [debug] [Thread-4 (]: Began running node model.dbt_exercise.int_products_northwind
[0m17:53:04.852394 [info ] [Thread-4 (]: 4 of 4 SKIP relation dbt_dw_intermediate.int_products_northwind ................ [[33mSKIP[0m]
[0m17:53:04.852998 [debug] [Thread-4 (]: Finished running node model.dbt_exercise.int_products_northwind
[0m17:53:04.855844 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:53:04.862556 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:53:04.863110 [debug] [MainThread]: Connection 'model.dbt_exercise.stg_suppliers_northwind' was properly closed.
[0m17:53:04.863444 [debug] [MainThread]: Connection 'list_corded-sunlight-464012-e2_dbt_dw_marts' was properly closed.
[0m17:53:04.863782 [debug] [MainThread]: Connection 'model.dbt_exercise.stg_categories_northwind' was properly closed.
[0m17:53:04.864148 [debug] [MainThread]: Connection 'model.dbt_exercise.stg_products_northwind' was properly closed.
[0m17:53:04.864671 [info ] [MainThread]: 
[0m17:53:04.865116 [info ] [MainThread]: Finished running 4 view models in 0 hours 0 minutes and 9.28 seconds (9.28s).
[0m17:53:04.866374 [debug] [MainThread]: Command end result
[0m17:53:04.928987 [debug] [MainThread]: Wrote artifact WritableManifest to /home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/target/manifest.json
[0m17:53:04.943376 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/target/semantic_manifest.json
[0m17:53:04.949188 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/target/run_results.json
[0m17:53:04.949915 [info ] [MainThread]: 
[0m17:53:04.950968 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m17:53:04.951963 [info ] [MainThread]: 
[0m17:53:04.953106 [error] [MainThread]: [31mFailure in model stg_suppliers_northwind (models/staging/stg_suppliers_northwind.sql)[0m
[0m17:53:04.953831 [error] [MainThread]:   Database Error in model stg_suppliers_northwind (models/staging/stg_suppliers_northwind.sql)
  Table "stg_suppliers_northwindsuppliers" must be qualified with a dataset (e.g. dataset.table).
  compiled code at target/run/dbt_exercise/models/staging/stg_suppliers_northwind.sql
[0m17:53:04.954399 [info ] [MainThread]: 
[0m17:53:04.954901 [info ] [MainThread]:   compiled code at target/compiled/dbt_exercise/models/staging/stg_suppliers_northwind.sql
[0m17:53:04.955448 [info ] [MainThread]: 
[0m17:53:04.956002 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=1 NO-OP=0 TOTAL=4
[0m17:53:04.956860 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- DuplicateYAMLKeysDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m17:53:04.961040 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 104.21802, "process_in_blocks": "122928", "process_kernel_time": 13.690334, "process_mem_max_rss": "368560", "process_out_blocks": "3560", "process_user_time": 10.814541}
[0m17:53:04.961646 [debug] [MainThread]: Command `dbt run` failed at 17:53:04.961487 after 104.22 seconds
[0m17:53:04.962149 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7897ee7f3ef0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7897a8de8950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7897a8de8ce0>]}
[0m17:53:04.962569 [debug] [MainThread]: Flushing usage events
[0m17:53:05.297903 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:53:42.213710 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76ba8087d4c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76ba811320f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76ba809f93d0>]}


============================== 17:53:42.230373 | 7f73a1a4-e867-4362-8bda-46bda51d2510 ==============================
[0m17:53:42.230373 [info ] [MainThread]: Running with dbt=1.10.2
[0m17:53:42.231010 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run -s +int_products_northwind', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:54:27.780759 [warn ] [MainThread]: [[33mWARNING[0m][DuplicateYAMLKeysDeprecation]: Deprecated functionality
Duplicate key 'version' in "<unicode string>", line 4, column 1 in file
`/home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/dbt_project.yml`
[0m17:54:27.781403 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '7f73a1a4-e867-4362-8bda-46bda51d2510', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76ba434b7410>]}
[0m17:54:28.351846 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7f73a1a4-e867-4362-8bda-46bda51d2510', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76ba432c8380>]}
[0m17:54:28.408451 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7f73a1a4-e867-4362-8bda-46bda51d2510', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76ba4311b3b0>]}
[0m17:54:28.412651 [info ] [MainThread]: Registered adapter: bigquery=1.9.2
[0m17:55:14.962197 [debug] [MainThread]: checksum: 1adc40777973ef30f45f80b3b6d04d5013c1edd53d96363881b3b199e612468b, vars: {}, profile: , target: , version: 1.10.2
[0m17:55:19.661400 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:55:19.661844 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:55:19.712808 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7f73a1a4-e867-4362-8bda-46bda51d2510', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76ba42f26b70>]}
[0m17:55:19.976317 [debug] [MainThread]: Wrote artifact WritableManifest to /home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/target/manifest.json
[0m17:55:19.988773 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/target/semantic_manifest.json
[0m17:55:20.359107 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7f73a1a4-e867-4362-8bda-46bda51d2510', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76ba42f873e0>]}
[0m17:55:20.359739 [info ] [MainThread]: Found 14 seeds, 36 data tests, 16 models, 14 sources, 609 macros
[0m17:55:20.360132 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7f73a1a4-e867-4362-8bda-46bda51d2510', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76ba42d05760>]}
[0m17:55:20.362126 [info ] [MainThread]: 
[0m17:55:20.362746 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m17:55:20.363150 [info ] [MainThread]: 
[0m17:55:20.363696 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m17:55:20.367997 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_corded-sunlight-464012-e2'
[0m17:55:20.369915 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_corded-sunlight-464012-e2'
[0m17:55:20.370616 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:55:20.371425 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:55:21.614109 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_corded-sunlight-464012-e2, now list_corded-sunlight-464012-e2_dbt_dw_marts)
[0m17:55:21.615255 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_corded-sunlight-464012-e2, now list_corded-sunlight-464012-e2_dbt_dw_staging)
[0m17:55:21.615820 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:55:21.617211 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_corded-sunlight-464012-e2_dbt_dw_intermediate'
[0m17:55:21.618513 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:55:21.619268 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_corded-sunlight-464012-e2_dbt_dw_raw'
[0m17:55:21.620319 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:55:21.621262 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:55:23.397909 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7f73a1a4-e867-4362-8bda-46bda51d2510', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76ba4320c560>]}
[0m17:55:23.398570 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:55:23.410413 [debug] [Thread-1 (]: Began running node model.dbt_exercise.stg_categories_northwind
[0m17:55:23.411047 [debug] [Thread-2 (]: Began running node model.dbt_exercise.stg_products_northwind
[0m17:55:23.411717 [debug] [Thread-3 (]: Began running node model.dbt_exercise.stg_suppliers_northwind
[0m17:55:23.412628 [info ] [Thread-1 (]: 1 of 4 START sql view model dbt_dw_staging.stg_categories_northwind ............ [RUN]
[0m17:55:23.413595 [info ] [Thread-2 (]: 2 of 4 START sql view model dbt_dw_staging.stg_products_northwind .............. [RUN]
[0m17:55:23.414300 [info ] [Thread-3 (]: 3 of 4 START sql view model dbt_dw_staging.stg_suppliers_northwind ............. [RUN]
[0m17:55:23.415104 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_corded-sunlight-464012-e2_dbt_dw_staging, now model.dbt_exercise.stg_categories_northwind)
[0m17:55:23.415738 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_corded-sunlight-464012-e2_dbt_dw_marts, now model.dbt_exercise.stg_products_northwind)
[0m17:55:23.416316 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_corded-sunlight-464012-e2_dbt_dw_raw, now model.dbt_exercise.stg_suppliers_northwind)
[0m17:55:23.417227 [debug] [Thread-1 (]: Began compiling node model.dbt_exercise.stg_categories_northwind
[0m17:55:23.417798 [debug] [Thread-2 (]: Began compiling node model.dbt_exercise.stg_products_northwind
[0m17:55:23.418462 [debug] [Thread-3 (]: Began compiling node model.dbt_exercise.stg_suppliers_northwind
[0m17:55:23.428732 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_exercise.stg_categories_northwind"
[0m17:55:23.432479 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_exercise.stg_products_northwind"
[0m17:55:23.436945 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_exercise.stg_suppliers_northwind"
[0m17:55:23.438672 [debug] [Thread-1 (]: Began executing node model.dbt_exercise.stg_categories_northwind
[0m17:55:23.445536 [debug] [Thread-2 (]: Began executing node model.dbt_exercise.stg_products_northwind
[0m17:55:23.452883 [debug] [Thread-3 (]: Began executing node model.dbt_exercise.stg_suppliers_northwind
[0m17:55:23.491979 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_exercise.stg_categories_northwind"
[0m17:55:23.495943 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_exercise.stg_products_northwind"
[0m17:55:23.499464 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_exercise.stg_suppliers_northwind"
[0m17:55:23.501325 [debug] [Thread-1 (]: On model.dbt_exercise.stg_categories_northwind: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "model.dbt_exercise.stg_categories_northwind"} */


  create or replace view `corded-sunlight-464012-e2`.`dbt_dw_staging`.`stg_categories_northwind`
  OPTIONS()
  as with raw_categories as (
    select *
    from `corded-sunlight-464012-e2`.`dbt_dw_raw`.`categories`
)

/* Ao construir a staging não vamos trazer a coluna picture, pois ela não traz informação relevante */
, stg_categories_northwind as (
    select
        cast(category_id as string) as category_id
        , cast(category_name as string) as category_name
        , cast(description as string) as description
    from raw_categories
)

select *
from stg_categories_northwind;


[0m17:55:23.502537 [debug] [Thread-3 (]: On model.dbt_exercise.stg_suppliers_northwind: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "model.dbt_exercise.stg_suppliers_northwind"} */


  create or replace view `corded-sunlight-464012-e2`.`dbt_dw_staging`.`stg_suppliers_northwind`
  OPTIONS()
  as with raw_suppliers as (
    select *
    from `corded-sunlight-464012-e2`.`dbt_dw_raw`.`suppliers`
)

, stg_suppliers_northwind as (
    select
        cast(supplier_id as string) as supplier_id
        , cast(company_name as string) as company_name
        , cast(contact_name as string) as contact_name
        , cast(contact_title as string) as contact_title
        , cast(address as string) as address
        , cast(city as string) as city
        , cast(region as string) as region
        , cast(postal_code as string) as postal_code
        , cast(country as string) as country
        , cast(phone as string) as phone
        , cast(fax as string) as fax
        , cast(homepage as string) as home_page
    from raw_suppliers
)

select *
from stg_suppliers_northwind;


[0m17:55:23.503119 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:55:23.503975 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m17:55:23.505084 [debug] [Thread-2 (]: On model.dbt_exercise.stg_products_northwind: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "model.dbt_exercise.stg_products_northwind"} */


  create or replace view `corded-sunlight-464012-e2`.`dbt_dw_staging`.`stg_products_northwind`
  OPTIONS()
  as with raw_products as (
    select *
    from `corded-sunlight-464012-e2`.`dbt_dw_raw`.`products`
)

, stg_products_northwind as (
    select
        cast(product_id as string) as product_id
        , cast(product_name as string) as product_name
        , cast(supplier_id as string) as supplier_id
        , cast(category_id as string) as category_id
        , cast(quantity_per_unit as string) as quantity_per_unit
        , cast(unit_price as numeric) as unit_price
        , cast(units_in_stock as numeric) as units_in_stock
        , cast(units_on_order as numeric) as units_on_order
        , cast(reorder_level as numeric) as reorder_level
        , cast(discontinued as integer) as discontinued
    from raw_products
)

select *
from stg_products_northwind;


[0m17:55:23.506432 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:55:24.566841 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:db5378b0-caad-4119-aa53-66f194c8e0b0&page=queryresults
[0m17:55:24.576548 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:b01006fa-df29-4f1d-ad3d-4731c336a1b8&page=queryresults
[0m17:55:24.606977 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:88445d2d-85ed-4ebc-9cca-4ee8cbd2b94e&page=queryresults
[0m17:55:29.390085 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7f73a1a4-e867-4362-8bda-46bda51d2510', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76ba4315eb40>]}
[0m17:55:29.390861 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7f73a1a4-e867-4362-8bda-46bda51d2510', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76ba47eee330>]}
[0m17:55:29.391591 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7f73a1a4-e867-4362-8bda-46bda51d2510', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76ba810c5df0>]}
[0m17:55:29.392509 [info ] [Thread-2 (]: 2 of 4 OK created sql view model dbt_dw_staging.stg_products_northwind ......... [[32mCREATE VIEW (0 processed)[0m in 5.96s]
[0m17:55:29.393673 [info ] [Thread-1 (]: 1 of 4 OK created sql view model dbt_dw_staging.stg_categories_northwind ....... [[32mCREATE VIEW (0 processed)[0m in 5.97s]
[0m17:55:29.394576 [info ] [Thread-3 (]: 3 of 4 OK created sql view model dbt_dw_staging.stg_suppliers_northwind ........ [[32mCREATE VIEW (0 processed)[0m in 5.97s]
[0m17:55:29.395588 [debug] [Thread-2 (]: Finished running node model.dbt_exercise.stg_products_northwind
[0m17:55:29.396516 [debug] [Thread-1 (]: Finished running node model.dbt_exercise.stg_categories_northwind
[0m17:55:29.397520 [debug] [Thread-3 (]: Finished running node model.dbt_exercise.stg_suppliers_northwind
[0m17:55:29.399462 [debug] [Thread-4 (]: Began running node model.dbt_exercise.int_products_northwind
[0m17:55:29.400994 [info ] [Thread-4 (]: 4 of 4 START sql view model dbt_dw_intermediate.int_products_northwind ......... [RUN]
[0m17:55:29.402060 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly list_corded-sunlight-464012-e2_dbt_dw_intermediate, now model.dbt_exercise.int_products_northwind)
[0m17:55:29.403273 [debug] [Thread-4 (]: Began compiling node model.dbt_exercise.int_products_northwind
[0m17:55:29.408225 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_exercise.int_products_northwind"
[0m17:55:29.409501 [debug] [Thread-4 (]: Began executing node model.dbt_exercise.int_products_northwind
[0m17:55:29.412416 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_exercise.int_products_northwind"
[0m17:55:29.414099 [debug] [Thread-4 (]: On model.dbt_exercise.int_products_northwind: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "model.dbt_exercise.int_products_northwind"} */


  create or replace view `corded-sunlight-464012-e2`.`dbt_dw_intermediate`.`int_products_northwind`
  OPTIONS()
  as with stg_products_northwind as (
    select *
    from `corded-sunlight-464012-e2`.`dbt_dw_staging`.`stg_products_northwind`
)

, stg_categories_northwind as (
    select *
    from `corded-sunlight-464012-e2`.`dbt_dw_staging`.`stg_categories_northwind`
)

, stg_suppliers_northwind as (
    select *
    from `corded-sunlight-464012-e2`.`dbt_dw_staging`.`stg_suppliers_northwind`
)

, final_table as (
    select
        stg_products_northwind.product_id
        , stg_products_northwind.product_name
        , stg_products_northwind.quantity_per_unit
        , stg_categories_northwind.category_name
        , stg_suppliers_northwind.company_name as supplier_name
        , stg_suppliers_northwind.city as supplier_city
        , stg_suppliers_northwind.region as supplier_region
        , stg_suppliers_northwind.country as supplier_country
        , case
            when stg_suppliers_northwind.country in ('USA', 'Canada') then 'North America'
            when stg_suppliers_northwind.country in ('Brazil') then 'South America'
            when stg_suppliers_northwind.country in ('UK', 'Germany', 'Netherlands', 'Spain', 'France', 'Norway', 'Italy', 'Denmark', 'Sweden', 'Finland') then 'Europe'
            when stg_suppliers_northwind.country in ('Singapore', 'Japan') then 'Asia'
            when stg_suppliers_northwind.country in ('Australia') then 'Oceania'
            else 'Other'
          end as supplier_continent
        , case 
            when stg_products_northwind.discontinued = 1 then True
            else False
        end as is_discontinued
    from stg_products_northwind
    left join stg_categories_northwind
        on stg_products_northwind.category_id = stg_categories_northwind.category_id
    left join stg_suppliers_northwind
        on stg_products_northwind.supplier_id = stg_suppliers_northwind.supplier_id
)

select *
from final_table;


[0m17:55:29.414785 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m17:55:30.511184 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:b46a8a12-2635-47cb-904b-cb08617af222&page=queryresults
[0m17:55:31.140170 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7f73a1a4-e867-4362-8bda-46bda51d2510', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76ba401dcd70>]}
[0m17:55:31.141079 [info ] [Thread-4 (]: 4 of 4 OK created sql view model dbt_dw_intermediate.int_products_northwind .... [[32mCREATE VIEW (0 processed)[0m in 1.74s]
[0m17:55:31.141874 [debug] [Thread-4 (]: Finished running node model.dbt_exercise.int_products_northwind
[0m17:55:31.145360 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:55:31.153083 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:55:31.153588 [debug] [MainThread]: Connection 'model.dbt_exercise.stg_products_northwind' was properly closed.
[0m17:55:31.153962 [debug] [MainThread]: Connection 'model.dbt_exercise.stg_categories_northwind' was properly closed.
[0m17:55:31.154287 [debug] [MainThread]: Connection 'model.dbt_exercise.int_products_northwind' was properly closed.
[0m17:55:31.154619 [debug] [MainThread]: Connection 'model.dbt_exercise.stg_suppliers_northwind' was properly closed.
[0m17:55:31.155041 [info ] [MainThread]: 
[0m17:55:31.155418 [info ] [MainThread]: Finished running 4 view models in 0 hours 0 minutes and 10.79 seconds (10.79s).
[0m17:55:31.156357 [debug] [MainThread]: Command end result
[0m17:55:31.198622 [debug] [MainThread]: Wrote artifact WritableManifest to /home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/target/manifest.json
[0m17:55:31.210419 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/target/semantic_manifest.json
[0m17:55:31.216014 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/target/run_results.json
[0m17:55:31.216594 [info ] [MainThread]: 
[0m17:55:31.217198 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:55:31.217555 [info ] [MainThread]: 
[0m17:55:31.217939 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=4
[0m17:55:31.218477 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- DuplicateYAMLKeysDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m17:55:31.222632 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 106.35293, "process_in_blocks": "122920", "process_kernel_time": 13.112563, "process_mem_max_rss": "368040", "process_out_blocks": "3616", "process_user_time": 10.573277}
[0m17:55:31.223305 [debug] [MainThread]: Command `dbt run` succeeded at 17:55:31.223158 after 106.35 seconds
[0m17:55:31.223769 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76ba80a63a70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76ba432f5e20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76ba4320cef0>]}
[0m17:55:31.224297 [debug] [MainThread]: Flushing usage events
[0m17:55:31.622912 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:55:55.964326 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77e5e1be3aa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77e5e177ac60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77e5e1e8f1a0>]}


============================== 17:55:55.980648 | 46722dd7-3f50-42e9-95b0-e52aeb674d99 ==============================
[0m17:55:55.980648 [info ] [MainThread]: Running with dbt=1.10.2
[0m17:55:55.981231 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise', 'log_path': '/home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt run', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:56:42.740394 [warn ] [MainThread]: [[33mWARNING[0m][DuplicateYAMLKeysDeprecation]: Deprecated functionality
Duplicate key 'version' in "<unicode string>", line 4, column 1 in file
`/home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/dbt_project.yml`
[0m17:56:42.741809 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '46722dd7-3f50-42e9-95b0-e52aeb674d99', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77e5a45a2720>]}
[0m17:56:43.536418 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '46722dd7-3f50-42e9-95b0-e52aeb674d99', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77e5a42cffb0>]}
[0m17:56:43.603698 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '46722dd7-3f50-42e9-95b0-e52aeb674d99', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77e5a43ae3c0>]}
[0m17:56:43.608855 [info ] [MainThread]: Registered adapter: bigquery=1.9.2
[0m17:57:30.287142 [debug] [MainThread]: checksum: 1adc40777973ef30f45f80b3b6d04d5013c1edd53d96363881b3b199e612468b, vars: {}, profile: , target: , version: 1.10.2
[0m17:57:35.027743 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:57:35.028374 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:57:35.076288 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '46722dd7-3f50-42e9-95b0-e52aeb674d99', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77e5e141f950>]}
[0m17:57:35.387957 [debug] [MainThread]: Wrote artifact WritableManifest to /home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/target/manifest.json
[0m17:57:35.400755 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/target/semantic_manifest.json
[0m17:57:35.763795 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '46722dd7-3f50-42e9-95b0-e52aeb674d99', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77e5a4286d80>]}
[0m17:57:35.764516 [info ] [MainThread]: Found 14 seeds, 36 data tests, 16 models, 14 sources, 609 macros
[0m17:57:35.765009 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '46722dd7-3f50-42e9-95b0-e52aeb674d99', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77e5a425be30>]}
[0m17:57:35.767814 [info ] [MainThread]: 
[0m17:57:35.768542 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m17:57:35.768945 [info ] [MainThread]: 
[0m17:57:35.769569 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m17:57:35.775348 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_corded-sunlight-464012-e2'
[0m17:57:35.776949 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:57:35.778163 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_corded-sunlight-464012-e2'
[0m17:57:35.779580 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_corded-sunlight-464012-e2'
[0m17:57:35.780742 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:57:35.781342 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:57:36.973350 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_corded-sunlight-464012-e2, now list_corded-sunlight-464012-e2_dbt_dw_staging)
[0m17:57:36.975111 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_corded-sunlight-464012-e2, now list_corded-sunlight-464012-e2_dbt_dw_intermediate)
[0m17:57:36.975840 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:57:36.976771 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_corded-sunlight-464012-e2, now list_corded-sunlight-464012-e2_dbt_dw_raw)
[0m17:57:36.977806 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_corded-sunlight-464012-e2_dbt_dw_marts'
[0m17:57:36.978344 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:57:36.979364 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:57:36.980099 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:57:38.026336 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '46722dd7-3f50-42e9-95b0-e52aeb674d99', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77e5e3ca3a70>]}
[0m17:57:38.027184 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:57:38.037351 [debug] [Thread-1 (]: Began running node model.dbt_exercise.stg_categories_northwind
[0m17:57:38.038065 [debug] [Thread-2 (]: Began running node model.dbt_exercise.stg_customers_northwind
[0m17:57:38.038640 [debug] [Thread-3 (]: Began running node model.dbt_exercise.stg_employee_territories
[0m17:57:38.040839 [debug] [Thread-4 (]: Began running node model.dbt_exercise.stg_employees_northwind
[0m17:57:38.039738 [info ] [Thread-1 (]: 1 of 15 START sql view model dbt_dw_staging.stg_categories_northwind ........... [RUN]
[0m17:57:38.042606 [info ] [Thread-2 (]: 2 of 15 START sql view model dbt_dw_staging.stg_customers_northwind ............ [RUN]
[0m17:57:38.043782 [info ] [Thread-3 (]: 3 of 15 START sql view model dbt_dw_staging.stg_employee_territories ........... [RUN]
[0m17:57:38.044794 [info ] [Thread-4 (]: 4 of 15 START sql view model dbt_dw_staging.stg_employees_northwind ............ [RUN]
[0m17:57:38.046119 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_corded-sunlight-464012-e2_dbt_dw_raw, now model.dbt_exercise.stg_categories_northwind)
[0m17:57:38.047751 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_corded-sunlight-464012-e2_dbt_dw_marts, now model.dbt_exercise.stg_customers_northwind)
[0m17:57:38.048735 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_corded-sunlight-464012-e2_dbt_dw_staging, now model.dbt_exercise.stg_employee_territories)
[0m17:57:38.049735 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly list_corded-sunlight-464012-e2_dbt_dw_intermediate, now model.dbt_exercise.stg_employees_northwind)
[0m17:57:38.050622 [debug] [Thread-1 (]: Began compiling node model.dbt_exercise.stg_categories_northwind
[0m17:57:38.051215 [debug] [Thread-2 (]: Began compiling node model.dbt_exercise.stg_customers_northwind
[0m17:57:38.051906 [debug] [Thread-3 (]: Began compiling node model.dbt_exercise.stg_employee_territories
[0m17:57:38.052755 [debug] [Thread-4 (]: Began compiling node model.dbt_exercise.stg_employees_northwind
[0m17:57:38.063792 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_exercise.stg_categories_northwind"
[0m17:57:38.069410 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_exercise.stg_customers_northwind"
[0m17:57:38.073772 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_exercise.stg_employee_territories"
[0m17:57:38.079347 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_exercise.stg_employees_northwind"
[0m17:57:38.082148 [debug] [Thread-1 (]: Began executing node model.dbt_exercise.stg_categories_northwind
[0m17:57:38.083564 [debug] [Thread-3 (]: Began executing node model.dbt_exercise.stg_employee_territories
[0m17:57:38.090372 [debug] [Thread-2 (]: Began executing node model.dbt_exercise.stg_customers_northwind
[0m17:57:38.107864 [debug] [Thread-4 (]: Began executing node model.dbt_exercise.stg_employees_northwind
[0m17:57:38.132019 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_exercise.stg_employee_territories"
[0m17:57:38.134858 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_exercise.stg_categories_northwind"
[0m17:57:38.137693 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_exercise.stg_customers_northwind"
[0m17:57:38.142018 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_exercise.stg_employees_northwind"
[0m17:57:38.145306 [debug] [Thread-3 (]: On model.dbt_exercise.stg_employee_territories: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "model.dbt_exercise.stg_employee_territories"} */


  create or replace view `corded-sunlight-464012-e2`.`dbt_dw_staging`.`stg_employee_territories`
  OPTIONS()
  as with raw_employee_territories as (
    select *
    from `corded-sunlight-464012-e2`.`dbt_dw_raw`.`employee_territories`
)

, stg_employee_territories as (
    select
        cast(employee_id as string) as employee_id
        , cast(territory_id as string) as territory_id
    from raw_employee_territories
)

select *
from stg_employee_territories;


[0m17:57:38.146128 [debug] [Thread-2 (]: On model.dbt_exercise.stg_customers_northwind: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "model.dbt_exercise.stg_customers_northwind"} */


  create or replace view `corded-sunlight-464012-e2`.`dbt_dw_staging`.`stg_customers_northwind`
  OPTIONS()
  as with raw_customers as (
    select *
    from `corded-sunlight-464012-e2`.`dbt_dw_raw`.`customers`
)

, stg_customers_northwind as (
    select
        cast(customer_id as string) as customer_id
        , cast(company_name as string) as company_name
        , cast(contact_name as string) as contact_name
        , cast(contact_title as string) as contact_title
        , cast(address as string) as address
        , cast(city as string) as city
        , cast(region as string) as region
        , cast(postal_code as string) as postal_code
        , cast(country as string) as country
        , cast(phone as string) as phone
        , cast(fax as string) as fax
    from raw_customers
)

select *
from stg_customers_northwind;


[0m17:57:38.146744 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m17:57:38.147566 [debug] [Thread-4 (]: On model.dbt_exercise.stg_employees_northwind: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "model.dbt_exercise.stg_employees_northwind"} */


  create or replace view `corded-sunlight-464012-e2`.`dbt_dw_staging`.`stg_employees_northwind`
  OPTIONS()
  as with raw_employees as (
    select *
    from `corded-sunlight-464012-e2`.`dbt_dw_raw`.`employees`
)

/* Os campos photo, notes e reports_to e photo_path não são carregadas na staging */

, stg_employees_northwind as (
    select
        cast(employee_id as string) as employee_id
        , cast(first_name as string) as first_name
        , cast(last_name as string) as last_name
        , cast(title as string) as title
        , cast(title_of_courtesy as string) as title_of_courtesy
        , cast(birth_date as date) as birth_date
        , cast(hire_date as date) as hire_date
        , cast(address as string) as address
        , cast(city as string) as city
        , cast(region as string) as region
        , cast(postal_code as string) as postal_code
        , cast(country as string) as country
        , cast(home_phone as string) as home_phone
        , cast(extension as string) as extension
    from raw_employees
)

select *
from stg_employees_northwind;


[0m17:57:38.148861 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:57:38.150125 [debug] [Thread-1 (]: On model.dbt_exercise.stg_categories_northwind: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "model.dbt_exercise.stg_categories_northwind"} */


  create or replace view `corded-sunlight-464012-e2`.`dbt_dw_staging`.`stg_categories_northwind`
  OPTIONS()
  as with raw_categories as (
    select *
    from `corded-sunlight-464012-e2`.`dbt_dw_raw`.`categories`
)

/* Ao construir a staging não vamos trazer a coluna picture, pois ela não traz informação relevante */
, stg_categories_northwind as (
    select
        cast(category_id as string) as category_id
        , cast(category_name as string) as category_name
        , cast(description as string) as description
    from raw_categories
)

select *
from stg_categories_northwind;


[0m17:57:38.151200 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m17:57:38.153028 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:57:39.129939 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:4d68519c-75ea-4ae5-94c1-522d31bb1121&page=queryresults
[0m17:57:39.154148 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:bc9cb0c2-b9cf-494a-a808-08e5fb289291&page=queryresults
[0m17:57:39.215408 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:2e6196e7-f5b5-4f64-83ed-ea27c191cacf&page=queryresults
[0m17:57:39.228160 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:2dfa5a59-e756-473d-ac8b-5af086277592&page=queryresults
[0m17:57:43.858523 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '46722dd7-3f50-42e9-95b0-e52aeb674d99', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77e5e22f9e20>]}
[0m17:57:43.859351 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '46722dd7-3f50-42e9-95b0-e52aeb674d99', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77e5acfe6420>]}
[0m17:57:43.860264 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '46722dd7-3f50-42e9-95b0-e52aeb674d99', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77e5a0101760>]}
[0m17:57:43.861871 [info ] [Thread-1 (]: 1 of 15 OK created sql view model dbt_dw_staging.stg_categories_northwind ...... [[32mCREATE VIEW (0 processed)[0m in 5.79s]
[0m17:57:43.862564 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '46722dd7-3f50-42e9-95b0-e52aeb674d99', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77e5a3b24b30>]}
[0m17:57:43.863745 [info ] [Thread-3 (]: 3 of 15 OK created sql view model dbt_dw_staging.stg_employee_territories ...... [[32mCREATE VIEW (0 processed)[0m in 5.79s]
[0m17:57:43.864865 [info ] [Thread-4 (]: 4 of 15 OK created sql view model dbt_dw_staging.stg_employees_northwind ....... [[32mCREATE VIEW (0 processed)[0m in 5.80s]
[0m17:57:43.866033 [debug] [Thread-1 (]: Finished running node model.dbt_exercise.stg_categories_northwind
[0m17:57:43.867321 [info ] [Thread-2 (]: 2 of 15 OK created sql view model dbt_dw_staging.stg_customers_northwind ....... [[32mCREATE VIEW (0 processed)[0m in 5.80s]
[0m17:57:43.868484 [debug] [Thread-3 (]: Finished running node model.dbt_exercise.stg_employee_territories
[0m17:57:43.869603 [debug] [Thread-4 (]: Finished running node model.dbt_exercise.stg_employees_northwind
[0m17:57:43.870725 [debug] [Thread-1 (]: Began running node model.dbt_exercise.stg_order_details_northwind
[0m17:57:43.872090 [debug] [Thread-2 (]: Finished running node model.dbt_exercise.stg_customers_northwind
[0m17:57:43.873008 [debug] [Thread-3 (]: Began running node model.dbt_exercise.stg_orders_northwind
[0m17:57:43.874237 [debug] [Thread-4 (]: Began running node model.dbt_exercise.stg_products_northwind
[0m17:57:43.875168 [info ] [Thread-1 (]: 5 of 15 START sql view model dbt_dw_staging.stg_order_details_northwind ........ [RUN]
[0m17:57:43.876306 [debug] [Thread-2 (]: Began running node model.dbt_exercise.stg_shippers_northwind
[0m17:57:43.877996 [info ] [Thread-3 (]: 6 of 15 START sql view model dbt_dw_staging.stg_orders_northwind ............... [RUN]
[0m17:57:43.879092 [info ] [Thread-4 (]: 7 of 15 START sql view model dbt_dw_staging.stg_products_northwind ............. [RUN]
[0m17:57:43.880214 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_exercise.stg_categories_northwind, now model.dbt_exercise.stg_order_details_northwind)
[0m17:57:43.882075 [info ] [Thread-2 (]: 8 of 15 START sql view model dbt_dw_staging.stg_shippers_northwind ............. [RUN]
[0m17:57:43.884245 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_exercise.stg_employee_territories, now model.dbt_exercise.stg_orders_northwind)
[0m17:57:43.885373 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.dbt_exercise.stg_employees_northwind, now model.dbt_exercise.stg_products_northwind)
[0m17:57:43.886678 [debug] [Thread-1 (]: Began compiling node model.dbt_exercise.stg_order_details_northwind
[0m17:57:43.887434 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_exercise.stg_customers_northwind, now model.dbt_exercise.stg_shippers_northwind)
[0m17:57:43.888326 [debug] [Thread-3 (]: Began compiling node model.dbt_exercise.stg_orders_northwind
[0m17:57:43.889297 [debug] [Thread-4 (]: Began compiling node model.dbt_exercise.stg_products_northwind
[0m17:57:43.895492 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_exercise.stg_order_details_northwind"
[0m17:57:43.896200 [debug] [Thread-2 (]: Began compiling node model.dbt_exercise.stg_shippers_northwind
[0m17:57:43.901098 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_exercise.stg_orders_northwind"
[0m17:57:43.905122 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_exercise.stg_products_northwind"
[0m17:57:43.910347 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_exercise.stg_shippers_northwind"
[0m17:57:43.911829 [debug] [Thread-1 (]: Began executing node model.dbt_exercise.stg_order_details_northwind
[0m17:57:43.913495 [debug] [Thread-3 (]: Began executing node model.dbt_exercise.stg_orders_northwind
[0m17:57:43.921231 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_exercise.stg_order_details_northwind"
[0m17:57:43.923341 [debug] [Thread-4 (]: Began executing node model.dbt_exercise.stg_products_northwind
[0m17:57:43.927463 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_exercise.stg_orders_northwind"
[0m17:57:43.928286 [debug] [Thread-2 (]: Began executing node model.dbt_exercise.stg_shippers_northwind
[0m17:57:43.935188 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_exercise.stg_products_northwind"
[0m17:57:43.940884 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_exercise.stg_shippers_northwind"
[0m17:57:43.942284 [debug] [Thread-3 (]: On model.dbt_exercise.stg_orders_northwind: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "model.dbt_exercise.stg_orders_northwind"} */


  create or replace view `corded-sunlight-464012-e2`.`dbt_dw_staging`.`stg_orders_northwind`
  OPTIONS()
  as with raw_orders as (
    select *
    from `corded-sunlight-464012-e2`.`dbt_dw_raw`.`orders`
)

, stg_orders_northwind as (
    select
        cast(order_id as string) as order_id
        , cast(customer_id as string) as customer_id
        , cast(employee_id as string) as employee_id
        , cast(order_date as timestamp) as order_date
        , cast(required_date as timestamp) as required_date
        , cast(shipped_date as timestamp) as shipped_date
        , cast(ship_via as string) as ship_via
        , cast(freight as numeric) as freight
        , cast(ship_name as string) as ship_name
        , cast(ship_address as string) as ship_address
        , cast(ship_city as string) as ship_city
        , cast(ship_region as string) as ship_region
        , cast(ship_postal_code as string) as ship_postal_code
        , cast(ship_country as string) as ship_country
    from raw_orders
)

select *
from stg_orders_northwind;


[0m17:57:43.943064 [debug] [Thread-1 (]: On model.dbt_exercise.stg_order_details_northwind: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "model.dbt_exercise.stg_order_details_northwind"} */


  create or replace view `corded-sunlight-464012-e2`.`dbt_dw_staging`.`stg_order_details_northwind`
  OPTIONS()
  as with raw_order_details as (
    select *
    from `corded-sunlight-464012-e2`.`dbt_dw_raw`.`order_details`
)

, stg_order_details_northwind as (
    select
        cast(order_id as string) as order_id
        , cast(product_id as string) as product_id
        , cast(unit_price as numeric) as unit_price
        , cast(quantity as integer) as quantity
        , cast(discount as numeric) as discount
    from raw_order_details
)

select *
from stg_order_details_northwind;


[0m17:57:43.945043 [debug] [Thread-4 (]: On model.dbt_exercise.stg_products_northwind: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "model.dbt_exercise.stg_products_northwind"} */


  create or replace view `corded-sunlight-464012-e2`.`dbt_dw_staging`.`stg_products_northwind`
  OPTIONS()
  as with raw_products as (
    select *
    from `corded-sunlight-464012-e2`.`dbt_dw_raw`.`products`
)

, stg_products_northwind as (
    select
        cast(product_id as string) as product_id
        , cast(product_name as string) as product_name
        , cast(supplier_id as string) as supplier_id
        , cast(category_id as string) as category_id
        , cast(quantity_per_unit as string) as quantity_per_unit
        , cast(unit_price as numeric) as unit_price
        , cast(units_in_stock as numeric) as units_in_stock
        , cast(units_on_order as numeric) as units_on_order
        , cast(reorder_level as numeric) as reorder_level
        , cast(discontinued as integer) as discontinued
    from raw_products
)

select *
from stg_products_northwind;


[0m17:57:43.945901 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m17:57:43.947156 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:57:43.948484 [debug] [Thread-2 (]: On model.dbt_exercise.stg_shippers_northwind: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "model.dbt_exercise.stg_shippers_northwind"} */


  create or replace view `corded-sunlight-464012-e2`.`dbt_dw_staging`.`stg_shippers_northwind`
  OPTIONS()
  as with raw_shippers as (
    select *
    from `corded-sunlight-464012-e2`.`dbt_dw_raw`.`shippers`
)

, stg_shippers_northwind as (
    select
        cast(shipper_id as string) as shipper_id
        , cast(company_name as string) as company_name
        , cast(phone as string) as phone
    from raw_shippers
)

select *
from stg_shippers_northwind;


[0m17:57:43.950768 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m17:57:43.952407 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:57:44.949205 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:971ecf23-266c-4b5a-9e56-d262f0966f06&page=queryresults
[0m17:57:44.956170 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:b56908f6-dd52-460a-9dcf-1ddc747e1357&page=queryresults
[0m17:57:44.969348 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:cddcaba3-0adc-4f91-83a1-b415c4caf4e3&page=queryresults
[0m17:57:45.034997 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:ac792919-9a24-4d43-a345-50f5d128ba48&page=queryresults
[0m17:57:45.539263 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '46722dd7-3f50-42e9-95b0-e52aeb674d99', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77e5a01aedb0>]}
[0m17:57:45.540195 [info ] [Thread-3 (]: 6 of 15 OK created sql view model dbt_dw_staging.stg_orders_northwind .......... [[32mCREATE VIEW (0 processed)[0m in 1.66s]
[0m17:57:45.540928 [debug] [Thread-3 (]: Finished running node model.dbt_exercise.stg_orders_northwind
[0m17:57:45.541369 [debug] [Thread-3 (]: Began running node model.dbt_exercise.stg_suppliers_northwind
[0m17:57:45.542413 [info ] [Thread-3 (]: 9 of 15 START sql view model dbt_dw_staging.stg_suppliers_northwind ............ [RUN]
[0m17:57:45.543411 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_exercise.stg_orders_northwind, now model.dbt_exercise.stg_suppliers_northwind)
[0m17:57:45.543914 [debug] [Thread-3 (]: Began compiling node model.dbt_exercise.stg_suppliers_northwind
[0m17:57:45.546870 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_exercise.stg_suppliers_northwind"
[0m17:57:45.552033 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '46722dd7-3f50-42e9-95b0-e52aeb674d99', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77e583fcc2c0>]}
[0m17:57:45.553035 [info ] [Thread-2 (]: 8 of 15 OK created sql view model dbt_dw_staging.stg_shippers_northwind ........ [[32mCREATE VIEW (0 processed)[0m in 1.66s]
[0m17:57:45.554474 [debug] [Thread-2 (]: Finished running node model.dbt_exercise.stg_shippers_northwind
[0m17:57:45.555198 [debug] [Thread-3 (]: Began executing node model.dbt_exercise.stg_suppliers_northwind
[0m17:57:45.555993 [debug] [Thread-2 (]: Began running node model.dbt_exercise.int_customers_northwind
[0m17:57:45.559953 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_exercise.stg_suppliers_northwind"
[0m17:57:45.561276 [info ] [Thread-2 (]: 10 of 15 START sql view model dbt_dw_intermediate.int_customers_northwind ...... [RUN]
[0m17:57:45.562602 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_exercise.stg_shippers_northwind, now model.dbt_exercise.int_customers_northwind)
[0m17:57:45.563295 [debug] [Thread-2 (]: Began compiling node model.dbt_exercise.int_customers_northwind
[0m17:57:45.564299 [debug] [Thread-3 (]: On model.dbt_exercise.stg_suppliers_northwind: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "model.dbt_exercise.stg_suppliers_northwind"} */


  create or replace view `corded-sunlight-464012-e2`.`dbt_dw_staging`.`stg_suppliers_northwind`
  OPTIONS()
  as with raw_suppliers as (
    select *
    from `corded-sunlight-464012-e2`.`dbt_dw_raw`.`suppliers`
)

, stg_suppliers_northwind as (
    select
        cast(supplier_id as string) as supplier_id
        , cast(company_name as string) as company_name
        , cast(contact_name as string) as contact_name
        , cast(contact_title as string) as contact_title
        , cast(address as string) as address
        , cast(city as string) as city
        , cast(region as string) as region
        , cast(postal_code as string) as postal_code
        , cast(country as string) as country
        , cast(phone as string) as phone
        , cast(fax as string) as fax
        , cast(homepage as string) as home_page
    from raw_suppliers
)

select *
from stg_suppliers_northwind;


[0m17:57:45.568048 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_exercise.int_customers_northwind"
[0m17:57:45.569085 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m17:57:45.570201 [debug] [Thread-2 (]: Began executing node model.dbt_exercise.int_customers_northwind
[0m17:57:45.573946 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_exercise.int_customers_northwind"
[0m17:57:45.575084 [debug] [Thread-2 (]: On model.dbt_exercise.int_customers_northwind: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "model.dbt_exercise.int_customers_northwind"} */


  create or replace view `corded-sunlight-464012-e2`.`dbt_dw_intermediate`.`int_customers_northwind`
  OPTIONS()
  as with stg_customers_northwind as (
    select *
    from `corded-sunlight-464012-e2`.`dbt_dw_staging`.`stg_customers_northwind`
)

, final_table as (
    select 
        customer_id
        , company_name
        , contact_name
        , contact_title
        , address
        , city
        , region
        , country
        , case 
            when country in ('USA', 'Canada', 'Mexico') then 'North America'
            when country in ('UK', 'France', 'Germany', 'Austria', 'Belgium', 'Denmark', 'Ireland'
            , 'Finland', 'Italy', 'Norway', 'Poland', 'Portugal', 'Spain', 'Sweden', 'Switzerland') then 'Europe'
            when country in ('Brazil', 'Argentina', 'Venezuela') then 'South America'
            else 'Other'
        end as continent
    from stg_customers_northwind
)

select *
from final_table;


[0m17:57:45.576173 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:57:45.608072 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '46722dd7-3f50-42e9-95b0-e52aeb674d99', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77e5a01a16d0>]}
[0m17:57:45.632219 [info ] [Thread-4 (]: 7 of 15 OK created sql view model dbt_dw_staging.stg_products_northwind ........ [[32mCREATE VIEW (0 processed)[0m in 1.72s]
[0m17:57:45.633367 [debug] [Thread-4 (]: Finished running node model.dbt_exercise.stg_products_northwind
[0m17:57:45.634101 [debug] [Thread-4 (]: Began running node model.dbt_exercise.int_employees_northwind
[0m17:57:45.634926 [info ] [Thread-4 (]: 11 of 15 START sql view model dbt_dw_intermediate.int_employees_northwind ...... [RUN]
[0m17:57:45.635538 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.dbt_exercise.stg_products_northwind, now model.dbt_exercise.int_employees_northwind)
[0m17:57:45.635949 [debug] [Thread-4 (]: Began compiling node model.dbt_exercise.int_employees_northwind
[0m17:57:45.639341 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_exercise.int_employees_northwind"
[0m17:57:45.640162 [debug] [Thread-4 (]: Began executing node model.dbt_exercise.int_employees_northwind
[0m17:57:45.644709 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_exercise.int_employees_northwind"
[0m17:57:45.645979 [debug] [Thread-4 (]: On model.dbt_exercise.int_employees_northwind: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "model.dbt_exercise.int_employees_northwind"} */


  create or replace view `corded-sunlight-464012-e2`.`dbt_dw_intermediate`.`int_employees_northwind`
  OPTIONS()
  as with employees as (
    select *
    from `corded-sunlight-464012-e2`.`dbt_dw_staging`.`stg_employees_northwind`
)

, max_fact_date as (
    select 
        cast(
            case 
                when max(order_date) >= max(shipped_date) then max(order_date)
                else max(shipped_date)
            end 
        as date) as max_date
    from `corded-sunlight-464012-e2`.`dbt_dw_staging`.`stg_orders_northwind`
)

, final_table as (
    select
        employee_id
        , concat(first_name, ' ', last_name) as employee_name
        , title
        , birth_date
        , date_diff((select * from max_fact_date), birth_date, year) as age
        , hire_date
        , date_diff((select * from max_fact_date), hire_date, year) as years_hired
        , address
        , city
        , region
        , country
    from employees
)

select *
from final_table;


[0m17:57:45.646824 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m17:57:45.709251 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '46722dd7-3f50-42e9-95b0-e52aeb674d99', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77e583e5c7d0>]}
[0m17:57:45.710127 [info ] [Thread-1 (]: 5 of 15 OK created sql view model dbt_dw_staging.stg_order_details_northwind ... [[32mCREATE VIEW (0 processed)[0m in 1.83s]
[0m17:57:45.710879 [debug] [Thread-1 (]: Finished running node model.dbt_exercise.stg_order_details_northwind
[0m17:57:45.711571 [debug] [Thread-1 (]: Began running node model.dbt_exercise.int_shippers_northwind
[0m17:57:45.712895 [info ] [Thread-1 (]: 12 of 15 START sql view model dbt_dw_intermediate.int_shippers_northwind ....... [RUN]
[0m17:57:45.714297 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_exercise.stg_order_details_northwind, now model.dbt_exercise.int_shippers_northwind)
[0m17:57:45.714868 [debug] [Thread-1 (]: Began compiling node model.dbt_exercise.int_shippers_northwind
[0m17:57:45.718975 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_exercise.int_shippers_northwind"
[0m17:57:45.721282 [debug] [Thread-1 (]: Began executing node model.dbt_exercise.int_shippers_northwind
[0m17:57:45.724045 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_exercise.int_shippers_northwind"
[0m17:57:45.726466 [debug] [Thread-1 (]: On model.dbt_exercise.int_shippers_northwind: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "model.dbt_exercise.int_shippers_northwind"} */


  create or replace view `corded-sunlight-464012-e2`.`dbt_dw_intermediate`.`int_shippers_northwind`
  OPTIONS()
  as with stg_shippers_northwind as (
    select *
    from `corded-sunlight-464012-e2`.`dbt_dw_staging`.`stg_shippers_northwind`
)

, stg_orders_northwind as (
    select *
    from `corded-sunlight-464012-e2`.`dbt_dw_staging`.`stg_orders_northwind`
)

, transformed_table as (
    select
        concat(
            coalesce(stg_shippers_northwind.shipper_id, '')
            , '-'
            , coalesce(stg_shippers_northwind.company_name, '')
            , '-'
            , coalesce(stg_orders_northwind.ship_address, '')
        ) as ship_id
        , stg_shippers_northwind.shipper_id
        , stg_shippers_northwind.company_name
        , stg_orders_northwind.ship_address
        , stg_orders_northwind.ship_city
        , stg_orders_northwind.ship_region
        , stg_orders_northwind.ship_country
    from stg_shippers_northwind
    left join stg_orders_northwind
        on stg_shippers_northwind.shipper_id = stg_orders_northwind.ship_via
)

/* Aqui é feita a deduplicação da transformed_table */
, dedup_table as (
    select distinct *
    from transformed_table
)

, final_table as (
    select 
        *
        , case
            when dedup_table.ship_country in ('USA', 'Canada', 'Mexico') then 'North America'
            when dedup_table.ship_country in ('UK', 'France', 'Germany', 'Austria', 'Belgium', 
            'Denmark', 'Ireland', 'Finland', 'Italy', 'Norway', 'Poland', 'Portugal', 'Spain', 'Sweden', 'Switzerland') then 'Europe'
            when dedup_table.ship_country in ('Brazil', 'Argentina', 'Venezuela') then 'South America'
            else 'Other'
        end as ship_continent
    from dedup_table
)

select *
from final_table;


[0m17:57:45.727379 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:57:46.568783 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:bec49144-e0d9-4892-a276-bda635bfb2e2&page=queryresults
[0m17:57:46.657140 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:e96644e2-dfae-4549-b01b-d905142fec37&page=queryresults
[0m17:57:46.743813 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:023e14ad-4946-498c-b728-e4eebae2fd92&page=queryresults
[0m17:57:46.781754 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:205b2742-e759-40b7-9a88-1a566a5c35e5&page=queryresults
[0m17:57:47.118274 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '46722dd7-3f50-42e9-95b0-e52aeb674d99', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77e583f3b5f0>]}
[0m17:57:47.119218 [info ] [Thread-3 (]: 9 of 15 OK created sql view model dbt_dw_staging.stg_suppliers_northwind ....... [[32mCREATE VIEW (0 processed)[0m in 1.57s]
[0m17:57:47.119991 [debug] [Thread-3 (]: Finished running node model.dbt_exercise.stg_suppliers_northwind
[0m17:57:47.120509 [debug] [Thread-3 (]: Began running node model.dbt_exercise.int_orders_northwind
[0m17:57:47.121871 [info ] [Thread-3 (]: 13 of 15 START sql view model dbt_dw_intermediate.int_orders_northwind ......... [RUN]
[0m17:57:47.122583 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_exercise.stg_suppliers_northwind, now model.dbt_exercise.int_orders_northwind)
[0m17:57:47.123049 [debug] [Thread-3 (]: Began compiling node model.dbt_exercise.int_orders_northwind
[0m17:57:47.126792 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_exercise.int_orders_northwind"
[0m17:57:47.127675 [debug] [Thread-3 (]: Began executing node model.dbt_exercise.int_orders_northwind
[0m17:57:47.131198 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_exercise.int_orders_northwind"
[0m17:57:47.132126 [debug] [Thread-3 (]: On model.dbt_exercise.int_orders_northwind: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "model.dbt_exercise.int_orders_northwind"} */


  create or replace view `corded-sunlight-464012-e2`.`dbt_dw_intermediate`.`int_orders_northwind`
  OPTIONS()
  as with stg_orders_northwind as (
    select *
    from `corded-sunlight-464012-e2`.`dbt_dw_staging`.`stg_orders_northwind`
)

, stg_order_details_northwind as (
    select *
    from `corded-sunlight-464012-e2`.`dbt_dw_staging`.`stg_order_details_northwind`
)

, stg_shippers_northwind as (
    select *
    from `corded-sunlight-464012-e2`.`dbt_dw_staging`.`stg_shippers_northwind`
)

, transformed_table as (    
    select
        stg_orders_northwind.order_id 
        , stg_orders_northwind.customer_id
        , stg_orders_northwind.employee_id
        , stg_orders_northwind.order_date
        , stg_orders_northwind.required_date
        , stg_orders_northwind.shipped_date
        , date_diff(stg_orders_northwind.shipped_date, stg_orders_northwind.order_date, day) as days_to_ship
        , concat(
            coalesce(stg_orders_northwind.ship_via, '')
            , '-'
            , coalesce(stg_shippers_northwind.company_name, '')
            , '-'
            , coalesce(stg_orders_northwind.ship_address, '')
        ) as ship_id
        , stg_orders_northwind.ship_via      
        , stg_shippers_northwind.company_name as shipper_name
        , sum(stg_order_details_northwind.unit_price * stg_order_details_northwind.quantity * (1 - stg_order_details_northwind.discount)) as total_order_amount
        , stg_orders_northwind.freight
        , stg_orders_northwind.ship_name
        , stg_orders_northwind.ship_address
        , stg_orders_northwind.ship_city
        , stg_orders_northwind.ship_region
        , stg_orders_northwind.ship_country
        , case
            when stg_orders_northwind.ship_country in ('USA', 'Canada', 'Mexico') then 'North America'
            when stg_orders_northwind.ship_country in ('UK', 'France', 'Germany', 'Austria', 'Belgium', 
            'Denmark', 'Ireland', 'Finland', 'Italy', 'Norway', 'Poland', 'Portugal', 'Spain', 'Sweden', 'Switzerland') then 'Europe'
            when stg_orders_northwind.ship_country in ('Brazil', 'Argentina', 'Venezuela') then 'South America'
            else 'Other'
        end as ship_continent
    from stg_orders_northwind
    left join stg_order_details_northwind
        on stg_orders_northwind.order_id = stg_order_details_northwind.order_id
    left join stg_shippers_northwind
        on stg_orders_northwind.ship_via = stg_shippers_northwind.shipper_id
    group by 
        stg_orders_northwind.order_id
        , stg_orders_northwind.customer_id
        , stg_orders_northwind.employee_id
        , stg_orders_northwind.order_date
        , stg_orders_northwind.required_date
        , stg_orders_northwind.shipped_date
        , stg_orders_northwind.ship_via
        , stg_shippers_northwind.company_name
        , stg_orders_northwind.freight
        , stg_orders_northwind.ship_name
        , stg_orders_northwind.ship_address
        , stg_orders_northwind.ship_city
        , stg_orders_northwind.ship_region
        , stg_orders_northwind.ship_country
)

, final_table as (
    select
        transformed_table.order_id
        , transformed_table.customer_id
        , transformed_table.employee_id
        , transformed_table.order_date
        , transformed_table.required_date
        , transformed_table.shipped_date
        , transformed_table.days_to_ship
        , transformed_table.ship_id
        , transformed_table.ship_via
        , transformed_table.shipper_name
        , transformed_table.total_order_amount
        , transformed_table.freight
        , transformed_table.ship_name
        , transformed_table.ship_address
        , transformed_table.ship_city
        , transformed_table.ship_region
        , transformed_table.ship_country
        , transformed_table.ship_continent
        , case 
            when transformed_table.days_to_ship is null then False
            else True
          end as is_shipped
    from transformed_table
)

select *
from final_table;


[0m17:57:47.132594 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m17:57:47.166261 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '46722dd7-3f50-42e9-95b0-e52aeb674d99', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77e583f62600>]}
[0m17:57:47.167000 [info ] [Thread-2 (]: 10 of 15 OK created sql view model dbt_dw_intermediate.int_customers_northwind . [[32mCREATE VIEW (0 processed)[0m in 1.60s]
[0m17:57:47.167538 [debug] [Thread-2 (]: Finished running node model.dbt_exercise.int_customers_northwind
[0m17:57:47.167933 [debug] [Thread-2 (]: Began running node model.dbt_exercise.int_products_northwind
[0m17:57:47.168813 [info ] [Thread-2 (]: 14 of 15 START sql view model dbt_dw_intermediate.int_products_northwind ....... [RUN]
[0m17:57:47.169742 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_exercise.int_customers_northwind, now model.dbt_exercise.int_products_northwind)
[0m17:57:47.170366 [debug] [Thread-2 (]: Began compiling node model.dbt_exercise.int_products_northwind
[0m17:57:47.173509 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_exercise.int_products_northwind"
[0m17:57:47.174339 [debug] [Thread-2 (]: Began executing node model.dbt_exercise.int_products_northwind
[0m17:57:47.177023 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_exercise.int_products_northwind"
[0m17:57:47.178047 [debug] [Thread-2 (]: On model.dbt_exercise.int_products_northwind: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "model.dbt_exercise.int_products_northwind"} */


  create or replace view `corded-sunlight-464012-e2`.`dbt_dw_intermediate`.`int_products_northwind`
  OPTIONS()
  as with stg_products_northwind as (
    select *
    from `corded-sunlight-464012-e2`.`dbt_dw_staging`.`stg_products_northwind`
)

, stg_categories_northwind as (
    select *
    from `corded-sunlight-464012-e2`.`dbt_dw_staging`.`stg_categories_northwind`
)

, stg_suppliers_northwind as (
    select *
    from `corded-sunlight-464012-e2`.`dbt_dw_staging`.`stg_suppliers_northwind`
)

, final_table as (
    select
        stg_products_northwind.product_id
        , stg_products_northwind.product_name
        , stg_products_northwind.quantity_per_unit
        , stg_categories_northwind.category_name
        , stg_suppliers_northwind.company_name as supplier_name
        , stg_suppliers_northwind.city as supplier_city
        , stg_suppliers_northwind.region as supplier_region
        , stg_suppliers_northwind.country as supplier_country
        , case
            when stg_suppliers_northwind.country in ('USA', 'Canada') then 'North America'
            when stg_suppliers_northwind.country in ('Brazil') then 'South America'
            when stg_suppliers_northwind.country in ('UK', 'Germany', 'Netherlands', 'Spain', 'France', 'Norway', 'Italy', 'Denmark', 'Sweden', 'Finland') then 'Europe'
            when stg_suppliers_northwind.country in ('Singapore', 'Japan') then 'Asia'
            when stg_suppliers_northwind.country in ('Australia') then 'Oceania'
            else 'Other'
          end as supplier_continent
        , case 
            when stg_products_northwind.discontinued = 1 then True
            else False
        end as is_discontinued
    from stg_products_northwind
    left join stg_categories_northwind
        on stg_products_northwind.category_id = stg_categories_northwind.category_id
    left join stg_suppliers_northwind
        on stg_products_northwind.supplier_id = stg_suppliers_northwind.supplier_id
)

select *
from final_table;


[0m17:57:47.178850 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:57:47.257285 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '46722dd7-3f50-42e9-95b0-e52aeb674d99', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77e583e93e30>]}
[0m17:57:47.258147 [info ] [Thread-1 (]: 12 of 15 OK created sql view model dbt_dw_intermediate.int_shippers_northwind .. [[32mCREATE VIEW (0 processed)[0m in 1.54s]
[0m17:57:47.258796 [debug] [Thread-1 (]: Finished running node model.dbt_exercise.int_shippers_northwind
[0m17:57:47.318205 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '46722dd7-3f50-42e9-95b0-e52aeb674d99', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77e5e1288b90>]}
[0m17:57:47.319086 [info ] [Thread-4 (]: 11 of 15 OK created sql view model dbt_dw_intermediate.int_employees_northwind . [[32mCREATE VIEW (0 processed)[0m in 1.68s]
[0m17:57:47.319739 [debug] [Thread-4 (]: Finished running node model.dbt_exercise.int_employees_northwind
[0m17:57:48.167710 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:d33eadd3-7475-4f01-b2c6-10c988b4f77d&page=queryresults
[0m17:57:48.255901 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:da2a478c-f0f2-4ee9-b49c-6e710c8b5e00&page=queryresults
[0m17:57:48.710657 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '46722dd7-3f50-42e9-95b0-e52aeb674d99', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77e583ead760>]}
[0m17:57:48.711572 [info ] [Thread-3 (]: 13 of 15 OK created sql view model dbt_dw_intermediate.int_orders_northwind .... [[32mCREATE VIEW (0 processed)[0m in 1.59s]
[0m17:57:48.712635 [debug] [Thread-3 (]: Finished running node model.dbt_exercise.int_orders_northwind
[0m17:57:48.784387 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '46722dd7-3f50-42e9-95b0-e52aeb674d99', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77e5a4259880>]}
[0m17:57:48.785088 [info ] [Thread-2 (]: 14 of 15 OK created sql view model dbt_dw_intermediate.int_products_northwind .. [[32mCREATE VIEW (0 processed)[0m in 1.61s]
[0m17:57:48.785720 [debug] [Thread-2 (]: Finished running node model.dbt_exercise.int_products_northwind
[0m17:57:48.787102 [debug] [Thread-1 (]: Began running node model.dbt_exercise.dim_products
[0m17:57:48.787672 [info ] [Thread-1 (]: 15 of 15 START sql table model dbt_dw_marts.dim_products ....................... [RUN]
[0m17:57:48.788257 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_exercise.int_shippers_northwind, now model.dbt_exercise.dim_products)
[0m17:57:48.788663 [debug] [Thread-1 (]: Began compiling node model.dbt_exercise.dim_products
[0m17:57:48.802574 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_exercise.dim_products"
[0m17:57:48.806493 [debug] [Thread-1 (]: Began executing node model.dbt_exercise.dim_products
[0m17:57:48.819088 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:57:49.612424 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_exercise.dim_products"
[0m17:57:49.613927 [debug] [Thread-1 (]: On model.dbt_exercise.dim_products: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "model.dbt_exercise.dim_products"} */

  
    

    create or replace table `corded-sunlight-464012-e2`.`dbt_dw_marts`.`dim_products`
      
    
    

    OPTIONS()
    as (
      with int_products as (
    select *
    from `corded-sunlight-464012-e2`.`dbt_dw_intermediate`.`int_products_northwind`
)

, dim_products as (
    select
        to_hex(md5(cast(coalesce(cast(product_id as string), '_dbt_utils_surrogate_key_null_') as string))) as sk_product
        , product_id
        , product_name
        , quantity_per_unit
        , category_name
        , supplier_name
        , supplier_city
        , supplier_region
        , supplier_country
        , supplier_continent
        , discontinued
    from int_products
)

select *
from dim_products
    );
  
[0m17:57:50.311536 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:7228913a-e4f2-48bb-92a3-acf3fb9cf9d9&page=queryresults
[0m17:57:50.630507 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:7228913a-e4f2-48bb-92a3-acf3fb9cf9d9&page=queryresults
[0m17:57:50.719509 [debug] [Thread-1 (]: Database Error in model dim_products (models/marts/dim_products.sql)
  Unrecognized name: discontinued; Did you mean is_discontinued? at [30:11]
  compiled code at target/run/dbt_exercise/models/marts/dim_products.sql
[0m17:57:50.720475 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '46722dd7-3f50-42e9-95b0-e52aeb674d99', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77e583e74da0>]}
[0m17:57:50.721550 [error] [Thread-1 (]: 15 of 15 ERROR creating sql table model dbt_dw_marts.dim_products .............. [[31mERROR[0m in 1.93s]
[0m17:57:50.722297 [debug] [Thread-1 (]: Finished running node model.dbt_exercise.dim_products
[0m17:57:50.723012 [debug] [Thread-7 (]: Marking all children of 'model.dbt_exercise.dim_products' to be skipped because of status 'error'.  Reason: Database Error in model dim_products (models/marts/dim_products.sql)
  Unrecognized name: discontinued; Did you mean is_discontinued? at [30:11]
  compiled code at target/run/dbt_exercise/models/marts/dim_products.sql.
[0m17:57:50.728020 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:57:50.735827 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:57:50.736517 [debug] [MainThread]: Connection 'model.dbt_exercise.dim_products' was properly closed.
[0m17:57:50.736848 [debug] [MainThread]: Connection 'model.dbt_exercise.int_orders_northwind' was properly closed.
[0m17:57:50.737128 [debug] [MainThread]: Connection 'model.dbt_exercise.int_employees_northwind' was properly closed.
[0m17:57:50.737467 [debug] [MainThread]: Connection 'model.dbt_exercise.int_products_northwind' was properly closed.
[0m17:57:50.738138 [info ] [MainThread]: 
[0m17:57:50.738696 [info ] [MainThread]: Finished running 1 table model, 14 view models in 0 hours 0 minutes and 14.97 seconds (14.97s).
[0m17:57:50.741268 [debug] [MainThread]: Command end result
[0m17:57:50.788910 [debug] [MainThread]: Wrote artifact WritableManifest to /home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/target/manifest.json
[0m17:57:50.802643 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/target/semantic_manifest.json
[0m17:57:50.809461 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/target/run_results.json
[0m17:57:50.810075 [info ] [MainThread]: 
[0m17:57:50.810725 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m17:57:50.811389 [info ] [MainThread]: 
[0m17:57:50.811973 [error] [MainThread]: [31mFailure in model dim_products (models/marts/dim_products.sql)[0m
[0m17:57:50.812480 [error] [MainThread]:   Database Error in model dim_products (models/marts/dim_products.sql)
  Unrecognized name: discontinued; Did you mean is_discontinued? at [30:11]
  compiled code at target/run/dbt_exercise/models/marts/dim_products.sql
[0m17:57:50.812828 [info ] [MainThread]: 
[0m17:57:50.814525 [info ] [MainThread]:   compiled code at target/compiled/dbt_exercise/models/marts/dim_products.sql
[0m17:57:50.815240 [info ] [MainThread]: 
[0m17:57:50.815759 [info ] [MainThread]: Done. PASS=14 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=15
[0m17:57:50.816659 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- DuplicateYAMLKeysDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m17:57:50.820963 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 112.15032, "process_in_blocks": "123448", "process_kernel_time": 13.702068, "process_mem_max_rss": "368500", "process_out_blocks": "3936", "process_user_time": 11.989309}
[0m17:57:50.821617 [debug] [MainThread]: Command `dbt run` failed at 17:57:50.821456 after 112.15 seconds
[0m17:57:50.822142 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77e5e1e16ab0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77e5a3c7ee10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77e5a0196db0>]}
[0m17:57:50.822495 [debug] [MainThread]: Flushing usage events
[0m17:57:51.231714 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:07:42.244821 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d6f62e70a10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d6f64a3a600>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d6f64a39400>]}


============================== 18:07:42.266536 | 4fd074a3-4c6f-4172-92bf-1affdad03e41 ==============================
[0m18:07:42.266536 [info ] [MainThread]: Running with dbt=1.10.2
[0m18:07:42.267541 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m18:08:26.531396 [warn ] [MainThread]: [[33mWARNING[0m][DuplicateYAMLKeysDeprecation]: Deprecated functionality
Duplicate key 'version' in "<unicode string>", line 4, column 1 in file
`/home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/dbt_project.yml`
[0m18:08:26.531937 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '4fd074a3-4c6f-4172-92bf-1affdad03e41', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d6f2561cdd0>]}
[0m18:08:27.130711 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4fd074a3-4c6f-4172-92bf-1affdad03e41', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d6f2572b080>]}
[0m18:08:27.182967 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4fd074a3-4c6f-4172-92bf-1affdad03e41', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d6f25801640>]}
[0m18:08:27.187143 [info ] [MainThread]: Registered adapter: bigquery=1.9.2
[0m18:09:13.730792 [debug] [MainThread]: checksum: 1adc40777973ef30f45f80b3b6d04d5013c1edd53d96363881b3b199e612468b, vars: {}, profile: , target: , version: 1.10.2
[0m18:09:18.245054 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:09:18.245603 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:09:18.295064 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4fd074a3-4c6f-4172-92bf-1affdad03e41', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d6f255156d0>]}
[0m18:09:18.567134 [debug] [MainThread]: Wrote artifact WritableManifest to /home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/target/manifest.json
[0m18:09:18.581206 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/target/semantic_manifest.json
[0m18:09:18.972618 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4fd074a3-4c6f-4172-92bf-1affdad03e41', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d6f64dbb8c0>]}
[0m18:09:18.973204 [info ] [MainThread]: Found 14 seeds, 36 data tests, 16 models, 14 sources, 609 macros
[0m18:09:18.973579 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4fd074a3-4c6f-4172-92bf-1affdad03e41', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d6f6266ec60>]}
[0m18:09:18.977011 [info ] [MainThread]: 
[0m18:09:18.977536 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m18:09:18.977842 [info ] [MainThread]: 
[0m18:09:18.978393 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m18:09:18.982829 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_corded-sunlight-464012-e2'
[0m18:09:18.984315 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_corded-sunlight-464012-e2'
[0m18:09:18.985092 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:09:18.985958 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_corded-sunlight-464012-e2'
[0m18:09:18.986596 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:09:18.988306 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:09:20.253983 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_corded-sunlight-464012-e2, now list_corded-sunlight-464012-e2_dbt_dw_raw)
[0m18:09:20.255151 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_corded-sunlight-464012-e2, now list_corded-sunlight-464012-e2_dbt_dw_marts)
[0m18:09:20.256164 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:09:20.257383 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_corded-sunlight-464012-e2, now list_corded-sunlight-464012-e2_dbt_dw_staging)
[0m18:09:20.258550 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:09:20.259223 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_corded-sunlight-464012-e2_dbt_dw_intermediate'
[0m18:09:20.260438 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:09:20.261697 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:09:21.145295 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4fd074a3-4c6f-4172-92bf-1affdad03e41', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d6f62e42660>]}
[0m18:09:21.145952 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:09:21.159144 [debug] [Thread-1 (]: Began running node model.dbt_exercise.stg_categories_northwind
[0m18:09:21.159829 [debug] [Thread-2 (]: Began running node model.dbt_exercise.stg_customers_northwind
[0m18:09:21.160860 [info ] [Thread-1 (]: 1 of 15 START sql view model dbt_dw_staging.stg_categories_northwind ........... [RUN]
[0m18:09:21.161799 [debug] [Thread-3 (]: Began running node model.dbt_exercise.stg_employee_territories
[0m18:09:21.163191 [debug] [Thread-4 (]: Began running node model.dbt_exercise.stg_employees_northwind
[0m18:09:21.162823 [info ] [Thread-2 (]: 2 of 15 START sql view model dbt_dw_staging.stg_customers_northwind ............ [RUN]
[0m18:09:21.164463 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_corded-sunlight-464012-e2_dbt_dw_intermediate, now model.dbt_exercise.stg_categories_northwind)
[0m18:09:21.165536 [info ] [Thread-3 (]: 3 of 15 START sql view model dbt_dw_staging.stg_employee_territories ........... [RUN]
[0m18:09:21.166343 [info ] [Thread-4 (]: 4 of 15 START sql view model dbt_dw_staging.stg_employees_northwind ............ [RUN]
[0m18:09:21.167328 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_corded-sunlight-464012-e2_dbt_dw_marts, now model.dbt_exercise.stg_customers_northwind)
[0m18:09:21.168379 [debug] [Thread-1 (]: Began compiling node model.dbt_exercise.stg_categories_northwind
[0m18:09:21.169622 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_corded-sunlight-464012-e2_dbt_dw_staging, now model.dbt_exercise.stg_employee_territories)
[0m18:09:21.170423 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly list_corded-sunlight-464012-e2_dbt_dw_raw, now model.dbt_exercise.stg_employees_northwind)
[0m18:09:21.171146 [debug] [Thread-2 (]: Began compiling node model.dbt_exercise.stg_customers_northwind
[0m18:09:21.180591 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_exercise.stg_categories_northwind"
[0m18:09:21.181198 [debug] [Thread-3 (]: Began compiling node model.dbt_exercise.stg_employee_territories
[0m18:09:21.181873 [debug] [Thread-4 (]: Began compiling node model.dbt_exercise.stg_employees_northwind
[0m18:09:21.185131 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_exercise.stg_customers_northwind"
[0m18:09:21.189981 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_exercise.stg_employee_territories"
[0m18:09:21.194744 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_exercise.stg_employees_northwind"
[0m18:09:21.196528 [debug] [Thread-1 (]: Began executing node model.dbt_exercise.stg_categories_northwind
[0m18:09:21.203813 [debug] [Thread-4 (]: Began executing node model.dbt_exercise.stg_employees_northwind
[0m18:09:21.210096 [debug] [Thread-2 (]: Began executing node model.dbt_exercise.stg_customers_northwind
[0m18:09:21.211217 [debug] [Thread-3 (]: Began executing node model.dbt_exercise.stg_employee_territories
[0m18:09:21.253520 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_exercise.stg_employees_northwind"
[0m18:09:21.257116 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_exercise.stg_categories_northwind"
[0m18:09:21.260833 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_exercise.stg_customers_northwind"
[0m18:09:21.264506 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_exercise.stg_employee_territories"
[0m18:09:21.266176 [debug] [Thread-4 (]: On model.dbt_exercise.stg_employees_northwind: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "model.dbt_exercise.stg_employees_northwind"} */


  create or replace view `corded-sunlight-464012-e2`.`dbt_dw_staging`.`stg_employees_northwind`
  OPTIONS()
  as with raw_employees as (
    select *
    from `corded-sunlight-464012-e2`.`dbt_dw_raw`.`employees`
)

/* Os campos photo, notes e reports_to e photo_path não são carregadas na staging */

, stg_employees_northwind as (
    select
        cast(employee_id as string) as employee_id
        , cast(first_name as string) as first_name
        , cast(last_name as string) as last_name
        , cast(title as string) as title
        , cast(title_of_courtesy as string) as title_of_courtesy
        , cast(birth_date as date) as birth_date
        , cast(hire_date as date) as hire_date
        , cast(address as string) as address
        , cast(city as string) as city
        , cast(region as string) as region
        , cast(postal_code as string) as postal_code
        , cast(country as string) as country
        , cast(home_phone as string) as home_phone
        , cast(extension as string) as extension
    from raw_employees
)

select *
from stg_employees_northwind;


[0m18:09:21.267907 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m18:09:21.269418 [debug] [Thread-1 (]: On model.dbt_exercise.stg_categories_northwind: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "model.dbt_exercise.stg_categories_northwind"} */


  create or replace view `corded-sunlight-464012-e2`.`dbt_dw_staging`.`stg_categories_northwind`
  OPTIONS()
  as with raw_categories as (
    select *
    from `corded-sunlight-464012-e2`.`dbt_dw_raw`.`categories`
)

/* Ao construir a staging não vamos trazer a coluna picture, pois ela não traz informação relevante */
, stg_categories_northwind as (
    select
        cast(category_id as string) as category_id
        , cast(category_name as string) as category_name
        , cast(description as string) as description
    from raw_categories
)

select *
from stg_categories_northwind;


[0m18:09:21.270648 [debug] [Thread-2 (]: On model.dbt_exercise.stg_customers_northwind: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "model.dbt_exercise.stg_customers_northwind"} */


  create or replace view `corded-sunlight-464012-e2`.`dbt_dw_staging`.`stg_customers_northwind`
  OPTIONS()
  as with raw_customers as (
    select *
    from `corded-sunlight-464012-e2`.`dbt_dw_raw`.`customers`
)

, stg_customers_northwind as (
    select
        cast(customer_id as string) as customer_id
        , cast(company_name as string) as company_name
        , cast(contact_name as string) as contact_name
        , cast(contact_title as string) as contact_title
        , cast(address as string) as address
        , cast(city as string) as city
        , cast(region as string) as region
        , cast(postal_code as string) as postal_code
        , cast(country as string) as country
        , cast(phone as string) as phone
        , cast(fax as string) as fax
    from raw_customers
)

select *
from stg_customers_northwind;


[0m18:09:21.271572 [debug] [Thread-3 (]: On model.dbt_exercise.stg_employee_territories: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "model.dbt_exercise.stg_employee_territories"} */


  create or replace view `corded-sunlight-464012-e2`.`dbt_dw_staging`.`stg_employee_territories`
  OPTIONS()
  as with raw_employee_territories as (
    select *
    from `corded-sunlight-464012-e2`.`dbt_dw_raw`.`employee_territories`
)

, stg_employee_territories as (
    select
        cast(employee_id as string) as employee_id
        , cast(territory_id as string) as territory_id
    from raw_employee_territories
)

select *
from stg_employee_territories;


[0m18:09:21.272547 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:09:21.273180 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:09:21.273769 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m18:09:22.312288 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:f8299e5c-2e26-44bb-ab69-60cb48ba6847&page=queryresults
[0m18:09:22.340813 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:3f7b392e-b144-4144-9696-0211614d02f6&page=queryresults
[0m18:09:22.347930 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:4ebbe40d-a57a-4a06-8e7e-4b043e6793ed&page=queryresults
[0m18:09:22.363523 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:024f7ee3-8fae-4b9b-b889-35a6c9d0a5d5&page=queryresults
[0m18:09:27.212862 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4fd074a3-4c6f-4172-92bf-1affdad03e41', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d6f24fabe30>]}
[0m18:09:27.213429 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4fd074a3-4c6f-4172-92bf-1affdad03e41', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d6f6266ec60>]}
[0m18:09:27.214249 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4fd074a3-4c6f-4172-92bf-1affdad03e41', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d6f2a202480>]}
[0m18:09:27.216006 [info ] [Thread-2 (]: 2 of 15 OK created sql view model dbt_dw_staging.stg_customers_northwind ....... [[32mCREATE VIEW (0 processed)[0m in 6.03s]
[0m18:09:27.216867 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4fd074a3-4c6f-4172-92bf-1affdad03e41', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d6f245b7ad0>]}
[0m18:09:27.217587 [info ] [Thread-1 (]: 1 of 15 OK created sql view model dbt_dw_staging.stg_categories_northwind ...... [[32mCREATE VIEW (0 processed)[0m in 6.04s]
[0m18:09:27.218912 [info ] [Thread-4 (]: 4 of 15 OK created sql view model dbt_dw_staging.stg_employees_northwind ....... [[32mCREATE VIEW (0 processed)[0m in 6.03s]
[0m18:09:27.220096 [debug] [Thread-2 (]: Finished running node model.dbt_exercise.stg_customers_northwind
[0m18:09:27.220924 [info ] [Thread-3 (]: 3 of 15 OK created sql view model dbt_dw_staging.stg_employee_territories ...... [[32mCREATE VIEW (0 processed)[0m in 6.04s]
[0m18:09:27.222152 [debug] [Thread-1 (]: Finished running node model.dbt_exercise.stg_categories_northwind
[0m18:09:27.222934 [debug] [Thread-4 (]: Finished running node model.dbt_exercise.stg_employees_northwind
[0m18:09:27.223621 [debug] [Thread-2 (]: Began running node model.dbt_exercise.stg_order_details_northwind
[0m18:09:27.224735 [debug] [Thread-3 (]: Finished running node model.dbt_exercise.stg_employee_territories
[0m18:09:27.225966 [debug] [Thread-1 (]: Began running node model.dbt_exercise.stg_orders_northwind
[0m18:09:27.226826 [debug] [Thread-4 (]: Began running node model.dbt_exercise.stg_products_northwind
[0m18:09:27.228194 [info ] [Thread-2 (]: 5 of 15 START sql view model dbt_dw_staging.stg_order_details_northwind ........ [RUN]
[0m18:09:27.229419 [debug] [Thread-3 (]: Began running node model.dbt_exercise.stg_shippers_northwind
[0m18:09:27.230480 [info ] [Thread-1 (]: 6 of 15 START sql view model dbt_dw_staging.stg_orders_northwind ............... [RUN]
[0m18:09:27.231482 [info ] [Thread-4 (]: 7 of 15 START sql view model dbt_dw_staging.stg_products_northwind ............. [RUN]
[0m18:09:27.232509 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_exercise.stg_customers_northwind, now model.dbt_exercise.stg_order_details_northwind)
[0m18:09:27.233481 [info ] [Thread-3 (]: 8 of 15 START sql view model dbt_dw_staging.stg_shippers_northwind ............. [RUN]
[0m18:09:27.234879 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_exercise.stg_categories_northwind, now model.dbt_exercise.stg_orders_northwind)
[0m18:09:27.236240 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.dbt_exercise.stg_employees_northwind, now model.dbt_exercise.stg_products_northwind)
[0m18:09:27.237404 [debug] [Thread-2 (]: Began compiling node model.dbt_exercise.stg_order_details_northwind
[0m18:09:27.239047 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_exercise.stg_employee_territories, now model.dbt_exercise.stg_shippers_northwind)
[0m18:09:27.240737 [debug] [Thread-1 (]: Began compiling node model.dbt_exercise.stg_orders_northwind
[0m18:09:27.242457 [debug] [Thread-4 (]: Began compiling node model.dbt_exercise.stg_products_northwind
[0m18:09:27.250533 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_exercise.stg_order_details_northwind"
[0m18:09:27.252235 [debug] [Thread-3 (]: Began compiling node model.dbt_exercise.stg_shippers_northwind
[0m18:09:27.256393 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_exercise.stg_orders_northwind"
[0m18:09:27.260490 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_exercise.stg_products_northwind"
[0m18:09:27.264726 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_exercise.stg_shippers_northwind"
[0m18:09:27.265621 [debug] [Thread-2 (]: Began executing node model.dbt_exercise.stg_order_details_northwind
[0m18:09:27.271513 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_exercise.stg_order_details_northwind"
[0m18:09:27.273109 [debug] [Thread-1 (]: Began executing node model.dbt_exercise.stg_orders_northwind
[0m18:09:27.274713 [debug] [Thread-3 (]: Began executing node model.dbt_exercise.stg_shippers_northwind
[0m18:09:27.276289 [debug] [Thread-4 (]: Began executing node model.dbt_exercise.stg_products_northwind
[0m18:09:27.280612 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_exercise.stg_orders_northwind"
[0m18:09:27.281208 [debug] [Thread-2 (]: On model.dbt_exercise.stg_order_details_northwind: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "model.dbt_exercise.stg_order_details_northwind"} */


  create or replace view `corded-sunlight-464012-e2`.`dbt_dw_staging`.`stg_order_details_northwind`
  OPTIONS()
  as with raw_order_details as (
    select *
    from `corded-sunlight-464012-e2`.`dbt_dw_raw`.`order_details`
)

, stg_order_details_northwind as (
    select
        cast(order_id as string) as order_id
        , cast(product_id as string) as product_id
        , cast(unit_price as numeric) as unit_price
        , cast(quantity as integer) as quantity
        , cast(discount as numeric) as discount
    from raw_order_details
)

select *
from stg_order_details_northwind;


[0m18:09:27.283946 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_exercise.stg_shippers_northwind"
[0m18:09:27.286638 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_exercise.stg_products_northwind"
[0m18:09:27.287813 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:09:27.289571 [debug] [Thread-1 (]: On model.dbt_exercise.stg_orders_northwind: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "model.dbt_exercise.stg_orders_northwind"} */


  create or replace view `corded-sunlight-464012-e2`.`dbt_dw_staging`.`stg_orders_northwind`
  OPTIONS()
  as with raw_orders as (
    select *
    from `corded-sunlight-464012-e2`.`dbt_dw_raw`.`orders`
)

, stg_orders_northwind as (
    select
        cast(order_id as string) as order_id
        , cast(customer_id as string) as customer_id
        , cast(employee_id as string) as employee_id
        , cast(order_date as timestamp) as order_date
        , cast(required_date as timestamp) as required_date
        , cast(shipped_date as timestamp) as shipped_date
        , cast(ship_via as string) as ship_via
        , cast(freight as numeric) as freight
        , cast(ship_name as string) as ship_name
        , cast(ship_address as string) as ship_address
        , cast(ship_city as string) as ship_city
        , cast(ship_region as string) as ship_region
        , cast(ship_postal_code as string) as ship_postal_code
        , cast(ship_country as string) as ship_country
    from raw_orders
)

select *
from stg_orders_northwind;


[0m18:09:27.292122 [debug] [Thread-3 (]: On model.dbt_exercise.stg_shippers_northwind: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "model.dbt_exercise.stg_shippers_northwind"} */


  create or replace view `corded-sunlight-464012-e2`.`dbt_dw_staging`.`stg_shippers_northwind`
  OPTIONS()
  as with raw_shippers as (
    select *
    from `corded-sunlight-464012-e2`.`dbt_dw_raw`.`shippers`
)

, stg_shippers_northwind as (
    select
        cast(shipper_id as string) as shipper_id
        , cast(company_name as string) as company_name
        , cast(phone as string) as phone
    from raw_shippers
)

select *
from stg_shippers_northwind;


[0m18:09:27.293381 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:09:27.294276 [debug] [Thread-4 (]: On model.dbt_exercise.stg_products_northwind: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "model.dbt_exercise.stg_products_northwind"} */


  create or replace view `corded-sunlight-464012-e2`.`dbt_dw_staging`.`stg_products_northwind`
  OPTIONS()
  as with raw_products as (
    select *
    from `corded-sunlight-464012-e2`.`dbt_dw_raw`.`products`
)

, stg_products_northwind as (
    select
        cast(product_id as string) as product_id
        , cast(product_name as string) as product_name
        , cast(supplier_id as string) as supplier_id
        , cast(category_id as string) as category_id
        , cast(quantity_per_unit as string) as quantity_per_unit
        , cast(unit_price as numeric) as unit_price
        , cast(units_in_stock as numeric) as units_in_stock
        , cast(units_on_order as numeric) as units_on_order
        , cast(reorder_level as numeric) as reorder_level
        , cast(discontinued as integer) as discontinued
    from raw_products
)

select *
from stg_products_northwind;


[0m18:09:27.295609 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m18:09:27.296697 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m18:09:28.373648 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:9068d82f-a985-4efa-9984-c18bdf82a878&page=queryresults
[0m18:09:28.381724 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:b2c28209-0db2-4538-bcc7-01191a66c541&page=queryresults
[0m18:09:28.391774 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:03d5b262-6502-407b-aedd-40c3623f4fe6&page=queryresults
[0m18:09:28.418755 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:0264c1f4-a1f6-4198-92ee-50fccfadd0a1&page=queryresults
[0m18:09:28.886040 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4fd074a3-4c6f-4172-92bf-1affdad03e41', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d6f24434050>]}
[0m18:09:28.887386 [info ] [Thread-1 (]: 6 of 15 OK created sql view model dbt_dw_staging.stg_orders_northwind .......... [[32mCREATE VIEW (0 processed)[0m in 1.65s]
[0m18:09:28.888558 [debug] [Thread-1 (]: Finished running node model.dbt_exercise.stg_orders_northwind
[0m18:09:28.889533 [debug] [Thread-1 (]: Began running node model.dbt_exercise.stg_suppliers_northwind
[0m18:09:28.892160 [info ] [Thread-1 (]: 9 of 15 START sql view model dbt_dw_staging.stg_suppliers_northwind ............ [RUN]
[0m18:09:28.894606 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_exercise.stg_orders_northwind, now model.dbt_exercise.stg_suppliers_northwind)
[0m18:09:28.896961 [debug] [Thread-1 (]: Began compiling node model.dbt_exercise.stg_suppliers_northwind
[0m18:09:28.904016 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_exercise.stg_suppliers_northwind"
[0m18:09:28.911520 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4fd074a3-4c6f-4172-92bf-1affdad03e41', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d6f24300290>]}
[0m18:09:28.912641 [info ] [Thread-2 (]: 5 of 15 OK created sql view model dbt_dw_staging.stg_order_details_northwind ... [[32mCREATE VIEW (0 processed)[0m in 1.68s]
[0m18:09:28.913986 [debug] [Thread-2 (]: Finished running node model.dbt_exercise.stg_order_details_northwind
[0m18:09:28.914767 [debug] [Thread-1 (]: Began executing node model.dbt_exercise.stg_suppliers_northwind
[0m18:09:28.915445 [debug] [Thread-2 (]: Began running node model.dbt_exercise.int_customers_northwind
[0m18:09:28.919854 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_exercise.stg_suppliers_northwind"
[0m18:09:28.920988 [info ] [Thread-2 (]: 10 of 15 START sql view model dbt_dw_intermediate.int_customers_northwind ...... [RUN]
[0m18:09:28.922509 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_exercise.stg_order_details_northwind, now model.dbt_exercise.int_customers_northwind)
[0m18:09:28.923991 [debug] [Thread-2 (]: Began compiling node model.dbt_exercise.int_customers_northwind
[0m18:09:28.926183 [debug] [Thread-1 (]: On model.dbt_exercise.stg_suppliers_northwind: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "model.dbt_exercise.stg_suppliers_northwind"} */


  create or replace view `corded-sunlight-464012-e2`.`dbt_dw_staging`.`stg_suppliers_northwind`
  OPTIONS()
  as with raw_suppliers as (
    select *
    from `corded-sunlight-464012-e2`.`dbt_dw_raw`.`suppliers`
)

, stg_suppliers_northwind as (
    select
        cast(supplier_id as string) as supplier_id
        , cast(company_name as string) as company_name
        , cast(contact_name as string) as contact_name
        , cast(contact_title as string) as contact_title
        , cast(address as string) as address
        , cast(city as string) as city
        , cast(region as string) as region
        , cast(postal_code as string) as postal_code
        , cast(country as string) as country
        , cast(phone as string) as phone
        , cast(fax as string) as fax
        , cast(homepage as string) as home_page
    from raw_suppliers
)

select *
from stg_suppliers_northwind;


[0m18:09:28.929887 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_exercise.int_customers_northwind"
[0m18:09:28.934080 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:09:28.935461 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4fd074a3-4c6f-4172-92bf-1affdad03e41', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d6f2430fef0>]}
[0m18:09:28.937287 [info ] [Thread-4 (]: 7 of 15 OK created sql view model dbt_dw_staging.stg_products_northwind ........ [[32mCREATE VIEW (0 processed)[0m in 1.70s]
[0m18:09:28.938742 [debug] [Thread-4 (]: Finished running node model.dbt_exercise.stg_products_northwind
[0m18:09:28.939921 [debug] [Thread-4 (]: Began running node model.dbt_exercise.int_employees_northwind
[0m18:09:28.940816 [debug] [Thread-2 (]: Began executing node model.dbt_exercise.int_customers_northwind
[0m18:09:28.942250 [info ] [Thread-4 (]: 11 of 15 START sql view model dbt_dw_intermediate.int_employees_northwind ...... [RUN]
[0m18:09:28.946186 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_exercise.int_customers_northwind"
[0m18:09:28.947324 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.dbt_exercise.stg_products_northwind, now model.dbt_exercise.int_employees_northwind)
[0m18:09:28.949008 [debug] [Thread-4 (]: Began compiling node model.dbt_exercise.int_employees_northwind
[0m18:09:28.954627 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_exercise.int_employees_northwind"
[0m18:09:28.979619 [debug] [Thread-2 (]: On model.dbt_exercise.int_customers_northwind: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "model.dbt_exercise.int_customers_northwind"} */


  create or replace view `corded-sunlight-464012-e2`.`dbt_dw_intermediate`.`int_customers_northwind`
  OPTIONS()
  as with stg_customers_northwind as (
    select *
    from `corded-sunlight-464012-e2`.`dbt_dw_staging`.`stg_customers_northwind`
)

, int_customers_northwind as (
    select 
        customer_id
        , company_name
        , contact_name
        , contact_title
        , address
        , city
        , region
        , country
        , case 
            when country in ('USA', 'Canada', 'Mexico') then 'North America'
            when country in ('UK', 'France', 'Germany', 'Austria', 'Belgium', 'Denmark', 'Ireland'
            , 'Finland', 'Italy', 'Norway', 'Poland', 'Portugal', 'Spain', 'Sweden', 'Switzerland') then 'Europe'
            when country in ('Brazil', 'Argentina', 'Venezuela') then 'South America'
            else 'Other'
        end as continent
    from stg_customers_northwind
)

select *
from int_customers_northwind;


[0m18:09:28.981052 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:09:28.982096 [debug] [Thread-4 (]: Began executing node model.dbt_exercise.int_employees_northwind
[0m18:09:28.989122 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_exercise.int_employees_northwind"
[0m18:09:28.990830 [debug] [Thread-4 (]: On model.dbt_exercise.int_employees_northwind: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "model.dbt_exercise.int_employees_northwind"} */


  create or replace view `corded-sunlight-464012-e2`.`dbt_dw_intermediate`.`int_employees_northwind`
  OPTIONS()
  as with raw_employees as (
    select *
    from `corded-sunlight-464012-e2`.`dbt_dw_staging`.`stg_employees_northwind`
)

, max_fact_date as (
    select 
        cast(
            case 
                when max(order_date) >= max(shipped_date) then max(order_date)
                else max(shipped_date)
            end 
        as date) as max_date
    from `corded-sunlight-464012-e2`.`dbt_dw_staging`.`stg_orders_northwind`
)

, int_employees_northwind as (
    select
        employee_id
        , concat(first_name, ' ', last_name) as employee_name
        , title
        , birth_date
        , date_diff((select * from max_fact_date), birth_date, year) as age
        , hire_date
        , date_diff((select * from max_fact_date), hire_date, year) as years_hired
        , address
        , city
        , region
        , country
    from raw_employees
)

select *
from int_employees_northwind;


[0m18:09:28.991694 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m18:09:29.020698 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4fd074a3-4c6f-4172-92bf-1affdad03e41', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d6f24362c30>]}
[0m18:09:29.021696 [info ] [Thread-3 (]: 8 of 15 OK created sql view model dbt_dw_staging.stg_shippers_northwind ........ [[32mCREATE VIEW (0 processed)[0m in 1.78s]
[0m18:09:29.023746 [debug] [Thread-3 (]: Finished running node model.dbt_exercise.stg_shippers_northwind
[0m18:09:29.047890 [debug] [Thread-3 (]: Began running node model.dbt_exercise.int_orders_northwind
[0m18:09:29.048610 [info ] [Thread-3 (]: 12 of 15 START sql view model dbt_dw_intermediate.int_orders_northwind ......... [RUN]
[0m18:09:29.049226 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_exercise.stg_shippers_northwind, now model.dbt_exercise.int_orders_northwind)
[0m18:09:29.049844 [debug] [Thread-3 (]: Began compiling node model.dbt_exercise.int_orders_northwind
[0m18:09:29.054671 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_exercise.int_orders_northwind"
[0m18:09:29.055590 [debug] [Thread-3 (]: Began executing node model.dbt_exercise.int_orders_northwind
[0m18:09:29.058402 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_exercise.int_orders_northwind"
[0m18:09:29.059840 [debug] [Thread-3 (]: On model.dbt_exercise.int_orders_northwind: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "model.dbt_exercise.int_orders_northwind"} */


  create or replace view `corded-sunlight-464012-e2`.`dbt_dw_intermediate`.`int_orders_northwind`
  OPTIONS()
  as with stg_orders_northwind as (
    select *
    from `corded-sunlight-464012-e2`.`dbt_dw_staging`.`stg_orders_northwind`
)

, stg_order_details_northwind as (
    select *
    from `corded-sunlight-464012-e2`.`dbt_dw_staging`.`stg_order_details_northwind`
)

, stg_shippers_northwind as (
    select *
    from `corded-sunlight-464012-e2`.`dbt_dw_staging`.`stg_shippers_northwind`
)

, transformed_table as (    
    select
        stg_orders_northwind.order_id 
        , stg_orders_northwind.customer_id
        , stg_orders_northwind.employee_id
        , stg_orders_northwind.order_date
        , stg_orders_northwind.required_date
        , stg_orders_northwind.shipped_date
        , date_diff(stg_orders_northwind.shipped_date, stg_orders_northwind.order_date, day) as days_to_ship
        , concat(
            coalesce(stg_orders_northwind.ship_via, '')
            , '-'
            , coalesce(stg_shippers_northwind.company_name, '')
            , '-'
            , coalesce(stg_orders_northwind.ship_address, '')
        ) as ship_id
        , stg_orders_northwind.ship_via      
        , stg_shippers_northwind.company_name as shipper_name
        , sum(stg_order_details_northwind.unit_price * stg_order_details_northwind.quantity * (1 - stg_order_details_northwind.discount)) as total_order_amount
        , stg_orders_northwind.freight
        , stg_orders_northwind.ship_name
        , stg_orders_northwind.ship_address
        , stg_orders_northwind.ship_city
        , stg_orders_northwind.ship_region
        , stg_orders_northwind.ship_country
        , case
            when stg_orders_northwind.ship_country in ('USA', 'Canada', 'Mexico') then 'North America'
            when stg_orders_northwind.ship_country in ('UK', 'France', 'Germany', 'Austria', 'Belgium', 
            'Denmark', 'Ireland', 'Finland', 'Italy', 'Norway', 'Poland', 'Portugal', 'Spain', 'Sweden', 'Switzerland') then 'Europe'
            when stg_orders_northwind.ship_country in ('Brazil', 'Argentina', 'Venezuela') then 'South America'
            else 'Other'
        end as ship_continent
    from stg_orders_northwind
    left join stg_order_details_northwind
        on stg_orders_northwind.order_id = stg_order_details_northwind.order_id
    left join stg_shippers_northwind
        on stg_orders_northwind.ship_via = stg_shippers_northwind.shipper_id
    group by 
        stg_orders_northwind.order_id
        , stg_orders_northwind.customer_id
        , stg_orders_northwind.employee_id
        , stg_orders_northwind.order_date
        , stg_orders_northwind.required_date
        , stg_orders_northwind.shipped_date
        , stg_orders_northwind.ship_via
        , stg_shippers_northwind.company_name
        , stg_orders_northwind.freight
        , stg_orders_northwind.ship_name
        , stg_orders_northwind.ship_address
        , stg_orders_northwind.ship_city
        , stg_orders_northwind.ship_region
        , stg_orders_northwind.ship_country
)

, int_orders_northwind as (
    select
        transformed_table.order_id
        , transformed_table.customer_id
        , transformed_table.employee_id
        , transformed_table.order_date
        , transformed_table.required_date
        , transformed_table.shipped_date
        , transformed_table.days_to_ship
        , transformed_table.ship_id
        , transformed_table.ship_via
        , transformed_table.shipper_name
        , transformed_table.total_order_amount
        , transformed_table.freight
        , transformed_table.ship_name
        , transformed_table.ship_address
        , transformed_table.ship_city
        , transformed_table.ship_region
        , transformed_table.ship_country
        , transformed_table.ship_continent
        , case 
            when transformed_table.days_to_ship is null then False
            else True
          end as is_shipped
    from transformed_table
)

select *
from int_orders_northwind;


[0m18:09:29.060812 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m18:09:29.969573 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:9fc4dbbb-aaa4-4234-8433-305d73533b4b&page=queryresults
[0m18:09:30.107534 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:0186dbec-61a9-40fb-90d8-2922d3e4d11e&page=queryresults
[0m18:09:30.145903 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:089d1505-e910-4aa0-b936-072010845c67&page=queryresults
[0m18:09:30.151556 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:88d6a7f8-efd3-4e6c-b3d3-47d73bfb9bed&page=queryresults
[0m18:09:30.493381 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4fd074a3-4c6f-4172-92bf-1affdad03e41', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d6f24376ed0>]}
[0m18:09:30.494349 [info ] [Thread-1 (]: 9 of 15 OK created sql view model dbt_dw_staging.stg_suppliers_northwind ....... [[32mCREATE VIEW (0 processed)[0m in 1.60s]
[0m18:09:30.495019 [debug] [Thread-1 (]: Finished running node model.dbt_exercise.stg_suppliers_northwind
[0m18:09:30.495493 [debug] [Thread-1 (]: Began running node model.dbt_exercise.int_shippers_northwind
[0m18:09:30.496829 [info ] [Thread-1 (]: 13 of 15 START sql view model dbt_dw_intermediate.int_shippers_northwind ....... [RUN]
[0m18:09:30.498062 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_exercise.stg_suppliers_northwind, now model.dbt_exercise.int_shippers_northwind)
[0m18:09:30.498483 [debug] [Thread-1 (]: Began compiling node model.dbt_exercise.int_shippers_northwind
[0m18:09:30.501378 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_exercise.int_shippers_northwind"
[0m18:09:30.503678 [debug] [Thread-1 (]: Began executing node model.dbt_exercise.int_shippers_northwind
[0m18:09:30.506916 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_exercise.int_shippers_northwind"
[0m18:09:30.509428 [debug] [Thread-1 (]: On model.dbt_exercise.int_shippers_northwind: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "model.dbt_exercise.int_shippers_northwind"} */


  create or replace view `corded-sunlight-464012-e2`.`dbt_dw_intermediate`.`int_shippers_northwind`
  OPTIONS()
  as with stg_shippers_northwind as (
    select *
    from `corded-sunlight-464012-e2`.`dbt_dw_staging`.`stg_shippers_northwind`
)

, stg_orders_northwind as (
    select *
    from `corded-sunlight-464012-e2`.`dbt_dw_staging`.`stg_orders_northwind`
)

, transformed_table as (
    select
        concat(
            coalesce(stg_shippers_northwind.shipper_id, '')
            , '-'
            , coalesce(stg_shippers_northwind.company_name, '')
            , '-'
            , coalesce(stg_orders_northwind.ship_address, '')
        ) as ship_id
        , stg_shippers_northwind.shipper_id
        , stg_shippers_northwind.company_name
        , stg_orders_northwind.ship_address
        , stg_orders_northwind.ship_city
        , stg_orders_northwind.ship_region
        , stg_orders_northwind.ship_country
    from stg_shippers_northwind
    left join stg_orders_northwind
        on stg_shippers_northwind.shipper_id = stg_orders_northwind.ship_via
)

/* Aqui é feita a deduplicação da transformed_table */
, dedup_table as (
    select distinct *
    from transformed_table
)

, int_shippers_northwind as (
    select 
        *
        , case
            when dedup_table.ship_country in ('USA', 'Canada', 'Mexico') then 'North America'
            when dedup_table.ship_country in ('UK', 'France', 'Germany', 'Austria', 'Belgium', 
            'Denmark', 'Ireland', 'Finland', 'Italy', 'Norway', 'Poland', 'Portugal', 'Spain', 'Sweden', 'Switzerland') then 'Europe'
            when dedup_table.ship_country in ('Brazil', 'Argentina', 'Venezuela') then 'South America'
            else 'Other'
        end as ship_continent
    from dedup_table
)

select *
from int_shippers_northwind;


[0m18:09:30.510043 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:09:30.648526 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4fd074a3-4c6f-4172-92bf-1affdad03e41', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d6f2438bfe0>]}
[0m18:09:30.649306 [info ] [Thread-4 (]: 11 of 15 OK created sql view model dbt_dw_intermediate.int_employees_northwind . [[32mCREATE VIEW (0 processed)[0m in 1.70s]
[0m18:09:30.649876 [debug] [Thread-4 (]: Finished running node model.dbt_exercise.int_employees_northwind
[0m18:09:30.650266 [debug] [Thread-4 (]: Began running node model.dbt_exercise.int_products_northwind
[0m18:09:30.650743 [info ] [Thread-4 (]: 14 of 15 START sql view model dbt_dw_intermediate.int_products_northwind ....... [RUN]
[0m18:09:30.651718 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.dbt_exercise.int_employees_northwind, now model.dbt_exercise.int_products_northwind)
[0m18:09:30.653302 [debug] [Thread-4 (]: Began compiling node model.dbt_exercise.int_products_northwind
[0m18:09:30.656444 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4fd074a3-4c6f-4172-92bf-1affdad03e41', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d6f24347fe0>]}
[0m18:09:30.660503 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_exercise.int_products_northwind"
[0m18:09:30.661810 [info ] [Thread-3 (]: 12 of 15 OK created sql view model dbt_dw_intermediate.int_orders_northwind .... [[32mCREATE VIEW (0 processed)[0m in 1.61s]
[0m18:09:30.663621 [debug] [Thread-3 (]: Finished running node model.dbt_exercise.int_orders_northwind
[0m18:09:30.664844 [debug] [Thread-4 (]: Began executing node model.dbt_exercise.int_products_northwind
[0m18:09:30.667694 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_exercise.int_products_northwind"
[0m18:09:30.668516 [debug] [Thread-4 (]: On model.dbt_exercise.int_products_northwind: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "model.dbt_exercise.int_products_northwind"} */


  create or replace view `corded-sunlight-464012-e2`.`dbt_dw_intermediate`.`int_products_northwind`
  OPTIONS()
  as with stg_products_northwind as (
    select *
    from `corded-sunlight-464012-e2`.`dbt_dw_staging`.`stg_products_northwind`
)

, stg_categories_northwind as (
    select *
    from `corded-sunlight-464012-e2`.`dbt_dw_staging`.`stg_categories_northwind`
)

, stg_suppliers_northwind as (
    select *
    from `corded-sunlight-464012-e2`.`dbt_dw_staging`.`stg_suppliers_northwind`
)

, int_products_northwind as (
    select
        stg_products_northwind.product_id
        , stg_products_northwind.product_name
        , stg_products_northwind.quantity_per_unit
        , stg_categories_northwind.category_name
        , stg_suppliers_northwind.company_name as supplier_name
        , stg_suppliers_northwind.city as supplier_city
        , stg_suppliers_northwind.region as supplier_region
        , stg_suppliers_northwind.country as supplier_country
        , case
            when stg_suppliers_northwind.country in ('USA', 'Canada') then 'North America'
            when stg_suppliers_northwind.country in ('Brazil') then 'South America'
            when stg_suppliers_northwind.country in ('UK', 'Germany', 'Netherlands', 'Spain', 'France', 'Norway', 'Italy', 'Denmark', 'Sweden', 'Finland') then 'Europe'
            when stg_suppliers_northwind.country in ('Singapore', 'Japan') then 'Asia'
            when stg_suppliers_northwind.country in ('Australia') then 'Oceania'
            else 'Other'
          end as supplier_continent
        , case 
            when stg_products_northwind.discontinued = 1 then True
            else False
        end as is_discontinued
    from stg_products_northwind
    left join stg_categories_northwind
        on stg_products_northwind.category_id = stg_categories_northwind.category_id
    left join stg_suppliers_northwind
        on stg_products_northwind.supplier_id = stg_suppliers_northwind.supplier_id
)

select *
from int_products_northwind;


[0m18:09:30.669021 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m18:09:30.702822 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4fd074a3-4c6f-4172-92bf-1affdad03e41', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d6f243638c0>]}
[0m18:09:30.704498 [info ] [Thread-2 (]: 10 of 15 OK created sql view model dbt_dw_intermediate.int_customers_northwind . [[32mCREATE VIEW (0 processed)[0m in 1.78s]
[0m18:09:30.705754 [debug] [Thread-2 (]: Finished running node model.dbt_exercise.int_customers_northwind
[0m18:09:31.526846 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:0b70c14a-7558-46c0-88ff-b182c5797d28&page=queryresults
[0m18:09:31.813790 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:a7f91ffc-b966-46ad-94b2-8563b2175a42&page=queryresults
[0m18:09:32.062641 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4fd074a3-4c6f-4172-92bf-1affdad03e41', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d6f24347b00>]}
[0m18:09:32.063649 [info ] [Thread-1 (]: 13 of 15 OK created sql view model dbt_dw_intermediate.int_shippers_northwind .. [[32mCREATE VIEW (0 processed)[0m in 1.56s]
[0m18:09:32.064512 [debug] [Thread-1 (]: Finished running node model.dbt_exercise.int_shippers_northwind
[0m18:09:32.319192 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4fd074a3-4c6f-4172-92bf-1affdad03e41', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d6f2438b830>]}
[0m18:09:32.320063 [info ] [Thread-4 (]: 14 of 15 OK created sql view model dbt_dw_intermediate.int_products_northwind .. [[32mCREATE VIEW (0 processed)[0m in 1.67s]
[0m18:09:32.320775 [debug] [Thread-4 (]: Finished running node model.dbt_exercise.int_products_northwind
[0m18:09:32.322957 [debug] [Thread-3 (]: Began running node model.dbt_exercise.dim_products
[0m18:09:32.324157 [info ] [Thread-3 (]: 15 of 15 START sql table model dbt_dw_marts.dim_products ....................... [RUN]
[0m18:09:32.325120 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_exercise.int_orders_northwind, now model.dbt_exercise.dim_products)
[0m18:09:32.325686 [debug] [Thread-3 (]: Began compiling node model.dbt_exercise.dim_products
[0m18:09:32.344298 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_exercise.dim_products"
[0m18:09:32.348226 [debug] [Thread-3 (]: Began executing node model.dbt_exercise.dim_products
[0m18:09:32.358565 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m18:09:33.189080 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_exercise.dim_products"
[0m18:09:33.189941 [debug] [Thread-3 (]: On model.dbt_exercise.dim_products: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "model.dbt_exercise.dim_products"} */

  
    

    create or replace table `corded-sunlight-464012-e2`.`dbt_dw_marts`.`dim_products`
      
    
    

    OPTIONS()
    as (
      with int_products as (
    select *
    from `corded-sunlight-464012-e2`.`dbt_dw_intermediate`.`int_products_northwind`
)

, dim_products as (
    select
        to_hex(md5(cast(coalesce(cast(product_id as string), '_dbt_utils_surrogate_key_null_') as string))) as sk_product
        , product_id
        , product_name
        , quantity_per_unit
        , category_name
        , supplier_name
        , supplier_city
        , supplier_region
        , supplier_country
        , supplier_continent
        , discontinued
    from int_products
)

select *
from dim_products
    );
  
[0m18:09:33.952472 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:85e617f9-b103-44e2-824a-92d398fa3a94&page=queryresults
[0m18:09:34.231941 [error] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:85e617f9-b103-44e2-824a-92d398fa3a94&page=queryresults
[0m18:09:34.330945 [debug] [Thread-3 (]: Database Error in model dim_products (models/marts/dim_products.sql)
  Unrecognized name: discontinued; Did you mean is_discontinued? at [30:11]
  compiled code at target/run/dbt_exercise/models/marts/dim_products.sql
[0m18:09:34.331737 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4fd074a3-4c6f-4172-92bf-1affdad03e41', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d6f24353380>]}
[0m18:09:34.332420 [error] [Thread-3 (]: 15 of 15 ERROR creating sql table model dbt_dw_marts.dim_products .............. [[31mERROR[0m in 2.01s]
[0m18:09:34.333006 [debug] [Thread-3 (]: Finished running node model.dbt_exercise.dim_products
[0m18:09:34.333639 [debug] [Thread-7 (]: Marking all children of 'model.dbt_exercise.dim_products' to be skipped because of status 'error'.  Reason: Database Error in model dim_products (models/marts/dim_products.sql)
  Unrecognized name: discontinued; Did you mean is_discontinued? at [30:11]
  compiled code at target/run/dbt_exercise/models/marts/dim_products.sql.
[0m18:09:34.337310 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:09:34.344830 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:09:34.345337 [debug] [MainThread]: Connection 'model.dbt_exercise.int_customers_northwind' was properly closed.
[0m18:09:34.345678 [debug] [MainThread]: Connection 'model.dbt_exercise.dim_products' was properly closed.
[0m18:09:34.346017 [debug] [MainThread]: Connection 'model.dbt_exercise.int_products_northwind' was properly closed.
[0m18:09:34.346392 [debug] [MainThread]: Connection 'model.dbt_exercise.int_shippers_northwind' was properly closed.
[0m18:09:34.346912 [info ] [MainThread]: 
[0m18:09:34.347607 [info ] [MainThread]: Finished running 1 table model, 14 view models in 0 hours 0 minutes and 15.37 seconds (15.37s).
[0m18:09:34.350111 [debug] [MainThread]: Command end result
[0m18:09:34.392295 [debug] [MainThread]: Wrote artifact WritableManifest to /home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/target/manifest.json
[0m18:09:34.405282 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/target/semantic_manifest.json
[0m18:09:34.411840 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/target/run_results.json
[0m18:09:34.412286 [info ] [MainThread]: 
[0m18:09:34.412679 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m18:09:34.413114 [info ] [MainThread]: 
[0m18:09:34.413645 [error] [MainThread]: [31mFailure in model dim_products (models/marts/dim_products.sql)[0m
[0m18:09:34.414069 [error] [MainThread]:   Database Error in model dim_products (models/marts/dim_products.sql)
  Unrecognized name: discontinued; Did you mean is_discontinued? at [30:11]
  compiled code at target/run/dbt_exercise/models/marts/dim_products.sql
[0m18:09:34.414379 [info ] [MainThread]: 
[0m18:09:34.414726 [info ] [MainThread]:   compiled code at target/compiled/dbt_exercise/models/marts/dim_products.sql
[0m18:09:34.415061 [info ] [MainThread]: 
[0m18:09:34.415528 [info ] [MainThread]: Done. PASS=14 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=15
[0m18:09:34.416145 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- DuplicateYAMLKeysDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m18:09:34.420645 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 108.84873, "process_in_blocks": "145144", "process_kernel_time": 12.691071, "process_mem_max_rss": "369592", "process_out_blocks": "3936", "process_user_time": 11.109156}
[0m18:09:34.421458 [debug] [MainThread]: Command `dbt run` failed at 18:09:34.421284 after 108.85 seconds
[0m18:09:34.421960 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d6f63400e60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d6f250ec740>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d6f25567080>]}
[0m18:09:34.422348 [debug] [MainThread]: Flushing usage events
[0m18:09:35.057834 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:15:24.030187 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x703792ba1370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70379120bc50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x703790a21250>]}


============================== 18:15:24.055137 | ac39f711-8523-4922-ad99-047300bc9bdb ==============================
[0m18:15:24.055137 [info ] [MainThread]: Running with dbt=1.10.2
[0m18:15:24.056571 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/logs', 'profiles_dir': '/home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt run -s +dim_products', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m18:16:10.671518 [warn ] [MainThread]: [[33mWARNING[0m][DuplicateYAMLKeysDeprecation]: Deprecated functionality
Duplicate key 'version' in "<unicode string>", line 4, column 1 in file
`/home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/dbt_project.yml`
[0m18:16:10.672120 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'ac39f711-8523-4922-ad99-047300bc9bdb', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x703753568d10>]}
[0m18:16:11.358318 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ac39f711-8523-4922-ad99-047300bc9bdb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x703790254320>]}
[0m18:16:11.421521 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ac39f711-8523-4922-ad99-047300bc9bdb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x703790babfb0>]}
[0m18:16:11.424939 [info ] [MainThread]: Registered adapter: bigquery=1.9.2
[0m18:16:56.915963 [debug] [MainThread]: checksum: 1adc40777973ef30f45f80b3b6d04d5013c1edd53d96363881b3b199e612468b, vars: {}, profile: , target: , version: 1.10.2
[0m18:17:01.474616 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:17:01.475159 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:17:01.521752 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ac39f711-8523-4922-ad99-047300bc9bdb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70379020d820>]}
[0m18:17:01.839773 [debug] [MainThread]: Wrote artifact WritableManifest to /home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/target/manifest.json
[0m18:17:01.854858 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/target/semantic_manifest.json
[0m18:17:02.225480 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ac39f711-8523-4922-ad99-047300bc9bdb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7037533ed460>]}
[0m18:17:02.226037 [info ] [MainThread]: Found 14 seeds, 36 data tests, 16 models, 14 sources, 609 macros
[0m18:17:02.226416 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ac39f711-8523-4922-ad99-047300bc9bdb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x703752f67980>]}
[0m18:17:02.228538 [info ] [MainThread]: 
[0m18:17:02.229125 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m18:17:02.229468 [info ] [MainThread]: 
[0m18:17:02.229994 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m18:17:02.234608 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_corded-sunlight-464012-e2'
[0m18:17:02.235664 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:17:02.236451 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_corded-sunlight-464012-e2'
[0m18:17:02.238183 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_corded-sunlight-464012-e2'
[0m18:17:02.239136 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:17:02.239888 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:17:03.631949 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_corded-sunlight-464012-e2, now list_corded-sunlight-464012-e2_dbt_dw_intermediate)
[0m18:17:03.633343 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_corded-sunlight-464012-e2, now list_corded-sunlight-464012-e2_dbt_dw_staging)
[0m18:17:03.634211 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:17:03.635554 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_corded-sunlight-464012-e2, now list_corded-sunlight-464012-e2_dbt_dw_raw)
[0m18:17:03.636758 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:17:03.637687 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_corded-sunlight-464012-e2_dbt_dw_marts'
[0m18:17:03.639272 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:17:03.640608 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:17:04.492519 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ac39f711-8523-4922-ad99-047300bc9bdb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x703792cfc230>]}
[0m18:17:04.493535 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:17:04.508204 [debug] [Thread-1 (]: Began running node model.dbt_exercise.stg_categories_northwind
[0m18:17:04.508656 [debug] [Thread-2 (]: Began running node model.dbt_exercise.stg_products_northwind
[0m18:17:04.509162 [debug] [Thread-3 (]: Began running node model.dbt_exercise.stg_suppliers_northwind
[0m18:17:04.509802 [info ] [Thread-1 (]: 1 of 5 START sql view model dbt_dw_staging.stg_categories_northwind ............ [RUN]
[0m18:17:04.510977 [info ] [Thread-2 (]: 2 of 5 START sql view model dbt_dw_staging.stg_products_northwind .............. [RUN]
[0m18:17:04.511894 [info ] [Thread-3 (]: 3 of 5 START sql view model dbt_dw_staging.stg_suppliers_northwind ............. [RUN]
[0m18:17:04.512745 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_corded-sunlight-464012-e2_dbt_dw_marts, now model.dbt_exercise.stg_categories_northwind)
[0m18:17:04.513326 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_corded-sunlight-464012-e2_dbt_dw_raw, now model.dbt_exercise.stg_products_northwind)
[0m18:17:04.513891 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_corded-sunlight-464012-e2_dbt_dw_intermediate, now model.dbt_exercise.stg_suppliers_northwind)
[0m18:17:04.515003 [debug] [Thread-1 (]: Began compiling node model.dbt_exercise.stg_categories_northwind
[0m18:17:04.515749 [debug] [Thread-2 (]: Began compiling node model.dbt_exercise.stg_products_northwind
[0m18:17:04.516501 [debug] [Thread-3 (]: Began compiling node model.dbt_exercise.stg_suppliers_northwind
[0m18:17:04.525426 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_exercise.stg_categories_northwind"
[0m18:17:04.530008 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_exercise.stg_products_northwind"
[0m18:17:04.533723 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_exercise.stg_suppliers_northwind"
[0m18:17:04.536824 [debug] [Thread-2 (]: Began executing node model.dbt_exercise.stg_products_northwind
[0m18:17:04.537651 [debug] [Thread-3 (]: Began executing node model.dbt_exercise.stg_suppliers_northwind
[0m18:17:04.544501 [debug] [Thread-1 (]: Began executing node model.dbt_exercise.stg_categories_northwind
[0m18:17:04.595418 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_exercise.stg_suppliers_northwind"
[0m18:17:04.593004 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_exercise.stg_products_northwind"
[0m18:17:04.599404 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_exercise.stg_categories_northwind"
[0m18:17:04.601869 [debug] [Thread-3 (]: On model.dbt_exercise.stg_suppliers_northwind: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "model.dbt_exercise.stg_suppliers_northwind"} */


  create or replace view `corded-sunlight-464012-e2`.`dbt_dw_staging`.`stg_suppliers_northwind`
  OPTIONS()
  as with raw_suppliers as (
    select *
    from `corded-sunlight-464012-e2`.`dbt_dw_raw`.`suppliers`
)

, stg_suppliers_northwind as (
    select
        cast(supplier_id as string) as supplier_id
        , cast(company_name as string) as company_name
        , cast(contact_name as string) as contact_name
        , cast(contact_title as string) as contact_title
        , cast(address as string) as address
        , cast(city as string) as city
        , cast(region as string) as region
        , cast(postal_code as string) as postal_code
        , cast(country as string) as country
        , cast(phone as string) as phone
        , cast(fax as string) as fax
        , cast(homepage as string) as home_page
    from raw_suppliers
)

select *
from stg_suppliers_northwind;


[0m18:17:04.602543 [debug] [Thread-2 (]: On model.dbt_exercise.stg_products_northwind: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "model.dbt_exercise.stg_products_northwind"} */


  create or replace view `corded-sunlight-464012-e2`.`dbt_dw_staging`.`stg_products_northwind`
  OPTIONS()
  as with raw_products as (
    select *
    from `corded-sunlight-464012-e2`.`dbt_dw_raw`.`products`
)

, stg_products_northwind as (
    select
        cast(product_id as string) as product_id
        , cast(product_name as string) as product_name
        , cast(supplier_id as string) as supplier_id
        , cast(category_id as string) as category_id
        , cast(quantity_per_unit as string) as quantity_per_unit
        , cast(unit_price as numeric) as unit_price
        , cast(units_in_stock as numeric) as units_in_stock
        , cast(units_on_order as numeric) as units_on_order
        , cast(reorder_level as numeric) as reorder_level
        , cast(discontinued as integer) as discontinued
    from raw_products
)

select *
from stg_products_northwind;


[0m18:17:04.603651 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m18:17:04.604487 [debug] [Thread-1 (]: On model.dbt_exercise.stg_categories_northwind: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "model.dbt_exercise.stg_categories_northwind"} */


  create or replace view `corded-sunlight-464012-e2`.`dbt_dw_staging`.`stg_categories_northwind`
  OPTIONS()
  as with raw_categories as (
    select *
    from `corded-sunlight-464012-e2`.`dbt_dw_raw`.`categories`
)

/* Ao construir a staging não vamos trazer a coluna picture, pois ela não traz informação relevante */
, stg_categories_northwind as (
    select
        cast(category_id as string) as category_id
        , cast(category_name as string) as category_name
        , cast(description as string) as description
    from raw_categories
)

select *
from stg_categories_northwind;


[0m18:17:04.605305 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:17:04.606707 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:17:05.645309 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:8f58949a-c631-48e2-90ed-7a5ff59e92b2&page=queryresults
[0m18:17:05.678703 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:0cec61e2-e950-4c48-af86-d5117feea82e&page=queryresults
[0m18:17:05.701444 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:ba69a317-10a1-439c-b09a-4e278e98d6d0&page=queryresults
[0m18:17:10.056612 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ac39f711-8523-4922-ad99-047300bc9bdb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x703757ebeb70>]}
[0m18:17:10.057263 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ac39f711-8523-4922-ad99-047300bc9bdb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x703791616180>]}
[0m18:17:10.058456 [info ] [Thread-2 (]: 2 of 5 OK created sql view model dbt_dw_staging.stg_products_northwind ......... [[32mCREATE VIEW (0 processed)[0m in 5.53s]
[0m18:17:10.059715 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ac39f711-8523-4922-ad99-047300bc9bdb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7037902555e0>]}
[0m18:17:10.061001 [info ] [Thread-3 (]: 3 of 5 OK created sql view model dbt_dw_staging.stg_suppliers_northwind ........ [[32mCREATE VIEW (0 processed)[0m in 5.53s]
[0m18:17:10.061909 [debug] [Thread-2 (]: Finished running node model.dbt_exercise.stg_products_northwind
[0m18:17:10.063082 [info ] [Thread-1 (]: 1 of 5 OK created sql view model dbt_dw_staging.stg_categories_northwind ....... [[32mCREATE VIEW (0 processed)[0m in 5.53s]
[0m18:17:10.063796 [debug] [Thread-3 (]: Finished running node model.dbt_exercise.stg_suppliers_northwind
[0m18:17:10.065424 [debug] [Thread-1 (]: Finished running node model.dbt_exercise.stg_categories_northwind
[0m18:17:10.068096 [debug] [Thread-4 (]: Began running node model.dbt_exercise.int_products_northwind
[0m18:17:10.068934 [info ] [Thread-4 (]: 4 of 5 START sql view model dbt_dw_intermediate.int_products_northwind ......... [RUN]
[0m18:17:10.070018 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly list_corded-sunlight-464012-e2_dbt_dw_staging, now model.dbt_exercise.int_products_northwind)
[0m18:17:10.070571 [debug] [Thread-4 (]: Began compiling node model.dbt_exercise.int_products_northwind
[0m18:17:10.074297 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_exercise.int_products_northwind"
[0m18:17:10.076471 [debug] [Thread-4 (]: Began executing node model.dbt_exercise.int_products_northwind
[0m18:17:10.080309 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_exercise.int_products_northwind"
[0m18:17:10.081938 [debug] [Thread-4 (]: On model.dbt_exercise.int_products_northwind: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "model.dbt_exercise.int_products_northwind"} */


  create or replace view `corded-sunlight-464012-e2`.`dbt_dw_intermediate`.`int_products_northwind`
  OPTIONS()
  as with stg_products_northwind as (
    select *
    from `corded-sunlight-464012-e2`.`dbt_dw_staging`.`stg_products_northwind`
)

, stg_categories_northwind as (
    select *
    from `corded-sunlight-464012-e2`.`dbt_dw_staging`.`stg_categories_northwind`
)

, stg_suppliers_northwind as (
    select *
    from `corded-sunlight-464012-e2`.`dbt_dw_staging`.`stg_suppliers_northwind`
)

, int_products_northwind as (
    select
        stg_products_northwind.product_id
        , stg_products_northwind.product_name
        , stg_products_northwind.quantity_per_unit
        , stg_categories_northwind.category_name
        , stg_suppliers_northwind.company_name as supplier_name
        , stg_suppliers_northwind.city as supplier_city
        , stg_suppliers_northwind.region as supplier_region
        , stg_suppliers_northwind.country as supplier_country
        , case
            when stg_suppliers_northwind.country in ('USA', 'Canada') then 'North America'
            when stg_suppliers_northwind.country in ('Brazil') then 'South America'
            when stg_suppliers_northwind.country in ('UK', 'Germany', 'Netherlands', 'Spain', 'France', 'Norway', 'Italy', 'Denmark', 'Sweden', 'Finland') then 'Europe'
            when stg_suppliers_northwind.country in ('Singapore', 'Japan') then 'Asia'
            when stg_suppliers_northwind.country in ('Australia') then 'Oceania'
            else 'Other'
          end as supplier_continent
        , case 
            when stg_products_northwind.discontinued = 1 then True
            else False
        end as is_discontinued
    from stg_products_northwind
    left join stg_categories_northwind
        on stg_products_northwind.category_id = stg_categories_northwind.category_id
    left join stg_suppliers_northwind
        on stg_products_northwind.supplier_id = stg_suppliers_northwind.supplier_id
)

select *
from int_products_northwind;


[0m18:17:10.082867 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m18:17:11.218217 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:1aeed10d-0686-4bfd-8277-053166dac6ec&page=queryresults
[0m18:17:11.741420 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ac39f711-8523-4922-ad99-047300bc9bdb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70375017e3f0>]}
[0m18:17:11.742225 [info ] [Thread-4 (]: 4 of 5 OK created sql view model dbt_dw_intermediate.int_products_northwind .... [[32mCREATE VIEW (0 processed)[0m in 1.67s]
[0m18:17:11.743072 [debug] [Thread-4 (]: Finished running node model.dbt_exercise.int_products_northwind
[0m18:17:11.744352 [debug] [Thread-3 (]: Began running node model.dbt_exercise.dim_products
[0m18:17:11.745693 [info ] [Thread-3 (]: 5 of 5 START sql table model dbt_dw_marts.dim_products ......................... [RUN]
[0m18:17:11.746506 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_exercise.stg_suppliers_northwind, now model.dbt_exercise.dim_products)
[0m18:17:11.746998 [debug] [Thread-3 (]: Began compiling node model.dbt_exercise.dim_products
[0m18:17:11.761816 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_exercise.dim_products"
[0m18:17:11.764079 [debug] [Thread-3 (]: Began executing node model.dbt_exercise.dim_products
[0m18:17:11.773805 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m18:17:12.649637 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_exercise.dim_products"
[0m18:17:12.650397 [debug] [Thread-3 (]: On model.dbt_exercise.dim_products: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "model.dbt_exercise.dim_products"} */

  
    

    create or replace table `corded-sunlight-464012-e2`.`dbt_dw_marts`.`dim_products`
      
    
    

    OPTIONS()
    as (
      with int_products_northwind as (
    select *
    from `corded-sunlight-464012-e2`.`dbt_dw_intermediate`.`int_products_northwind`
)

, dim_products as (
    select
        to_hex(md5(cast(coalesce(cast(product_id as string), '_dbt_utils_surrogate_key_null_') as string))) as sk_product
        , product_id
        , product_name
        , quantity_per_unit
        , category_name
        , supplier_name
        , supplier_city
        , supplier_region
        , supplier_country
        , supplier_continent
        , is_discontinued
    from int_products
)

select *
from dim_products
    );
  
[0m18:17:12.948149 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:714380a0-64f6-43e2-8ffe-fda96b9d7e60&page=queryresults
[0m18:17:12.948797 [error] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:714380a0-64f6-43e2-8ffe-fda96b9d7e60&page=queryresults
[0m18:17:13.033780 [debug] [Thread-3 (]: Database Error in model dim_products (models/marts/dim_products.sql)
  Table "int_products" must be qualified with a dataset (e.g. dataset.table).
  compiled code at target/run/dbt_exercise/models/marts/dim_products.sql
[0m18:17:13.034440 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ac39f711-8523-4922-ad99-047300bc9bdb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x703752c6cf50>]}
[0m18:17:13.035277 [error] [Thread-3 (]: 5 of 5 ERROR creating sql table model dbt_dw_marts.dim_products ................ [[31mERROR[0m in 1.29s]
[0m18:17:13.036164 [debug] [Thread-3 (]: Finished running node model.dbt_exercise.dim_products
[0m18:17:13.037032 [debug] [Thread-7 (]: Marking all children of 'model.dbt_exercise.dim_products' to be skipped because of status 'error'.  Reason: Database Error in model dim_products (models/marts/dim_products.sql)
  Table "int_products" must be qualified with a dataset (e.g. dataset.table).
  compiled code at target/run/dbt_exercise/models/marts/dim_products.sql.
[0m18:17:13.041071 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:17:13.047687 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:17:13.048270 [debug] [MainThread]: Connection 'model.dbt_exercise.int_products_northwind' was properly closed.
[0m18:17:13.048598 [debug] [MainThread]: Connection 'model.dbt_exercise.stg_products_northwind' was properly closed.
[0m18:17:13.050061 [debug] [MainThread]: Connection 'model.dbt_exercise.dim_products' was properly closed.
[0m18:17:13.050546 [debug] [MainThread]: Connection 'model.dbt_exercise.stg_categories_northwind' was properly closed.
[0m18:17:13.051224 [info ] [MainThread]: 
[0m18:17:13.051842 [info ] [MainThread]: Finished running 1 table model, 4 view models in 0 hours 0 minutes and 10.82 seconds (10.82s).
[0m18:17:13.053066 [debug] [MainThread]: Command end result
[0m18:17:13.095959 [debug] [MainThread]: Wrote artifact WritableManifest to /home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/target/manifest.json
[0m18:17:13.106961 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/target/semantic_manifest.json
[0m18:17:13.112909 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/target/run_results.json
[0m18:17:13.113420 [info ] [MainThread]: 
[0m18:17:13.113878 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m18:17:13.114223 [info ] [MainThread]: 
[0m18:17:13.114732 [error] [MainThread]: [31mFailure in model dim_products (models/marts/dim_products.sql)[0m
[0m18:17:13.115248 [error] [MainThread]:   Database Error in model dim_products (models/marts/dim_products.sql)
  Table "int_products" must be qualified with a dataset (e.g. dataset.table).
  compiled code at target/run/dbt_exercise/models/marts/dim_products.sql
[0m18:17:13.115588 [info ] [MainThread]: 
[0m18:17:13.115947 [info ] [MainThread]:   compiled code at target/compiled/dbt_exercise/models/marts/dim_products.sql
[0m18:17:13.116429 [info ] [MainThread]: 
[0m18:17:13.116765 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=5
[0m18:17:13.117278 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- DuplicateYAMLKeysDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m18:17:13.123181 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 105.68709, "process_in_blocks": "143400", "process_kernel_time": 13.75292, "process_mem_max_rss": "368560", "process_out_blocks": "3648", "process_user_time": 11.389348}
[0m18:17:13.123884 [debug] [MainThread]: Command `dbt run` failed at 18:17:13.123734 after 105.69 seconds
[0m18:17:13.124292 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x703790ae5340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x703752c3f4d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x703752c3f5c0>]}
[0m18:17:13.124638 [debug] [MainThread]: Flushing usage events
[0m18:17:13.775164 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:17:50.742527 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7aacf9a43830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7aacfa691940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7aacf9365340>]}


============================== 18:17:50.763151 | 2b27c916-357e-4fba-beab-33dcf47c847d ==============================
[0m18:17:50.763151 [info ] [MainThread]: Running with dbt=1.10.2
[0m18:17:50.763675 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'invocation_command': 'dbt run -s +dim_products', 'send_anonymous_usage_stats': 'True'}
[0m18:18:40.099281 [warn ] [MainThread]: [[33mWARNING[0m][DuplicateYAMLKeysDeprecation]: Deprecated functionality
Duplicate key 'version' in "<unicode string>", line 4, column 1 in file
`/home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/dbt_project.yml`
[0m18:18:40.100067 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '2b27c916-357e-4fba-beab-33dcf47c847d', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7aacf8ba4d70>]}
[0m18:18:40.741084 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2b27c916-357e-4fba-beab-33dcf47c847d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7aacbba33350>]}
[0m18:18:40.802432 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2b27c916-357e-4fba-beab-33dcf47c847d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7aacbbb92840>]}
[0m18:18:40.806092 [info ] [MainThread]: Registered adapter: bigquery=1.9.2
[0m18:19:27.036409 [debug] [MainThread]: checksum: 1adc40777973ef30f45f80b3b6d04d5013c1edd53d96363881b3b199e612468b, vars: {}, profile: , target: , version: 1.10.2
[0m18:19:31.809469 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:19:31.810306 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:19:31.864449 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2b27c916-357e-4fba-beab-33dcf47c847d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7aacbba9c440>]}
[0m18:19:32.280749 [debug] [MainThread]: Wrote artifact WritableManifest to /home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/target/manifest.json
[0m18:19:32.293322 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/target/semantic_manifest.json
[0m18:19:32.695076 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2b27c916-357e-4fba-beab-33dcf47c847d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7aacbbb92990>]}
[0m18:19:32.695891 [info ] [MainThread]: Found 14 seeds, 36 data tests, 16 models, 14 sources, 609 macros
[0m18:19:32.696583 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2b27c916-357e-4fba-beab-33dcf47c847d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7aacbbb72630>]}
[0m18:19:32.699272 [info ] [MainThread]: 
[0m18:19:32.699996 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m18:19:32.700479 [info ] [MainThread]: 
[0m18:19:32.701145 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m18:19:32.706576 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_corded-sunlight-464012-e2'
[0m18:19:32.707987 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:19:32.708848 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_corded-sunlight-464012-e2'
[0m18:19:32.710286 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_corded-sunlight-464012-e2'
[0m18:19:32.711154 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:19:32.711831 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:19:33.902481 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_corded-sunlight-464012-e2, now list_corded-sunlight-464012-e2_dbt_dw_intermediate)
[0m18:19:33.903559 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_corded-sunlight-464012-e2, now list_corded-sunlight-464012-e2_dbt_dw_raw)
[0m18:19:33.904231 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:19:33.905237 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_corded-sunlight-464012-e2, now list_corded-sunlight-464012-e2_dbt_dw_marts)
[0m18:19:33.905900 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:19:33.907067 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_corded-sunlight-464012-e2_dbt_dw_staging'
[0m18:19:33.908249 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:19:33.909081 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:19:34.771547 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2b27c916-357e-4fba-beab-33dcf47c847d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7aacfcc19b50>]}
[0m18:19:34.772211 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:19:34.786168 [debug] [Thread-1 (]: Began running node model.dbt_exercise.stg_categories_northwind
[0m18:19:34.786718 [debug] [Thread-2 (]: Began running node model.dbt_exercise.stg_products_northwind
[0m18:19:34.787255 [debug] [Thread-3 (]: Began running node model.dbt_exercise.stg_suppliers_northwind
[0m18:19:34.787885 [info ] [Thread-1 (]: 1 of 5 START sql view model dbt_dw_staging.stg_categories_northwind ............ [RUN]
[0m18:19:34.788858 [info ] [Thread-2 (]: 2 of 5 START sql view model dbt_dw_staging.stg_products_northwind .............. [RUN]
[0m18:19:34.789811 [info ] [Thread-3 (]: 3 of 5 START sql view model dbt_dw_staging.stg_suppliers_northwind ............. [RUN]
[0m18:19:34.790846 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_corded-sunlight-464012-e2_dbt_dw_intermediate, now model.dbt_exercise.stg_categories_northwind)
[0m18:19:34.791429 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_corded-sunlight-464012-e2_dbt_dw_staging, now model.dbt_exercise.stg_products_northwind)
[0m18:19:34.791915 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_corded-sunlight-464012-e2_dbt_dw_marts, now model.dbt_exercise.stg_suppliers_northwind)
[0m18:19:34.793131 [debug] [Thread-1 (]: Began compiling node model.dbt_exercise.stg_categories_northwind
[0m18:19:34.794122 [debug] [Thread-2 (]: Began compiling node model.dbt_exercise.stg_products_northwind
[0m18:19:34.794853 [debug] [Thread-3 (]: Began compiling node model.dbt_exercise.stg_suppliers_northwind
[0m18:19:34.803857 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_exercise.stg_categories_northwind"
[0m18:19:34.807860 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_exercise.stg_products_northwind"
[0m18:19:34.811907 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_exercise.stg_suppliers_northwind"
[0m18:19:34.814789 [debug] [Thread-3 (]: Began executing node model.dbt_exercise.stg_suppliers_northwind
[0m18:19:34.815455 [debug] [Thread-2 (]: Began executing node model.dbt_exercise.stg_products_northwind
[0m18:19:34.816321 [debug] [Thread-1 (]: Began executing node model.dbt_exercise.stg_categories_northwind
[0m18:19:34.884829 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_exercise.stg_categories_northwind"
[0m18:19:34.888115 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_exercise.stg_products_northwind"
[0m18:19:34.889380 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_exercise.stg_suppliers_northwind"
[0m18:19:34.891262 [debug] [Thread-3 (]: On model.dbt_exercise.stg_suppliers_northwind: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "model.dbt_exercise.stg_suppliers_northwind"} */


  create or replace view `corded-sunlight-464012-e2`.`dbt_dw_staging`.`stg_suppliers_northwind`
  OPTIONS()
  as with raw_suppliers as (
    select *
    from `corded-sunlight-464012-e2`.`dbt_dw_raw`.`suppliers`
)

, stg_suppliers_northwind as (
    select
        cast(supplier_id as string) as supplier_id
        , cast(company_name as string) as company_name
        , cast(contact_name as string) as contact_name
        , cast(contact_title as string) as contact_title
        , cast(address as string) as address
        , cast(city as string) as city
        , cast(region as string) as region
        , cast(postal_code as string) as postal_code
        , cast(country as string) as country
        , cast(phone as string) as phone
        , cast(fax as string) as fax
        , cast(homepage as string) as home_page
    from raw_suppliers
)

select *
from stg_suppliers_northwind;


[0m18:19:34.891970 [debug] [Thread-2 (]: On model.dbt_exercise.stg_products_northwind: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "model.dbt_exercise.stg_products_northwind"} */


  create or replace view `corded-sunlight-464012-e2`.`dbt_dw_staging`.`stg_products_northwind`
  OPTIONS()
  as with raw_products as (
    select *
    from `corded-sunlight-464012-e2`.`dbt_dw_raw`.`products`
)

, stg_products_northwind as (
    select
        cast(product_id as string) as product_id
        , cast(product_name as string) as product_name
        , cast(supplier_id as string) as supplier_id
        , cast(category_id as string) as category_id
        , cast(quantity_per_unit as string) as quantity_per_unit
        , cast(unit_price as numeric) as unit_price
        , cast(units_in_stock as numeric) as units_in_stock
        , cast(units_on_order as numeric) as units_on_order
        , cast(reorder_level as numeric) as reorder_level
        , cast(discontinued as integer) as discontinued
    from raw_products
)

select *
from stg_products_northwind;


[0m18:19:34.892481 [debug] [Thread-1 (]: On model.dbt_exercise.stg_categories_northwind: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "model.dbt_exercise.stg_categories_northwind"} */


  create or replace view `corded-sunlight-464012-e2`.`dbt_dw_staging`.`stg_categories_northwind`
  OPTIONS()
  as with raw_categories as (
    select *
    from `corded-sunlight-464012-e2`.`dbt_dw_raw`.`categories`
)

/* Ao construir a staging não vamos trazer a coluna picture, pois ela não traz informação relevante */
, stg_categories_northwind as (
    select
        cast(category_id as string) as category_id
        , cast(category_name as string) as category_name
        , cast(description as string) as description
    from raw_categories
)

select *
from stg_categories_northwind;


[0m18:19:34.893210 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m18:19:34.894040 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:19:34.894626 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:19:35.899880 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:4def10a0-0708-4a6f-82e1-1f527191147a&page=queryresults
[0m18:19:35.944150 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:97ed936a-e43c-4b41-83d7-3c358535cdeb&page=queryresults
[0m18:19:35.949190 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:bde26b02-74d0-48d6-90eb-3041fc79163c&page=queryresults
[0m18:19:41.696381 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2b27c916-357e-4fba-beab-33dcf47c847d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7aacb83d93a0>]}
[0m18:19:41.696915 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2b27c916-357e-4fba-beab-33dcf47c847d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7aacc469e780>]}
[0m18:19:41.697573 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2b27c916-357e-4fba-beab-33dcf47c847d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7aacbb546db0>]}
[0m18:19:41.699007 [info ] [Thread-3 (]: 3 of 5 OK created sql view model dbt_dw_staging.stg_suppliers_northwind ........ [[32mCREATE VIEW (0 processed)[0m in 6.89s]
[0m18:19:41.700440 [info ] [Thread-2 (]: 2 of 5 OK created sql view model dbt_dw_staging.stg_products_northwind ......... [[32mCREATE VIEW (0 processed)[0m in 6.89s]
[0m18:19:41.701360 [info ] [Thread-1 (]: 1 of 5 OK created sql view model dbt_dw_staging.stg_categories_northwind ....... [[32mCREATE VIEW (0 processed)[0m in 6.90s]
[0m18:19:41.702319 [debug] [Thread-3 (]: Finished running node model.dbt_exercise.stg_suppliers_northwind
[0m18:19:41.703415 [debug] [Thread-2 (]: Finished running node model.dbt_exercise.stg_products_northwind
[0m18:19:41.704045 [debug] [Thread-1 (]: Finished running node model.dbt_exercise.stg_categories_northwind
[0m18:19:41.707329 [debug] [Thread-4 (]: Began running node model.dbt_exercise.int_products_northwind
[0m18:19:41.708066 [info ] [Thread-4 (]: 4 of 5 START sql view model dbt_dw_intermediate.int_products_northwind ......... [RUN]
[0m18:19:41.708817 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly list_corded-sunlight-464012-e2_dbt_dw_raw, now model.dbt_exercise.int_products_northwind)
[0m18:19:41.709294 [debug] [Thread-4 (]: Began compiling node model.dbt_exercise.int_products_northwind
[0m18:19:41.712951 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_exercise.int_products_northwind"
[0m18:19:41.716880 [debug] [Thread-4 (]: Began executing node model.dbt_exercise.int_products_northwind
[0m18:19:41.721599 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_exercise.int_products_northwind"
[0m18:19:41.723798 [debug] [Thread-4 (]: On model.dbt_exercise.int_products_northwind: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "model.dbt_exercise.int_products_northwind"} */


  create or replace view `corded-sunlight-464012-e2`.`dbt_dw_intermediate`.`int_products_northwind`
  OPTIONS()
  as with stg_products_northwind as (
    select *
    from `corded-sunlight-464012-e2`.`dbt_dw_staging`.`stg_products_northwind`
)

, stg_categories_northwind as (
    select *
    from `corded-sunlight-464012-e2`.`dbt_dw_staging`.`stg_categories_northwind`
)

, stg_suppliers_northwind as (
    select *
    from `corded-sunlight-464012-e2`.`dbt_dw_staging`.`stg_suppliers_northwind`
)

, int_products_northwind as (
    select
        stg_products_northwind.product_id
        , stg_products_northwind.product_name
        , stg_products_northwind.quantity_per_unit
        , stg_categories_northwind.category_name
        , stg_suppliers_northwind.company_name as supplier_name
        , stg_suppliers_northwind.city as supplier_city
        , stg_suppliers_northwind.region as supplier_region
        , stg_suppliers_northwind.country as supplier_country
        , case
            when stg_suppliers_northwind.country in ('USA', 'Canada') then 'North America'
            when stg_suppliers_northwind.country in ('Brazil') then 'South America'
            when stg_suppliers_northwind.country in ('UK', 'Germany', 'Netherlands', 'Spain', 'France', 'Norway', 'Italy', 'Denmark', 'Sweden', 'Finland') then 'Europe'
            when stg_suppliers_northwind.country in ('Singapore', 'Japan') then 'Asia'
            when stg_suppliers_northwind.country in ('Australia') then 'Oceania'
            else 'Other'
          end as supplier_continent
        , case 
            when stg_products_northwind.discontinued = 1 then True
            else False
        end as is_discontinued
    from stg_products_northwind
    left join stg_categories_northwind
        on stg_products_northwind.category_id = stg_categories_northwind.category_id
    left join stg_suppliers_northwind
        on stg_products_northwind.supplier_id = stg_suppliers_northwind.supplier_id
)

select *
from int_products_northwind;


[0m18:19:41.725008 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m18:19:42.837701 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:3c1e5c9a-0001-4de2-ac49-5a9a2966ea21&page=queryresults
[0m18:19:43.368955 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2b27c916-357e-4fba-beab-33dcf47c847d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7aacb81064b0>]}
[0m18:19:43.369777 [info ] [Thread-4 (]: 4 of 5 OK created sql view model dbt_dw_intermediate.int_products_northwind .... [[32mCREATE VIEW (0 processed)[0m in 1.66s]
[0m18:19:43.370623 [debug] [Thread-4 (]: Finished running node model.dbt_exercise.int_products_northwind
[0m18:19:43.372133 [debug] [Thread-2 (]: Began running node model.dbt_exercise.dim_products
[0m18:19:43.372807 [info ] [Thread-2 (]: 5 of 5 START sql table model dbt_dw_marts.dim_products ......................... [RUN]
[0m18:19:43.373451 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_exercise.stg_products_northwind, now model.dbt_exercise.dim_products)
[0m18:19:43.373894 [debug] [Thread-2 (]: Began compiling node model.dbt_exercise.dim_products
[0m18:19:43.389579 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_exercise.dim_products"
[0m18:19:43.391866 [debug] [Thread-2 (]: Began executing node model.dbt_exercise.dim_products
[0m18:19:43.402751 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:19:44.228999 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_exercise.dim_products"
[0m18:19:44.229794 [debug] [Thread-2 (]: On model.dbt_exercise.dim_products: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "model.dbt_exercise.dim_products"} */

  
    

    create or replace table `corded-sunlight-464012-e2`.`dbt_dw_marts`.`dim_products`
      
    
    

    OPTIONS()
    as (
      with int_products_northwind as (
    select *
    from `corded-sunlight-464012-e2`.`dbt_dw_intermediate`.`int_products_northwind`
)

, dim_products as (
    select
        to_hex(md5(cast(coalesce(cast(product_id as string), '_dbt_utils_surrogate_key_null_') as string))) as sk_product
        , product_id
        , product_name
        , quantity_per_unit
        , category_name
        , supplier_name
        , supplier_city
        , supplier_region
        , supplier_country
        , supplier_continent
        , is_discontinued
    from int_products_northwind
)

select *
from dim_products
    );
  
[0m18:19:44.906714 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:89d88417-8378-4fed-932f-a699201eefb5&page=queryresults
[0m18:19:47.323889 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2b27c916-357e-4fba-beab-33dcf47c847d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7aacb819d3d0>]}
[0m18:19:47.324944 [info ] [Thread-2 (]: 5 of 5 OK created sql table model dbt_dw_marts.dim_products .................... [[32mCREATE TABLE (77.0 rows, 6.6 KiB processed)[0m in 3.95s]
[0m18:19:47.325936 [debug] [Thread-2 (]: Finished running node model.dbt_exercise.dim_products
[0m18:19:47.329116 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:19:47.336301 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:19:47.336747 [debug] [MainThread]: Connection 'model.dbt_exercise.int_products_northwind' was properly closed.
[0m18:19:47.337058 [debug] [MainThread]: Connection 'model.dbt_exercise.stg_suppliers_northwind' was properly closed.
[0m18:19:47.337327 [debug] [MainThread]: Connection 'model.dbt_exercise.stg_categories_northwind' was properly closed.
[0m18:19:47.337605 [debug] [MainThread]: Connection 'model.dbt_exercise.dim_products' was properly closed.
[0m18:19:47.338044 [info ] [MainThread]: 
[0m18:19:47.338574 [info ] [MainThread]: Finished running 1 table model, 4 view models in 0 hours 0 minutes and 14.64 seconds (14.64s).
[0m18:19:47.341387 [debug] [MainThread]: Command end result
[0m18:19:47.392433 [debug] [MainThread]: Wrote artifact WritableManifest to /home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/target/manifest.json
[0m18:19:47.403891 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/target/semantic_manifest.json
[0m18:19:47.412062 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/target/run_results.json
[0m18:19:47.412467 [info ] [MainThread]: 
[0m18:19:47.412845 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:19:47.413186 [info ] [MainThread]: 
[0m18:19:47.413588 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=5
[0m18:19:47.414226 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- DuplicateYAMLKeysDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m18:19:47.418899 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 112.16797, "process_in_blocks": "143760", "process_kernel_time": 13.738177, "process_mem_max_rss": "368240", "process_out_blocks": "3640", "process_user_time": 12.207196}
[0m18:19:47.419498 [debug] [MainThread]: Command `dbt run` succeeded at 18:19:47.419404 after 112.17 seconds
[0m18:19:47.419875 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7aacf8fe6c00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7aacf9a40350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7aacf9a40cb0>]}
[0m18:19:47.420423 [debug] [MainThread]: Flushing usage events
[0m18:19:47.827720 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:28:27.634197 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b4123dfbf20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b41244e29c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b4123dfbf50>]}


============================== 18:28:27.651615 | a5fb0a2e-0432-4085-b8ca-de37a3fc2f9e ==============================
[0m18:28:27.651615 [info ] [MainThread]: Running with dbt=1.10.2
[0m18:28:27.652348 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise', 'debug': 'False', 'warn_error': 'None', 'log_path': '/home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt run -s +dim_employees', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:29:13.290128 [warn ] [MainThread]: [[33mWARNING[0m][DuplicateYAMLKeysDeprecation]: Deprecated functionality
Duplicate key 'version' in "<unicode string>", line 4, column 1 in file
`/home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/dbt_project.yml`
[0m18:29:13.290860 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'a5fb0a2e-0432-4085-b8ca-de37a3fc2f9e', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b40e698c230>]}
[0m18:29:13.882984 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a5fb0a2e-0432-4085-b8ca-de37a3fc2f9e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b40e675db80>]}
[0m18:29:13.935532 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a5fb0a2e-0432-4085-b8ca-de37a3fc2f9e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b40e655be00>]}
[0m18:29:13.939095 [info ] [MainThread]: Registered adapter: bigquery=1.9.2
[0m18:29:58.922910 [debug] [MainThread]: checksum: 1adc40777973ef30f45f80b3b6d04d5013c1edd53d96363881b3b199e612468b, vars: {}, profile: , target: , version: 1.10.2
[0m18:30:03.357330 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:30:03.357748 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:30:03.569922 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a5fb0a2e-0432-4085-b8ca-de37a3fc2f9e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b40e64f1f10>]}
[0m18:30:03.668091 [debug] [MainThread]: Wrote artifact WritableManifest to /home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/target/manifest.json
[0m18:30:03.680939 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/target/semantic_manifest.json
[0m18:30:04.041648 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a5fb0a2e-0432-4085-b8ca-de37a3fc2f9e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b40e64943e0>]}
[0m18:30:04.042344 [info ] [MainThread]: Found 14 seeds, 40 data tests, 17 models, 14 sources, 609 macros
[0m18:30:04.042796 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a5fb0a2e-0432-4085-b8ca-de37a3fc2f9e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b40e65baab0>]}
[0m18:30:04.045012 [info ] [MainThread]: 
[0m18:30:04.045551 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m18:30:04.045943 [info ] [MainThread]: 
[0m18:30:04.046538 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m18:30:04.051026 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_corded-sunlight-464012-e2'
[0m18:30:04.052274 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:30:04.053353 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_corded-sunlight-464012-e2'
[0m18:30:04.055032 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_corded-sunlight-464012-e2'
[0m18:30:04.056035 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:30:04.056663 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:30:05.267577 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_corded-sunlight-464012-e2, now list_corded-sunlight-464012-e2_dbt_dw_raw)
[0m18:30:05.269278 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_corded-sunlight-464012-e2, now list_corded-sunlight-464012-e2_dbt_dw_staging)
[0m18:30:05.270405 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:30:05.270920 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_corded-sunlight-464012-e2, now list_corded-sunlight-464012-e2_dbt_dw_intermediate)
[0m18:30:05.272032 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:30:05.272630 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_corded-sunlight-464012-e2_dbt_dw_marts'
[0m18:30:05.273925 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:30:05.274907 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:30:06.138240 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a5fb0a2e-0432-4085-b8ca-de37a3fc2f9e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b40e644f170>]}
[0m18:30:06.138767 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:30:06.151062 [debug] [Thread-1 (]: Began running node model.dbt_exercise.stg_employees_northwind
[0m18:30:06.151931 [debug] [Thread-2 (]: Began running node model.dbt_exercise.stg_orders_northwind
[0m18:30:06.152541 [info ] [Thread-1 (]: 1 of 4 START sql view model dbt_dw_staging.stg_employees_northwind ............. [RUN]
[0m18:30:06.153800 [info ] [Thread-2 (]: 2 of 4 START sql view model dbt_dw_staging.stg_orders_northwind ................ [RUN]
[0m18:30:06.154706 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_corded-sunlight-464012-e2_dbt_dw_staging, now model.dbt_exercise.stg_employees_northwind)
[0m18:30:06.155301 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_corded-sunlight-464012-e2_dbt_dw_marts, now model.dbt_exercise.stg_orders_northwind)
[0m18:30:06.155863 [debug] [Thread-1 (]: Began compiling node model.dbt_exercise.stg_employees_northwind
[0m18:30:06.156349 [debug] [Thread-2 (]: Began compiling node model.dbt_exercise.stg_orders_northwind
[0m18:30:06.166788 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_exercise.stg_employees_northwind"
[0m18:30:06.170628 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_exercise.stg_orders_northwind"
[0m18:30:06.173550 [debug] [Thread-1 (]: Began executing node model.dbt_exercise.stg_employees_northwind
[0m18:30:06.174648 [debug] [Thread-2 (]: Began executing node model.dbt_exercise.stg_orders_northwind
[0m18:30:06.217558 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_exercise.stg_employees_northwind"
[0m18:30:06.219762 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_exercise.stg_orders_northwind"
[0m18:30:06.221009 [debug] [Thread-1 (]: On model.dbt_exercise.stg_employees_northwind: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "model.dbt_exercise.stg_employees_northwind"} */


  create or replace view `corded-sunlight-464012-e2`.`dbt_dw_staging`.`stg_employees_northwind`
  OPTIONS()
  as with raw_employees as (
    select *
    from `corded-sunlight-464012-e2`.`dbt_dw_raw`.`employees`
)

/* Os campos photo, notes e reports_to e photo_path não são carregadas na staging */

, stg_employees_northwind as (
    select
        cast(employee_id as string) as employee_id
        , cast(first_name as string) as first_name
        , cast(last_name as string) as last_name
        , cast(title as string) as title
        , cast(title_of_courtesy as string) as title_of_courtesy
        , cast(birth_date as date) as birth_date
        , cast(hire_date as date) as hire_date
        , cast(address as string) as address
        , cast(city as string) as city
        , cast(region as string) as region
        , cast(postal_code as string) as postal_code
        , cast(country as string) as country
        , cast(home_phone as string) as home_phone
        , cast(extension as string) as extension
    from raw_employees
)

select *
from stg_employees_northwind;


[0m18:30:06.221687 [debug] [Thread-2 (]: On model.dbt_exercise.stg_orders_northwind: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "model.dbt_exercise.stg_orders_northwind"} */


  create or replace view `corded-sunlight-464012-e2`.`dbt_dw_staging`.`stg_orders_northwind`
  OPTIONS()
  as with raw_orders as (
    select *
    from `corded-sunlight-464012-e2`.`dbt_dw_raw`.`orders`
)

, stg_orders_northwind as (
    select
        cast(order_id as string) as order_id
        , cast(customer_id as string) as customer_id
        , cast(employee_id as string) as employee_id
        , cast(order_date as timestamp) as order_date
        , cast(required_date as timestamp) as required_date
        , cast(shipped_date as timestamp) as shipped_date
        , cast(ship_via as string) as ship_via
        , cast(freight as numeric) as freight
        , cast(ship_name as string) as ship_name
        , cast(ship_address as string) as ship_address
        , cast(ship_city as string) as ship_city
        , cast(ship_region as string) as ship_region
        , cast(ship_postal_code as string) as ship_postal_code
        , cast(ship_country as string) as ship_country
    from raw_orders
)

select *
from stg_orders_northwind;


[0m18:30:06.223221 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:30:06.222475 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:30:07.301335 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:45ba1a2b-d31d-44c3-a842-159ee3e6933f&page=queryresults
[0m18:30:07.369254 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:af415b86-44bd-453d-8a27-81409420f008&page=queryresults
[0m18:30:11.708593 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a5fb0a2e-0432-4085-b8ca-de37a3fc2f9e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b40e43afc50>]}
[0m18:30:11.709157 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a5fb0a2e-0432-4085-b8ca-de37a3fc2f9e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b40eafce270>]}
[0m18:30:11.710435 [info ] [Thread-2 (]: 2 of 4 OK created sql view model dbt_dw_staging.stg_orders_northwind ........... [[32mCREATE VIEW (0 processed)[0m in 5.54s]
[0m18:30:11.711400 [info ] [Thread-1 (]: 1 of 4 OK created sql view model dbt_dw_staging.stg_employees_northwind ........ [[32mCREATE VIEW (0 processed)[0m in 5.54s]
[0m18:30:11.712217 [debug] [Thread-2 (]: Finished running node model.dbt_exercise.stg_orders_northwind
[0m18:30:11.713200 [debug] [Thread-1 (]: Finished running node model.dbt_exercise.stg_employees_northwind
[0m18:30:11.715133 [debug] [Thread-4 (]: Began running node model.dbt_exercise.int_employees_northwind
[0m18:30:11.716396 [info ] [Thread-4 (]: 3 of 4 START sql view model dbt_dw_intermediate.int_employees_northwind ........ [RUN]
[0m18:30:11.717010 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly list_corded-sunlight-464012-e2_dbt_dw_intermediate, now model.dbt_exercise.int_employees_northwind)
[0m18:30:11.717407 [debug] [Thread-4 (]: Began compiling node model.dbt_exercise.int_employees_northwind
[0m18:30:11.720491 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_exercise.int_employees_northwind"
[0m18:30:11.724383 [debug] [Thread-4 (]: Began executing node model.dbt_exercise.int_employees_northwind
[0m18:30:11.726944 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_exercise.int_employees_northwind"
[0m18:30:11.727861 [debug] [Thread-4 (]: On model.dbt_exercise.int_employees_northwind: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "model.dbt_exercise.int_employees_northwind"} */


  create or replace view `corded-sunlight-464012-e2`.`dbt_dw_intermediate`.`int_employees_northwind`
  OPTIONS()
  as with raw_employees as (
    select *
    from `corded-sunlight-464012-e2`.`dbt_dw_staging`.`stg_employees_northwind`
)

, max_fact_date as (
    select 
        cast(
            case 
                when max(order_date) >= max(shipped_date) then max(order_date)
                else max(shipped_date)
            end 
        as date) as max_date
    from `corded-sunlight-464012-e2`.`dbt_dw_staging`.`stg_orders_northwind`
)

, int_employees_northwind as (
    select
        employee_id
        , concat(first_name, ' ', last_name) as employee_name
        , title
        , birth_date
        , date_diff((select * from max_fact_date), birth_date, year) as age
        , hire_date
        , date_diff((select * from max_fact_date), hire_date, year) as years_hired
        , address
        , city
        , region
        , country
    from raw_employees
)

select *
from int_employees_northwind;


[0m18:30:11.728446 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m18:30:14.168818 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:090455eb-25c5-4504-9e1b-7c89a0f02d6e&page=queryresults
[0m18:30:14.748076 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a5fb0a2e-0432-4085-b8ca-de37a3fc2f9e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b40e41d1b50>]}
[0m18:30:14.749193 [info ] [Thread-4 (]: 3 of 4 OK created sql view model dbt_dw_intermediate.int_employees_northwind ... [[32mCREATE VIEW (0 processed)[0m in 3.03s]
[0m18:30:14.749947 [debug] [Thread-4 (]: Finished running node model.dbt_exercise.int_employees_northwind
[0m18:30:14.751721 [debug] [Thread-2 (]: Began running node model.dbt_exercise.dim_employees
[0m18:30:14.752455 [info ] [Thread-2 (]: 4 of 4 START sql table model dbt_dw_marts.dim_employees ........................ [RUN]
[0m18:30:14.753058 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_exercise.stg_orders_northwind, now model.dbt_exercise.dim_employees)
[0m18:30:14.753518 [debug] [Thread-2 (]: Began compiling node model.dbt_exercise.dim_employees
[0m18:30:14.771761 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_exercise.dim_employees"
[0m18:30:14.776169 [debug] [Thread-2 (]: Began executing node model.dbt_exercise.dim_employees
[0m18:30:14.805476 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_exercise.dim_employees"
[0m18:30:14.808638 [debug] [Thread-2 (]: On model.dbt_exercise.dim_employees: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "model.dbt_exercise.dim_employees"} */

  
    

    create or replace table `corded-sunlight-464012-e2`.`dbt_dw_marts`.`dim_employees`
      
    
    

    OPTIONS()
    as (
      with int_employees_northwind as (
    select *
    from `corded-sunlight-464012-e2`.`dbt_dw_intermediate`.`int_employees_northwind`
)

, dim_employees as (
    select
        to_hex(md5(cast(coalesce(cast(employee_id as string), '_dbt_utils_surrogate_key_null_') as string))) as sk_employee
        , employee_id
        , employee_name
        , title
        , birth_date
        , age
        , hire_date
        , years_hired
        , address
        , city
        , region
        , country
    from int_employees_northwind
)
select *
from dim_employees
    );
  
[0m18:30:14.809722 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:30:16.015513 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:6b11f58e-8114-4cf7-b6f5-61cac4e53c8e&page=queryresults
[0m18:30:18.453156 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a5fb0a2e-0432-4085-b8ca-de37a3fc2f9e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b40e41cf320>]}
[0m18:30:18.453911 [info ] [Thread-2 (]: 4 of 4 OK created sql table model dbt_dw_marts.dim_employees ................... [[32mCREATE TABLE (9.0 rows, 13.7 KiB processed)[0m in 3.70s]
[0m18:30:18.454599 [debug] [Thread-2 (]: Finished running node model.dbt_exercise.dim_employees
[0m18:30:18.457991 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:30:18.465821 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:30:18.466397 [debug] [MainThread]: Connection 'list_corded-sunlight-464012-e2_dbt_dw_raw' was properly closed.
[0m18:30:18.466856 [debug] [MainThread]: Connection 'model.dbt_exercise.stg_employees_northwind' was properly closed.
[0m18:30:18.467201 [debug] [MainThread]: Connection 'model.dbt_exercise.int_employees_northwind' was properly closed.
[0m18:30:18.467516 [debug] [MainThread]: Connection 'model.dbt_exercise.dim_employees' was properly closed.
[0m18:30:18.467983 [info ] [MainThread]: 
[0m18:30:18.468400 [info ] [MainThread]: Finished running 1 table model, 3 view models in 0 hours 0 minutes and 14.42 seconds (14.42s).
[0m18:30:18.469602 [debug] [MainThread]: Command end result
[0m18:30:18.519151 [debug] [MainThread]: Wrote artifact WritableManifest to /home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/target/manifest.json
[0m18:30:18.530764 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/target/semantic_manifest.json
[0m18:30:18.537910 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/target/run_results.json
[0m18:30:18.538510 [info ] [MainThread]: 
[0m18:30:18.539135 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:30:18.539623 [info ] [MainThread]: 
[0m18:30:18.540154 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=4
[0m18:30:18.540845 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- DuplicateYAMLKeysDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m18:30:18.545302 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 106.42449, "process_in_blocks": "123600", "process_kernel_time": 12.762494, "process_mem_max_rss": "368416", "process_out_blocks": "3688", "process_user_time": 11.04647}
[0m18:30:18.545839 [debug] [MainThread]: Command `dbt run` succeeded at 18:30:18.545742 after 106.43 seconds
[0m18:30:18.546295 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b41277b73e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b40e655a630>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b4124340bf0>]}
[0m18:30:18.547472 [debug] [MainThread]: Flushing usage events
[0m18:30:18.965912 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:41:00.028094 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7df39ab6a7b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7df398fdf0b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7df398aad520>]}


============================== 18:41:00.048706 | 6d95e445-0c85-4646-a351-4314c5e0d854 ==============================
[0m18:41:00.048706 [info ] [MainThread]: Running with dbt=1.10.2
[0m18:41:00.049195 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise', 'log_path': '/home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'invocation_command': 'dbt run -s +dim_customers', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m18:41:51.969500 [warn ] [MainThread]: [[33mWARNING[0m][DuplicateYAMLKeysDeprecation]: Deprecated functionality
Duplicate key 'version' in "<unicode string>", line 4, column 1 in file
`/home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/dbt_project.yml`
[0m18:41:51.970550 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '6d95e445-0c85-4646-a351-4314c5e0d854', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7df35b7b85c0>]}
[0m18:41:52.723304 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6d95e445-0c85-4646-a351-4314c5e0d854', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7df35baac200>]}
[0m18:41:52.923737 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6d95e445-0c85-4646-a351-4314c5e0d854', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7df399585d30>]}
[0m18:41:52.928929 [info ] [MainThread]: Registered adapter: bigquery=1.9.2
[0m18:42:42.594900 [debug] [MainThread]: checksum: 1adc40777973ef30f45f80b3b6d04d5013c1edd53d96363881b3b199e612468b, vars: {}, profile: , target: , version: 1.10.2
[0m18:42:47.313026 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:42:47.313489 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:42:47.602099 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6d95e445-0c85-4646-a351-4314c5e0d854', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7df35b37d760>]}
[0m18:42:47.708411 [debug] [MainThread]: Wrote artifact WritableManifest to /home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/target/manifest.json
[0m18:42:47.720601 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/target/semantic_manifest.json
[0m18:42:48.100918 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6d95e445-0c85-4646-a351-4314c5e0d854', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7df35b6b3d70>]}
[0m18:42:48.101722 [info ] [MainThread]: Found 14 seeds, 40 data tests, 18 models, 14 sources, 609 macros
[0m18:42:48.102244 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6d95e445-0c85-4646-a351-4314c5e0d854', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7df35b526d20>]}
[0m18:42:48.103303 [warn ] [MainThread]: The selection criterion '+dim_customers' does not match any enabled nodes
[0m18:42:48.104804 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m18:42:48.107284 [debug] [MainThread]: Command end result
[0m18:42:48.156021 [debug] [MainThread]: Wrote artifact WritableManifest to /home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/target/manifest.json
[0m18:42:48.169799 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/target/semantic_manifest.json
[0m18:42:48.173690 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/target/run_results.json
[0m18:42:48.174439 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- DuplicateYAMLKeysDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m18:42:48.178490 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 105.52036, "process_in_blocks": "122920", "process_kernel_time": 14.093467, "process_mem_max_rss": "360216", "process_out_blocks": "3608", "process_user_time": 11.429828}
[0m18:42:48.179843 [debug] [MainThread]: Command `dbt run` succeeded at 18:42:48.179625 after 105.52 seconds
[0m18:42:48.180423 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7df3986537d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7df35b524200>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7df35b0cf9e0>]}
[0m18:42:48.180893 [debug] [MainThread]: Flushing usage events
[0m18:42:48.541524 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:51:32.051996 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x729c69556780>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x729c6a3e6d80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x729c68973bc0>]}


============================== 18:51:32.074798 | f10846d5-c3de-4d5e-b569-4c34c503fc8a ==============================
[0m18:51:32.074798 [info ] [MainThread]: Running with dbt=1.10.2
[0m18:51:32.075662 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/logs', 'profiles_dir': '/home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run -s +dim_ship', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m18:52:19.153706 [warn ] [MainThread]: [[33mWARNING[0m][DuplicateYAMLKeysDeprecation]: Deprecated functionality
Duplicate key 'version' in "<unicode string>", line 4, column 1 in file
`/home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/dbt_project.yml`
[0m18:52:19.154470 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'f10846d5-c3de-4d5e-b569-4c34c503fc8a', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x729c2b7c6ab0>]}
[0m18:52:19.806248 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f10846d5-c3de-4d5e-b569-4c34c503fc8a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x729c2e6e1130>]}
[0m18:52:19.862119 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f10846d5-c3de-4d5e-b569-4c34c503fc8a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x729c69410e00>]}
[0m18:52:19.866127 [info ] [MainThread]: Registered adapter: bigquery=1.9.2
[0m18:53:07.488705 [debug] [MainThread]: checksum: 1adc40777973ef30f45f80b3b6d04d5013c1edd53d96363881b3b199e612468b, vars: {}, profile: , target: , version: 1.10.2
[0m18:53:12.166638 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:53:12.167179 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:53:12.400830 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f10846d5-c3de-4d5e-b569-4c34c503fc8a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x729c2b4b15b0>]}
[0m18:53:12.500806 [debug] [MainThread]: Wrote artifact WritableManifest to /home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/target/manifest.json
[0m18:53:12.513177 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/target/semantic_manifest.json
[0m18:53:12.896845 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f10846d5-c3de-4d5e-b569-4c34c503fc8a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x729c2b3410a0>]}
[0m18:53:12.897587 [info ] [MainThread]: Found 14 seeds, 45 data tests, 19 models, 14 sources, 609 macros
[0m18:53:12.898279 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f10846d5-c3de-4d5e-b569-4c34c503fc8a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x729c2af33440>]}
[0m18:53:12.900855 [info ] [MainThread]: 
[0m18:53:12.901685 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m18:53:12.902283 [info ] [MainThread]: 
[0m18:53:12.903117 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m18:53:12.908093 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_corded-sunlight-464012-e2'
[0m18:53:12.909929 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_corded-sunlight-464012-e2'
[0m18:53:12.910731 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:53:12.911801 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_corded-sunlight-464012-e2'
[0m18:53:12.912491 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:53:12.913285 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:53:14.140273 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_corded-sunlight-464012-e2, now list_corded-sunlight-464012-e2_dbt_dw_raw)
[0m18:53:14.141173 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:53:14.142157 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_corded-sunlight-464012-e2, now list_corded-sunlight-464012-e2_dbt_dw_intermediate)
[0m18:53:14.143916 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_corded-sunlight-464012-e2, now list_corded-sunlight-464012-e2_dbt_dw_marts)
[0m18:53:14.145301 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:53:14.146578 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_corded-sunlight-464012-e2_dbt_dw_staging'
[0m18:53:14.147748 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:53:14.148562 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:53:15.002996 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f10846d5-c3de-4d5e-b569-4c34c503fc8a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x729c2c410680>]}
[0m18:53:15.003743 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:53:15.019095 [debug] [Thread-1 (]: Began running node model.dbt_exercise.stg_orders_northwind
[0m18:53:15.019636 [debug] [Thread-2 (]: Began running node model.dbt_exercise.stg_shippers_northwind
[0m18:53:15.020556 [info ] [Thread-1 (]: 1 of 4 START sql view model dbt_dw_staging.stg_orders_northwind ................ [RUN]
[0m18:53:15.021949 [info ] [Thread-2 (]: 2 of 4 START sql view model dbt_dw_staging.stg_shippers_northwind .............. [RUN]
[0m18:53:15.022663 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_corded-sunlight-464012-e2_dbt_dw_staging, now model.dbt_exercise.stg_orders_northwind)
[0m18:53:15.023413 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_corded-sunlight-464012-e2_dbt_dw_marts, now model.dbt_exercise.stg_shippers_northwind)
[0m18:53:15.023894 [debug] [Thread-1 (]: Began compiling node model.dbt_exercise.stg_orders_northwind
[0m18:53:15.024299 [debug] [Thread-2 (]: Began compiling node model.dbt_exercise.stg_shippers_northwind
[0m18:53:15.033211 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_exercise.stg_orders_northwind"
[0m18:53:15.037144 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_exercise.stg_shippers_northwind"
[0m18:53:15.039969 [debug] [Thread-1 (]: Began executing node model.dbt_exercise.stg_orders_northwind
[0m18:53:15.040654 [debug] [Thread-2 (]: Began executing node model.dbt_exercise.stg_shippers_northwind
[0m18:53:15.101598 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_exercise.stg_orders_northwind"
[0m18:53:15.102828 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_exercise.stg_shippers_northwind"
[0m18:53:15.104565 [debug] [Thread-1 (]: On model.dbt_exercise.stg_orders_northwind: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "model.dbt_exercise.stg_orders_northwind"} */


  create or replace view `corded-sunlight-464012-e2`.`dbt_dw_staging`.`stg_orders_northwind`
  OPTIONS()
  as with raw_orders as (
    select *
    from `corded-sunlight-464012-e2`.`dbt_dw_raw`.`orders`
)

, stg_orders_northwind as (
    select
        cast(order_id as string) as order_id
        , cast(customer_id as string) as customer_id
        , cast(employee_id as string) as employee_id
        , cast(order_date as timestamp) as order_date
        , cast(required_date as timestamp) as required_date
        , cast(shipped_date as timestamp) as shipped_date
        , cast(ship_via as string) as ship_via
        , cast(freight as numeric) as freight
        , cast(ship_name as string) as ship_name
        , cast(ship_address as string) as ship_address
        , cast(ship_city as string) as ship_city
        , cast(ship_region as string) as ship_region
        , cast(ship_postal_code as string) as ship_postal_code
        , cast(ship_country as string) as ship_country
    from raw_orders
)

select *
from stg_orders_northwind;


[0m18:53:15.105441 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:53:15.106314 [debug] [Thread-2 (]: On model.dbt_exercise.stg_shippers_northwind: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "model.dbt_exercise.stg_shippers_northwind"} */


  create or replace view `corded-sunlight-464012-e2`.`dbt_dw_staging`.`stg_shippers_northwind`
  OPTIONS()
  as with raw_shippers as (
    select *
    from `corded-sunlight-464012-e2`.`dbt_dw_raw`.`shippers`
)

, stg_shippers_northwind as (
    select
        cast(shipper_id as string) as shipper_id
        , cast(company_name as string) as company_name
        , cast(phone as string) as phone
    from raw_shippers
)

select *
from stg_shippers_northwind;


[0m18:53:15.106974 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:53:16.134022 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:691cc2c9-4ee7-42df-8605-dc6a78addcf9&page=queryresults
[0m18:53:16.157445 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:f5d09a34-7cb6-428c-b1b0-ddc0b0d94f30&page=queryresults
[0m18:53:20.881059 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f10846d5-c3de-4d5e-b569-4c34c503fc8a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x729c69351c40>]}
[0m18:53:20.881706 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f10846d5-c3de-4d5e-b569-4c34c503fc8a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x729c2ad2b800>]}
[0m18:53:20.882954 [info ] [Thread-2 (]: 2 of 4 OK created sql view model dbt_dw_staging.stg_shippers_northwind ......... [[32mCREATE VIEW (0 processed)[0m in 5.84s]
[0m18:53:20.883840 [info ] [Thread-1 (]: 1 of 4 OK created sql view model dbt_dw_staging.stg_orders_northwind ........... [[32mCREATE VIEW (0 processed)[0m in 5.85s]
[0m18:53:20.884621 [debug] [Thread-2 (]: Finished running node model.dbt_exercise.stg_shippers_northwind
[0m18:53:20.885161 [debug] [Thread-1 (]: Finished running node model.dbt_exercise.stg_orders_northwind
[0m18:53:20.886693 [debug] [Thread-4 (]: Began running node model.dbt_exercise.int_shippers_northwind
[0m18:53:20.887261 [info ] [Thread-4 (]: 3 of 4 START sql view model dbt_dw_intermediate.int_shippers_northwind ......... [RUN]
[0m18:53:20.887727 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly list_corded-sunlight-464012-e2_dbt_dw_intermediate, now model.dbt_exercise.int_shippers_northwind)
[0m18:53:20.888062 [debug] [Thread-4 (]: Began compiling node model.dbt_exercise.int_shippers_northwind
[0m18:53:20.891257 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_exercise.int_shippers_northwind"
[0m18:53:20.893589 [debug] [Thread-4 (]: Began executing node model.dbt_exercise.int_shippers_northwind
[0m18:53:20.896473 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_exercise.int_shippers_northwind"
[0m18:53:20.898542 [debug] [Thread-4 (]: On model.dbt_exercise.int_shippers_northwind: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "model.dbt_exercise.int_shippers_northwind"} */


  create or replace view `corded-sunlight-464012-e2`.`dbt_dw_intermediate`.`int_shippers_northwind`
  OPTIONS()
  as with stg_shippers_northwind as (
    select *
    from `corded-sunlight-464012-e2`.`dbt_dw_staging`.`stg_shippers_northwind`
)

, stg_orders_northwind as (
    select *
    from `corded-sunlight-464012-e2`.`dbt_dw_staging`.`stg_orders_northwind`
)

, transformed_table as (
    select
        concat(
            coalesce(stg_shippers_northwind.shipper_id, '')
            , '-'
            , coalesce(stg_shippers_northwind.company_name, '')
            , '-'
            , coalesce(stg_orders_northwind.ship_address, '')
        ) as ship_id
        , stg_shippers_northwind.shipper_id
        , stg_shippers_northwind.company_name
        , stg_orders_northwind.ship_address
        , stg_orders_northwind.ship_city
        , stg_orders_northwind.ship_region
        , stg_orders_northwind.ship_country
    from stg_shippers_northwind
    left join stg_orders_northwind
        on stg_shippers_northwind.shipper_id = stg_orders_northwind.ship_via
)

/* Aqui é feita a deduplicação da transformed_table */
, dedup_table as (
    select distinct *
    from transformed_table
)

, int_shippers_northwind as (
    select 
        *
        , case
            when dedup_table.ship_country in ('USA', 'Canada', 'Mexico') then 'North America'
            when dedup_table.ship_country in ('UK', 'France', 'Germany', 'Austria', 'Belgium', 
            'Denmark', 'Ireland', 'Finland', 'Italy', 'Norway', 'Poland', 'Portugal', 'Spain', 'Sweden', 'Switzerland') then 'Europe'
            when dedup_table.ship_country in ('Brazil', 'Argentina', 'Venezuela') then 'South America'
            else 'Other'
        end as ship_continent
    from dedup_table
)

select *
from int_shippers_northwind;


[0m18:53:20.899179 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m18:53:22.003422 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:282dbba6-62a6-4d57-9f2a-ed166ff1826b&page=queryresults
[0m18:53:22.569707 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f10846d5-c3de-4d5e-b569-4c34c503fc8a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x729c283aad20>]}
[0m18:53:22.570554 [info ] [Thread-4 (]: 3 of 4 OK created sql view model dbt_dw_intermediate.int_shippers_northwind .... [[32mCREATE VIEW (0 processed)[0m in 1.68s]
[0m18:53:22.571316 [debug] [Thread-4 (]: Finished running node model.dbt_exercise.int_shippers_northwind
[0m18:53:22.572849 [debug] [Thread-2 (]: Began running node model.dbt_exercise.dim_ship
[0m18:53:22.573434 [info ] [Thread-2 (]: 4 of 4 START sql table model dbt_dw_marts.dim_ship ............................. [RUN]
[0m18:53:22.574066 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_exercise.stg_shippers_northwind, now model.dbt_exercise.dim_ship)
[0m18:53:22.574572 [debug] [Thread-2 (]: Began compiling node model.dbt_exercise.dim_ship
[0m18:53:22.591553 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_exercise.dim_ship"
[0m18:53:22.593154 [debug] [Thread-2 (]: Began executing node model.dbt_exercise.dim_ship
[0m18:53:22.622469 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_exercise.dim_ship"
[0m18:53:22.624302 [debug] [Thread-2 (]: On model.dbt_exercise.dim_ship: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "model.dbt_exercise.dim_ship"} */

  
    

    create or replace table `corded-sunlight-464012-e2`.`dbt_dw_marts`.`dim_ship`
      
    
    

    OPTIONS()
    as (
      with int_shippers_northwind as (
    select *
    from `corded-sunlight-464012-e2`.`dbt_dw_intermediate`.`int_shippers_northwind`
)

, dim_ship as (
    select
        to_hex(md5(cast(coalesce(cast(shipper_id as string), '_dbt_utils_surrogate_key_null_') as string))) as sk_ship
        , ship_id
        , shipper_id
        , company_name
        , ship_address
        , ship_city
        , ship_region
        , ship_country
        , ship_continent
    from int_shippers_northwind
)

select *
from dim_ship
    );
  
[0m18:53:22.624894 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:53:23.859175 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:ff6f5345-afef-4a16-a42c-119ac8a1ad88&page=queryresults
[0m18:53:26.822504 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f10846d5-c3de-4d5e-b569-4c34c503fc8a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x729c2810e360>]}
[0m18:53:26.823407 [info ] [Thread-2 (]: 4 of 4 OK created sql table model dbt_dw_marts.dim_ship ........................ [[32mCREATE TABLE (242.0 rows, 39.9 KiB processed)[0m in 4.25s]
[0m18:53:26.824125 [debug] [Thread-2 (]: Finished running node model.dbt_exercise.dim_ship
[0m18:53:26.827298 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:53:26.834392 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:53:26.834897 [debug] [MainThread]: Connection 'model.dbt_exercise.int_shippers_northwind' was properly closed.
[0m18:53:26.835311 [debug] [MainThread]: Connection 'model.dbt_exercise.dim_ship' was properly closed.
[0m18:53:26.835838 [debug] [MainThread]: Connection 'list_corded-sunlight-464012-e2_dbt_dw_raw' was properly closed.
[0m18:53:26.836276 [debug] [MainThread]: Connection 'model.dbt_exercise.stg_orders_northwind' was properly closed.
[0m18:53:26.836791 [info ] [MainThread]: 
[0m18:53:26.837301 [info ] [MainThread]: Finished running 1 table model, 3 view models in 0 hours 0 minutes and 13.93 seconds (13.93s).
[0m18:53:26.838525 [debug] [MainThread]: Command end result
[0m18:53:26.883929 [debug] [MainThread]: Wrote artifact WritableManifest to /home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/target/manifest.json
[0m18:53:26.895535 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/target/semantic_manifest.json
[0m18:53:26.903725 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/target/run_results.json
[0m18:53:26.904241 [info ] [MainThread]: 
[0m18:53:26.904643 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:53:26.904975 [info ] [MainThread]: 
[0m18:53:26.905336 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=4
[0m18:53:26.905854 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- DuplicateYAMLKeysDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m18:53:26.910606 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 111.817894, "process_in_blocks": "124072", "process_kernel_time": 13.16396, "process_mem_max_rss": "368360", "process_out_blocks": "3808", "process_user_time": 11.373881}
[0m18:53:26.911199 [debug] [MainThread]: Command `dbt run` succeeded at 18:53:26.911091 after 111.82 seconds
[0m18:53:26.911626 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x729c68ed1d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x729c2af33800>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x729c69353e90>]}
[0m18:53:26.912199 [debug] [MainThread]: Flushing usage events
[0m18:53:27.320737 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:56:38.820679 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73c0985a9280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73c0986adb80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73c09807b4a0>]}


============================== 18:56:38.835378 | df489ce1-e84b-4190-a71b-de6e4e1e3931 ==============================
[0m18:56:38.835378 [info ] [MainThread]: Running with dbt=1.10.2
[0m18:56:38.836024 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/logs', 'profiles_dir': '/home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt run -s +dim_customers', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m18:57:26.932440 [warn ] [MainThread]: [[33mWARNING[0m][DuplicateYAMLKeysDeprecation]: Deprecated functionality
Duplicate key 'version' in "<unicode string>", line 4, column 1 in file
`/home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/dbt_project.yml`
[0m18:57:26.933178 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'df489ce1-e84b-4190-a71b-de6e4e1e3931', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73c058cfc470>]}
[0m18:57:27.580793 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'df489ce1-e84b-4190-a71b-de6e4e1e3931', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73c058ed3e30>]}
[0m18:57:27.643378 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'df489ce1-e84b-4190-a71b-de6e4e1e3931', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73c096b89640>]}
[0m18:57:27.648022 [info ] [MainThread]: Registered adapter: bigquery=1.9.2
[0m18:58:15.176404 [debug] [MainThread]: checksum: 1adc40777973ef30f45f80b3b6d04d5013c1edd53d96363881b3b199e612468b, vars: {}, profile: , target: , version: 1.10.2
[0m18:58:20.272408 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 1 files added, 1 files changed.
[0m18:58:20.273372 [debug] [MainThread]: Partial parsing: added file: dbt_exercise://models/marts/dim_customers.sql
[0m18:58:20.273759 [debug] [MainThread]: Partial parsing: deleted file: dbt_exercise://models/marts/dim_customer.sql
[0m18:58:20.274178 [debug] [MainThread]: Partial parsing: updated file: dbt_exercise://models/marts/fact_orders.sql
[0m18:58:20.766694 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'df489ce1-e84b-4190-a71b-de6e4e1e3931', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73c0584c0110>]}
[0m18:58:20.872418 [debug] [MainThread]: Wrote artifact WritableManifest to /home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/target/manifest.json
[0m18:58:20.886187 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/target/semantic_manifest.json
[0m18:58:21.299467 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'df489ce1-e84b-4190-a71b-de6e4e1e3931', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73c05850ea20>]}
[0m18:58:21.300104 [info ] [MainThread]: Found 14 seeds, 45 data tests, 19 models, 14 sources, 609 macros
[0m18:58:21.300624 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'df489ce1-e84b-4190-a71b-de6e4e1e3931', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73c058b42e40>]}
[0m18:58:21.302952 [info ] [MainThread]: 
[0m18:58:21.303535 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m18:58:21.303946 [info ] [MainThread]: 
[0m18:58:21.304549 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m18:58:21.308884 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_corded-sunlight-464012-e2'
[0m18:58:21.310282 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:58:21.311300 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_corded-sunlight-464012-e2'
[0m18:58:21.313372 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_corded-sunlight-464012-e2'
[0m18:58:21.314465 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:58:21.315408 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:58:22.505966 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_corded-sunlight-464012-e2, now list_corded-sunlight-464012-e2_dbt_dw_intermediate)
[0m18:58:22.507229 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_corded-sunlight-464012-e2, now list_corded-sunlight-464012-e2_dbt_dw_raw)
[0m18:58:22.508063 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:58:22.509210 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_corded-sunlight-464012-e2, now list_corded-sunlight-464012-e2_dbt_dw_marts)
[0m18:58:22.510576 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:58:22.511184 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_corded-sunlight-464012-e2_dbt_dw_staging'
[0m18:58:22.512440 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:58:22.513370 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:58:23.383492 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'df489ce1-e84b-4190-a71b-de6e4e1e3931', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73c058e92b10>]}
[0m18:58:23.384514 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:58:23.396263 [debug] [Thread-1 (]: Began running node model.dbt_exercise.stg_customers_northwind
[0m18:58:23.397403 [info ] [Thread-1 (]: 1 of 3 START sql view model dbt_dw_staging.stg_customers_northwind ............. [RUN]
[0m18:58:23.398271 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_corded-sunlight-464012-e2_dbt_dw_staging, now model.dbt_exercise.stg_customers_northwind)
[0m18:58:23.398826 [debug] [Thread-1 (]: Began compiling node model.dbt_exercise.stg_customers_northwind
[0m18:58:23.410434 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_exercise.stg_customers_northwind"
[0m18:58:23.413747 [debug] [Thread-1 (]: Began executing node model.dbt_exercise.stg_customers_northwind
[0m18:58:23.482814 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_exercise.stg_customers_northwind"
[0m18:58:23.484484 [debug] [Thread-1 (]: On model.dbt_exercise.stg_customers_northwind: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "model.dbt_exercise.stg_customers_northwind"} */


  create or replace view `corded-sunlight-464012-e2`.`dbt_dw_staging`.`stg_customers_northwind`
  OPTIONS()
  as with raw_customers as (
    select *
    from `corded-sunlight-464012-e2`.`dbt_dw_raw`.`customers`
)

, stg_customers_northwind as (
    select
        cast(customer_id as string) as customer_id
        , cast(company_name as string) as company_name
        , cast(contact_name as string) as contact_name
        , cast(contact_title as string) as contact_title
        , cast(address as string) as address
        , cast(city as string) as city
        , cast(region as string) as region
        , cast(postal_code as string) as postal_code
        , cast(country as string) as country
        , cast(phone as string) as phone
        , cast(fax as string) as fax
    from raw_customers
)

select *
from stg_customers_northwind;


[0m18:58:23.485624 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:58:24.428671 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:51e4ec0c-2c01-4e4b-afc2-f642e3e41d27&page=queryresults
[0m18:58:29.650039 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'df489ce1-e84b-4190-a71b-de6e4e1e3931', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73c05d981e20>]}
[0m18:58:29.651537 [info ] [Thread-1 (]: 1 of 3 OK created sql view model dbt_dw_staging.stg_customers_northwind ........ [[32mCREATE VIEW (0 processed)[0m in 6.24s]
[0m18:58:29.652936 [debug] [Thread-1 (]: Finished running node model.dbt_exercise.stg_customers_northwind
[0m18:58:29.654708 [debug] [Thread-3 (]: Began running node model.dbt_exercise.int_customers_northwind
[0m18:58:29.656630 [info ] [Thread-3 (]: 2 of 3 START sql view model dbt_dw_intermediate.int_customers_northwind ........ [RUN]
[0m18:58:29.657406 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_corded-sunlight-464012-e2_dbt_dw_raw, now model.dbt_exercise.int_customers_northwind)
[0m18:58:29.658054 [debug] [Thread-3 (]: Began compiling node model.dbt_exercise.int_customers_northwind
[0m18:58:29.663225 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_exercise.int_customers_northwind"
[0m18:58:29.667382 [debug] [Thread-3 (]: Began executing node model.dbt_exercise.int_customers_northwind
[0m18:58:29.671330 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_exercise.int_customers_northwind"
[0m18:58:29.672928 [debug] [Thread-3 (]: On model.dbt_exercise.int_customers_northwind: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "model.dbt_exercise.int_customers_northwind"} */


  create or replace view `corded-sunlight-464012-e2`.`dbt_dw_intermediate`.`int_customers_northwind`
  OPTIONS()
  as with stg_customers_northwind as (
    select *
    from `corded-sunlight-464012-e2`.`dbt_dw_staging`.`stg_customers_northwind`
)

, int_customers_northwind as (
    select 
        customer_id
        , company_name
        , contact_name
        , contact_title
        , address
        , city
        , region
        , country
        , case 
            when country in ('USA', 'Canada', 'Mexico') then 'North America'
            when country in ('UK', 'France', 'Germany', 'Austria', 'Belgium', 'Denmark', 'Ireland'
            , 'Finland', 'Italy', 'Norway', 'Poland', 'Portugal', 'Spain', 'Sweden', 'Switzerland') then 'Europe'
            when country in ('Brazil', 'Argentina', 'Venezuela') then 'South America'
            else 'Other'
        end as continent
    from stg_customers_northwind
)

select *
from int_customers_northwind;


[0m18:58:29.673832 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m18:58:31.987158 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:d10b745e-586e-41b0-aa06-f16cc79208d0&page=queryresults
[0m18:58:32.558156 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'df489ce1-e84b-4190-a71b-de6e4e1e3931', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73c032796cc0>]}
[0m18:58:32.558858 [info ] [Thread-3 (]: 2 of 3 OK created sql view model dbt_dw_intermediate.int_customers_northwind ... [[32mCREATE VIEW (0 processed)[0m in 2.90s]
[0m18:58:32.559495 [debug] [Thread-3 (]: Finished running node model.dbt_exercise.int_customers_northwind
[0m18:58:32.560930 [debug] [Thread-2 (]: Began running node model.dbt_exercise.dim_customers
[0m18:58:32.561920 [info ] [Thread-2 (]: 3 of 3 START sql table model dbt_dw_marts.dim_customers ........................ [RUN]
[0m18:58:32.562540 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_corded-sunlight-464012-e2_dbt_dw_marts, now model.dbt_exercise.dim_customers)
[0m18:58:32.563013 [debug] [Thread-2 (]: Began compiling node model.dbt_exercise.dim_customers
[0m18:58:32.566724 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_exercise.dim_customers"
[0m18:58:32.567505 [debug] [Thread-2 (]: Began executing node model.dbt_exercise.dim_customers
[0m18:58:32.597076 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_exercise.dim_customers"
[0m18:58:32.598132 [debug] [Thread-2 (]: On model.dbt_exercise.dim_customers: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "model.dbt_exercise.dim_customers"} */

  
    

    create or replace table `corded-sunlight-464012-e2`.`dbt_dw_marts`.`dim_customers`
      
    
    

    OPTIONS()
    as (
      with int_customers_northwind as (
    select *
    from `corded-sunlight-464012-e2`.`dbt_dw_intermediate`.`int_customers_northwind`
)

, dim_customers as (
    select
        to_hex(md5(cast(coalesce(cast(customer_id as string), '_dbt_utils_surrogate_key_null_') as string))) as sk_customer
        , customer_id
        , company_name
        , contact_name
        , contact_title
        , address
        , city
        , region
        , country
        , continent
    from int_customers_northwind
)

select *
from dim_customers
    );
  
[0m18:58:32.598615 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m18:58:33.810150 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:2dbb29fe-ec39-4024-94f7-4da0a10bdd05&page=queryresults
[0m18:58:36.013418 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'df489ce1-e84b-4190-a71b-de6e4e1e3931', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73c032638ad0>]}
[0m18:58:36.014449 [info ] [Thread-2 (]: 3 of 3 OK created sql table model dbt_dw_marts.dim_customers ................... [[32mCREATE TABLE (91.0 rows, 9.1 KiB processed)[0m in 3.45s]
[0m18:58:36.015296 [debug] [Thread-2 (]: Finished running node model.dbt_exercise.dim_customers
[0m18:58:36.018901 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:58:36.026801 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:58:36.027394 [debug] [MainThread]: Connection 'model.dbt_exercise.int_customers_northwind' was properly closed.
[0m18:58:36.027878 [debug] [MainThread]: Connection 'list_corded-sunlight-464012-e2_dbt_dw_intermediate' was properly closed.
[0m18:58:36.028297 [debug] [MainThread]: Connection 'model.dbt_exercise.dim_customers' was properly closed.
[0m18:58:36.028673 [debug] [MainThread]: Connection 'model.dbt_exercise.stg_customers_northwind' was properly closed.
[0m18:58:36.029180 [info ] [MainThread]: 
[0m18:58:36.029834 [info ] [MainThread]: Finished running 1 table model, 2 view models in 0 hours 0 minutes and 14.72 seconds (14.72s).
[0m18:58:36.031119 [debug] [MainThread]: Command end result
[0m18:58:36.080457 [debug] [MainThread]: Wrote artifact WritableManifest to /home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/target/manifest.json
[0m18:58:36.092585 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/target/semantic_manifest.json
[0m18:58:36.098457 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/target/run_results.json
[0m18:58:36.099071 [info ] [MainThread]: 
[0m18:58:36.099600 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:58:36.100054 [info ] [MainThread]: 
[0m18:58:36.100460 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=3
[0m18:58:36.101107 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- DuplicateYAMLKeysDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m18:58:36.106005 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 113.15523, "process_in_blocks": "123552", "process_kernel_time": 13.358656, "process_mem_max_rss": "371688", "process_out_blocks": "5424", "process_user_time": 12.328286}
[0m18:58:36.107308 [debug] [MainThread]: Command `dbt run` succeeded at 18:58:36.106801 after 113.16 seconds
[0m18:58:36.108063 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73c0986adb80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73c058577650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73c032667fb0>]}
[0m18:58:36.108620 [debug] [MainThread]: Flushing usage events
[0m18:58:36.442980 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m13:51:57.994758 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eb1cba96480>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eb1cd8e1430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eb1cbf32c00>]}


============================== 13:51:58.000478 | c1976a10-fb65-4622-a3db-65b7e7caf01e ==============================
[0m13:51:58.000478 [info ] [MainThread]: Running with dbt=1.10.2
[0m13:51:58.002330 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt ', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m13:51:58.004409 [warn ] [MainThread]: [[33mWARNING[0m][DuplicateYAMLKeysDeprecation]: Deprecated functionality
Duplicate key 'version' in "<unicode string>", line 4, column 1 in file
`/home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/dbt_project.yml`
[0m13:51:58.005306 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'c1976a10-fb65-4622-a3db-65b7e7caf01e', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eb1caf41eb0>]}
[0m13:51:58.153533 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c1976a10-fb65-4622-a3db-65b7e7caf01e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eb1cd7ae600>]}
[0m13:51:58.199514 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-ifkf98j1'
[0m13:51:58.200573 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m13:51:58.444246 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m13:51:58.445100 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m13:51:58.471625 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m13:51:58.476012 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m13:51:58.944612 [info ] [MainThread]: Installed from version 1.3.0
[0m13:51:58.945362 [info ] [MainThread]: Up to date!
[0m13:51:58.945924 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'c1976a10-fb65-4622-a3db-65b7e7caf01e', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eb1cb632300>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eb1cb0174a0>]}
[0m13:51:58.947255 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- DuplicateYAMLKeysDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m13:51:58.949426 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 1.0221972, "process_in_blocks": "368", "process_kernel_time": 0.423686, "process_mem_max_rss": "102652", "process_out_blocks": "2304", "process_user_time": 2.070467}
[0m13:51:58.950588 [debug] [MainThread]: Command `cli deps` succeeded at 13:51:58.950269 after 1.02 seconds
[0m13:51:58.951665 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eb1cbe0e8a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eb1cb118380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eb1cb592000>]}
[0m13:51:58.952689 [debug] [MainThread]: Flushing usage events
[0m13:51:59.298385 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:20:14.580966 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dd62e38f740>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dd62d6b7b30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dd62e025d30>]}


============================== 15:20:14.602367 | 802572c8-4df5-4463-80a3-facd58308f3b ==============================
[0m15:20:14.602367 [info ] [MainThread]: Running with dbt=1.10.2
[0m15:20:14.604116 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/logs', 'debug': 'False', 'profiles_dir': '/home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'invocation_command': 'dbt run -s +int_orders_northwind', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:21:44.743418 [warn ] [MainThread]: [[33mWARNING[0m][DuplicateYAMLKeysDeprecation]: Deprecated functionality
Duplicate key 'version' in "<unicode string>", line 4, column 1 in file
`/home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/dbt_project.yml`
[0m15:21:44.744843 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '802572c8-4df5-4463-80a3-facd58308f3b', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dd62d487710>]}
[0m15:21:45.853014 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '802572c8-4df5-4463-80a3-facd58308f3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dd5f24abef0>]}
[0m15:21:45.971455 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '802572c8-4df5-4463-80a3-facd58308f3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dd62e222ff0>]}
[0m15:21:45.975895 [info ] [MainThread]: Registered adapter: bigquery=1.9.2
[0m15:22:46.964172 [debug] [MainThread]: checksum: 1adc40777973ef30f45f80b3b6d04d5013c1edd53d96363881b3b199e612468b, vars: {}, profile: , target: , version: 1.10.2
[0m15:22:54.893034 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:22:54.893676 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:22:55.163628 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '802572c8-4df5-4463-80a3-facd58308f3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dd5f036f470>]}
[0m15:22:55.363264 [debug] [MainThread]: Wrote artifact WritableManifest to /home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/target/manifest.json
[0m15:22:55.407259 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/target/semantic_manifest.json
[0m15:22:56.297595 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '802572c8-4df5-4463-80a3-facd58308f3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dd5f03fa2a0>]}
[0m15:22:56.298381 [info ] [MainThread]: Found 14 seeds, 45 data tests, 19 models, 14 sources, 609 macros
[0m15:22:56.299201 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '802572c8-4df5-4463-80a3-facd58308f3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dd5efd0c860>]}
[0m15:22:56.303166 [info ] [MainThread]: 
[0m15:22:56.304271 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:22:56.305272 [info ] [MainThread]: 
[0m15:22:56.306865 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m15:22:56.323096 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_corded-sunlight-464012-e2'
[0m15:22:56.324342 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:22:56.332155 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_corded-sunlight-464012-e2'
[0m15:22:56.333560 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:22:57.578533 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_corded-sunlight-464012-e2, now list_corded-sunlight-464012-e2_dbt_dw_marts)
[0m15:22:57.580518 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:22:57.583849 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_corded-sunlight-464012-e2, now list_corded-sunlight-464012-e2_dbt_dw_raw)
[0m15:22:57.587291 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:22:57.589356 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_corded-sunlight-464012-e2_dbt_dw_intermediate'
[0m15:22:57.592422 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_corded-sunlight-464012-e2_dbt_dw_staging'
[0m15:22:57.594725 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:22:57.596554 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:22:58.602760 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '802572c8-4df5-4463-80a3-facd58308f3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dd62d36d0d0>]}
[0m15:22:58.603835 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:22:58.639016 [debug] [Thread-1 (]: Began running node model.dbt_exercise.stg_order_details_northwind
[0m15:22:58.640454 [debug] [Thread-2 (]: Began running node model.dbt_exercise.stg_orders_northwind
[0m15:22:58.642708 [debug] [Thread-3 (]: Began running node model.dbt_exercise.stg_shippers_northwind
[0m15:22:58.641944 [info ] [Thread-1 (]: 1 of 4 START sql view model dbt_dw_staging.stg_order_details_northwind ......... [RUN]
[0m15:22:58.644202 [info ] [Thread-2 (]: 2 of 4 START sql view model dbt_dw_staging.stg_orders_northwind ................ [RUN]
[0m15:22:58.645762 [info ] [Thread-3 (]: 3 of 4 START sql view model dbt_dw_staging.stg_shippers_northwind .............. [RUN]
[0m15:22:58.647025 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_corded-sunlight-464012-e2_dbt_dw_intermediate, now model.dbt_exercise.stg_order_details_northwind)
[0m15:22:58.647993 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_corded-sunlight-464012-e2_dbt_dw_staging, now model.dbt_exercise.stg_orders_northwind)
[0m15:22:58.649071 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_corded-sunlight-464012-e2_dbt_dw_raw, now model.dbt_exercise.stg_shippers_northwind)
[0m15:22:58.650466 [debug] [Thread-1 (]: Began compiling node model.dbt_exercise.stg_order_details_northwind
[0m15:22:58.652231 [debug] [Thread-2 (]: Began compiling node model.dbt_exercise.stg_orders_northwind
[0m15:22:58.654045 [debug] [Thread-3 (]: Began compiling node model.dbt_exercise.stg_shippers_northwind
[0m15:22:58.683707 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_exercise.stg_order_details_northwind"
[0m15:22:58.688093 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_exercise.stg_orders_northwind"
[0m15:22:58.693393 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_exercise.stg_shippers_northwind"
[0m15:22:58.697680 [debug] [Thread-2 (]: Began executing node model.dbt_exercise.stg_orders_northwind
[0m15:22:58.710413 [debug] [Thread-1 (]: Began executing node model.dbt_exercise.stg_order_details_northwind
[0m15:22:58.733876 [debug] [Thread-3 (]: Began executing node model.dbt_exercise.stg_shippers_northwind
[0m15:22:58.814650 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_exercise.stg_orders_northwind"
[0m15:22:58.821630 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_exercise.stg_order_details_northwind"
[0m15:22:58.826119 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_exercise.stg_shippers_northwind"
[0m15:22:58.828081 [debug] [Thread-1 (]: On model.dbt_exercise.stg_order_details_northwind: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "model.dbt_exercise.stg_order_details_northwind"} */


  create or replace view `corded-sunlight-464012-e2`.`dbt_dw_staging`.`stg_order_details_northwind`
  OPTIONS()
  as with raw_order_details as (
    select *
    from `corded-sunlight-464012-e2`.`dbt_dw_raw`.`order_details`
)

, stg_order_details_northwind as (
    select
        cast(order_id as string) as order_id
        , cast(product_id as string) as product_id
        , cast(unit_price as numeric) as unit_price
        , cast(quantity as integer) as quantity
        , cast(discount as numeric) as discount
    from raw_order_details
)

select *
from stg_order_details_northwind;


[0m15:22:58.829122 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:22:58.838680 [debug] [Thread-2 (]: On model.dbt_exercise.stg_orders_northwind: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "model.dbt_exercise.stg_orders_northwind"} */


  create or replace view `corded-sunlight-464012-e2`.`dbt_dw_staging`.`stg_orders_northwind`
  OPTIONS()
  as with raw_orders as (
    select *
    from `corded-sunlight-464012-e2`.`dbt_dw_raw`.`orders`
)

, stg_orders_northwind as (
    select
        cast(order_id as string) as order_id
        , cast(customer_id as string) as customer_id
        , cast(employee_id as string) as employee_id
        , cast(order_date as timestamp) as order_date
        , cast(required_date as timestamp) as required_date
        , cast(shipped_date as timestamp) as shipped_date
        , cast(ship_via as string) as ship_via
        , cast(freight as numeric) as freight
        , cast(ship_name as string) as ship_name
        , cast(ship_address as string) as ship_address
        , cast(ship_city as string) as ship_city
        , cast(ship_region as string) as ship_region
        , cast(ship_postal_code as string) as ship_postal_code
        , cast(ship_country as string) as ship_country
    from raw_orders
)

select *
from stg_orders_northwind;


[0m15:22:58.842663 [debug] [Thread-3 (]: On model.dbt_exercise.stg_shippers_northwind: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "model.dbt_exercise.stg_shippers_northwind"} */


  create or replace view `corded-sunlight-464012-e2`.`dbt_dw_staging`.`stg_shippers_northwind`
  OPTIONS()
  as with raw_shippers as (
    select *
    from `corded-sunlight-464012-e2`.`dbt_dw_raw`.`shippers`
)

, stg_shippers_northwind as (
    select
        cast(shipper_id as string) as shipper_id
        , cast(company_name as string) as company_name
        , cast(phone as string) as phone
    from raw_shippers
)

select *
from stg_shippers_northwind;


[0m15:22:58.844162 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:22:58.887966 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m15:22:59.901210 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:f8b456e6-33f1-4c76-9ca4-2ecc8234f947&page=queryresults
[0m15:22:59.977771 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:e09cfef0-8830-4cfd-940b-eb664eb3e032&page=queryresults
[0m15:22:59.986043 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:4f8f7534-a54e-4682-9422-666751addcbe&page=queryresults
[0m15:23:11.144904 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '802572c8-4df5-4463-80a3-facd58308f3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dd62e361e20>]}
[0m15:23:11.145959 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '802572c8-4df5-4463-80a3-facd58308f3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dd5f0228b00>]}
[0m15:23:11.147123 [info ] [Thread-2 (]: 2 of 4 OK created sql view model dbt_dw_staging.stg_orders_northwind ........... [[32mCREATE VIEW (0 processed)[0m in 12.47s]
[0m15:23:11.148399 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '802572c8-4df5-4463-80a3-facd58308f3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dd5f03c1f40>]}
[0m15:23:11.150068 [info ] [Thread-1 (]: 1 of 4 OK created sql view model dbt_dw_staging.stg_order_details_northwind .... [[32mCREATE VIEW (0 processed)[0m in 12.48s]
[0m15:23:11.151918 [debug] [Thread-2 (]: Finished running node model.dbt_exercise.stg_orders_northwind
[0m15:23:11.153660 [info ] [Thread-3 (]: 3 of 4 OK created sql view model dbt_dw_staging.stg_shippers_northwind ......... [[32mCREATE VIEW (0 processed)[0m in 12.48s]
[0m15:23:11.155607 [debug] [Thread-1 (]: Finished running node model.dbt_exercise.stg_order_details_northwind
[0m15:23:11.157923 [debug] [Thread-3 (]: Finished running node model.dbt_exercise.stg_shippers_northwind
[0m15:23:11.161919 [debug] [Thread-4 (]: Began running node model.dbt_exercise.int_orders_northwind
[0m15:23:11.163632 [info ] [Thread-4 (]: 4 of 4 START sql view model dbt_dw_intermediate.int_orders_northwind ........... [RUN]
[0m15:23:11.165837 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly list_corded-sunlight-464012-e2_dbt_dw_marts, now model.dbt_exercise.int_orders_northwind)
[0m15:23:11.166881 [debug] [Thread-4 (]: Began compiling node model.dbt_exercise.int_orders_northwind
[0m15:23:11.176283 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_exercise.int_orders_northwind"
[0m15:23:11.197662 [debug] [Thread-4 (]: Began executing node model.dbt_exercise.int_orders_northwind
[0m15:23:11.208916 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_exercise.int_orders_northwind"
[0m15:23:11.214287 [debug] [Thread-4 (]: On model.dbt_exercise.int_orders_northwind: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "model.dbt_exercise.int_orders_northwind"} */


  create or replace view `corded-sunlight-464012-e2`.`dbt_dw_intermediate`.`int_orders_northwind`
  OPTIONS()
  as with stg_orders_northwind as (
    select *
    from `corded-sunlight-464012-e2`.`dbt_dw_staging`.`stg_orders_northwind`
)

, stg_order_details_northwind as (
    select *
    from `corded-sunlight-464012-e2`.`dbt_dw_staging`.`stg_order_details_northwind`
)

, stg_shippers_northwind as (
    select *
    from `corded-sunlight-464012-e2`.`dbt_dw_staging`.`stg_shippers_northwind`
)

, transformed_table as (    
    select
        stg_orders_northwind.order_id 
        , stg_orders_northwind.customer_id
        , stg_orders_northwind.employee_id
        , stg_orders_northwind.order_date
        , stg_orders_northwind.required_date
        , stg_orders_northwind.shipped_date
        , date_diff(stg_orders_northwind.shipped_date, stg_orders_northwind.order_date, day) as days_to_ship
        , concat(
            coalesce(stg_orders_northwind.ship_via, '')
            , '-'
            , coalesce(stg_shippers_northwind.company_name, '')
            , '-'
            , coalesce(stg_orders_northwind.ship_address, '')
        ) as ship_id
        , stg_orders_northwind.ship_via      
        , stg_shippers_northwind.company_name as shipper_name
        , stg_order_details_northwind.product_id
        , sum(stg_order_details_northwind.unit_price * stg_order_details_northwind.quantity * (1 - stg_order_details_northwind.discount)) as amount
        /* O frete na stg_orders_northwind corresponde ao valor total do pedido, no entanto, como o grão da tabela é o produto no pedido
        , o valor do frete é racionado, sendo o total a soma do valor racionado por order_id */
        , (stg_orders_northwind.freight) / count(stg_order_details_northwind.product_id) over (partition by stg_orders_northwind.order_id) as rationed_shipping        
        , stg_orders_northwind.ship_name
        , stg_orders_northwind.ship_address
        , stg_orders_northwind.ship_city
        , stg_orders_northwind.ship_region
        , stg_orders_northwind.ship_country
        , case
            when stg_orders_northwind.ship_country in ('USA', 'Canada', 'Mexico') then 'North America'
            when stg_orders_northwind.ship_country in ('UK', 'France', 'Germany', 'Austria', 'Belgium', 
            'Denmark', 'Ireland', 'Finland', 'Italy', 'Norway', 'Poland', 'Portugal', 'Spain', 'Sweden', 'Switzerland') then 'Europe'
            when stg_orders_northwind.ship_country in ('Brazil', 'Argentina', 'Venezuela') then 'South America'
            else 'Other'
        end as ship_continent
    from stg_orders_northwind
    left join stg_order_details_northwind
        on stg_orders_northwind.order_id = stg_order_details_northwind.order_id
    left join stg_shippers_northwind
        on stg_orders_northwind.ship_via = stg_shippers_northwind.shipper_id
    group by 
        stg_orders_northwind.order_id
        , stg_orders_northwind.customer_id
        , stg_orders_northwind.employee_id
        , stg_orders_northwind.order_date
        , stg_orders_northwind.required_date
        , stg_orders_northwind.shipped_date
        , stg_orders_northwind.ship_via
        , stg_shippers_northwind.company_name
        , stg_order_details_northwind.product_id
        , stg_orders_northwind.freight
        , stg_orders_northwind.ship_name
        , stg_orders_northwind.ship_address
        , stg_orders_northwind.ship_city
        , stg_orders_northwind.ship_region
        , stg_orders_northwind.ship_country
)

, int_orders_northwind as (
    select
        transformed_table.order_id
        , transformed_table.customer_id
        , transformed_table.employee_id
        , transformed_table.order_date
        , transformed_table.required_date
        , transformed_table.shipped_date
        , transformed_table.days_to_ship
        , transformed_table.ship_id
        , transformed_table.ship_via
        , transformed_table.shipper_name
        , transformed_table.product_id
        , transformed_table.amount
        , round(transformed_table.rationed_shipping, 2) as rationed_shipping
        , transformed_table.ship_name
        , transformed_table.ship_address
        , transformed_table.ship_city
        , transformed_table.ship_region
        , transformed_table.ship_country
        , transformed_table.ship_continent
        , case 
            when transformed_table.days_to_ship is null then False
            else True
          end as is_shipped
    from transformed_table
)

select *
from int_orders_northwind;


[0m15:23:11.216018 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m15:23:12.389473 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:fd08f825-31df-4030-a32f-0f28bbe21cd3&page=queryresults
[0m15:23:15.209815 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '802572c8-4df5-4463-80a3-facd58308f3b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dd5ec28ef90>]}
[0m15:23:15.211198 [info ] [Thread-4 (]: 4 of 4 OK created sql view model dbt_dw_intermediate.int_orders_northwind ...... [[32mCREATE VIEW (0 processed)[0m in 4.04s]
[0m15:23:15.212480 [debug] [Thread-4 (]: Finished running node model.dbt_exercise.int_orders_northwind
[0m15:23:15.216287 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:23:15.227878 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:23:15.229075 [debug] [MainThread]: Connection 'model.dbt_exercise.stg_shippers_northwind' was properly closed.
[0m15:23:15.230468 [debug] [MainThread]: Connection 'model.dbt_exercise.int_orders_northwind' was properly closed.
[0m15:23:15.231604 [debug] [MainThread]: Connection 'model.dbt_exercise.stg_order_details_northwind' was properly closed.
[0m15:23:15.233158 [debug] [MainThread]: Connection 'model.dbt_exercise.stg_orders_northwind' was properly closed.
[0m15:23:15.235336 [info ] [MainThread]: 
[0m15:23:15.238170 [info ] [MainThread]: Finished running 4 view models in 0 hours 0 minutes and 18.93 seconds (18.93s).
[0m15:23:15.242014 [debug] [MainThread]: Command end result
[0m15:23:15.351357 [debug] [MainThread]: Wrote artifact WritableManifest to /home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/target/manifest.json
[0m15:23:15.368772 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/target/semantic_manifest.json
[0m15:23:15.377397 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/target/run_results.json
[0m15:23:15.378067 [info ] [MainThread]: 
[0m15:23:15.378661 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:23:15.379220 [info ] [MainThread]: 
[0m15:23:15.379864 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=4
[0m15:23:15.380699 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- DuplicateYAMLKeysDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m15:23:15.385081 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 167.76295, "process_in_blocks": "127296", "process_kernel_time": 17.435364, "process_mem_max_rss": "368104", "process_out_blocks": "3816", "process_user_time": 14.495623}
[0m15:23:15.385940 [debug] [MainThread]: Command `dbt run` succeeded at 15:23:15.385781 after 167.76 seconds
[0m15:23:15.386535 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dd62d6ebef0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dd5efdbbf50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7dd62e38c740>]}
[0m15:23:15.387217 [debug] [MainThread]: Flushing usage events
[0m15:23:15.792816 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:26:20.868547 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a5b47c43020>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a5b49b5dc70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a5b48127ef0>]}


============================== 16:26:20.893185 | 8e448560-b747-43cf-9626-1447f95afdcd ==============================
[0m16:26:20.893185 [info ] [MainThread]: Running with dbt=1.10.2
[0m16:26:20.894232 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/logs', 'fail_fast': 'False', 'profiles_dir': '/home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run -s fact_orders', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m16:27:29.008901 [warn ] [MainThread]: [[33mWARNING[0m][DuplicateYAMLKeysDeprecation]: Deprecated functionality
Duplicate key 'version' in "<unicode string>", line 4, column 1 in file
`/home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/dbt_project.yml`
[0m16:27:29.010122 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '8e448560-b747-43cf-9626-1447f95afdcd', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a5b0a31b6b0>]}
[0m16:27:29.970798 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8e448560-b747-43cf-9626-1447f95afdcd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a5b48041760>]}
[0m16:27:30.098219 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8e448560-b747-43cf-9626-1447f95afdcd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a5b471e12e0>]}
[0m16:27:30.103304 [info ] [MainThread]: Registered adapter: bigquery=1.9.2
[0m16:28:40.971231 [debug] [MainThread]: checksum: 1adc40777973ef30f45f80b3b6d04d5013c1edd53d96363881b3b199e612468b, vars: {}, profile: , target: , version: 1.10.2
[0m16:28:48.031097 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:28:48.031897 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:28:48.448612 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8e448560-b747-43cf-9626-1447f95afdcd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a5b0a0aebd0>]}
[0m16:28:48.655732 [debug] [MainThread]: Wrote artifact WritableManifest to /home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/target/manifest.json
[0m16:28:48.672987 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/target/semantic_manifest.json
[0m16:28:49.266946 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8e448560-b747-43cf-9626-1447f95afdcd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a5b0a20e090>]}
[0m16:28:49.267845 [info ] [MainThread]: Found 14 seeds, 45 data tests, 19 models, 14 sources, 609 macros
[0m16:28:49.268685 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8e448560-b747-43cf-9626-1447f95afdcd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a5b09d71070>]}
[0m16:28:49.273428 [info ] [MainThread]: 
[0m16:28:49.274825 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:28:49.275990 [info ] [MainThread]: 
[0m16:28:49.277328 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m16:28:49.280300 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_corded-sunlight-464012-e2'
[0m16:28:49.281303 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:28:50.663830 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_corded-sunlight-464012-e2, now list_corded-sunlight-464012-e2_dbt_dw_staging)
[0m16:28:50.665264 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_corded-sunlight-464012-e2_dbt_dw_marts'
[0m16:28:50.665870 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:28:50.667039 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_corded-sunlight-464012-e2_dbt_dw_raw'
[0m16:28:50.668235 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:28:50.669137 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_corded-sunlight-464012-e2_dbt_dw_intermediate'
[0m16:28:50.670494 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:28:50.671933 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:28:51.599758 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8e448560-b747-43cf-9626-1447f95afdcd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a5b497e42f0>]}
[0m16:28:51.600547 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:28:51.632672 [debug] [Thread-1 (]: Began running node model.dbt_exercise.fact_orders
[0m16:28:51.633754 [info ] [Thread-1 (]: 1 of 1 START sql table model dbt_dw_marts.fact_orders .......................... [RUN]
[0m16:28:51.634657 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_corded-sunlight-464012-e2_dbt_dw_raw, now model.dbt_exercise.fact_orders)
[0m16:28:51.635488 [debug] [Thread-1 (]: Began compiling node model.dbt_exercise.fact_orders
[0m16:28:51.675570 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_exercise.fact_orders"
[0m16:28:51.678277 [debug] [Thread-1 (]: Began executing node model.dbt_exercise.fact_orders
[0m16:28:51.749127 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_exercise.fact_orders"
[0m16:28:51.752367 [debug] [Thread-1 (]: On model.dbt_exercise.fact_orders: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "model.dbt_exercise.fact_orders"} */

  
    

    create or replace table `corded-sunlight-464012-e2`.`dbt_dw_marts`.`fact_orders`
      
    
    

    OPTIONS()
    as (
      with int_orders_northwind as (
    select *
    from `corded-sunlight-464012-e2`.`dbt_dw_intermediate`.`int_orders_northwind`
)

, dim_products as (
    select *
    from `corded-sunlight-464012-e2`.`dbt_dw_marts`.`dim_products`
)

, dim_customers as (
    select *
    from `corded-sunlight-464012-e2`.`dbt_dw_marts`.`dim_customers`
)

, dim_ship as (
    select *
    from `corded-sunlight-464012-e2`.`dbt_dw_marts`.`dim_ship`
)

, dim_employees as (
    select *
    from `corded-sunlight-464012-e2`.`dbt_dw_marts`.`dim_employees`
)

, fact_orders as (
    select 
        to_hex(md5(cast(coalesce(cast(int_orders_northwind.order_id as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(dim_customers.customer_id as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(dim_employees.employee_id as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(dim_products.product_id as string), '_dbt_utils_surrogate_key_null_') as string))) as sk_orders
        , int_orders_northwind.order_id
        , dim_customers.sk_customer
        , int_orders_northwind.customer_id
        , dim_employees.sk_employee
        , int_orders_northwind.employee_id
        , int_orders_northwind.order_date
        , int_orders_northwind.required_date
        , dim_ship.sk_ship
        , int_orders_northwind.ship_id
        , int_orders_northwind.shipped_date
        , int_orders_northwind.days_to_ship
        , dim_products.sk_product
        , int_orders_northwind.product_id
        , int_orders_northwind.amount
        , int_orders_northwind.rationed_shipping
        , int_orders_northwind.is_shipped
    from int_orders_northwind
    left join dim_products
        on int_orders_northwind.product_id = dim_products.product_id
    left join dim_customers
        on int_orders_northwind.customer_id = dim_customers.customer_id
    left join dim_employees
        on int_orders_northwind.employee_id = dim_employees.employee_id
    left join dim_ship
        on int_orders_northwind.ship_id = dim_ship.ship_id
)

select *
from fact_orders
    );
  
[0m16:28:51.754004 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:28:53.051028 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:8a9a398d-f772-473d-ba4f-90ebb79fdd5a&page=queryresults
[0m16:29:04.546882 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8e448560-b747-43cf-9626-1447f95afdcd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a5b0ee32390>]}
[0m16:29:04.549152 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dbt_dw_marts.fact_orders ..................... [[32mCREATE TABLE (2.2k rows, 208.5 KiB processed)[0m in 12.90s]
[0m16:29:04.550419 [debug] [Thread-1 (]: Finished running node model.dbt_exercise.fact_orders
[0m16:29:04.555735 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:29:04.564720 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:29:04.565651 [debug] [MainThread]: Connection 'list_corded-sunlight-464012-e2_dbt_dw_staging' was properly closed.
[0m16:29:04.566486 [debug] [MainThread]: Connection 'list_corded-sunlight-464012-e2_dbt_dw_marts' was properly closed.
[0m16:29:04.567467 [debug] [MainThread]: Connection 'model.dbt_exercise.fact_orders' was properly closed.
[0m16:29:04.568389 [debug] [MainThread]: Connection 'list_corded-sunlight-464012-e2_dbt_dw_intermediate' was properly closed.
[0m16:29:04.569523 [info ] [MainThread]: 
[0m16:29:04.570522 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 15.29 seconds (15.29s).
[0m16:29:04.573638 [debug] [MainThread]: Command end result
[0m16:29:04.696929 [debug] [MainThread]: Wrote artifact WritableManifest to /home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/target/manifest.json
[0m16:29:04.713293 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/target/semantic_manifest.json
[0m16:29:04.722393 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/target/run_results.json
[0m16:29:04.723074 [info ] [MainThread]: 
[0m16:29:04.724045 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:29:04.724716 [info ] [MainThread]: 
[0m16:29:04.725487 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m16:29:04.726822 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- DuplicateYAMLKeysDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m16:29:04.733453 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 152.32195, "process_in_blocks": "123016", "process_kernel_time": 19.58512, "process_mem_max_rss": "367076", "process_out_blocks": "3728", "process_user_time": 15.769064}
[0m16:29:04.734828 [debug] [MainThread]: Command `dbt run` succeeded at 16:29:04.734334 after 152.32 seconds
[0m16:29:04.735782 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a5b4a09f770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a5b47fac3b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a5b47facce0>]}
[0m16:29:04.736611 [debug] [MainThread]: Flushing usage events
[0m16:29:05.175097 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:34:08.021236 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efb68963920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efb690a5f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efb66faf740>]}


============================== 16:34:08.048148 | 28d22af9-4292-4cdb-93e0-6b3f827c20d4 ==============================
[0m16:34:08.048148 [info ] [MainThread]: Running with dbt=1.10.2
[0m16:34:08.049352 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt test', 'send_anonymous_usage_stats': 'True'}
[0m16:35:14.598609 [warn ] [MainThread]: [[33mWARNING[0m][DuplicateYAMLKeysDeprecation]: Deprecated functionality
Duplicate key 'version' in "<unicode string>", line 4, column 1 in file
`/home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/dbt_project.yml`
[0m16:35:14.599807 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '28d22af9-4292-4cdb-93e0-6b3f827c20d4', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efb66aa2cf0>]}
[0m16:35:15.474703 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '28d22af9-4292-4cdb-93e0-6b3f827c20d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efb29890560>]}
[0m16:35:15.626657 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '28d22af9-4292-4cdb-93e0-6b3f827c20d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efb29a09520>]}
[0m16:35:15.632913 [info ] [MainThread]: Registered adapter: bigquery=1.9.2
[0m16:36:22.203863 [debug] [MainThread]: checksum: 1adc40777973ef30f45f80b3b6d04d5013c1edd53d96363881b3b199e612468b, vars: {}, profile: , target: , version: 1.10.2
[0m16:36:31.072154 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:36:31.072876 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:36:31.570552 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '28d22af9-4292-4cdb-93e0-6b3f827c20d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efb2964b350>]}
[0m16:36:31.812675 [debug] [MainThread]: Wrote artifact WritableManifest to /home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/target/manifest.json
[0m16:36:31.830116 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/target/semantic_manifest.json
[0m16:36:32.475144 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '28d22af9-4292-4cdb-93e0-6b3f827c20d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efb2919be00>]}
[0m16:36:32.476069 [info ] [MainThread]: Found 14 seeds, 55 data tests, 19 models, 14 sources, 609 macros
[0m16:36:32.477097 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '28d22af9-4292-4cdb-93e0-6b3f827c20d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efb2940d8e0>]}
[0m16:36:32.484796 [info ] [MainThread]: 
[0m16:36:32.485727 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:36:32.486928 [info ] [MainThread]: 
[0m16:36:32.488844 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m16:36:32.504111 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_corded-sunlight-464012-e2_dbt_dw_raw'
[0m16:36:32.505858 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:36:32.507213 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_corded-sunlight-464012-e2_dbt_dw_staging'
[0m16:36:32.510371 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_corded-sunlight-464012-e2_dbt_dw_marts'
[0m16:36:32.512799 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_corded-sunlight-464012-e2_dbt_dw_intermediate'
[0m16:36:32.514362 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:36:32.515960 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:36:32.517203 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:36:33.515983 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '28d22af9-4292-4cdb-93e0-6b3f827c20d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efb68d3c0e0>]}
[0m16:36:33.517046 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:36:33.533485 [debug] [Thread-1 (]: Began running node test.dbt_exercise.accepted_values_dim_products_discontinued__True__False.07bc696cf6
[0m16:36:33.534286 [debug] [Thread-2 (]: Began running node test.dbt_exercise.not_null_dim_employees_employee_id.ef83a0c291
[0m16:36:33.535138 [debug] [Thread-3 (]: Began running node test.dbt_exercise.not_null_dim_employees_employee_sk.e2e35a6891
[0m16:36:33.536820 [debug] [Thread-4 (]: Began running node test.dbt_exercise.not_null_dim_products_product_id.c8aba288d1
[0m16:36:33.536151 [info ] [Thread-1 (]: 1 of 55 START test accepted_values_dim_products_discontinued__True__False ...... [RUN]
[0m16:36:33.538432 [info ] [Thread-2 (]: 2 of 55 START test not_null_dim_employees_employee_id .......................... [RUN]
[0m16:36:33.539769 [info ] [Thread-3 (]: 3 of 55 START test not_null_dim_employees_employee_sk .......................... [RUN]
[0m16:36:33.541089 [info ] [Thread-4 (]: 4 of 55 START test not_null_dim_products_product_id ............................ [RUN]
[0m16:36:33.542987 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_corded-sunlight-464012-e2_dbt_dw_staging, now test.dbt_exercise.accepted_values_dim_products_discontinued__True__False.07bc696cf6)
[0m16:36:33.544884 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_corded-sunlight-464012-e2_dbt_dw_raw, now test.dbt_exercise.not_null_dim_employees_employee_id.ef83a0c291)
[0m16:36:33.546310 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_corded-sunlight-464012-e2_dbt_dw_marts, now test.dbt_exercise.not_null_dim_employees_employee_sk.e2e35a6891)
[0m16:36:33.547491 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly list_corded-sunlight-464012-e2_dbt_dw_intermediate, now test.dbt_exercise.not_null_dim_products_product_id.c8aba288d1)
[0m16:36:33.548385 [debug] [Thread-1 (]: Began compiling node test.dbt_exercise.accepted_values_dim_products_discontinued__True__False.07bc696cf6
[0m16:36:33.549360 [debug] [Thread-2 (]: Began compiling node test.dbt_exercise.not_null_dim_employees_employee_id.ef83a0c291
[0m16:36:33.550707 [debug] [Thread-3 (]: Began compiling node test.dbt_exercise.not_null_dim_employees_employee_sk.e2e35a6891
[0m16:36:33.551922 [debug] [Thread-4 (]: Began compiling node test.dbt_exercise.not_null_dim_products_product_id.c8aba288d1
[0m16:36:33.583211 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_exercise.accepted_values_dim_products_discontinued__True__False.07bc696cf6"
[0m16:36:33.598734 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_exercise.not_null_dim_employees_employee_id.ef83a0c291"
[0m16:36:33.605256 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_exercise.not_null_dim_employees_employee_sk.e2e35a6891"
[0m16:36:33.615375 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_exercise.not_null_dim_products_product_id.c8aba288d1"
[0m16:36:33.617739 [debug] [Thread-1 (]: Began executing node test.dbt_exercise.accepted_values_dim_products_discontinued__True__False.07bc696cf6
[0m16:36:33.619734 [debug] [Thread-2 (]: Began executing node test.dbt_exercise.not_null_dim_employees_employee_id.ef83a0c291
[0m16:36:33.620452 [debug] [Thread-3 (]: Began executing node test.dbt_exercise.not_null_dim_employees_employee_sk.e2e35a6891
[0m16:36:33.626942 [debug] [Thread-4 (]: Began executing node test.dbt_exercise.not_null_dim_products_product_id.c8aba288d1
[0m16:36:33.672037 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_exercise.accepted_values_dim_products_discontinued__True__False.07bc696cf6"
[0m16:36:33.676209 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_exercise.not_null_dim_employees_employee_id.ef83a0c291"
[0m16:36:33.681618 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_exercise.not_null_dim_employees_employee_sk.e2e35a6891"
[0m16:36:33.686164 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_exercise.not_null_dim_products_product_id.c8aba288d1"
[0m16:36:33.689828 [debug] [Thread-1 (]: On test.dbt_exercise.accepted_values_dim_products_discontinued__True__False.07bc696cf6: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "test.dbt_exercise.accepted_values_dim_products_discontinued__True__False.07bc696cf6"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        discontinued as value_field,
        count(*) as n_records

    from `corded-sunlight-464012-e2`.`dbt_dw_marts`.`dim_products`
    group by discontinued

)

select *
from all_values
where value_field not in (
    'True','False'
)



  
  
      
    ) dbt_internal_test
[0m16:36:33.691719 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:36:33.693747 [debug] [Thread-3 (]: On test.dbt_exercise.not_null_dim_employees_employee_sk.e2e35a6891: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "test.dbt_exercise.not_null_dim_employees_employee_sk.e2e35a6891"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select employee_sk
from `corded-sunlight-464012-e2`.`dbt_dw_marts`.`dim_employees`
where employee_sk is null



  
  
      
    ) dbt_internal_test
[0m16:36:33.695182 [debug] [Thread-2 (]: On test.dbt_exercise.not_null_dim_employees_employee_id.ef83a0c291: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "test.dbt_exercise.not_null_dim_employees_employee_id.ef83a0c291"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select employee_id
from `corded-sunlight-464012-e2`.`dbt_dw_marts`.`dim_employees`
where employee_id is null



  
  
      
    ) dbt_internal_test
[0m16:36:33.696522 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:36:33.697697 [debug] [Thread-4 (]: On test.dbt_exercise.not_null_dim_products_product_id.c8aba288d1: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "test.dbt_exercise.not_null_dim_products_product_id.c8aba288d1"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select product_id
from `corded-sunlight-464012-e2`.`dbt_dw_marts`.`dim_products`
where product_id is null



  
  
      
    ) dbt_internal_test
[0m16:36:33.698462 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:36:33.699762 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:36:34.814021 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:cabb6080-1dcf-4443-99c2-939e28250c3f&page=queryresults
[0m16:36:34.815745 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:cabb6080-1dcf-4443-99c2-939e28250c3f&page=queryresults
[0m16:36:34.821599 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:800082e0-321c-4abe-acae-71c39276a8e4&page=queryresults
[0m16:36:34.822935 [error] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:800082e0-321c-4abe-acae-71c39276a8e4&page=queryresults
[0m16:36:34.953416 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:f5aab775-ba27-486f-9641-5cec2cd39038&page=queryresults
[0m16:36:34.982952 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:2e6a9065-b8d9-4424-bb86-509424973497&page=queryresults
[0m16:36:35.200334 [debug] [Thread-1 (]: Database Error in test accepted_values_dim_products_discontinued__True__False (models/marts/dim_products.yml)
  Unrecognized name: discontinued; Did you mean is_discontinued? at [17:9]
  compiled code at target/run/dbt_exercise/models/marts/dim_products.yml/accepted_values_dim_products_discontinued__True__False.sql
[0m16:36:35.201467 [error] [Thread-1 (]: 1 of 55 ERROR accepted_values_dim_products_discontinued__True__False ........... [[31mERROR[0m in 1.66s]
[0m16:36:35.202571 [debug] [Thread-1 (]: Finished running node test.dbt_exercise.accepted_values_dim_products_discontinued__True__False.07bc696cf6
[0m16:36:35.204492 [debug] [Thread-3 (]: Database Error in test not_null_dim_employees_employee_sk (models/marts/dim_employees.yml)
  Unrecognized name: employee_sk; Did you mean employee_id? at [18:7]
  compiled code at target/run/dbt_exercise/models/marts/dim_employees.yml/not_null_dim_employees_employee_sk.sql
[0m16:36:35.205260 [debug] [Thread-1 (]: Began running node test.dbt_exercise.not_null_dim_products_sk_product.7ce7792ece
[0m16:36:35.206176 [debug] [Thread-7 (]: Marking all children of 'test.dbt_exercise.accepted_values_dim_products_discontinued__True__False.07bc696cf6' to be skipped because of status 'error'.  Reason: Database Error in test accepted_values_dim_products_discontinued__True__False (models/marts/dim_products.yml)
  Unrecognized name: discontinued; Did you mean is_discontinued? at [17:9]
  compiled code at target/run/dbt_exercise/models/marts/dim_products.yml/accepted_values_dim_products_discontinued__True__False.sql.
[0m16:36:35.206957 [error] [Thread-3 (]: 3 of 55 ERROR not_null_dim_employees_employee_sk ............................... [[31mERROR[0m in 1.66s]
[0m16:36:35.208122 [info ] [Thread-1 (]: 5 of 55 START test not_null_dim_products_sk_product ............................ [RUN]
[0m16:36:35.211046 [debug] [Thread-3 (]: Finished running node test.dbt_exercise.not_null_dim_employees_employee_sk.e2e35a6891
[0m16:36:35.212491 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_exercise.accepted_values_dim_products_discontinued__True__False.07bc696cf6, now test.dbt_exercise.not_null_dim_products_sk_product.7ce7792ece)
[0m16:36:35.213732 [debug] [Thread-3 (]: Began running node test.dbt_exercise.not_null_dim_ship_ship_id.0e7926966a
[0m16:36:35.214813 [debug] [Thread-7 (]: Marking all children of 'test.dbt_exercise.not_null_dim_employees_employee_sk.e2e35a6891' to be skipped because of status 'error'.  Reason: Database Error in test not_null_dim_employees_employee_sk (models/marts/dim_employees.yml)
  Unrecognized name: employee_sk; Did you mean employee_id? at [18:7]
  compiled code at target/run/dbt_exercise/models/marts/dim_employees.yml/not_null_dim_employees_employee_sk.sql.
[0m16:36:35.216021 [debug] [Thread-1 (]: Began compiling node test.dbt_exercise.not_null_dim_products_sk_product.7ce7792ece
[0m16:36:35.217524 [info ] [Thread-3 (]: 6 of 55 START test not_null_dim_ship_ship_id ................................... [RUN]
[0m16:36:35.229363 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_exercise.not_null_dim_products_sk_product.7ce7792ece"
[0m16:36:35.231046 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_exercise.not_null_dim_employees_employee_sk.e2e35a6891, now test.dbt_exercise.not_null_dim_ship_ship_id.0e7926966a)
[0m16:36:35.233086 [debug] [Thread-3 (]: Began compiling node test.dbt_exercise.not_null_dim_ship_ship_id.0e7926966a
[0m16:36:35.243477 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_exercise.not_null_dim_ship_ship_id.0e7926966a"
[0m16:36:35.244333 [debug] [Thread-1 (]: Began executing node test.dbt_exercise.not_null_dim_products_sk_product.7ce7792ece
[0m16:36:35.249898 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_exercise.not_null_dim_products_sk_product.7ce7792ece"
[0m16:36:35.251239 [debug] [Thread-3 (]: Began executing node test.dbt_exercise.not_null_dim_ship_ship_id.0e7926966a
[0m16:36:35.254131 [debug] [Thread-1 (]: On test.dbt_exercise.not_null_dim_products_sk_product.7ce7792ece: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "test.dbt_exercise.not_null_dim_products_sk_product.7ce7792ece"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select sk_product
from `corded-sunlight-464012-e2`.`dbt_dw_marts`.`dim_products`
where sk_product is null



  
  
      
    ) dbt_internal_test
[0m16:36:35.259360 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_exercise.not_null_dim_ship_ship_id.0e7926966a"
[0m16:36:35.261200 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:36:35.264415 [debug] [Thread-3 (]: On test.dbt_exercise.not_null_dim_ship_ship_id.0e7926966a: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "test.dbt_exercise.not_null_dim_ship_ship_id.0e7926966a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select ship_id
from `corded-sunlight-464012-e2`.`dbt_dw_marts`.`dim_ship`
where ship_id is null



  
  
      
    ) dbt_internal_test
[0m16:36:35.265832 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:36:36.514734 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:6508553c-8301-4cd4-a093-cc2406f11b7f&page=queryresults
[0m16:36:36.539091 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:7b0562ce-856a-474e-930d-2e2ac8cf4d5d&page=queryresults
[0m16:36:41.561523 [info ] [Thread-2 (]: 2 of 55 PASS not_null_dim_employees_employee_id ................................ [[32mPASS[0m in 8.02s]
[0m16:36:41.566104 [debug] [Thread-2 (]: Finished running node test.dbt_exercise.not_null_dim_employees_employee_id.ef83a0c291
[0m16:36:41.571985 [debug] [Thread-2 (]: Began running node test.dbt_exercise.not_null_dim_ship_ship_sk.5c221820c2
[0m16:36:41.575588 [info ] [Thread-3 (]: 6 of 55 PASS not_null_dim_ship_ship_id ......................................... [[32mPASS[0m in 6.34s]
[0m16:36:41.577485 [info ] [Thread-1 (]: 5 of 55 PASS not_null_dim_products_sk_product .................................. [[32mPASS[0m in 6.36s]
[0m16:36:41.584140 [debug] [Thread-3 (]: Finished running node test.dbt_exercise.not_null_dim_ship_ship_id.0e7926966a
[0m16:36:41.579530 [info ] [Thread-2 (]: 7 of 55 START test not_null_dim_ship_ship_sk ................................... [RUN]
[0m16:36:41.587057 [info ] [Thread-4 (]: 4 of 55 PASS not_null_dim_products_product_id .................................. [[32mPASS[0m in 8.04s]
[0m16:36:41.588903 [debug] [Thread-1 (]: Finished running node test.dbt_exercise.not_null_dim_products_sk_product.7ce7792ece
[0m16:36:41.590432 [debug] [Thread-3 (]: Began running node test.dbt_exercise.not_null_dim_ship_shipper_id.78acf0f3d3
[0m16:36:41.592431 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_exercise.not_null_dim_employees_employee_id.ef83a0c291, now test.dbt_exercise.not_null_dim_ship_ship_sk.5c221820c2)
[0m16:36:41.594838 [debug] [Thread-4 (]: Finished running node test.dbt_exercise.not_null_dim_products_product_id.c8aba288d1
[0m16:36:41.596724 [debug] [Thread-1 (]: Began running node test.dbt_exercise.not_null_fact_orders_customer_id.9c2270d0dc
[0m16:36:41.598691 [info ] [Thread-3 (]: 8 of 55 START test not_null_dim_ship_shipper_id ................................ [RUN]
[0m16:36:41.600543 [debug] [Thread-2 (]: Began compiling node test.dbt_exercise.not_null_dim_ship_ship_sk.5c221820c2
[0m16:36:41.601948 [debug] [Thread-4 (]: Began running node test.dbt_exercise.not_null_fact_orders_employee_id.4d01f9cb32
[0m16:36:41.603697 [info ] [Thread-1 (]: 9 of 55 START test not_null_fact_orders_customer_id ............................ [RUN]
[0m16:36:41.605198 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_exercise.not_null_dim_ship_ship_id.0e7926966a, now test.dbt_exercise.not_null_dim_ship_shipper_id.78acf0f3d3)
[0m16:36:41.620559 [info ] [Thread-4 (]: 10 of 55 START test not_null_fact_orders_employee_id ........................... [RUN]
[0m16:36:41.626278 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_exercise.not_null_dim_ship_ship_sk.5c221820c2"
[0m16:36:41.627807 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_exercise.not_null_dim_products_sk_product.7ce7792ece, now test.dbt_exercise.not_null_fact_orders_customer_id.9c2270d0dc)
[0m16:36:41.629072 [debug] [Thread-3 (]: Began compiling node test.dbt_exercise.not_null_dim_ship_shipper_id.78acf0f3d3
[0m16:36:41.630764 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_exercise.not_null_dim_products_product_id.c8aba288d1, now test.dbt_exercise.not_null_fact_orders_employee_id.4d01f9cb32)
[0m16:36:41.633117 [debug] [Thread-1 (]: Began compiling node test.dbt_exercise.not_null_fact_orders_customer_id.9c2270d0dc
[0m16:36:41.646409 [debug] [Thread-2 (]: Began executing node test.dbt_exercise.not_null_dim_ship_ship_sk.5c221820c2
[0m16:36:41.650366 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_exercise.not_null_dim_ship_shipper_id.78acf0f3d3"
[0m16:36:41.652045 [debug] [Thread-4 (]: Began compiling node test.dbt_exercise.not_null_fact_orders_employee_id.4d01f9cb32
[0m16:36:41.666244 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_exercise.not_null_fact_orders_customer_id.9c2270d0dc"
[0m16:36:41.672676 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_exercise.not_null_dim_ship_ship_sk.5c221820c2"
[0m16:36:41.684241 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_exercise.not_null_fact_orders_employee_id.4d01f9cb32"
[0m16:36:41.685636 [debug] [Thread-3 (]: Began executing node test.dbt_exercise.not_null_dim_ship_shipper_id.78acf0f3d3
[0m16:36:41.687609 [debug] [Thread-2 (]: On test.dbt_exercise.not_null_dim_ship_ship_sk.5c221820c2: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "test.dbt_exercise.not_null_dim_ship_ship_sk.5c221820c2"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select ship_sk
from `corded-sunlight-464012-e2`.`dbt_dw_marts`.`dim_ship`
where ship_sk is null



  
  
      
    ) dbt_internal_test
[0m16:36:41.692250 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_exercise.not_null_dim_ship_shipper_id.78acf0f3d3"
[0m16:36:41.693787 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:36:41.694961 [debug] [Thread-4 (]: Began executing node test.dbt_exercise.not_null_fact_orders_employee_id.4d01f9cb32
[0m16:36:41.696697 [debug] [Thread-1 (]: Began executing node test.dbt_exercise.not_null_fact_orders_customer_id.9c2270d0dc
[0m16:36:41.704670 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_exercise.not_null_fact_orders_employee_id.4d01f9cb32"
[0m16:36:41.705504 [debug] [Thread-3 (]: On test.dbt_exercise.not_null_dim_ship_shipper_id.78acf0f3d3: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "test.dbt_exercise.not_null_dim_ship_shipper_id.78acf0f3d3"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select shipper_id
from `corded-sunlight-464012-e2`.`dbt_dw_marts`.`dim_ship`
where shipper_id is null



  
  
      
    ) dbt_internal_test
[0m16:36:41.718495 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_exercise.not_null_fact_orders_customer_id.9c2270d0dc"
[0m16:36:41.722108 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:36:41.762618 [debug] [Thread-1 (]: On test.dbt_exercise.not_null_fact_orders_customer_id.9c2270d0dc: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "test.dbt_exercise.not_null_fact_orders_customer_id.9c2270d0dc"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select customer_id
from `corded-sunlight-464012-e2`.`dbt_dw_marts`.`fact_orders`
where customer_id is null



  
  
      
    ) dbt_internal_test
[0m16:36:41.764466 [debug] [Thread-4 (]: On test.dbt_exercise.not_null_fact_orders_employee_id.4d01f9cb32: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "test.dbt_exercise.not_null_fact_orders_employee_id.4d01f9cb32"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select employee_id
from `corded-sunlight-464012-e2`.`dbt_dw_marts`.`fact_orders`
where employee_id is null



  
  
      
    ) dbt_internal_test
[0m16:36:41.765772 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:36:41.767471 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:36:42.702789 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:93aca205-a03f-46db-ab9b-b435b7b519af&page=queryresults
[0m16:36:42.704166 [error] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:93aca205-a03f-46db-ab9b-b435b7b519af&page=queryresults
[0m16:36:42.754010 [debug] [Thread-2 (]: Database Error in test not_null_dim_ship_ship_sk (models/marts/dim_ship.yml)
  Unrecognized name: ship_sk; Did you mean ship_id? at [18:7]
  compiled code at target/run/dbt_exercise/models/marts/dim_ship.yml/not_null_dim_ship_ship_sk.sql
[0m16:36:42.755950 [error] [Thread-2 (]: 7 of 55 ERROR not_null_dim_ship_ship_sk ........................................ [[31mERROR[0m in 1.16s]
[0m16:36:42.757577 [debug] [Thread-2 (]: Finished running node test.dbt_exercise.not_null_dim_ship_ship_sk.5c221820c2
[0m16:36:42.758471 [debug] [Thread-2 (]: Began running node test.dbt_exercise.not_null_fact_orders_order_id.6ba6d3f0a0
[0m16:36:42.759346 [debug] [Thread-7 (]: Marking all children of 'test.dbt_exercise.not_null_dim_ship_ship_sk.5c221820c2' to be skipped because of status 'error'.  Reason: Database Error in test not_null_dim_ship_ship_sk (models/marts/dim_ship.yml)
  Unrecognized name: ship_sk; Did you mean ship_id? at [18:7]
  compiled code at target/run/dbt_exercise/models/marts/dim_ship.yml/not_null_dim_ship_ship_sk.sql.
[0m16:36:42.760266 [info ] [Thread-2 (]: 11 of 55 START test not_null_fact_orders_order_id .............................. [RUN]
[0m16:36:42.761786 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_exercise.not_null_dim_ship_ship_sk.5c221820c2, now test.dbt_exercise.not_null_fact_orders_order_id.6ba6d3f0a0)
[0m16:36:42.762814 [debug] [Thread-2 (]: Began compiling node test.dbt_exercise.not_null_fact_orders_order_id.6ba6d3f0a0
[0m16:36:42.770698 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_exercise.not_null_fact_orders_order_id.6ba6d3f0a0"
[0m16:36:42.772360 [debug] [Thread-2 (]: Began executing node test.dbt_exercise.not_null_fact_orders_order_id.6ba6d3f0a0
[0m16:36:42.776071 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_exercise.not_null_fact_orders_order_id.6ba6d3f0a0"
[0m16:36:42.777035 [debug] [Thread-2 (]: On test.dbt_exercise.not_null_fact_orders_order_id.6ba6d3f0a0: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "test.dbt_exercise.not_null_fact_orders_order_id.6ba6d3f0a0"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select order_id
from `corded-sunlight-464012-e2`.`dbt_dw_marts`.`fact_orders`
where order_id is null



  
  
      
    ) dbt_internal_test
[0m16:36:42.777651 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:36:42.857470 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:e82f30d0-fbab-43cc-9cb8-c25731c6b1f3&page=queryresults
[0m16:36:42.902562 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:7aaa6438-6243-488f-84fb-683aa2d5e358&page=queryresults
[0m16:36:42.938828 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:b3b78b3d-5124-43b8-b30e-4112a6a2e585&page=queryresults
[0m16:36:43.689914 [info ] [Thread-3 (]: 8 of 55 PASS not_null_dim_ship_shipper_id ...................................... [[32mPASS[0m in 2.08s]
[0m16:36:43.691308 [debug] [Thread-3 (]: Finished running node test.dbt_exercise.not_null_dim_ship_shipper_id.78acf0f3d3
[0m16:36:43.692388 [debug] [Thread-3 (]: Began running node test.dbt_exercise.not_null_fact_orders_product_id.346126b727
[0m16:36:43.693243 [info ] [Thread-3 (]: 12 of 55 START test not_null_fact_orders_product_id ............................ [RUN]
[0m16:36:43.694174 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_exercise.not_null_dim_ship_shipper_id.78acf0f3d3, now test.dbt_exercise.not_null_fact_orders_product_id.346126b727)
[0m16:36:43.694807 [debug] [Thread-3 (]: Began compiling node test.dbt_exercise.not_null_fact_orders_product_id.346126b727
[0m16:36:43.703112 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_exercise.not_null_fact_orders_product_id.346126b727"
[0m16:36:43.705055 [debug] [Thread-3 (]: Began executing node test.dbt_exercise.not_null_fact_orders_product_id.346126b727
[0m16:36:43.709935 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_exercise.not_null_fact_orders_product_id.346126b727"
[0m16:36:43.711495 [debug] [Thread-3 (]: On test.dbt_exercise.not_null_fact_orders_product_id.346126b727: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "test.dbt_exercise.not_null_fact_orders_product_id.346126b727"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select product_id
from `corded-sunlight-464012-e2`.`dbt_dw_marts`.`fact_orders`
where product_id is null



  
  
      
    ) dbt_internal_test
[0m16:36:43.712935 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:36:43.768997 [info ] [Thread-4 (]: 10 of 55 PASS not_null_fact_orders_employee_id ................................. [[32mPASS[0m in 2.14s]
[0m16:36:43.772119 [info ] [Thread-1 (]: 9 of 55 PASS not_null_fact_orders_customer_id .................................. [[32mPASS[0m in 2.14s]
[0m16:36:43.774794 [debug] [Thread-4 (]: Finished running node test.dbt_exercise.not_null_fact_orders_employee_id.4d01f9cb32
[0m16:36:43.777262 [debug] [Thread-1 (]: Finished running node test.dbt_exercise.not_null_fact_orders_customer_id.9c2270d0dc
[0m16:36:43.780217 [debug] [Thread-4 (]: Began running node test.dbt_exercise.not_null_fact_orders_sk_customer.6134ecd4cd
[0m16:36:43.783889 [debug] [Thread-1 (]: Began running node test.dbt_exercise.not_null_fact_orders_sk_employee.cf36d136ff
[0m16:36:43.786747 [info ] [Thread-4 (]: 13 of 55 START test not_null_fact_orders_sk_customer ........................... [RUN]
[0m16:36:43.789000 [info ] [Thread-1 (]: 14 of 55 START test not_null_fact_orders_sk_employee ........................... [RUN]
[0m16:36:43.790848 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_exercise.not_null_fact_orders_employee_id.4d01f9cb32, now test.dbt_exercise.not_null_fact_orders_sk_customer.6134ecd4cd)
[0m16:36:43.792399 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_exercise.not_null_fact_orders_customer_id.9c2270d0dc, now test.dbt_exercise.not_null_fact_orders_sk_employee.cf36d136ff)
[0m16:36:43.794280 [debug] [Thread-4 (]: Began compiling node test.dbt_exercise.not_null_fact_orders_sk_customer.6134ecd4cd
[0m16:36:43.796083 [debug] [Thread-1 (]: Began compiling node test.dbt_exercise.not_null_fact_orders_sk_employee.cf36d136ff
[0m16:36:43.814885 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_exercise.not_null_fact_orders_sk_customer.6134ecd4cd"
[0m16:36:43.821824 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_exercise.not_null_fact_orders_sk_employee.cf36d136ff"
[0m16:36:43.823323 [debug] [Thread-4 (]: Began executing node test.dbt_exercise.not_null_fact_orders_sk_customer.6134ecd4cd
[0m16:36:43.825152 [debug] [Thread-1 (]: Began executing node test.dbt_exercise.not_null_fact_orders_sk_employee.cf36d136ff
[0m16:36:43.831620 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_exercise.not_null_fact_orders_sk_customer.6134ecd4cd"
[0m16:36:43.842280 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_exercise.not_null_fact_orders_sk_employee.cf36d136ff"
[0m16:36:43.844226 [debug] [Thread-4 (]: On test.dbt_exercise.not_null_fact_orders_sk_customer.6134ecd4cd: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "test.dbt_exercise.not_null_fact_orders_sk_customer.6134ecd4cd"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select sk_customer
from `corded-sunlight-464012-e2`.`dbt_dw_marts`.`fact_orders`
where sk_customer is null



  
  
      
    ) dbt_internal_test
[0m16:36:43.846416 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:36:43.847414 [debug] [Thread-1 (]: On test.dbt_exercise.not_null_fact_orders_sk_employee.cf36d136ff: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "test.dbt_exercise.not_null_fact_orders_sk_employee.cf36d136ff"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select sk_employee
from `corded-sunlight-464012-e2`.`dbt_dw_marts`.`fact_orders`
where sk_employee is null



  
  
      
    ) dbt_internal_test
[0m16:36:43.848850 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:36:43.934483 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:0fd96ba0-dd9d-4611-a672-f2f9e091465c&page=queryresults
[0m16:36:44.751789 [info ] [Thread-2 (]: 11 of 55 PASS not_null_fact_orders_order_id .................................... [[32mPASS[0m in 1.99s]
[0m16:36:44.753807 [debug] [Thread-2 (]: Finished running node test.dbt_exercise.not_null_fact_orders_order_id.6ba6d3f0a0
[0m16:36:44.755025 [debug] [Thread-2 (]: Began running node test.dbt_exercise.not_null_fact_orders_sk_orders.c6a2fa98b5
[0m16:36:44.756604 [info ] [Thread-2 (]: 15 of 55 START test not_null_fact_orders_sk_orders ............................. [RUN]
[0m16:36:44.758382 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_exercise.not_null_fact_orders_order_id.6ba6d3f0a0, now test.dbt_exercise.not_null_fact_orders_sk_orders.c6a2fa98b5)
[0m16:36:44.759587 [debug] [Thread-2 (]: Began compiling node test.dbt_exercise.not_null_fact_orders_sk_orders.c6a2fa98b5
[0m16:36:44.771821 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_exercise.not_null_fact_orders_sk_orders.c6a2fa98b5"
[0m16:36:44.773623 [debug] [Thread-2 (]: Began executing node test.dbt_exercise.not_null_fact_orders_sk_orders.c6a2fa98b5
[0m16:36:44.783312 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_exercise.not_null_fact_orders_sk_orders.c6a2fa98b5"
[0m16:36:44.786023 [debug] [Thread-2 (]: On test.dbt_exercise.not_null_fact_orders_sk_orders.c6a2fa98b5: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "test.dbt_exercise.not_null_fact_orders_sk_orders.c6a2fa98b5"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select sk_orders
from `corded-sunlight-464012-e2`.`dbt_dw_marts`.`fact_orders`
where sk_orders is null



  
  
      
    ) dbt_internal_test
[0m16:36:44.787826 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:36:44.856476 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:7e61907b-aff8-4db7-a787-d90f9ff0a3f7&page=queryresults
[0m16:36:44.931116 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:6017733c-dfba-4e65-a500-a24ca4283a51&page=queryresults
[0m16:36:44.999881 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:30a0ba5e-a7cb-43d7-89a9-5921e3799664&page=queryresults
[0m16:36:45.675849 [info ] [Thread-3 (]: 12 of 55 PASS not_null_fact_orders_product_id .................................. [[32mPASS[0m in 1.98s]
[0m16:36:45.678413 [debug] [Thread-3 (]: Finished running node test.dbt_exercise.not_null_fact_orders_product_id.346126b727
[0m16:36:45.679499 [debug] [Thread-3 (]: Began running node test.dbt_exercise.not_null_fact_orders_sk_product.9e0a112d70
[0m16:36:45.680428 [info ] [Thread-3 (]: 16 of 55 START test not_null_fact_orders_sk_product ............................ [RUN]
[0m16:36:45.681289 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_exercise.not_null_fact_orders_product_id.346126b727, now test.dbt_exercise.not_null_fact_orders_sk_product.9e0a112d70)
[0m16:36:45.681924 [debug] [Thread-3 (]: Began compiling node test.dbt_exercise.not_null_fact_orders_sk_product.9e0a112d70
[0m16:36:45.689957 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_exercise.not_null_fact_orders_sk_product.9e0a112d70"
[0m16:36:45.691290 [debug] [Thread-3 (]: Began executing node test.dbt_exercise.not_null_fact_orders_sk_product.9e0a112d70
[0m16:36:45.695518 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_exercise.not_null_fact_orders_sk_product.9e0a112d70"
[0m16:36:45.697054 [debug] [Thread-3 (]: On test.dbt_exercise.not_null_fact_orders_sk_product.9e0a112d70: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "test.dbt_exercise.not_null_fact_orders_sk_product.9e0a112d70"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select sk_product
from `corded-sunlight-464012-e2`.`dbt_dw_marts`.`fact_orders`
where sk_product is null



  
  
      
    ) dbt_internal_test
[0m16:36:45.698202 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:36:45.747010 [info ] [Thread-1 (]: 14 of 55 PASS not_null_fact_orders_sk_employee ................................. [[32mPASS[0m in 1.95s]
[0m16:36:45.748796 [debug] [Thread-1 (]: Finished running node test.dbt_exercise.not_null_fact_orders_sk_employee.cf36d136ff
[0m16:36:45.749573 [debug] [Thread-1 (]: Began running node test.dbt_exercise.not_null_fact_orders_sk_ship.c82a3b72ed
[0m16:36:45.750797 [info ] [Thread-1 (]: 17 of 55 START test not_null_fact_orders_sk_ship ............................... [RUN]
[0m16:36:45.752549 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_exercise.not_null_fact_orders_sk_employee.cf36d136ff, now test.dbt_exercise.not_null_fact_orders_sk_ship.c82a3b72ed)
[0m16:36:45.753759 [debug] [Thread-1 (]: Began compiling node test.dbt_exercise.not_null_fact_orders_sk_ship.c82a3b72ed
[0m16:36:45.763615 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_exercise.not_null_fact_orders_sk_ship.c82a3b72ed"
[0m16:36:45.765114 [debug] [Thread-1 (]: Began executing node test.dbt_exercise.not_null_fact_orders_sk_ship.c82a3b72ed
[0m16:36:45.770293 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_exercise.not_null_fact_orders_sk_ship.c82a3b72ed"
[0m16:36:45.773167 [debug] [Thread-1 (]: On test.dbt_exercise.not_null_fact_orders_sk_ship.c82a3b72ed: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "test.dbt_exercise.not_null_fact_orders_sk_ship.c82a3b72ed"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select sk_ship
from `corded-sunlight-464012-e2`.`dbt_dw_marts`.`fact_orders`
where sk_ship is null



  
  
      
    ) dbt_internal_test
[0m16:36:45.774941 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:36:45.841658 [info ] [Thread-4 (]: 13 of 55 PASS not_null_fact_orders_sk_customer ................................. [[32mPASS[0m in 2.05s]
[0m16:36:45.843190 [debug] [Thread-4 (]: Finished running node test.dbt_exercise.not_null_fact_orders_sk_customer.6134ecd4cd
[0m16:36:45.844543 [debug] [Thread-4 (]: Began running node test.dbt_exercise.source_accepted_values_northwind_categories_category_name__Beverages__Condiments__Confections__Dairy_Products__Grains_Cereals__Meat_Poultry__Produce__Seafood.ea6d0ab2ae
[0m16:36:45.846149 [info ] [Thread-4 (]: 18 of 55 START test source_accepted_values_northwind_categories_category_name__Beverages__Condiments__Confections__Dairy_Products__Grains_Cereals__Meat_Poultry__Produce__Seafood  [RUN]
[0m16:36:45.847205 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_exercise.not_null_fact_orders_sk_customer.6134ecd4cd, now test.dbt_exercise.source_accepted_values_northwind_categories_category_name__Beverages__Condiments__Confections__Dairy_Products__Grains_Cereals__Meat_Poultry__Produce__Seafood.ea6d0ab2ae)
[0m16:36:45.848010 [debug] [Thread-4 (]: Began compiling node test.dbt_exercise.source_accepted_values_northwind_categories_category_name__Beverages__Condiments__Confections__Dairy_Products__Grains_Cereals__Meat_Poultry__Produce__Seafood.ea6d0ab2ae
[0m16:36:45.864495 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_exercise.source_accepted_values_northwind_categories_category_name__Beverages__Condiments__Confections__Dairy_Products__Grains_Cereals__Meat_Poultry__Produce__Seafood.ea6d0ab2ae"
[0m16:36:45.868424 [debug] [Thread-4 (]: Began executing node test.dbt_exercise.source_accepted_values_northwind_categories_category_name__Beverages__Condiments__Confections__Dairy_Products__Grains_Cereals__Meat_Poultry__Produce__Seafood.ea6d0ab2ae
[0m16:36:45.878804 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_exercise.source_accepted_values_northwind_categories_category_name__Beverages__Condiments__Confections__Dairy_Products__Grains_Cereals__Meat_Poultry__Produce__Seafood.ea6d0ab2ae"
[0m16:36:45.880706 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:0b08820b-4abc-4e09-8ac0-f346d02a2e87&page=queryresults
[0m16:36:45.884730 [debug] [Thread-4 (]: On test.dbt_exercise.source_accepted_values_northwind_categories_category_name__Beverages__Condiments__Confections__Dairy_Products__Grains_Cereals__Meat_Poultry__Produce__Seafood.ea6d0ab2ae: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "test.dbt_exercise.source_accepted_values_northwind_categories_category_name__Beverages__Condiments__Confections__Dairy_Products__Grains_Cereals__Meat_Poultry__Produce__Seafood.ea6d0ab2ae"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        category_name as value_field,
        count(*) as n_records

    from `corded-sunlight-464012-e2`.`dbt_dw_raw`.`categories`
    group by category_name

)

select *
from all_values
where value_field not in (
    'Beverages','Condiments','Confections','Dairy Products','Grains/Cereals','Meat/Poultry','Produce','Seafood'
)



  
  
      
    ) dbt_internal_test
[0m16:36:45.885817 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:36:46.640919 [info ] [Thread-2 (]: 15 of 55 PASS not_null_fact_orders_sk_orders ................................... [[32mPASS[0m in 1.88s]
[0m16:36:46.642346 [debug] [Thread-2 (]: Finished running node test.dbt_exercise.not_null_fact_orders_sk_orders.c6a2fa98b5
[0m16:36:46.643510 [debug] [Thread-2 (]: Began running node test.dbt_exercise.source_not_null_northwind_categories_category_id.9a6df29828
[0m16:36:46.644313 [info ] [Thread-2 (]: 19 of 55 START test source_not_null_northwind_categories_category_id ........... [RUN]
[0m16:36:46.645153 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_exercise.not_null_fact_orders_sk_orders.c6a2fa98b5, now test.dbt_exercise.source_not_null_northwind_categories_category_id.9a6df29828)
[0m16:36:46.645818 [debug] [Thread-2 (]: Began compiling node test.dbt_exercise.source_not_null_northwind_categories_category_id.9a6df29828
[0m16:36:46.653807 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_exercise.source_not_null_northwind_categories_category_id.9a6df29828"
[0m16:36:46.656113 [debug] [Thread-2 (]: Began executing node test.dbt_exercise.source_not_null_northwind_categories_category_id.9a6df29828
[0m16:36:46.662130 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_exercise.source_not_null_northwind_categories_category_id.9a6df29828"
[0m16:36:46.663900 [debug] [Thread-2 (]: On test.dbt_exercise.source_not_null_northwind_categories_category_id.9a6df29828: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "test.dbt_exercise.source_not_null_northwind_categories_category_id.9a6df29828"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select category_id
from `corded-sunlight-464012-e2`.`dbt_dw_raw`.`categories`
where category_id is null



  
  
      
    ) dbt_internal_test
[0m16:36:46.666886 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:36:46.718916 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:82d1e18a-ea0b-4a59-9ed6-b24cc788a49d&page=queryresults
[0m16:36:46.786940 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:7fb47d05-c732-4ca4-96d3-5f7bfe2d8532&page=queryresults
[0m16:36:47.205104 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:f0f45d06-65dc-48cc-99de-a3b893eac720&page=queryresults
[0m16:36:47.502193 [info ] [Thread-3 (]: 16 of 55 PASS not_null_fact_orders_sk_product .................................. [[32mPASS[0m in 1.82s]
[0m16:36:47.503660 [debug] [Thread-3 (]: Finished running node test.dbt_exercise.not_null_fact_orders_sk_product.9e0a112d70
[0m16:36:47.504621 [debug] [Thread-3 (]: Began running node test.dbt_exercise.source_not_null_northwind_country_codes_country_code.c623b5676c
[0m16:36:47.505540 [info ] [Thread-3 (]: 20 of 55 START test source_not_null_northwind_country_codes_country_code ....... [RUN]
[0m16:36:47.506562 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_exercise.not_null_fact_orders_sk_product.9e0a112d70, now test.dbt_exercise.source_not_null_northwind_country_codes_country_code.c623b5676c)
[0m16:36:47.507232 [debug] [Thread-3 (]: Began compiling node test.dbt_exercise.source_not_null_northwind_country_codes_country_code.c623b5676c
[0m16:36:47.516465 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_exercise.source_not_null_northwind_country_codes_country_code.c623b5676c"
[0m16:36:47.518354 [debug] [Thread-3 (]: Began executing node test.dbt_exercise.source_not_null_northwind_country_codes_country_code.c623b5676c
[0m16:36:47.522701 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_exercise.source_not_null_northwind_country_codes_country_code.c623b5676c"
[0m16:36:47.524194 [debug] [Thread-3 (]: On test.dbt_exercise.source_not_null_northwind_country_codes_country_code.c623b5676c: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "test.dbt_exercise.source_not_null_northwind_country_codes_country_code.c623b5676c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select country_code
from `corded-sunlight-464012-e2`.`dbt_dw_raw`.`country_codes`
where country_code is null



  
  
      
    ) dbt_internal_test
[0m16:36:47.525346 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:36:47.580312 [info ] [Thread-1 (]: 17 of 55 PASS not_null_fact_orders_sk_ship ..................................... [[32mPASS[0m in 1.83s]
[0m16:36:47.581600 [debug] [Thread-1 (]: Finished running node test.dbt_exercise.not_null_fact_orders_sk_ship.c82a3b72ed
[0m16:36:47.582415 [debug] [Thread-1 (]: Began running node test.dbt_exercise.source_not_null_northwind_customers_customer_id.dba99593d2
[0m16:36:47.583789 [info ] [Thread-1 (]: 21 of 55 START test source_not_null_northwind_customers_customer_id ............ [RUN]
[0m16:36:47.586111 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_exercise.not_null_fact_orders_sk_ship.c82a3b72ed, now test.dbt_exercise.source_not_null_northwind_customers_customer_id.dba99593d2)
[0m16:36:47.587943 [debug] [Thread-1 (]: Began compiling node test.dbt_exercise.source_not_null_northwind_customers_customer_id.dba99593d2
[0m16:36:47.597670 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_exercise.source_not_null_northwind_customers_customer_id.dba99593d2"
[0m16:36:47.599812 [debug] [Thread-1 (]: Began executing node test.dbt_exercise.source_not_null_northwind_customers_customer_id.dba99593d2
[0m16:36:47.606838 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_exercise.source_not_null_northwind_customers_customer_id.dba99593d2"
[0m16:36:47.609590 [debug] [Thread-1 (]: On test.dbt_exercise.source_not_null_northwind_customers_customer_id.dba99593d2: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "test.dbt_exercise.source_not_null_northwind_customers_customer_id.dba99593d2"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select customer_id
from `corded-sunlight-464012-e2`.`dbt_dw_raw`.`customers`
where customer_id is null



  
  
      
    ) dbt_internal_test
[0m16:36:47.611665 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:36:47.900236 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:fc7c5ad8-002e-4e60-a9bc-11592f922d94&page=queryresults
[0m16:36:47.994942 [info ] [Thread-4 (]: 18 of 55 PASS source_accepted_values_northwind_categories_category_name__Beverages__Condiments__Confections__Dairy_Products__Grains_Cereals__Meat_Poultry__Produce__Seafood  [[32mPASS[0m in 2.15s]
[0m16:36:47.996681 [debug] [Thread-4 (]: Finished running node test.dbt_exercise.source_accepted_values_northwind_categories_category_name__Beverages__Condiments__Confections__Dairy_Products__Grains_Cereals__Meat_Poultry__Produce__Seafood.ea6d0ab2ae
[0m16:36:47.997894 [debug] [Thread-4 (]: Began running node test.dbt_exercise.source_not_null_northwind_dados_financeiros_data.cdd6b46fe7
[0m16:36:47.999495 [info ] [Thread-4 (]: 22 of 55 START test source_not_null_northwind_dados_financeiros_data ........... [RUN]
[0m16:36:48.000645 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_exercise.source_accepted_values_northwind_categories_category_name__Beverages__Condiments__Confections__Dairy_Products__Grains_Cereals__Meat_Poultry__Produce__Seafood.ea6d0ab2ae, now test.dbt_exercise.source_not_null_northwind_dados_financeiros_data.cdd6b46fe7)
[0m16:36:48.001346 [debug] [Thread-4 (]: Began compiling node test.dbt_exercise.source_not_null_northwind_dados_financeiros_data.cdd6b46fe7
[0m16:36:48.014082 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_exercise.source_not_null_northwind_dados_financeiros_data.cdd6b46fe7"
[0m16:36:48.015869 [debug] [Thread-4 (]: Began executing node test.dbt_exercise.source_not_null_northwind_dados_financeiros_data.cdd6b46fe7
[0m16:36:48.026006 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_exercise.source_not_null_northwind_dados_financeiros_data.cdd6b46fe7"
[0m16:36:48.028186 [debug] [Thread-4 (]: On test.dbt_exercise.source_not_null_northwind_dados_financeiros_data.cdd6b46fe7: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "test.dbt_exercise.source_not_null_northwind_dados_financeiros_data.cdd6b46fe7"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select data
from `corded-sunlight-464012-e2`.`dbt_dw_raw`.`dados_financeiros`
where data is null



  
  
      
    ) dbt_internal_test
[0m16:36:48.029285 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:36:48.604439 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:b9575f2c-007d-4321-bd7e-c955aecd3ffb&page=queryresults
[0m16:36:48.664490 [info ] [Thread-2 (]: 19 of 55 PASS source_not_null_northwind_categories_category_id ................. [[32mPASS[0m in 2.02s]
[0m16:36:48.665730 [debug] [Thread-2 (]: Finished running node test.dbt_exercise.source_not_null_northwind_categories_category_id.9a6df29828
[0m16:36:48.666483 [debug] [Thread-2 (]: Began running node test.dbt_exercise.source_not_null_northwind_employee_territories_employee_id.d7372217ec
[0m16:36:48.667353 [info ] [Thread-2 (]: 23 of 55 START test source_not_null_northwind_employee_territories_employee_id . [RUN]
[0m16:36:48.668518 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_exercise.source_not_null_northwind_categories_category_id.9a6df29828, now test.dbt_exercise.source_not_null_northwind_employee_territories_employee_id.d7372217ec)
[0m16:36:48.669292 [debug] [Thread-2 (]: Began compiling node test.dbt_exercise.source_not_null_northwind_employee_territories_employee_id.d7372217ec
[0m16:36:48.677287 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_exercise.source_not_null_northwind_employee_territories_employee_id.d7372217ec"
[0m16:36:48.679912 [debug] [Thread-2 (]: Began executing node test.dbt_exercise.source_not_null_northwind_employee_territories_employee_id.d7372217ec
[0m16:36:48.685810 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_exercise.source_not_null_northwind_employee_territories_employee_id.d7372217ec"
[0m16:36:48.687751 [debug] [Thread-2 (]: On test.dbt_exercise.source_not_null_northwind_employee_territories_employee_id.d7372217ec: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "test.dbt_exercise.source_not_null_northwind_employee_territories_employee_id.d7372217ec"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select employee_id
from `corded-sunlight-464012-e2`.`dbt_dw_raw`.`employee_territories`
where employee_id is null



  
  
      
    ) dbt_internal_test
[0m16:36:48.688916 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:36:48.746672 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:52cecd9a-15bb-4749-b4ca-ce3911ed8d39&page=queryresults
[0m16:36:49.249822 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:df8ba403-c269-4766-82c3-50eb99d24c0c&page=queryresults
[0m16:36:49.387338 [info ] [Thread-3 (]: 20 of 55 PASS source_not_null_northwind_country_codes_country_code ............. [[32mPASS[0m in 1.88s]
[0m16:36:49.389556 [debug] [Thread-3 (]: Finished running node test.dbt_exercise.source_not_null_northwind_country_codes_country_code.c623b5676c
[0m16:36:49.390873 [debug] [Thread-3 (]: Began running node test.dbt_exercise.source_not_null_northwind_employee_territories_territory_id.ae648a0b88
[0m16:36:49.392578 [info ] [Thread-3 (]: 24 of 55 START test source_not_null_northwind_employee_territories_territory_id  [RUN]
[0m16:36:49.394117 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_exercise.source_not_null_northwind_country_codes_country_code.c623b5676c, now test.dbt_exercise.source_not_null_northwind_employee_territories_territory_id.ae648a0b88)
[0m16:36:49.395345 [debug] [Thread-3 (]: Began compiling node test.dbt_exercise.source_not_null_northwind_employee_territories_territory_id.ae648a0b88
[0m16:36:49.411868 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_exercise.source_not_null_northwind_employee_territories_territory_id.ae648a0b88"
[0m16:36:49.413650 [debug] [Thread-3 (]: Began executing node test.dbt_exercise.source_not_null_northwind_employee_territories_territory_id.ae648a0b88
[0m16:36:49.425416 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_exercise.source_not_null_northwind_employee_territories_territory_id.ae648a0b88"
[0m16:36:49.427195 [debug] [Thread-3 (]: On test.dbt_exercise.source_not_null_northwind_employee_territories_territory_id.ae648a0b88: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "test.dbt_exercise.source_not_null_northwind_employee_territories_territory_id.ae648a0b88"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select territory_id
from `corded-sunlight-464012-e2`.`dbt_dw_raw`.`employee_territories`
where territory_id is null



  
  
      
    ) dbt_internal_test
[0m16:36:49.428141 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:36:49.529457 [info ] [Thread-1 (]: 21 of 55 PASS source_not_null_northwind_customers_customer_id .................. [[32mPASS[0m in 1.94s]
[0m16:36:49.530595 [debug] [Thread-1 (]: Finished running node test.dbt_exercise.source_not_null_northwind_customers_customer_id.dba99593d2
[0m16:36:49.531515 [debug] [Thread-1 (]: Began running node test.dbt_exercise.source_not_null_northwind_employees_employee_id.829479a08c
[0m16:36:49.532342 [info ] [Thread-1 (]: 25 of 55 START test source_not_null_northwind_employees_employee_id ............ [RUN]
[0m16:36:49.533466 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_exercise.source_not_null_northwind_customers_customer_id.dba99593d2, now test.dbt_exercise.source_not_null_northwind_employees_employee_id.829479a08c)
[0m16:36:49.534523 [debug] [Thread-1 (]: Began compiling node test.dbt_exercise.source_not_null_northwind_employees_employee_id.829479a08c
[0m16:36:49.543934 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_exercise.source_not_null_northwind_employees_employee_id.829479a08c"
[0m16:36:49.545800 [debug] [Thread-1 (]: Began executing node test.dbt_exercise.source_not_null_northwind_employees_employee_id.829479a08c
[0m16:36:49.550664 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_exercise.source_not_null_northwind_employees_employee_id.829479a08c"
[0m16:36:49.553019 [debug] [Thread-1 (]: On test.dbt_exercise.source_not_null_northwind_employees_employee_id.829479a08c: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "test.dbt_exercise.source_not_null_northwind_employees_employee_id.829479a08c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select employee_id
from `corded-sunlight-464012-e2`.`dbt_dw_raw`.`employees`
where employee_id is null



  
  
      
    ) dbt_internal_test
[0m16:36:49.554713 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:36:50.089954 [info ] [Thread-4 (]: 22 of 55 PASS source_not_null_northwind_dados_financeiros_data ................. [[32mPASS[0m in 2.09s]
[0m16:36:50.091738 [debug] [Thread-4 (]: Finished running node test.dbt_exercise.source_not_null_northwind_dados_financeiros_data.cdd6b46fe7
[0m16:36:50.092496 [debug] [Thread-4 (]: Began running node test.dbt_exercise.source_not_null_northwind_order_details_order_id.8acd43693e
[0m16:36:50.093325 [info ] [Thread-4 (]: 26 of 55 START test source_not_null_northwind_order_details_order_id ........... [RUN]
[0m16:36:50.094197 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_exercise.source_not_null_northwind_dados_financeiros_data.cdd6b46fe7, now test.dbt_exercise.source_not_null_northwind_order_details_order_id.8acd43693e)
[0m16:36:50.095134 [debug] [Thread-4 (]: Began compiling node test.dbt_exercise.source_not_null_northwind_order_details_order_id.8acd43693e
[0m16:36:50.105985 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_exercise.source_not_null_northwind_order_details_order_id.8acd43693e"
[0m16:36:50.107938 [debug] [Thread-4 (]: Began executing node test.dbt_exercise.source_not_null_northwind_order_details_order_id.8acd43693e
[0m16:36:50.112518 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_exercise.source_not_null_northwind_order_details_order_id.8acd43693e"
[0m16:36:50.118725 [debug] [Thread-4 (]: On test.dbt_exercise.source_not_null_northwind_order_details_order_id.8acd43693e: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "test.dbt_exercise.source_not_null_northwind_order_details_order_id.8acd43693e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select order_id
from `corded-sunlight-464012-e2`.`dbt_dw_raw`.`order_details`
where order_id is null



  
  
      
    ) dbt_internal_test
[0m16:36:50.120655 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:36:50.168355 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:130d4218-a0cf-421b-862a-f53a6b1b8230&page=queryresults
[0m16:36:50.546683 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:205a4238-725d-4de4-86a0-11b7daf9d337&page=queryresults
[0m16:36:50.737640 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:502b8425-bef2-4987-b2bd-81232d1f3d6d&page=queryresults
[0m16:36:50.931139 [info ] [Thread-2 (]: 23 of 55 PASS source_not_null_northwind_employee_territories_employee_id ....... [[32mPASS[0m in 2.26s]
[0m16:36:50.932751 [debug] [Thread-2 (]: Finished running node test.dbt_exercise.source_not_null_northwind_employee_territories_employee_id.d7372217ec
[0m16:36:50.933535 [debug] [Thread-2 (]: Began running node test.dbt_exercise.source_not_null_northwind_order_details_product_id.c084f7ad12
[0m16:36:50.934430 [info ] [Thread-2 (]: 27 of 55 START test source_not_null_northwind_order_details_product_id ......... [RUN]
[0m16:36:50.935379 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_exercise.source_not_null_northwind_employee_territories_employee_id.d7372217ec, now test.dbt_exercise.source_not_null_northwind_order_details_product_id.c084f7ad12)
[0m16:36:50.936159 [debug] [Thread-2 (]: Began compiling node test.dbt_exercise.source_not_null_northwind_order_details_product_id.c084f7ad12
[0m16:36:50.950597 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_exercise.source_not_null_northwind_order_details_product_id.c084f7ad12"
[0m16:36:50.954366 [debug] [Thread-2 (]: Began executing node test.dbt_exercise.source_not_null_northwind_order_details_product_id.c084f7ad12
[0m16:36:50.959661 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_exercise.source_not_null_northwind_order_details_product_id.c084f7ad12"
[0m16:36:50.961067 [debug] [Thread-2 (]: On test.dbt_exercise.source_not_null_northwind_order_details_product_id.c084f7ad12: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "test.dbt_exercise.source_not_null_northwind_order_details_product_id.c084f7ad12"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select product_id
from `corded-sunlight-464012-e2`.`dbt_dw_raw`.`order_details`
where product_id is null



  
  
      
    ) dbt_internal_test
[0m16:36:50.962326 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:36:51.219520 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:95104690-9b70-45fb-872b-67a257c9840b&page=queryresults
[0m16:36:51.318199 [info ] [Thread-3 (]: 24 of 55 PASS source_not_null_northwind_employee_territories_territory_id ...... [[32mPASS[0m in 1.92s]
[0m16:36:51.319822 [debug] [Thread-3 (]: Finished running node test.dbt_exercise.source_not_null_northwind_employee_territories_territory_id.ae648a0b88
[0m16:36:51.320676 [debug] [Thread-3 (]: Began running node test.dbt_exercise.source_not_null_northwind_orders_customer_id.3e09955b24
[0m16:36:51.321620 [info ] [Thread-3 (]: 28 of 55 START test source_not_null_northwind_orders_customer_id ............... [RUN]
[0m16:36:51.322707 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_exercise.source_not_null_northwind_employee_territories_territory_id.ae648a0b88, now test.dbt_exercise.source_not_null_northwind_orders_customer_id.3e09955b24)
[0m16:36:51.323674 [debug] [Thread-3 (]: Began compiling node test.dbt_exercise.source_not_null_northwind_orders_customer_id.3e09955b24
[0m16:36:51.333418 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_exercise.source_not_null_northwind_orders_customer_id.3e09955b24"
[0m16:36:51.335256 [debug] [Thread-3 (]: Began executing node test.dbt_exercise.source_not_null_northwind_orders_customer_id.3e09955b24
[0m16:36:51.341648 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_exercise.source_not_null_northwind_orders_customer_id.3e09955b24"
[0m16:36:51.344031 [debug] [Thread-3 (]: On test.dbt_exercise.source_not_null_northwind_orders_customer_id.3e09955b24: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "test.dbt_exercise.source_not_null_northwind_orders_customer_id.3e09955b24"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select customer_id
from `corded-sunlight-464012-e2`.`dbt_dw_raw`.`orders`
where customer_id is null



  
  
      
    ) dbt_internal_test
[0m16:36:51.345921 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:36:51.514812 [info ] [Thread-1 (]: 25 of 55 PASS source_not_null_northwind_employees_employee_id .................. [[32mPASS[0m in 1.98s]
[0m16:36:51.516327 [debug] [Thread-1 (]: Finished running node test.dbt_exercise.source_not_null_northwind_employees_employee_id.829479a08c
[0m16:36:51.517064 [debug] [Thread-1 (]: Began running node test.dbt_exercise.source_not_null_northwind_orders_employee_id.a8f4bf5ca3
[0m16:36:51.517951 [info ] [Thread-1 (]: 29 of 55 START test source_not_null_northwind_orders_employee_id ............... [RUN]
[0m16:36:51.518881 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_exercise.source_not_null_northwind_employees_employee_id.829479a08c, now test.dbt_exercise.source_not_null_northwind_orders_employee_id.a8f4bf5ca3)
[0m16:36:51.519882 [debug] [Thread-1 (]: Began compiling node test.dbt_exercise.source_not_null_northwind_orders_employee_id.a8f4bf5ca3
[0m16:36:51.527770 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_exercise.source_not_null_northwind_orders_employee_id.a8f4bf5ca3"
[0m16:36:51.529562 [debug] [Thread-1 (]: Began executing node test.dbt_exercise.source_not_null_northwind_orders_employee_id.a8f4bf5ca3
[0m16:36:51.535049 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_exercise.source_not_null_northwind_orders_employee_id.a8f4bf5ca3"
[0m16:36:51.536900 [debug] [Thread-1 (]: On test.dbt_exercise.source_not_null_northwind_orders_employee_id.a8f4bf5ca3: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "test.dbt_exercise.source_not_null_northwind_orders_employee_id.a8f4bf5ca3"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select employee_id
from `corded-sunlight-464012-e2`.`dbt_dw_raw`.`orders`
where employee_id is null



  
  
      
    ) dbt_internal_test
[0m16:36:51.538391 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:36:51.971917 [info ] [Thread-4 (]: 26 of 55 PASS source_not_null_northwind_order_details_order_id ................. [[32mPASS[0m in 1.88s]
[0m16:36:51.973350 [debug] [Thread-4 (]: Finished running node test.dbt_exercise.source_not_null_northwind_order_details_order_id.8acd43693e
[0m16:36:51.974110 [debug] [Thread-4 (]: Began running node test.dbt_exercise.source_not_null_northwind_orders_order_id.5a7c008c6e
[0m16:36:51.974856 [info ] [Thread-4 (]: 30 of 55 START test source_not_null_northwind_orders_order_id .................. [RUN]
[0m16:36:51.975835 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_exercise.source_not_null_northwind_order_details_order_id.8acd43693e, now test.dbt_exercise.source_not_null_northwind_orders_order_id.5a7c008c6e)
[0m16:36:51.976621 [debug] [Thread-4 (]: Began compiling node test.dbt_exercise.source_not_null_northwind_orders_order_id.5a7c008c6e
[0m16:36:51.985468 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_exercise.source_not_null_northwind_orders_order_id.5a7c008c6e"
[0m16:36:51.987123 [debug] [Thread-4 (]: Began executing node test.dbt_exercise.source_not_null_northwind_orders_order_id.5a7c008c6e
[0m16:36:51.992581 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_exercise.source_not_null_northwind_orders_order_id.5a7c008c6e"
[0m16:36:51.994465 [debug] [Thread-4 (]: On test.dbt_exercise.source_not_null_northwind_orders_order_id.5a7c008c6e: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "test.dbt_exercise.source_not_null_northwind_orders_order_id.5a7c008c6e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select order_id
from `corded-sunlight-464012-e2`.`dbt_dw_raw`.`orders`
where order_id is null



  
  
      
    ) dbt_internal_test
[0m16:36:51.996162 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:36:52.052753 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:68dfe1c5-a8c8-4ca6-bcfd-30b40810b748&page=queryresults
[0m16:36:52.389039 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:4264bb83-3b8a-4db3-9f0c-fbb5bf00ffb1&page=queryresults
[0m16:36:52.521804 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:2fe88db5-da71-49c7-9fa0-cea0d09c16b9&page=queryresults
[0m16:36:52.842376 [info ] [Thread-2 (]: 27 of 55 PASS source_not_null_northwind_order_details_product_id ............... [[32mPASS[0m in 1.91s]
[0m16:36:52.843950 [debug] [Thread-2 (]: Finished running node test.dbt_exercise.source_not_null_northwind_order_details_product_id.c084f7ad12
[0m16:36:52.844868 [debug] [Thread-2 (]: Began running node test.dbt_exercise.source_not_null_northwind_products_product_id.1bc1aa1d1c
[0m16:36:52.845760 [info ] [Thread-2 (]: 31 of 55 START test source_not_null_northwind_products_product_id .............. [RUN]
[0m16:36:52.846707 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_exercise.source_not_null_northwind_order_details_product_id.c084f7ad12, now test.dbt_exercise.source_not_null_northwind_products_product_id.1bc1aa1d1c)
[0m16:36:52.847523 [debug] [Thread-2 (]: Began compiling node test.dbt_exercise.source_not_null_northwind_products_product_id.1bc1aa1d1c
[0m16:36:52.860124 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_exercise.source_not_null_northwind_products_product_id.1bc1aa1d1c"
[0m16:36:52.861786 [debug] [Thread-2 (]: Began executing node test.dbt_exercise.source_not_null_northwind_products_product_id.1bc1aa1d1c
[0m16:36:52.867245 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_exercise.source_not_null_northwind_products_product_id.1bc1aa1d1c"
[0m16:36:52.869108 [debug] [Thread-2 (]: On test.dbt_exercise.source_not_null_northwind_products_product_id.1bc1aa1d1c: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "test.dbt_exercise.source_not_null_northwind_products_product_id.1bc1aa1d1c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select product_id
from `corded-sunlight-464012-e2`.`dbt_dw_raw`.`products`
where product_id is null



  
  
      
    ) dbt_internal_test
[0m16:36:52.870541 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:36:52.962087 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:be883242-c2c7-445b-9ba9-f907e19092d5&page=queryresults
[0m16:36:53.219297 [info ] [Thread-3 (]: 28 of 55 PASS source_not_null_northwind_orders_customer_id ..................... [[32mPASS[0m in 1.90s]
[0m16:36:53.220829 [debug] [Thread-3 (]: Finished running node test.dbt_exercise.source_not_null_northwind_orders_customer_id.3e09955b24
[0m16:36:53.221599 [debug] [Thread-3 (]: Began running node test.dbt_exercise.source_not_null_northwind_region_region_id.c95367d9e3
[0m16:36:53.222594 [info ] [Thread-3 (]: 32 of 55 START test source_not_null_northwind_region_region_id ................. [RUN]
[0m16:36:53.223740 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_exercise.source_not_null_northwind_orders_customer_id.3e09955b24, now test.dbt_exercise.source_not_null_northwind_region_region_id.c95367d9e3)
[0m16:36:53.224504 [debug] [Thread-3 (]: Began compiling node test.dbt_exercise.source_not_null_northwind_region_region_id.c95367d9e3
[0m16:36:53.233879 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_exercise.source_not_null_northwind_region_region_id.c95367d9e3"
[0m16:36:53.235876 [debug] [Thread-3 (]: Began executing node test.dbt_exercise.source_not_null_northwind_region_region_id.c95367d9e3
[0m16:36:53.240025 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_exercise.source_not_null_northwind_region_region_id.c95367d9e3"
[0m16:36:53.241878 [debug] [Thread-3 (]: On test.dbt_exercise.source_not_null_northwind_region_region_id.c95367d9e3: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "test.dbt_exercise.source_not_null_northwind_region_region_id.c95367d9e3"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select region_id
from `corded-sunlight-464012-e2`.`dbt_dw_raw`.`region`
where region_id is null



  
  
      
    ) dbt_internal_test
[0m16:36:53.243297 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:36:53.303254 [info ] [Thread-1 (]: 29 of 55 PASS source_not_null_northwind_orders_employee_id ..................... [[32mPASS[0m in 1.78s]
[0m16:36:53.304546 [debug] [Thread-1 (]: Finished running node test.dbt_exercise.source_not_null_northwind_orders_employee_id.a8f4bf5ca3
[0m16:36:53.305311 [debug] [Thread-1 (]: Began running node test.dbt_exercise.source_not_null_northwind_shippers_shipper_id.45221752ca
[0m16:36:53.306104 [info ] [Thread-1 (]: 33 of 55 START test source_not_null_northwind_shippers_shipper_id .............. [RUN]
[0m16:36:53.306882 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_exercise.source_not_null_northwind_orders_employee_id.a8f4bf5ca3, now test.dbt_exercise.source_not_null_northwind_shippers_shipper_id.45221752ca)
[0m16:36:53.307581 [debug] [Thread-1 (]: Began compiling node test.dbt_exercise.source_not_null_northwind_shippers_shipper_id.45221752ca
[0m16:36:53.315779 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_exercise.source_not_null_northwind_shippers_shipper_id.45221752ca"
[0m16:36:53.317454 [debug] [Thread-1 (]: Began executing node test.dbt_exercise.source_not_null_northwind_shippers_shipper_id.45221752ca
[0m16:36:53.323132 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_exercise.source_not_null_northwind_shippers_shipper_id.45221752ca"
[0m16:36:53.325234 [debug] [Thread-1 (]: On test.dbt_exercise.source_not_null_northwind_shippers_shipper_id.45221752ca: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "test.dbt_exercise.source_not_null_northwind_shippers_shipper_id.45221752ca"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select shipper_id
from `corded-sunlight-464012-e2`.`dbt_dw_raw`.`shippers`
where shipper_id is null



  
  
      
    ) dbt_internal_test
[0m16:36:53.327305 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:36:53.806134 [info ] [Thread-4 (]: 30 of 55 PASS source_not_null_northwind_orders_order_id ........................ [[32mPASS[0m in 1.83s]
[0m16:36:53.807610 [debug] [Thread-4 (]: Finished running node test.dbt_exercise.source_not_null_northwind_orders_order_id.5a7c008c6e
[0m16:36:53.808495 [debug] [Thread-4 (]: Began running node test.dbt_exercise.source_not_null_northwind_suppliers_supplier_id.de5c4d0062
[0m16:36:53.809690 [info ] [Thread-4 (]: 34 of 55 START test source_not_null_northwind_suppliers_supplier_id ............ [RUN]
[0m16:36:53.810690 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_exercise.source_not_null_northwind_orders_order_id.5a7c008c6e, now test.dbt_exercise.source_not_null_northwind_suppliers_supplier_id.de5c4d0062)
[0m16:36:53.811600 [debug] [Thread-4 (]: Began compiling node test.dbt_exercise.source_not_null_northwind_suppliers_supplier_id.de5c4d0062
[0m16:36:53.820396 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_exercise.source_not_null_northwind_suppliers_supplier_id.de5c4d0062"
[0m16:36:53.822034 [debug] [Thread-4 (]: Began executing node test.dbt_exercise.source_not_null_northwind_suppliers_supplier_id.de5c4d0062
[0m16:36:53.827993 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_exercise.source_not_null_northwind_suppliers_supplier_id.de5c4d0062"
[0m16:36:53.831077 [debug] [Thread-4 (]: On test.dbt_exercise.source_not_null_northwind_suppliers_supplier_id.de5c4d0062: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "test.dbt_exercise.source_not_null_northwind_suppliers_supplier_id.de5c4d0062"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select supplier_id
from `corded-sunlight-464012-e2`.`dbt_dw_raw`.`suppliers`
where supplier_id is null



  
  
      
    ) dbt_internal_test
[0m16:36:53.832142 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:36:54.002588 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:1bc3a8bc-5e87-4543-b447-0cdf09aca6a1&page=queryresults
[0m16:36:54.230567 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:c9715b3f-c901-498f-91cf-0b8d1e74b0dc&page=queryresults
[0m16:36:54.402567 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:0b19b75a-52b6-4f00-b44e-e8b4dc78adba&page=queryresults
[0m16:36:54.809035 [info ] [Thread-2 (]: 31 of 55 PASS source_not_null_northwind_products_product_id .................... [[32mPASS[0m in 1.96s]
[0m16:36:54.810326 [debug] [Thread-2 (]: Finished running node test.dbt_exercise.source_not_null_northwind_products_product_id.1bc1aa1d1c
[0m16:36:54.811175 [debug] [Thread-2 (]: Began running node test.dbt_exercise.source_not_null_northwind_territories_region_id.5df71bcf81
[0m16:36:54.812183 [info ] [Thread-2 (]: 35 of 55 START test source_not_null_northwind_territories_region_id ............ [RUN]
[0m16:36:54.813230 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_exercise.source_not_null_northwind_products_product_id.1bc1aa1d1c, now test.dbt_exercise.source_not_null_northwind_territories_region_id.5df71bcf81)
[0m16:36:54.813955 [debug] [Thread-2 (]: Began compiling node test.dbt_exercise.source_not_null_northwind_territories_region_id.5df71bcf81
[0m16:36:54.824929 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_exercise.source_not_null_northwind_territories_region_id.5df71bcf81"
[0m16:36:54.826963 [debug] [Thread-2 (]: Began executing node test.dbt_exercise.source_not_null_northwind_territories_region_id.5df71bcf81
[0m16:36:54.839670 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_exercise.source_not_null_northwind_territories_region_id.5df71bcf81"
[0m16:36:54.842164 [debug] [Thread-2 (]: On test.dbt_exercise.source_not_null_northwind_territories_region_id.5df71bcf81: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "test.dbt_exercise.source_not_null_northwind_territories_region_id.5df71bcf81"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select region_id
from `corded-sunlight-464012-e2`.`dbt_dw_raw`.`territories`
where region_id is null



  
  
      
    ) dbt_internal_test
[0m16:36:54.843237 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:36:54.900255 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:d441fcfc-b2bd-41b4-8b6f-7bd0c9cbcd2f&page=queryresults
[0m16:36:55.162717 [info ] [Thread-1 (]: 33 of 55 PASS source_not_null_northwind_shippers_shipper_id .................... [[32mPASS[0m in 1.86s]
[0m16:36:55.164414 [debug] [Thread-1 (]: Finished running node test.dbt_exercise.source_not_null_northwind_shippers_shipper_id.45221752ca
[0m16:36:55.165183 [debug] [Thread-1 (]: Began running node test.dbt_exercise.source_not_null_northwind_territories_territory_id.9b9655b8a9
[0m16:36:55.166043 [info ] [Thread-1 (]: 36 of 55 START test source_not_null_northwind_territories_territory_id ......... [RUN]
[0m16:36:55.167015 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_exercise.source_not_null_northwind_shippers_shipper_id.45221752ca, now test.dbt_exercise.source_not_null_northwind_territories_territory_id.9b9655b8a9)
[0m16:36:55.167754 [debug] [Thread-1 (]: Began compiling node test.dbt_exercise.source_not_null_northwind_territories_territory_id.9b9655b8a9
[0m16:36:55.177763 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_exercise.source_not_null_northwind_territories_territory_id.9b9655b8a9"
[0m16:36:55.188545 [info ] [Thread-3 (]: 32 of 55 PASS source_not_null_northwind_region_region_id ....................... [[32mPASS[0m in 1.96s]
[0m16:36:55.191646 [debug] [Thread-3 (]: Finished running node test.dbt_exercise.source_not_null_northwind_region_region_id.c95367d9e3
[0m16:36:55.193249 [debug] [Thread-1 (]: Began executing node test.dbt_exercise.source_not_null_northwind_territories_territory_id.9b9655b8a9
[0m16:36:55.194577 [debug] [Thread-3 (]: Began running node test.dbt_exercise.source_not_null_northwind_us_states_state_id.2e33a23d78
[0m16:36:55.204909 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_exercise.source_not_null_northwind_territories_territory_id.9b9655b8a9"
[0m16:36:55.206564 [info ] [Thread-3 (]: 37 of 55 START test source_not_null_northwind_us_states_state_id ............... [RUN]
[0m16:36:55.209478 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_exercise.source_not_null_northwind_region_region_id.c95367d9e3, now test.dbt_exercise.source_not_null_northwind_us_states_state_id.2e33a23d78)
[0m16:36:55.211036 [debug] [Thread-3 (]: Began compiling node test.dbt_exercise.source_not_null_northwind_us_states_state_id.2e33a23d78
[0m16:36:55.219223 [debug] [Thread-1 (]: On test.dbt_exercise.source_not_null_northwind_territories_territory_id.9b9655b8a9: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "test.dbt_exercise.source_not_null_northwind_territories_territory_id.9b9655b8a9"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select territory_id
from `corded-sunlight-464012-e2`.`dbt_dw_raw`.`territories`
where territory_id is null



  
  
      
    ) dbt_internal_test
[0m16:36:55.220999 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:36:55.232097 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_exercise.source_not_null_northwind_us_states_state_id.2e33a23d78"
[0m16:36:55.234384 [debug] [Thread-3 (]: Began executing node test.dbt_exercise.source_not_null_northwind_us_states_state_id.2e33a23d78
[0m16:36:55.241464 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_exercise.source_not_null_northwind_us_states_state_id.2e33a23d78"
[0m16:36:55.243098 [debug] [Thread-3 (]: On test.dbt_exercise.source_not_null_northwind_us_states_state_id.2e33a23d78: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "test.dbt_exercise.source_not_null_northwind_us_states_state_id.2e33a23d78"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select state_id
from `corded-sunlight-464012-e2`.`dbt_dw_raw`.`us_states`
where state_id is null



  
  
      
    ) dbt_internal_test
[0m16:36:55.244686 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:36:55.690040 [info ] [Thread-4 (]: 34 of 55 PASS source_not_null_northwind_suppliers_supplier_id .................. [[32mPASS[0m in 1.88s]
[0m16:36:55.691294 [debug] [Thread-4 (]: Finished running node test.dbt_exercise.source_not_null_northwind_suppliers_supplier_id.de5c4d0062
[0m16:36:55.692201 [debug] [Thread-4 (]: Began running node test.dbt_exercise.source_unique_northwind_categories_category_id.17d9baa2e0
[0m16:36:55.693178 [info ] [Thread-4 (]: 38 of 55 START test source_unique_northwind_categories_category_id ............. [RUN]
[0m16:36:55.694119 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_exercise.source_not_null_northwind_suppliers_supplier_id.de5c4d0062, now test.dbt_exercise.source_unique_northwind_categories_category_id.17d9baa2e0)
[0m16:36:55.694887 [debug] [Thread-4 (]: Began compiling node test.dbt_exercise.source_unique_northwind_categories_category_id.17d9baa2e0
[0m16:36:55.706408 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_exercise.source_unique_northwind_categories_category_id.17d9baa2e0"
[0m16:36:55.707811 [debug] [Thread-4 (]: Began executing node test.dbt_exercise.source_unique_northwind_categories_category_id.17d9baa2e0
[0m16:36:55.713424 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_exercise.source_unique_northwind_categories_category_id.17d9baa2e0"
[0m16:36:55.716621 [debug] [Thread-4 (]: On test.dbt_exercise.source_unique_northwind_categories_category_id.17d9baa2e0: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "test.dbt_exercise.source_unique_northwind_categories_category_id.17d9baa2e0"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with dbt_test__target as (

  select category_id as unique_field
  from `corded-sunlight-464012-e2`.`dbt_dw_raw`.`categories`
  where category_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m16:36:55.717758 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:36:56.113156 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:d905753b-283e-4741-857e-dc4dd0fc9b1e&page=queryresults
[0m16:36:56.262012 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:d74815b9-a870-4708-8c5f-2aeffd640151&page=queryresults
[0m16:36:56.374689 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:d05209a2-07ca-4bae-a323-9f01a72adbac&page=queryresults
[0m16:36:56.929315 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:1b444c06-d1e9-446f-bf79-486d4bbc8ab6&page=queryresults
[0m16:36:57.021184 [info ] [Thread-2 (]: 35 of 55 PASS source_not_null_northwind_territories_region_id .................. [[32mPASS[0m in 2.21s]
[0m16:36:57.022505 [debug] [Thread-2 (]: Finished running node test.dbt_exercise.source_not_null_northwind_territories_region_id.5df71bcf81
[0m16:36:57.023352 [debug] [Thread-2 (]: Began running node test.dbt_exercise.source_unique_northwind_country_codes_country_code.cf83d0431e
[0m16:36:57.024341 [info ] [Thread-2 (]: 39 of 55 START test source_unique_northwind_country_codes_country_code ......... [RUN]
[0m16:36:57.025334 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_exercise.source_not_null_northwind_territories_region_id.5df71bcf81, now test.dbt_exercise.source_unique_northwind_country_codes_country_code.cf83d0431e)
[0m16:36:57.026082 [debug] [Thread-2 (]: Began compiling node test.dbt_exercise.source_unique_northwind_country_codes_country_code.cf83d0431e
[0m16:36:57.036514 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_exercise.source_unique_northwind_country_codes_country_code.cf83d0431e"
[0m16:36:57.038782 [debug] [Thread-2 (]: Began executing node test.dbt_exercise.source_unique_northwind_country_codes_country_code.cf83d0431e
[0m16:36:57.052127 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_exercise.source_unique_northwind_country_codes_country_code.cf83d0431e"
[0m16:36:57.053583 [debug] [Thread-2 (]: On test.dbt_exercise.source_unique_northwind_country_codes_country_code.cf83d0431e: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "test.dbt_exercise.source_unique_northwind_country_codes_country_code.cf83d0431e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with dbt_test__target as (

  select country_code as unique_field
  from `corded-sunlight-464012-e2`.`dbt_dw_raw`.`country_codes`
  where country_code is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m16:36:57.054354 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:36:57.102739 [info ] [Thread-3 (]: 37 of 55 PASS source_not_null_northwind_us_states_state_id ..................... [[32mPASS[0m in 1.89s]
[0m16:36:57.104347 [debug] [Thread-3 (]: Finished running node test.dbt_exercise.source_not_null_northwind_us_states_state_id.2e33a23d78
[0m16:36:57.105623 [debug] [Thread-3 (]: Began running node test.dbt_exercise.source_unique_northwind_customers_customer_id.ff818c137b
[0m16:36:57.107101 [info ] [Thread-3 (]: 40 of 55 START test source_unique_northwind_customers_customer_id .............. [RUN]
[0m16:36:57.108706 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_exercise.source_not_null_northwind_us_states_state_id.2e33a23d78, now test.dbt_exercise.source_unique_northwind_customers_customer_id.ff818c137b)
[0m16:36:57.109553 [debug] [Thread-3 (]: Began compiling node test.dbt_exercise.source_unique_northwind_customers_customer_id.ff818c137b
[0m16:36:57.118281 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_exercise.source_unique_northwind_customers_customer_id.ff818c137b"
[0m16:36:57.120476 [debug] [Thread-3 (]: Began executing node test.dbt_exercise.source_unique_northwind_customers_customer_id.ff818c137b
[0m16:36:57.124986 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_exercise.source_unique_northwind_customers_customer_id.ff818c137b"
[0m16:36:57.127745 [debug] [Thread-3 (]: On test.dbt_exercise.source_unique_northwind_customers_customer_id.ff818c137b: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "test.dbt_exercise.source_unique_northwind_customers_customer_id.ff818c137b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with dbt_test__target as (

  select customer_id as unique_field
  from `corded-sunlight-464012-e2`.`dbt_dw_raw`.`customers`
  where customer_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m16:36:57.129127 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:36:57.184284 [info ] [Thread-1 (]: 36 of 55 PASS source_not_null_northwind_territories_territory_id ............... [[32mPASS[0m in 2.02s]
[0m16:36:57.185641 [debug] [Thread-1 (]: Finished running node test.dbt_exercise.source_not_null_northwind_territories_territory_id.9b9655b8a9
[0m16:36:57.186494 [debug] [Thread-1 (]: Began running node test.dbt_exercise.source_unique_northwind_employees_employee_id.e63c624594
[0m16:36:57.187472 [info ] [Thread-1 (]: 41 of 55 START test source_unique_northwind_employees_employee_id .............. [RUN]
[0m16:36:57.188544 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_exercise.source_not_null_northwind_territories_territory_id.9b9655b8a9, now test.dbt_exercise.source_unique_northwind_employees_employee_id.e63c624594)
[0m16:36:57.189489 [debug] [Thread-1 (]: Began compiling node test.dbt_exercise.source_unique_northwind_employees_employee_id.e63c624594
[0m16:36:57.200830 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_exercise.source_unique_northwind_employees_employee_id.e63c624594"
[0m16:36:57.206799 [debug] [Thread-1 (]: Began executing node test.dbt_exercise.source_unique_northwind_employees_employee_id.e63c624594
[0m16:36:57.212329 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_exercise.source_unique_northwind_employees_employee_id.e63c624594"
[0m16:36:57.214453 [debug] [Thread-1 (]: On test.dbt_exercise.source_unique_northwind_employees_employee_id.e63c624594: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "test.dbt_exercise.source_unique_northwind_employees_employee_id.e63c624594"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with dbt_test__target as (

  select employee_id as unique_field
  from `corded-sunlight-464012-e2`.`dbt_dw_raw`.`employees`
  where employee_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m16:36:57.216333 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:36:57.712139 [info ] [Thread-4 (]: 38 of 55 PASS source_unique_northwind_categories_category_id ................... [[32mPASS[0m in 2.02s]
[0m16:36:57.713502 [debug] [Thread-4 (]: Finished running node test.dbt_exercise.source_unique_northwind_categories_category_id.17d9baa2e0
[0m16:36:57.714333 [debug] [Thread-4 (]: Began running node test.dbt_exercise.source_unique_northwind_orders_order_id.4a8a4df128
[0m16:36:57.715234 [info ] [Thread-4 (]: 42 of 55 START test source_unique_northwind_orders_order_id .................... [RUN]
[0m16:36:57.716270 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_exercise.source_unique_northwind_categories_category_id.17d9baa2e0, now test.dbt_exercise.source_unique_northwind_orders_order_id.4a8a4df128)
[0m16:36:57.717060 [debug] [Thread-4 (]: Began compiling node test.dbt_exercise.source_unique_northwind_orders_order_id.4a8a4df128
[0m16:36:57.725742 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_exercise.source_unique_northwind_orders_order_id.4a8a4df128"
[0m16:36:57.727915 [debug] [Thread-4 (]: Began executing node test.dbt_exercise.source_unique_northwind_orders_order_id.4a8a4df128
[0m16:36:57.734301 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_exercise.source_unique_northwind_orders_order_id.4a8a4df128"
[0m16:36:57.745297 [debug] [Thread-4 (]: On test.dbt_exercise.source_unique_northwind_orders_order_id.4a8a4df128: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "test.dbt_exercise.source_unique_northwind_orders_order_id.4a8a4df128"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with dbt_test__target as (

  select order_id as unique_field
  from `corded-sunlight-464012-e2`.`dbt_dw_raw`.`orders`
  where order_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m16:36:57.746660 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:36:58.233534 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:ccebd33b-113b-4821-8b91-67e8474f1062&page=queryresults
[0m16:36:58.267291 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:b8bde147-f446-42fa-92b8-d5eee5dcec68&page=queryresults
[0m16:36:58.451217 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:5227f9a3-2c03-4df4-8cb0-ba3b573de00a&page=queryresults
[0m16:36:59.014230 [info ] [Thread-2 (]: 39 of 55 PASS source_unique_northwind_country_codes_country_code ............... [[32mPASS[0m in 1.99s]
[0m16:36:59.016009 [debug] [Thread-2 (]: Finished running node test.dbt_exercise.source_unique_northwind_country_codes_country_code.cf83d0431e
[0m16:36:59.017061 [debug] [Thread-2 (]: Began running node test.dbt_exercise.source_unique_northwind_products_product_id.740bf6f9a5
[0m16:36:59.018188 [info ] [Thread-2 (]: 43 of 55 START test source_unique_northwind_products_product_id ................ [RUN]
[0m16:36:59.019852 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_exercise.source_unique_northwind_country_codes_country_code.cf83d0431e, now test.dbt_exercise.source_unique_northwind_products_product_id.740bf6f9a5)
[0m16:36:59.026639 [debug] [Thread-2 (]: Began compiling node test.dbt_exercise.source_unique_northwind_products_product_id.740bf6f9a5
[0m16:36:59.039791 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_exercise.source_unique_northwind_products_product_id.740bf6f9a5"
[0m16:36:59.046594 [debug] [Thread-2 (]: Began executing node test.dbt_exercise.source_unique_northwind_products_product_id.740bf6f9a5
[0m16:36:59.044796 [info ] [Thread-3 (]: 40 of 55 PASS source_unique_northwind_customers_customer_id .................... [[32mPASS[0m in 1.94s]
[0m16:36:59.055042 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_exercise.source_unique_northwind_products_product_id.740bf6f9a5"
[0m16:36:59.056595 [debug] [Thread-3 (]: Finished running node test.dbt_exercise.source_unique_northwind_customers_customer_id.ff818c137b
[0m16:36:59.057647 [debug] [Thread-3 (]: Began running node test.dbt_exercise.source_unique_northwind_region_region_id.9688f1f5fd
[0m16:36:59.059890 [info ] [Thread-3 (]: 44 of 55 START test source_unique_northwind_region_region_id ................... [RUN]
[0m16:36:59.061363 [debug] [Thread-2 (]: On test.dbt_exercise.source_unique_northwind_products_product_id.740bf6f9a5: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "test.dbt_exercise.source_unique_northwind_products_product_id.740bf6f9a5"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with dbt_test__target as (

  select product_id as unique_field
  from `corded-sunlight-464012-e2`.`dbt_dw_raw`.`products`
  where product_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m16:36:59.062368 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_exercise.source_unique_northwind_customers_customer_id.ff818c137b, now test.dbt_exercise.source_unique_northwind_region_region_id.9688f1f5fd)
[0m16:36:59.063301 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:36:59.064476 [debug] [Thread-3 (]: Began compiling node test.dbt_exercise.source_unique_northwind_region_region_id.9688f1f5fd
[0m16:36:59.078994 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_exercise.source_unique_northwind_region_region_id.9688f1f5fd"
[0m16:36:59.081740 [debug] [Thread-3 (]: Began executing node test.dbt_exercise.source_unique_northwind_region_region_id.9688f1f5fd
[0m16:36:59.086707 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_exercise.source_unique_northwind_region_region_id.9688f1f5fd"
[0m16:36:59.133410 [debug] [Thread-3 (]: On test.dbt_exercise.source_unique_northwind_region_region_id.9688f1f5fd: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "test.dbt_exercise.source_unique_northwind_region_region_id.9688f1f5fd"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with dbt_test__target as (

  select region_id as unique_field
  from `corded-sunlight-464012-e2`.`dbt_dw_raw`.`region`
  where region_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m16:36:59.135001 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:36:59.183126 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:b448351a-f8bb-4609-8810-3567761b8948&page=queryresults
[0m16:36:59.273969 [info ] [Thread-1 (]: 41 of 55 PASS source_unique_northwind_employees_employee_id .................... [[32mPASS[0m in 2.09s]
[0m16:36:59.275853 [debug] [Thread-1 (]: Finished running node test.dbt_exercise.source_unique_northwind_employees_employee_id.e63c624594
[0m16:36:59.276928 [debug] [Thread-1 (]: Began running node test.dbt_exercise.source_unique_northwind_shippers_shipper_id.61edb3f736
[0m16:36:59.277991 [info ] [Thread-1 (]: 45 of 55 START test source_unique_northwind_shippers_shipper_id ................ [RUN]
[0m16:36:59.279222 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_exercise.source_unique_northwind_employees_employee_id.e63c624594, now test.dbt_exercise.source_unique_northwind_shippers_shipper_id.61edb3f736)
[0m16:36:59.280031 [debug] [Thread-1 (]: Began compiling node test.dbt_exercise.source_unique_northwind_shippers_shipper_id.61edb3f736
[0m16:36:59.287976 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_exercise.source_unique_northwind_shippers_shipper_id.61edb3f736"
[0m16:36:59.290103 [debug] [Thread-1 (]: Began executing node test.dbt_exercise.source_unique_northwind_shippers_shipper_id.61edb3f736
[0m16:36:59.294618 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_exercise.source_unique_northwind_shippers_shipper_id.61edb3f736"
[0m16:36:59.297348 [debug] [Thread-1 (]: On test.dbt_exercise.source_unique_northwind_shippers_shipper_id.61edb3f736: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "test.dbt_exercise.source_unique_northwind_shippers_shipper_id.61edb3f736"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with dbt_test__target as (

  select shipper_id as unique_field
  from `corded-sunlight-464012-e2`.`dbt_dw_raw`.`shippers`
  where shipper_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m16:36:59.298787 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:36:59.962897 [info ] [Thread-4 (]: 42 of 55 PASS source_unique_northwind_orders_order_id .......................... [[32mPASS[0m in 2.25s]
[0m16:36:59.964668 [debug] [Thread-4 (]: Finished running node test.dbt_exercise.source_unique_northwind_orders_order_id.4a8a4df128
[0m16:36:59.965488 [debug] [Thread-4 (]: Began running node test.dbt_exercise.source_unique_northwind_suppliers_supplier_id.aa7461739b
[0m16:36:59.966220 [info ] [Thread-4 (]: 46 of 55 START test source_unique_northwind_suppliers_supplier_id .............. [RUN]
[0m16:36:59.967154 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_exercise.source_unique_northwind_orders_order_id.4a8a4df128, now test.dbt_exercise.source_unique_northwind_suppliers_supplier_id.aa7461739b)
[0m16:36:59.967893 [debug] [Thread-4 (]: Began compiling node test.dbt_exercise.source_unique_northwind_suppliers_supplier_id.aa7461739b
[0m16:36:59.977115 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_exercise.source_unique_northwind_suppliers_supplier_id.aa7461739b"
[0m16:36:59.996131 [debug] [Thread-4 (]: Began executing node test.dbt_exercise.source_unique_northwind_suppliers_supplier_id.aa7461739b
[0m16:37:00.000139 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_exercise.source_unique_northwind_suppliers_supplier_id.aa7461739b"
[0m16:37:00.001753 [debug] [Thread-4 (]: On test.dbt_exercise.source_unique_northwind_suppliers_supplier_id.aa7461739b: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "test.dbt_exercise.source_unique_northwind_suppliers_supplier_id.aa7461739b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with dbt_test__target as (

  select supplier_id as unique_field
  from `corded-sunlight-464012-e2`.`dbt_dw_raw`.`suppliers`
  where supplier_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m16:37:00.002731 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:37:00.246553 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:c692c40a-7377-437f-8d69-c2be45e67528&page=queryresults
[0m16:37:00.495990 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:24b6a892-8824-4f31-b2de-0b40741feab2&page=queryresults
[0m16:37:01.013702 [info ] [Thread-3 (]: 44 of 55 PASS source_unique_northwind_region_region_id ......................... [[32mPASS[0m in 1.95s]
[0m16:37:01.015218 [debug] [Thread-3 (]: Finished running node test.dbt_exercise.source_unique_northwind_region_region_id.9688f1f5fd
[0m16:37:01.016128 [debug] [Thread-3 (]: Began running node test.dbt_exercise.source_unique_northwind_territories_territory_id.08bc548860
[0m16:37:01.016957 [info ] [Thread-3 (]: 47 of 55 START test source_unique_northwind_territories_territory_id ........... [RUN]
[0m16:37:01.017931 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_exercise.source_unique_northwind_region_region_id.9688f1f5fd, now test.dbt_exercise.source_unique_northwind_territories_territory_id.08bc548860)
[0m16:37:01.018615 [debug] [Thread-3 (]: Began compiling node test.dbt_exercise.source_unique_northwind_territories_territory_id.08bc548860
[0m16:37:01.027920 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_exercise.source_unique_northwind_territories_territory_id.08bc548860"
[0m16:37:01.030025 [debug] [Thread-3 (]: Began executing node test.dbt_exercise.source_unique_northwind_territories_territory_id.08bc548860
[0m16:37:01.034179 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_exercise.source_unique_northwind_territories_territory_id.08bc548860"
[0m16:37:01.035947 [debug] [Thread-3 (]: On test.dbt_exercise.source_unique_northwind_territories_territory_id.08bc548860: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "test.dbt_exercise.source_unique_northwind_territories_territory_id.08bc548860"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with dbt_test__target as (

  select territory_id as unique_field
  from `corded-sunlight-464012-e2`.`dbt_dw_raw`.`territories`
  where territory_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m16:37:01.037399 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:37:01.141434 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:0b8398e6-6f80-4249-80f3-797236e9864d&page=queryresults
[0m16:37:01.284467 [info ] [Thread-2 (]: 43 of 55 PASS source_unique_northwind_products_product_id ...................... [[32mPASS[0m in 2.26s]
[0m16:37:01.285778 [debug] [Thread-2 (]: Finished running node test.dbt_exercise.source_unique_northwind_products_product_id.740bf6f9a5
[0m16:37:01.286640 [debug] [Thread-2 (]: Began running node test.dbt_exercise.source_unique_northwind_us_states_state_id.c374c85cda
[0m16:37:01.287674 [info ] [Thread-2 (]: 48 of 55 START test source_unique_northwind_us_states_state_id ................. [RUN]
[0m16:37:01.288711 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_exercise.source_unique_northwind_products_product_id.740bf6f9a5, now test.dbt_exercise.source_unique_northwind_us_states_state_id.c374c85cda)
[0m16:37:01.289540 [debug] [Thread-2 (]: Began compiling node test.dbt_exercise.source_unique_northwind_us_states_state_id.c374c85cda
[0m16:37:01.303989 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_exercise.source_unique_northwind_us_states_state_id.c374c85cda"
[0m16:37:01.307784 [debug] [Thread-2 (]: Began executing node test.dbt_exercise.source_unique_northwind_us_states_state_id.c374c85cda
[0m16:37:01.313752 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_exercise.source_unique_northwind_us_states_state_id.c374c85cda"
[0m16:37:01.315214 [debug] [Thread-2 (]: On test.dbt_exercise.source_unique_northwind_us_states_state_id.c374c85cda: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "test.dbt_exercise.source_unique_northwind_us_states_state_id.c374c85cda"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with dbt_test__target as (

  select state_id as unique_field
  from `corded-sunlight-464012-e2`.`dbt_dw_raw`.`us_states`
  where state_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m16:37:01.316023 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:37:01.514505 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:c7c8b19b-6abd-4631-a738-026108d368c8&page=queryresults
[0m16:37:01.986563 [info ] [Thread-4 (]: 46 of 55 PASS source_unique_northwind_suppliers_supplier_id .................... [[32mPASS[0m in 2.02s]
[0m16:37:01.988216 [debug] [Thread-4 (]: Finished running node test.dbt_exercise.source_unique_northwind_suppliers_supplier_id.aa7461739b
[0m16:37:01.989236 [debug] [Thread-4 (]: Began running node test.dbt_exercise.unique_dim_employees_employee_id.79828c8f30
[0m16:37:01.990331 [info ] [Thread-4 (]: 49 of 55 START test unique_dim_employees_employee_id ........................... [RUN]
[0m16:37:01.991640 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_exercise.source_unique_northwind_suppliers_supplier_id.aa7461739b, now test.dbt_exercise.unique_dim_employees_employee_id.79828c8f30)
[0m16:37:01.992661 [debug] [Thread-4 (]: Began compiling node test.dbt_exercise.unique_dim_employees_employee_id.79828c8f30
[0m16:37:02.002632 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_exercise.unique_dim_employees_employee_id.79828c8f30"
[0m16:37:02.004742 [debug] [Thread-4 (]: Began executing node test.dbt_exercise.unique_dim_employees_employee_id.79828c8f30
[0m16:37:02.011287 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_exercise.unique_dim_employees_employee_id.79828c8f30"
[0m16:37:02.013670 [debug] [Thread-4 (]: On test.dbt_exercise.unique_dim_employees_employee_id.79828c8f30: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "test.dbt_exercise.unique_dim_employees_employee_id.79828c8f30"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with dbt_test__target as (

  select employee_id as unique_field
  from `corded-sunlight-464012-e2`.`dbt_dw_marts`.`dim_employees`
  where employee_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m16:37:02.015289 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:37:04.534915 [info ] [Thread-1 (]: 45 of 55 PASS source_unique_northwind_shippers_shipper_id ...................... [[32mPASS[0m in 5.26s]
[0m16:37:04.536397 [debug] [Thread-1 (]: Finished running node test.dbt_exercise.source_unique_northwind_shippers_shipper_id.61edb3f736
[0m16:37:04.537303 [debug] [Thread-1 (]: Began running node test.dbt_exercise.unique_dim_employees_employee_sk.8640166382
[0m16:37:04.538235 [info ] [Thread-1 (]: 50 of 55 START test unique_dim_employees_employee_sk ........................... [RUN]
[0m16:37:04.539333 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_exercise.source_unique_northwind_shippers_shipper_id.61edb3f736, now test.dbt_exercise.unique_dim_employees_employee_sk.8640166382)
[0m16:37:04.540271 [debug] [Thread-1 (]: Began compiling node test.dbt_exercise.unique_dim_employees_employee_sk.8640166382
[0m16:37:04.549836 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_exercise.unique_dim_employees_employee_sk.8640166382"
[0m16:37:04.552298 [debug] [Thread-1 (]: Began executing node test.dbt_exercise.unique_dim_employees_employee_sk.8640166382
[0m16:37:04.560327 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_exercise.unique_dim_employees_employee_sk.8640166382"
[0m16:37:04.562236 [debug] [Thread-1 (]: On test.dbt_exercise.unique_dim_employees_employee_sk.8640166382: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "test.dbt_exercise.unique_dim_employees_employee_sk.8640166382"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with dbt_test__target as (

  select employee_sk as unique_field
  from `corded-sunlight-464012-e2`.`dbt_dw_marts`.`dim_employees`
  where employee_sk is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m16:37:04.563189 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:37:04.568375 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:c74d68a0-9a80-414e-99e4-c0afcf6b94df&page=queryresults
[0m16:37:04.680236 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:33efa961-5a88-402f-91c7-5786937edf87&page=queryresults
[0m16:37:05.397299 [info ] [Thread-3 (]: 47 of 55 PASS source_unique_northwind_territories_territory_id ................. [[32mPASS[0m in 4.38s]
[0m16:37:05.399683 [debug] [Thread-3 (]: Finished running node test.dbt_exercise.source_unique_northwind_territories_territory_id.08bc548860
[0m16:37:05.402188 [debug] [Thread-3 (]: Began running node test.dbt_exercise.unique_dim_products_product_id.ef7b2a9985
[0m16:37:05.404650 [info ] [Thread-3 (]: 51 of 55 START test unique_dim_products_product_id ............................. [RUN]
[0m16:37:05.407867 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:71c2938c-ec67-48cd-9dc0-82a584ab5629&page=queryresults
[0m16:37:05.409392 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_exercise.source_unique_northwind_territories_territory_id.08bc548860, now test.dbt_exercise.unique_dim_products_product_id.ef7b2a9985)
[0m16:37:05.413814 [debug] [Thread-3 (]: Began compiling node test.dbt_exercise.unique_dim_products_product_id.ef7b2a9985
[0m16:37:05.426559 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_exercise.unique_dim_products_product_id.ef7b2a9985"
[0m16:37:05.431447 [debug] [Thread-3 (]: Began executing node test.dbt_exercise.unique_dim_products_product_id.ef7b2a9985
[0m16:37:05.436729 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_exercise.unique_dim_products_product_id.ef7b2a9985"
[0m16:37:05.439379 [debug] [Thread-3 (]: On test.dbt_exercise.unique_dim_products_product_id.ef7b2a9985: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "test.dbt_exercise.unique_dim_products_product_id.ef7b2a9985"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with dbt_test__target as (

  select product_id as unique_field
  from `corded-sunlight-464012-e2`.`dbt_dw_marts`.`dim_products`
  where product_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m16:37:05.448626 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:37:05.506957 [info ] [Thread-2 (]: 48 of 55 PASS source_unique_northwind_us_states_state_id ....................... [[32mPASS[0m in 4.22s]
[0m16:37:05.509422 [debug] [Thread-2 (]: Finished running node test.dbt_exercise.source_unique_northwind_us_states_state_id.c374c85cda
[0m16:37:05.510784 [debug] [Thread-2 (]: Began running node test.dbt_exercise.unique_dim_products_sk_product.1658453ef4
[0m16:37:05.512019 [info ] [Thread-2 (]: 52 of 55 START test unique_dim_products_sk_product ............................. [RUN]
[0m16:37:05.513184 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_exercise.source_unique_northwind_us_states_state_id.c374c85cda, now test.dbt_exercise.unique_dim_products_sk_product.1658453ef4)
[0m16:37:05.514076 [debug] [Thread-2 (]: Began compiling node test.dbt_exercise.unique_dim_products_sk_product.1658453ef4
[0m16:37:05.523073 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_exercise.unique_dim_products_sk_product.1658453ef4"
[0m16:37:05.524949 [debug] [Thread-2 (]: Began executing node test.dbt_exercise.unique_dim_products_sk_product.1658453ef4
[0m16:37:05.539387 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_exercise.unique_dim_products_sk_product.1658453ef4"
[0m16:37:05.541638 [debug] [Thread-2 (]: On test.dbt_exercise.unique_dim_products_sk_product.1658453ef4: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "test.dbt_exercise.unique_dim_products_sk_product.1658453ef4"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with dbt_test__target as (

  select sk_product as unique_field
  from `corded-sunlight-464012-e2`.`dbt_dw_marts`.`dim_products`
  where sk_product is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m16:37:05.543926 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:37:05.609800 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:dd0c4345-1280-4fab-a03e-b76f482d3c43&page=queryresults
[0m16:37:05.611498 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:dd0c4345-1280-4fab-a03e-b76f482d3c43&page=queryresults
[0m16:37:05.660595 [debug] [Thread-1 (]: Database Error in test unique_dim_employees_employee_sk (models/marts/dim_employees.yml)
  Unrecognized name: employee_sk; Did you mean employee_id? at [18:9]
  compiled code at target/run/dbt_exercise/models/marts/dim_employees.yml/unique_dim_employees_employee_sk.sql
[0m16:37:05.661749 [error] [Thread-1 (]: 50 of 55 ERROR unique_dim_employees_employee_sk ................................ [[31mERROR[0m in 1.12s]
[0m16:37:05.662975 [debug] [Thread-1 (]: Finished running node test.dbt_exercise.unique_dim_employees_employee_sk.8640166382
[0m16:37:05.663871 [debug] [Thread-1 (]: Began running node test.dbt_exercise.unique_dim_ship_ship_id.8825a91f8e
[0m16:37:05.665006 [debug] [Thread-7 (]: Marking all children of 'test.dbt_exercise.unique_dim_employees_employee_sk.8640166382' to be skipped because of status 'error'.  Reason: Database Error in test unique_dim_employees_employee_sk (models/marts/dim_employees.yml)
  Unrecognized name: employee_sk; Did you mean employee_id? at [18:9]
  compiled code at target/run/dbt_exercise/models/marts/dim_employees.yml/unique_dim_employees_employee_sk.sql.
[0m16:37:05.666194 [info ] [Thread-1 (]: 53 of 55 START test unique_dim_ship_ship_id .................................... [RUN]
[0m16:37:05.668363 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_exercise.unique_dim_employees_employee_sk.8640166382, now test.dbt_exercise.unique_dim_ship_ship_id.8825a91f8e)
[0m16:37:05.669354 [debug] [Thread-1 (]: Began compiling node test.dbt_exercise.unique_dim_ship_ship_id.8825a91f8e
[0m16:37:05.677561 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_exercise.unique_dim_ship_ship_id.8825a91f8e"
[0m16:37:05.679311 [debug] [Thread-1 (]: Began executing node test.dbt_exercise.unique_dim_ship_ship_id.8825a91f8e
[0m16:37:05.686359 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_exercise.unique_dim_ship_ship_id.8825a91f8e"
[0m16:37:05.688013 [debug] [Thread-1 (]: On test.dbt_exercise.unique_dim_ship_ship_id.8825a91f8e: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "test.dbt_exercise.unique_dim_ship_ship_id.8825a91f8e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with dbt_test__target as (

  select ship_id as unique_field
  from `corded-sunlight-464012-e2`.`dbt_dw_marts`.`dim_ship`
  where ship_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m16:37:05.689211 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:37:06.312725 [info ] [Thread-4 (]: 49 of 55 PASS unique_dim_employees_employee_id ................................. [[32mPASS[0m in 4.32s]
[0m16:37:06.314490 [debug] [Thread-4 (]: Finished running node test.dbt_exercise.unique_dim_employees_employee_id.79828c8f30
[0m16:37:06.315414 [debug] [Thread-4 (]: Began running node test.dbt_exercise.unique_dim_ship_ship_sk.1e84b87eb9
[0m16:37:06.316215 [info ] [Thread-4 (]: 54 of 55 START test unique_dim_ship_ship_sk .................................... [RUN]
[0m16:37:06.317232 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_exercise.unique_dim_employees_employee_id.79828c8f30, now test.dbt_exercise.unique_dim_ship_ship_sk.1e84b87eb9)
[0m16:37:06.318188 [debug] [Thread-4 (]: Began compiling node test.dbt_exercise.unique_dim_ship_ship_sk.1e84b87eb9
[0m16:37:06.327790 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_exercise.unique_dim_ship_ship_sk.1e84b87eb9"
[0m16:37:06.329481 [debug] [Thread-4 (]: Began executing node test.dbt_exercise.unique_dim_ship_ship_sk.1e84b87eb9
[0m16:37:06.335893 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_exercise.unique_dim_ship_ship_sk.1e84b87eb9"
[0m16:37:06.338340 [debug] [Thread-4 (]: On test.dbt_exercise.unique_dim_ship_ship_sk.1e84b87eb9: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "test.dbt_exercise.unique_dim_ship_ship_sk.1e84b87eb9"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with dbt_test__target as (

  select ship_sk as unique_field
  from `corded-sunlight-464012-e2`.`dbt_dw_marts`.`dim_ship`
  where ship_sk is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m16:37:06.340081 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:37:06.760749 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:909d883f-0ebc-4eab-a7ed-04df0b7cf152&page=queryresults
[0m16:37:06.779978 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:dcc646b8-4e79-435b-9e47-7d60463a2e94&page=queryresults
[0m16:37:06.985694 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:5f853c02-8151-40d8-ae90-a63032a17c90&page=queryresults
[0m16:37:07.352263 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:58f2a629-2330-4c60-b51a-d01a7dacd2b8&page=queryresults
[0m16:37:07.353200 [error] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:58f2a629-2330-4c60-b51a-d01a7dacd2b8&page=queryresults
[0m16:37:07.409795 [debug] [Thread-4 (]: Database Error in test unique_dim_ship_ship_sk (models/marts/dim_ship.yml)
  Unrecognized name: ship_sk; Did you mean ship_id? at [18:9]
  compiled code at target/run/dbt_exercise/models/marts/dim_ship.yml/unique_dim_ship_ship_sk.sql
[0m16:37:07.411642 [error] [Thread-4 (]: 54 of 55 ERROR unique_dim_ship_ship_sk ......................................... [[31mERROR[0m in 1.09s]
[0m16:37:07.416822 [debug] [Thread-4 (]: Finished running node test.dbt_exercise.unique_dim_ship_ship_sk.1e84b87eb9
[0m16:37:07.418553 [debug] [Thread-4 (]: Began running node test.dbt_exercise.unique_fact_orders_sk_orders.072a29dba8
[0m16:37:07.420884 [debug] [Thread-7 (]: Marking all children of 'test.dbt_exercise.unique_dim_ship_ship_sk.1e84b87eb9' to be skipped because of status 'error'.  Reason: Database Error in test unique_dim_ship_ship_sk (models/marts/dim_ship.yml)
  Unrecognized name: ship_sk; Did you mean ship_id? at [18:9]
  compiled code at target/run/dbt_exercise/models/marts/dim_ship.yml/unique_dim_ship_ship_sk.sql.
[0m16:37:07.422345 [info ] [Thread-4 (]: 55 of 55 START test unique_fact_orders_sk_orders ............................... [RUN]
[0m16:37:07.425261 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_exercise.unique_dim_ship_ship_sk.1e84b87eb9, now test.dbt_exercise.unique_fact_orders_sk_orders.072a29dba8)
[0m16:37:07.427216 [debug] [Thread-4 (]: Began compiling node test.dbt_exercise.unique_fact_orders_sk_orders.072a29dba8
[0m16:37:07.443118 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_exercise.unique_fact_orders_sk_orders.072a29dba8"
[0m16:37:07.444996 [debug] [Thread-4 (]: Began executing node test.dbt_exercise.unique_fact_orders_sk_orders.072a29dba8
[0m16:37:07.452576 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_exercise.unique_fact_orders_sk_orders.072a29dba8"
[0m16:37:07.454793 [debug] [Thread-4 (]: On test.dbt_exercise.unique_fact_orders_sk_orders.072a29dba8: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "test.dbt_exercise.unique_fact_orders_sk_orders.072a29dba8"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with dbt_test__target as (

  select sk_orders as unique_field
  from `corded-sunlight-464012-e2`.`dbt_dw_marts`.`fact_orders`
  where sk_orders is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m16:37:07.456350 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:37:07.598366 [info ] [Thread-3 (]: 51 of 55 PASS unique_dim_products_product_id ................................... [[32mPASS[0m in 2.19s]
[0m16:37:07.600846 [debug] [Thread-3 (]: Finished running node test.dbt_exercise.unique_dim_products_product_id.ef7b2a9985
[0m16:37:07.679217 [info ] [Thread-2 (]: 52 of 55 PASS unique_dim_products_sk_product ................................... [[32mPASS[0m in 2.17s]
[0m16:37:07.680687 [debug] [Thread-2 (]: Finished running node test.dbt_exercise.unique_dim_products_sk_product.1658453ef4
[0m16:37:07.832246 [info ] [Thread-1 (]: 53 of 55 PASS unique_dim_ship_ship_id .......................................... [[32mPASS[0m in 2.16s]
[0m16:37:07.833743 [debug] [Thread-1 (]: Finished running node test.dbt_exercise.unique_dim_ship_ship_id.8825a91f8e
[0m16:37:08.757571 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:9adeda54-83ba-4d90-b3b3-7fed8f1dc81a&page=queryresults
[0m16:37:09.576714 [info ] [Thread-4 (]: 55 of 55 PASS unique_fact_orders_sk_orders ..................................... [[32mPASS[0m in 2.15s]
[0m16:37:09.578941 [debug] [Thread-4 (]: Finished running node test.dbt_exercise.unique_fact_orders_sk_orders.072a29dba8
[0m16:37:09.584855 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:37:09.594952 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:37:09.596172 [debug] [MainThread]: Connection 'test.dbt_exercise.unique_dim_products_sk_product.1658453ef4' was properly closed.
[0m16:37:09.597209 [debug] [MainThread]: Connection 'test.dbt_exercise.unique_dim_ship_ship_id.8825a91f8e' was properly closed.
[0m16:37:09.598514 [debug] [MainThread]: Connection 'test.dbt_exercise.unique_dim_products_product_id.ef7b2a9985' was properly closed.
[0m16:37:09.599364 [debug] [MainThread]: Connection 'test.dbt_exercise.unique_fact_orders_sk_orders.072a29dba8' was properly closed.
[0m16:37:09.600216 [info ] [MainThread]: 
[0m16:37:09.601281 [info ] [MainThread]: Finished running 55 data tests in 0 hours 0 minutes and 37.11 seconds (37.11s).
[0m16:37:09.620463 [debug] [MainThread]: Command end result
[0m16:37:09.727109 [debug] [MainThread]: Wrote artifact WritableManifest to /home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/target/manifest.json
[0m16:37:09.746146 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/target/semantic_manifest.json
[0m16:37:09.766459 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/target/run_results.json
[0m16:37:09.767965 [info ] [MainThread]: 
[0m16:37:09.769285 [info ] [MainThread]: [31mCompleted with 5 errors, 0 partial successes, and 0 warnings:[0m
[0m16:37:09.770676 [info ] [MainThread]: 
[0m16:37:09.771497 [error] [MainThread]: [31mFailure in test accepted_values_dim_products_discontinued__True__False (models/marts/dim_products.yml)[0m
[0m16:37:09.772357 [error] [MainThread]:   Database Error in test accepted_values_dim_products_discontinued__True__False (models/marts/dim_products.yml)
  Unrecognized name: discontinued; Did you mean is_discontinued? at [17:9]
  compiled code at target/run/dbt_exercise/models/marts/dim_products.yml/accepted_values_dim_products_discontinued__True__False.sql
[0m16:37:09.773039 [info ] [MainThread]: 
[0m16:37:09.774260 [info ] [MainThread]:   compiled code at target/compiled/dbt_exercise/models/marts/dim_products.yml/accepted_values_dim_products_discontinued__True__False.sql
[0m16:37:09.776633 [info ] [MainThread]: 
[0m16:37:09.778901 [error] [MainThread]: [31mFailure in test not_null_dim_employees_employee_sk (models/marts/dim_employees.yml)[0m
[0m16:37:09.780462 [error] [MainThread]:   Database Error in test not_null_dim_employees_employee_sk (models/marts/dim_employees.yml)
  Unrecognized name: employee_sk; Did you mean employee_id? at [18:7]
  compiled code at target/run/dbt_exercise/models/marts/dim_employees.yml/not_null_dim_employees_employee_sk.sql
[0m16:37:09.781873 [info ] [MainThread]: 
[0m16:37:09.784128 [info ] [MainThread]:   compiled code at target/compiled/dbt_exercise/models/marts/dim_employees.yml/not_null_dim_employees_employee_sk.sql
[0m16:37:09.785479 [info ] [MainThread]: 
[0m16:37:09.787134 [error] [MainThread]: [31mFailure in test not_null_dim_ship_ship_sk (models/marts/dim_ship.yml)[0m
[0m16:37:09.788804 [error] [MainThread]:   Database Error in test not_null_dim_ship_ship_sk (models/marts/dim_ship.yml)
  Unrecognized name: ship_sk; Did you mean ship_id? at [18:7]
  compiled code at target/run/dbt_exercise/models/marts/dim_ship.yml/not_null_dim_ship_ship_sk.sql
[0m16:37:09.790680 [info ] [MainThread]: 
[0m16:37:09.793023 [info ] [MainThread]:   compiled code at target/compiled/dbt_exercise/models/marts/dim_ship.yml/not_null_dim_ship_ship_sk.sql
[0m16:37:09.794670 [info ] [MainThread]: 
[0m16:37:09.796370 [error] [MainThread]: [31mFailure in test unique_dim_employees_employee_sk (models/marts/dim_employees.yml)[0m
[0m16:37:09.797826 [error] [MainThread]:   Database Error in test unique_dim_employees_employee_sk (models/marts/dim_employees.yml)
  Unrecognized name: employee_sk; Did you mean employee_id? at [18:9]
  compiled code at target/run/dbt_exercise/models/marts/dim_employees.yml/unique_dim_employees_employee_sk.sql
[0m16:37:09.799406 [info ] [MainThread]: 
[0m16:37:09.801631 [info ] [MainThread]:   compiled code at target/compiled/dbt_exercise/models/marts/dim_employees.yml/unique_dim_employees_employee_sk.sql
[0m16:37:09.803911 [info ] [MainThread]: 
[0m16:37:09.805370 [error] [MainThread]: [31mFailure in test unique_dim_ship_ship_sk (models/marts/dim_ship.yml)[0m
[0m16:37:09.807128 [error] [MainThread]:   Database Error in test unique_dim_ship_ship_sk (models/marts/dim_ship.yml)
  Unrecognized name: ship_sk; Did you mean ship_id? at [18:9]
  compiled code at target/run/dbt_exercise/models/marts/dim_ship.yml/unique_dim_ship_ship_sk.sql
[0m16:37:09.808820 [info ] [MainThread]: 
[0m16:37:09.810331 [info ] [MainThread]:   compiled code at target/compiled/dbt_exercise/models/marts/dim_ship.yml/unique_dim_ship_ship_sk.sql
[0m16:37:09.811542 [info ] [MainThread]: 
[0m16:37:09.812663 [info ] [MainThread]: Done. PASS=50 WARN=0 ERROR=5 SKIP=0 NO-OP=0 TOTAL=55
[0m16:37:09.813973 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- DuplicateYAMLKeysDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m16:37:09.825533 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": false, "command_wall_clock_time": 167.8572, "process_in_blocks": "122928", "process_kernel_time": 20.217085, "process_mem_max_rss": "375472", "process_out_blocks": "5136", "process_user_time": 20.90776}
[0m16:37:09.827856 [debug] [MainThread]: Command `dbt test` failed at 16:37:09.827192 after 167.86 seconds
[0m16:37:09.828789 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efb66e513a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efb285f75f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efb286df920>]}
[0m16:37:09.829721 [debug] [MainThread]: Flushing usage events
[0m16:37:10.163299 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:40:50.475404 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x768f534e33b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x768f559e9ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x768f5528e720>]}


============================== 16:40:50.492718 | da6af671-6f31-45dc-9351-64305fdc52e7 ==============================
[0m16:40:50.492718 [info ] [MainThread]: Running with dbt=1.10.2
[0m16:40:50.493606 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise', 'log_path': '/home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt test', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m16:41:45.008321 [warn ] [MainThread]: [[33mWARNING[0m][DuplicateYAMLKeysDeprecation]: Deprecated functionality
Duplicate key 'version' in "<unicode string>", line 4, column 1 in file
`/home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/dbt_project.yml`
[0m16:41:45.009366 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'da6af671-6f31-45dc-9351-64305fdc52e7', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x768f15f16300>]}
[0m16:41:45.733800 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'da6af671-6f31-45dc-9351-64305fdc52e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x768f15f8e450>]}
[0m16:41:45.826954 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'da6af671-6f31-45dc-9351-64305fdc52e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x768f1616a810>]}
[0m16:41:45.831823 [info ] [MainThread]: Registered adapter: bigquery=1.9.2
[0m16:42:41.206462 [debug] [MainThread]: checksum: 1adc40777973ef30f45f80b3b6d04d5013c1edd53d96363881b3b199e612468b, vars: {}, profile: , target: , version: 1.10.2
[0m16:42:47.310287 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:42:47.310974 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:42:49.889794 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'da6af671-6f31-45dc-9351-64305fdc52e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x768f15f14ec0>]}
[0m16:42:50.067348 [debug] [MainThread]: Wrote artifact WritableManifest to /home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/target/manifest.json
[0m16:42:50.083909 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/target/semantic_manifest.json
[0m16:42:50.642356 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'da6af671-6f31-45dc-9351-64305fdc52e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x768f157dcb90>]}
[0m16:42:50.643175 [info ] [MainThread]: Found 14 seeds, 55 data tests, 19 models, 14 sources, 609 macros
[0m16:42:50.644091 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'da6af671-6f31-45dc-9351-64305fdc52e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x768f157cb0e0>]}
[0m16:42:50.651069 [info ] [MainThread]: 
[0m16:42:50.652071 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:42:50.653127 [info ] [MainThread]: 
[0m16:42:50.654727 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m16:42:50.666766 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_corded-sunlight-464012-e2_dbt_dw_marts'
[0m16:42:50.669266 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:42:50.670836 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_corded-sunlight-464012-e2_dbt_dw_raw'
[0m16:42:50.673657 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_corded-sunlight-464012-e2_dbt_dw_staging'
[0m16:42:50.675624 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_corded-sunlight-464012-e2_dbt_dw_intermediate'
[0m16:42:50.677045 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:42:50.678197 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:42:50.679323 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:42:51.695717 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'da6af671-6f31-45dc-9351-64305fdc52e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x768f15e64e30>]}
[0m16:42:51.697235 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:42:51.714778 [debug] [Thread-1 (]: Began running node test.dbt_exercise.accepted_values_dim_products_is_discontinued__True__False.b53ac91bb6
[0m16:42:51.716227 [debug] [Thread-2 (]: Began running node test.dbt_exercise.not_null_dim_employees_employee_id.ef83a0c291
[0m16:42:51.718602 [debug] [Thread-3 (]: Began running node test.dbt_exercise.not_null_dim_employees_sk_employee.92381e9313
[0m16:42:51.719821 [debug] [Thread-4 (]: Began running node test.dbt_exercise.not_null_dim_products_product_id.c8aba288d1
[0m16:42:51.717597 [info ] [Thread-1 (]: 1 of 55 START test accepted_values_dim_products_is_discontinued__True__False ... [RUN]
[0m16:42:51.721161 [info ] [Thread-2 (]: 2 of 55 START test not_null_dim_employees_employee_id .......................... [RUN]
[0m16:42:51.722827 [info ] [Thread-3 (]: 3 of 55 START test not_null_dim_employees_sk_employee .......................... [RUN]
[0m16:42:51.724227 [info ] [Thread-4 (]: 4 of 55 START test not_null_dim_products_product_id ............................ [RUN]
[0m16:42:51.725784 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_corded-sunlight-464012-e2_dbt_dw_staging, now test.dbt_exercise.accepted_values_dim_products_is_discontinued__True__False.b53ac91bb6)
[0m16:42:51.727454 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_corded-sunlight-464012-e2_dbt_dw_marts, now test.dbt_exercise.not_null_dim_employees_employee_id.ef83a0c291)
[0m16:42:51.729373 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_corded-sunlight-464012-e2_dbt_dw_raw, now test.dbt_exercise.not_null_dim_employees_sk_employee.92381e9313)
[0m16:42:51.731210 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly list_corded-sunlight-464012-e2_dbt_dw_intermediate, now test.dbt_exercise.not_null_dim_products_product_id.c8aba288d1)
[0m16:42:51.734275 [debug] [Thread-1 (]: Began compiling node test.dbt_exercise.accepted_values_dim_products_is_discontinued__True__False.b53ac91bb6
[0m16:42:51.735894 [debug] [Thread-2 (]: Began compiling node test.dbt_exercise.not_null_dim_employees_employee_id.ef83a0c291
[0m16:42:51.737438 [debug] [Thread-3 (]: Began compiling node test.dbt_exercise.not_null_dim_employees_sk_employee.92381e9313
[0m16:42:51.739056 [debug] [Thread-4 (]: Began compiling node test.dbt_exercise.not_null_dim_products_product_id.c8aba288d1
[0m16:42:51.818623 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_exercise.accepted_values_dim_products_is_discontinued__True__False.b53ac91bb6"
[0m16:42:51.819815 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_exercise.not_null_dim_employees_employee_id.ef83a0c291"
[0m16:42:51.827453 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_exercise.not_null_dim_employees_sk_employee.92381e9313"
[0m16:42:51.836386 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_exercise.not_null_dim_products_product_id.c8aba288d1"
[0m16:42:51.840675 [debug] [Thread-1 (]: Began executing node test.dbt_exercise.accepted_values_dim_products_is_discontinued__True__False.b53ac91bb6
[0m16:42:51.841713 [debug] [Thread-3 (]: Began executing node test.dbt_exercise.not_null_dim_employees_sk_employee.92381e9313
[0m16:42:51.843070 [debug] [Thread-2 (]: Began executing node test.dbt_exercise.not_null_dim_employees_employee_id.ef83a0c291
[0m16:42:51.844141 [debug] [Thread-4 (]: Began executing node test.dbt_exercise.not_null_dim_products_product_id.c8aba288d1
[0m16:42:51.893120 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_exercise.not_null_dim_employees_sk_employee.92381e9313"
[0m16:42:51.896124 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_exercise.accepted_values_dim_products_is_discontinued__True__False.b53ac91bb6"
[0m16:42:51.900470 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_exercise.not_null_dim_employees_employee_id.ef83a0c291"
[0m16:42:51.905516 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_exercise.not_null_dim_products_product_id.c8aba288d1"
[0m16:42:51.908615 [debug] [Thread-3 (]: On test.dbt_exercise.not_null_dim_employees_sk_employee.92381e9313: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "test.dbt_exercise.not_null_dim_employees_sk_employee.92381e9313"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select sk_employee
from `corded-sunlight-464012-e2`.`dbt_dw_marts`.`dim_employees`
where sk_employee is null



  
  
      
    ) dbt_internal_test
[0m16:42:51.910358 [debug] [Thread-1 (]: On test.dbt_exercise.accepted_values_dim_products_is_discontinued__True__False.b53ac91bb6: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "test.dbt_exercise.accepted_values_dim_products_is_discontinued__True__False.b53ac91bb6"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        is_discontinued as value_field,
        count(*) as n_records

    from `corded-sunlight-464012-e2`.`dbt_dw_marts`.`dim_products`
    group by is_discontinued

)

select *
from all_values
where value_field not in (
    'True','False'
)



  
  
      
    ) dbt_internal_test
[0m16:42:51.912075 [debug] [Thread-2 (]: On test.dbt_exercise.not_null_dim_employees_employee_id.ef83a0c291: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "test.dbt_exercise.not_null_dim_employees_employee_id.ef83a0c291"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select employee_id
from `corded-sunlight-464012-e2`.`dbt_dw_marts`.`dim_employees`
where employee_id is null



  
  
      
    ) dbt_internal_test
[0m16:42:51.913296 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:42:51.914464 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:42:51.915500 [debug] [Thread-4 (]: On test.dbt_exercise.not_null_dim_products_product_id.c8aba288d1: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "test.dbt_exercise.not_null_dim_products_product_id.c8aba288d1"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select product_id
from `corded-sunlight-464012-e2`.`dbt_dw_marts`.`dim_products`
where product_id is null



  
  
      
    ) dbt_internal_test
[0m16:42:51.916678 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:42:51.917925 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:42:53.067719 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:76ffb72b-8684-4516-b629-7696df8f3d0f&page=queryresults
[0m16:42:53.072370 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:65b38489-c46a-4950-9a11-1d76e1e982c2&page=queryresults
[0m16:42:53.074021 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:65b38489-c46a-4950-9a11-1d76e1e982c2&page=queryresults
[0m16:42:53.076365 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:56a44ff9-643c-42df-9c42-1eee2d7dcefb&page=queryresults
[0m16:42:53.186444 [debug] [Thread-1 (]: Database Error in test accepted_values_dim_products_is_discontinued__True__False (models/marts/dim_products.yml)
  No matching signature for operator IN for argument types BOOL and {STRING} at [27:23]
  compiled code at target/run/dbt_exercise/models/marts/dim_products.yml/accepted_values_dim_products_is_discontinued__True__False.sql
[0m16:42:53.187787 [error] [Thread-1 (]: 1 of 55 ERROR accepted_values_dim_products_is_discontinued__True__False ........ [[31mERROR[0m in 1.46s]
[0m16:42:53.189291 [debug] [Thread-1 (]: Finished running node test.dbt_exercise.accepted_values_dim_products_is_discontinued__True__False.b53ac91bb6
[0m16:42:53.190194 [debug] [Thread-1 (]: Began running node test.dbt_exercise.not_null_dim_products_sk_product.7ce7792ece
[0m16:42:53.191269 [debug] [Thread-7 (]: Marking all children of 'test.dbt_exercise.accepted_values_dim_products_is_discontinued__True__False.b53ac91bb6' to be skipped because of status 'error'.  Reason: Database Error in test accepted_values_dim_products_is_discontinued__True__False (models/marts/dim_products.yml)
  No matching signature for operator IN for argument types BOOL and {STRING} at [27:23]
  compiled code at target/run/dbt_exercise/models/marts/dim_products.yml/accepted_values_dim_products_is_discontinued__True__False.sql.
[0m16:42:53.192224 [info ] [Thread-1 (]: 5 of 55 START test not_null_dim_products_sk_product ............................ [RUN]
[0m16:42:53.195524 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_exercise.accepted_values_dim_products_is_discontinued__True__False.b53ac91bb6, now test.dbt_exercise.not_null_dim_products_sk_product.7ce7792ece)
[0m16:42:53.197760 [debug] [Thread-1 (]: Began compiling node test.dbt_exercise.not_null_dim_products_sk_product.7ce7792ece
[0m16:42:53.206510 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_exercise.not_null_dim_products_sk_product.7ce7792ece"
[0m16:42:53.209616 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:f90173f6-692f-4ed2-989c-6814a26e915b&page=queryresults
[0m16:42:53.211001 [debug] [Thread-1 (]: Began executing node test.dbt_exercise.not_null_dim_products_sk_product.7ce7792ece
[0m16:42:53.221698 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_exercise.not_null_dim_products_sk_product.7ce7792ece"
[0m16:42:53.222990 [debug] [Thread-1 (]: On test.dbt_exercise.not_null_dim_products_sk_product.7ce7792ece: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "test.dbt_exercise.not_null_dim_products_sk_product.7ce7792ece"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select sk_product
from `corded-sunlight-464012-e2`.`dbt_dw_marts`.`dim_products`
where sk_product is null



  
  
      
    ) dbt_internal_test
[0m16:42:53.223787 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:42:54.454020 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:6fa2f79d-7784-4907-b447-268c5875c8da&page=queryresults
[0m16:42:58.581157 [info ] [Thread-3 (]: 3 of 55 PASS not_null_dim_employees_sk_employee ................................ [[32mPASS[0m in 6.85s]
[0m16:42:58.583341 [debug] [Thread-3 (]: Finished running node test.dbt_exercise.not_null_dim_employees_sk_employee.92381e9313
[0m16:42:58.584983 [debug] [Thread-3 (]: Began running node test.dbt_exercise.not_null_dim_ship_ship_id.0e7926966a
[0m16:42:58.586212 [info ] [Thread-3 (]: 6 of 55 START test not_null_dim_ship_ship_id ................................... [RUN]
[0m16:42:58.587659 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_exercise.not_null_dim_employees_sk_employee.92381e9313, now test.dbt_exercise.not_null_dim_ship_ship_id.0e7926966a)
[0m16:42:58.590250 [debug] [Thread-3 (]: Began compiling node test.dbt_exercise.not_null_dim_ship_ship_id.0e7926966a
[0m16:42:58.592500 [info ] [Thread-2 (]: 2 of 55 PASS not_null_dim_employees_employee_id ................................ [[32mPASS[0m in 6.87s]
[0m16:42:58.605388 [debug] [Thread-2 (]: Finished running node test.dbt_exercise.not_null_dim_employees_employee_id.ef83a0c291
[0m16:42:58.606254 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_exercise.not_null_dim_ship_ship_id.0e7926966a"
[0m16:42:58.611131 [debug] [Thread-2 (]: Began running node test.dbt_exercise.not_null_dim_ship_shipper_id.78acf0f3d3
[0m16:42:58.619353 [info ] [Thread-4 (]: 4 of 55 PASS not_null_dim_products_product_id .................................. [[32mPASS[0m in 6.89s]
[0m16:42:58.624731 [debug] [Thread-4 (]: Finished running node test.dbt_exercise.not_null_dim_products_product_id.c8aba288d1
[0m16:42:58.627921 [debug] [Thread-4 (]: Began running node test.dbt_exercise.not_null_dim_ship_sk_ship.3ae993afec
[0m16:42:58.629198 [debug] [Thread-3 (]: Began executing node test.dbt_exercise.not_null_dim_ship_ship_id.0e7926966a
[0m16:42:58.621343 [info ] [Thread-2 (]: 7 of 55 START test not_null_dim_ship_shipper_id ................................ [RUN]
[0m16:42:58.626528 [info ] [Thread-1 (]: 5 of 55 PASS not_null_dim_products_sk_product .................................. [[32mPASS[0m in 5.43s]
[0m16:42:58.630974 [info ] [Thread-4 (]: 8 of 55 START test not_null_dim_ship_sk_ship ................................... [RUN]
[0m16:42:58.642046 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_exercise.not_null_dim_ship_ship_id.0e7926966a"
[0m16:42:58.643665 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_exercise.not_null_dim_employees_employee_id.ef83a0c291, now test.dbt_exercise.not_null_dim_ship_shipper_id.78acf0f3d3)
[0m16:42:58.645432 [debug] [Thread-1 (]: Finished running node test.dbt_exercise.not_null_dim_products_sk_product.7ce7792ece
[0m16:42:58.647062 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_exercise.not_null_dim_products_product_id.c8aba288d1, now test.dbt_exercise.not_null_dim_ship_sk_ship.3ae993afec)
[0m16:42:58.650630 [debug] [Thread-2 (]: Began compiling node test.dbt_exercise.not_null_dim_ship_shipper_id.78acf0f3d3
[0m16:42:58.652074 [debug] [Thread-1 (]: Began running node test.dbt_exercise.not_null_fact_orders_customer_id.9c2270d0dc
[0m16:42:58.653576 [debug] [Thread-4 (]: Began compiling node test.dbt_exercise.not_null_dim_ship_sk_ship.3ae993afec
[0m16:42:58.654521 [debug] [Thread-3 (]: On test.dbt_exercise.not_null_dim_ship_ship_id.0e7926966a: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "test.dbt_exercise.not_null_dim_ship_ship_id.0e7926966a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select ship_id
from `corded-sunlight-464012-e2`.`dbt_dw_marts`.`dim_ship`
where ship_id is null



  
  
      
    ) dbt_internal_test
[0m16:42:58.665183 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_exercise.not_null_dim_ship_shipper_id.78acf0f3d3"
[0m16:42:58.666740 [info ] [Thread-1 (]: 9 of 55 START test not_null_fact_orders_customer_id ............................ [RUN]
[0m16:42:58.675623 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_exercise.not_null_dim_ship_sk_ship.3ae993afec"
[0m16:42:58.677751 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:42:58.679577 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_exercise.not_null_dim_products_sk_product.7ce7792ece, now test.dbt_exercise.not_null_fact_orders_customer_id.9c2270d0dc)
[0m16:42:58.681607 [debug] [Thread-2 (]: Began executing node test.dbt_exercise.not_null_dim_ship_shipper_id.78acf0f3d3
[0m16:42:58.683363 [debug] [Thread-4 (]: Began executing node test.dbt_exercise.not_null_dim_ship_sk_ship.3ae993afec
[0m16:42:58.684823 [debug] [Thread-1 (]: Began compiling node test.dbt_exercise.not_null_fact_orders_customer_id.9c2270d0dc
[0m16:42:58.689762 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_exercise.not_null_dim_ship_shipper_id.78acf0f3d3"
[0m16:42:58.695731 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_exercise.not_null_dim_ship_sk_ship.3ae993afec"
[0m16:42:58.707311 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_exercise.not_null_fact_orders_customer_id.9c2270d0dc"
[0m16:42:58.748147 [debug] [Thread-2 (]: On test.dbt_exercise.not_null_dim_ship_shipper_id.78acf0f3d3: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "test.dbt_exercise.not_null_dim_ship_shipper_id.78acf0f3d3"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select shipper_id
from `corded-sunlight-464012-e2`.`dbt_dw_marts`.`dim_ship`
where shipper_id is null



  
  
      
    ) dbt_internal_test
[0m16:42:58.751530 [debug] [Thread-4 (]: On test.dbt_exercise.not_null_dim_ship_sk_ship.3ae993afec: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "test.dbt_exercise.not_null_dim_ship_sk_ship.3ae993afec"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select sk_ship
from `corded-sunlight-464012-e2`.`dbt_dw_marts`.`dim_ship`
where sk_ship is null



  
  
      
    ) dbt_internal_test
[0m16:42:58.753213 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:42:58.754514 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:42:58.755685 [debug] [Thread-1 (]: Began executing node test.dbt_exercise.not_null_fact_orders_customer_id.9c2270d0dc
[0m16:42:58.760965 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_exercise.not_null_fact_orders_customer_id.9c2270d0dc"
[0m16:42:58.762669 [debug] [Thread-1 (]: On test.dbt_exercise.not_null_fact_orders_customer_id.9c2270d0dc: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "test.dbt_exercise.not_null_fact_orders_customer_id.9c2270d0dc"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select customer_id
from `corded-sunlight-464012-e2`.`dbt_dw_marts`.`fact_orders`
where customer_id is null



  
  
      
    ) dbt_internal_test
[0m16:42:58.764459 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:42:59.813675 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:274dc0dd-54de-416b-aefa-67585f68e58c&page=queryresults
[0m16:42:59.814751 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:3b57a288-57b6-408d-b011-05bc6167571d&page=queryresults
[0m16:42:59.815740 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:c97b7e1c-7d30-42de-bd98-affa7298868e&page=queryresults
[0m16:42:59.881300 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:388c8050-0d87-4d8f-9b91-67a2ca7d6054&page=queryresults
[0m16:43:00.566625 [info ] [Thread-1 (]: 9 of 55 PASS not_null_fact_orders_customer_id .................................. [[32mPASS[0m in 1.89s]
[0m16:43:00.568406 [debug] [Thread-1 (]: Finished running node test.dbt_exercise.not_null_fact_orders_customer_id.9c2270d0dc
[0m16:43:00.569419 [debug] [Thread-1 (]: Began running node test.dbt_exercise.not_null_fact_orders_employee_id.4d01f9cb32
[0m16:43:00.570487 [info ] [Thread-1 (]: 10 of 55 START test not_null_fact_orders_employee_id ........................... [RUN]
[0m16:43:00.571479 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_exercise.not_null_fact_orders_customer_id.9c2270d0dc, now test.dbt_exercise.not_null_fact_orders_employee_id.4d01f9cb32)
[0m16:43:00.572444 [debug] [Thread-1 (]: Began compiling node test.dbt_exercise.not_null_fact_orders_employee_id.4d01f9cb32
[0m16:43:00.582629 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_exercise.not_null_fact_orders_employee_id.4d01f9cb32"
[0m16:43:00.584681 [debug] [Thread-1 (]: Began executing node test.dbt_exercise.not_null_fact_orders_employee_id.4d01f9cb32
[0m16:43:00.589289 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_exercise.not_null_fact_orders_employee_id.4d01f9cb32"
[0m16:43:00.592317 [debug] [Thread-1 (]: On test.dbt_exercise.not_null_fact_orders_employee_id.4d01f9cb32: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "test.dbt_exercise.not_null_fact_orders_employee_id.4d01f9cb32"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select employee_id
from `corded-sunlight-464012-e2`.`dbt_dw_marts`.`fact_orders`
where employee_id is null



  
  
      
    ) dbt_internal_test
[0m16:43:00.595247 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:43:00.649689 [info ] [Thread-3 (]: 6 of 55 PASS not_null_dim_ship_ship_id ......................................... [[32mPASS[0m in 2.06s]
[0m16:43:00.652194 [debug] [Thread-3 (]: Finished running node test.dbt_exercise.not_null_dim_ship_ship_id.0e7926966a
[0m16:43:00.654264 [debug] [Thread-3 (]: Began running node test.dbt_exercise.not_null_fact_orders_order_id.6ba6d3f0a0
[0m16:43:00.656100 [info ] [Thread-3 (]: 11 of 55 START test not_null_fact_orders_order_id .............................. [RUN]
[0m16:43:00.658778 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_exercise.not_null_dim_ship_ship_id.0e7926966a, now test.dbt_exercise.not_null_fact_orders_order_id.6ba6d3f0a0)
[0m16:43:00.660278 [debug] [Thread-3 (]: Began compiling node test.dbt_exercise.not_null_fact_orders_order_id.6ba6d3f0a0
[0m16:43:00.672858 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_exercise.not_null_fact_orders_order_id.6ba6d3f0a0"
[0m16:43:00.675956 [debug] [Thread-3 (]: Began executing node test.dbt_exercise.not_null_fact_orders_order_id.6ba6d3f0a0
[0m16:43:00.682372 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_exercise.not_null_fact_orders_order_id.6ba6d3f0a0"
[0m16:43:00.684158 [debug] [Thread-3 (]: On test.dbt_exercise.not_null_fact_orders_order_id.6ba6d3f0a0: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "test.dbt_exercise.not_null_fact_orders_order_id.6ba6d3f0a0"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select order_id
from `corded-sunlight-464012-e2`.`dbt_dw_marts`.`fact_orders`
where order_id is null



  
  
      
    ) dbt_internal_test
[0m16:43:00.685144 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:43:00.739118 [info ] [Thread-4 (]: 8 of 55 PASS not_null_dim_ship_sk_ship ......................................... [[32mPASS[0m in 2.09s]
[0m16:43:00.744527 [info ] [Thread-2 (]: 7 of 55 PASS not_null_dim_ship_shipper_id ...................................... [[32mPASS[0m in 2.10s]
[0m16:43:00.746428 [debug] [Thread-4 (]: Finished running node test.dbt_exercise.not_null_dim_ship_sk_ship.3ae993afec
[0m16:43:00.748268 [debug] [Thread-2 (]: Finished running node test.dbt_exercise.not_null_dim_ship_shipper_id.78acf0f3d3
[0m16:43:00.749973 [debug] [Thread-4 (]: Began running node test.dbt_exercise.not_null_fact_orders_product_id.346126b727
[0m16:43:00.751927 [debug] [Thread-2 (]: Began running node test.dbt_exercise.not_null_fact_orders_sk_customer.6134ecd4cd
[0m16:43:00.753453 [info ] [Thread-4 (]: 12 of 55 START test not_null_fact_orders_product_id ............................ [RUN]
[0m16:43:00.754913 [info ] [Thread-2 (]: 13 of 55 START test not_null_fact_orders_sk_customer ........................... [RUN]
[0m16:43:00.757019 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_exercise.not_null_dim_ship_sk_ship.3ae993afec, now test.dbt_exercise.not_null_fact_orders_product_id.346126b727)
[0m16:43:00.758372 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_exercise.not_null_dim_ship_shipper_id.78acf0f3d3, now test.dbt_exercise.not_null_fact_orders_sk_customer.6134ecd4cd)
[0m16:43:00.759398 [debug] [Thread-4 (]: Began compiling node test.dbt_exercise.not_null_fact_orders_product_id.346126b727
[0m16:43:00.760951 [debug] [Thread-2 (]: Began compiling node test.dbt_exercise.not_null_fact_orders_sk_customer.6134ecd4cd
[0m16:43:00.772214 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_exercise.not_null_fact_orders_product_id.346126b727"
[0m16:43:00.781375 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_exercise.not_null_fact_orders_sk_customer.6134ecd4cd"
[0m16:43:00.784186 [debug] [Thread-2 (]: Began executing node test.dbt_exercise.not_null_fact_orders_sk_customer.6134ecd4cd
[0m16:43:00.785431 [debug] [Thread-4 (]: Began executing node test.dbt_exercise.not_null_fact_orders_product_id.346126b727
[0m16:43:00.789843 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_exercise.not_null_fact_orders_sk_customer.6134ecd4cd"
[0m16:43:00.796322 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_exercise.not_null_fact_orders_product_id.346126b727"
[0m16:43:00.798245 [debug] [Thread-2 (]: On test.dbt_exercise.not_null_fact_orders_sk_customer.6134ecd4cd: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "test.dbt_exercise.not_null_fact_orders_sk_customer.6134ecd4cd"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select sk_customer
from `corded-sunlight-464012-e2`.`dbt_dw_marts`.`fact_orders`
where sk_customer is null



  
  
      
    ) dbt_internal_test
[0m16:43:00.799279 [debug] [Thread-4 (]: On test.dbt_exercise.not_null_fact_orders_product_id.346126b727: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "test.dbt_exercise.not_null_fact_orders_product_id.346126b727"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select product_id
from `corded-sunlight-464012-e2`.`dbt_dw_marts`.`fact_orders`
where product_id is null



  
  
      
    ) dbt_internal_test
[0m16:43:00.800519 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:43:00.801374 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:43:01.606920 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:91c0cff6-abe3-4fbf-b096-276dca814ee2&page=queryresults
[0m16:43:01.682280 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:ee31c051-ec6a-46a3-b96d-03e99921099c&page=queryresults
[0m16:43:01.780766 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:86aa3e29-8d6b-4585-8f41-e3ef1991c92a&page=queryresults
[0m16:43:01.817525 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:f705e2d7-b074-49bb-be02-50e4e7a8be5c&page=queryresults
[0m16:43:02.418576 [info ] [Thread-1 (]: 10 of 55 PASS not_null_fact_orders_employee_id ................................. [[32mPASS[0m in 1.85s]
[0m16:43:02.420185 [debug] [Thread-1 (]: Finished running node test.dbt_exercise.not_null_fact_orders_employee_id.4d01f9cb32
[0m16:43:02.421108 [debug] [Thread-1 (]: Began running node test.dbt_exercise.not_null_fact_orders_sk_employee.cf36d136ff
[0m16:43:02.421948 [info ] [Thread-1 (]: 14 of 55 START test not_null_fact_orders_sk_employee ........................... [RUN]
[0m16:43:02.422881 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_exercise.not_null_fact_orders_employee_id.4d01f9cb32, now test.dbt_exercise.not_null_fact_orders_sk_employee.cf36d136ff)
[0m16:43:02.423609 [debug] [Thread-1 (]: Began compiling node test.dbt_exercise.not_null_fact_orders_sk_employee.cf36d136ff
[0m16:43:02.432797 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_exercise.not_null_fact_orders_sk_employee.cf36d136ff"
[0m16:43:02.434526 [debug] [Thread-1 (]: Began executing node test.dbt_exercise.not_null_fact_orders_sk_employee.cf36d136ff
[0m16:43:02.443327 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_exercise.not_null_fact_orders_sk_employee.cf36d136ff"
[0m16:43:02.445593 [debug] [Thread-1 (]: On test.dbt_exercise.not_null_fact_orders_sk_employee.cf36d136ff: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "test.dbt_exercise.not_null_fact_orders_sk_employee.cf36d136ff"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select sk_employee
from `corded-sunlight-464012-e2`.`dbt_dw_marts`.`fact_orders`
where sk_employee is null



  
  
      
    ) dbt_internal_test
[0m16:43:02.447437 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:43:02.494056 [info ] [Thread-3 (]: 11 of 55 PASS not_null_fact_orders_order_id .................................... [[32mPASS[0m in 1.84s]
[0m16:43:02.495489 [debug] [Thread-3 (]: Finished running node test.dbt_exercise.not_null_fact_orders_order_id.6ba6d3f0a0
[0m16:43:02.496561 [debug] [Thread-3 (]: Began running node test.dbt_exercise.not_null_fact_orders_sk_orders.c6a2fa98b5
[0m16:43:02.497944 [info ] [Thread-3 (]: 15 of 55 START test not_null_fact_orders_sk_orders ............................. [RUN]
[0m16:43:02.500162 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_exercise.not_null_fact_orders_order_id.6ba6d3f0a0, now test.dbt_exercise.not_null_fact_orders_sk_orders.c6a2fa98b5)
[0m16:43:02.501912 [debug] [Thread-3 (]: Began compiling node test.dbt_exercise.not_null_fact_orders_sk_orders.c6a2fa98b5
[0m16:43:02.511610 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_exercise.not_null_fact_orders_sk_orders.c6a2fa98b5"
[0m16:43:02.514054 [debug] [Thread-3 (]: Began executing node test.dbt_exercise.not_null_fact_orders_sk_orders.c6a2fa98b5
[0m16:43:02.520235 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_exercise.not_null_fact_orders_sk_orders.c6a2fa98b5"
[0m16:43:02.521625 [debug] [Thread-3 (]: On test.dbt_exercise.not_null_fact_orders_sk_orders.c6a2fa98b5: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "test.dbt_exercise.not_null_fact_orders_sk_orders.c6a2fa98b5"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select sk_orders
from `corded-sunlight-464012-e2`.`dbt_dw_marts`.`fact_orders`
where sk_orders is null



  
  
      
    ) dbt_internal_test
[0m16:43:02.522479 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:43:02.570410 [info ] [Thread-2 (]: 13 of 55 PASS not_null_fact_orders_sk_customer ................................. [[32mPASS[0m in 1.81s]
[0m16:43:02.571662 [debug] [Thread-2 (]: Finished running node test.dbt_exercise.not_null_fact_orders_sk_customer.6134ecd4cd
[0m16:43:02.572525 [debug] [Thread-2 (]: Began running node test.dbt_exercise.not_null_fact_orders_sk_product.9e0a112d70
[0m16:43:02.573644 [info ] [Thread-2 (]: 16 of 55 START test not_null_fact_orders_sk_product ............................ [RUN]
[0m16:43:02.574991 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_exercise.not_null_fact_orders_sk_customer.6134ecd4cd, now test.dbt_exercise.not_null_fact_orders_sk_product.9e0a112d70)
[0m16:43:02.576020 [debug] [Thread-2 (]: Began compiling node test.dbt_exercise.not_null_fact_orders_sk_product.9e0a112d70
[0m16:43:02.584167 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_exercise.not_null_fact_orders_sk_product.9e0a112d70"
[0m16:43:02.585972 [debug] [Thread-2 (]: Began executing node test.dbt_exercise.not_null_fact_orders_sk_product.9e0a112d70
[0m16:43:02.592529 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_exercise.not_null_fact_orders_sk_product.9e0a112d70"
[0m16:43:02.595784 [debug] [Thread-2 (]: On test.dbt_exercise.not_null_fact_orders_sk_product.9e0a112d70: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "test.dbt_exercise.not_null_fact_orders_sk_product.9e0a112d70"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select sk_product
from `corded-sunlight-464012-e2`.`dbt_dw_marts`.`fact_orders`
where sk_product is null



  
  
      
    ) dbt_internal_test
[0m16:43:02.597087 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:43:02.643136 [info ] [Thread-4 (]: 12 of 55 PASS not_null_fact_orders_product_id .................................. [[32mPASS[0m in 1.89s]
[0m16:43:02.644444 [debug] [Thread-4 (]: Finished running node test.dbt_exercise.not_null_fact_orders_product_id.346126b727
[0m16:43:02.645277 [debug] [Thread-4 (]: Began running node test.dbt_exercise.not_null_fact_orders_sk_ship.c82a3b72ed
[0m16:43:02.646733 [info ] [Thread-4 (]: 17 of 55 START test not_null_fact_orders_sk_ship ............................... [RUN]
[0m16:43:02.648217 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_exercise.not_null_fact_orders_product_id.346126b727, now test.dbt_exercise.not_null_fact_orders_sk_ship.c82a3b72ed)
[0m16:43:02.649252 [debug] [Thread-4 (]: Began compiling node test.dbt_exercise.not_null_fact_orders_sk_ship.c82a3b72ed
[0m16:43:02.657859 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_exercise.not_null_fact_orders_sk_ship.c82a3b72ed"
[0m16:43:02.659945 [debug] [Thread-4 (]: Began executing node test.dbt_exercise.not_null_fact_orders_sk_ship.c82a3b72ed
[0m16:43:02.664156 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_exercise.not_null_fact_orders_sk_ship.c82a3b72ed"
[0m16:43:02.667680 [debug] [Thread-4 (]: On test.dbt_exercise.not_null_fact_orders_sk_ship.c82a3b72ed: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "test.dbt_exercise.not_null_fact_orders_sk_ship.c82a3b72ed"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select sk_ship
from `corded-sunlight-464012-e2`.`dbt_dw_marts`.`fact_orders`
where sk_ship is null



  
  
      
    ) dbt_internal_test
[0m16:43:02.669604 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:43:03.347628 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:408cb722-05d6-4ad4-823d-4c3a1d1e7b1c&page=queryresults
[0m16:43:03.416854 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:8971c9f8-a87e-43f5-b174-f5aec8c02abd&page=queryresults
[0m16:43:03.567217 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:2f65f7a1-63a8-419f-9746-f5774f2d68c0&page=queryresults
[0m16:43:03.627177 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:852dacad-f345-4c03-942d-74a8ed740ae0&page=queryresults
[0m16:43:04.094132 [info ] [Thread-1 (]: 14 of 55 PASS not_null_fact_orders_sk_employee ................................. [[32mPASS[0m in 1.67s]
[0m16:43:04.096503 [debug] [Thread-1 (]: Finished running node test.dbt_exercise.not_null_fact_orders_sk_employee.cf36d136ff
[0m16:43:04.100436 [debug] [Thread-1 (]: Began running node test.dbt_exercise.source_accepted_values_northwind_categories_category_name__Beverages__Condiments__Confections__Dairy_Products__Grains_Cereals__Meat_Poultry__Produce__Seafood.ea6d0ab2ae
[0m16:43:04.102898 [info ] [Thread-1 (]: 18 of 55 START test source_accepted_values_northwind_categories_category_name__Beverages__Condiments__Confections__Dairy_Products__Grains_Cereals__Meat_Poultry__Produce__Seafood  [RUN]
[0m16:43:04.105169 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_exercise.not_null_fact_orders_sk_employee.cf36d136ff, now test.dbt_exercise.source_accepted_values_northwind_categories_category_name__Beverages__Condiments__Confections__Dairy_Products__Grains_Cereals__Meat_Poultry__Produce__Seafood.ea6d0ab2ae)
[0m16:43:04.106168 [debug] [Thread-1 (]: Began compiling node test.dbt_exercise.source_accepted_values_northwind_categories_category_name__Beverages__Condiments__Confections__Dairy_Products__Grains_Cereals__Meat_Poultry__Produce__Seafood.ea6d0ab2ae
[0m16:43:04.132460 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_exercise.source_accepted_values_northwind_categories_category_name__Beverages__Condiments__Confections__Dairy_Products__Grains_Cereals__Meat_Poultry__Produce__Seafood.ea6d0ab2ae"
[0m16:43:04.133707 [debug] [Thread-1 (]: Began executing node test.dbt_exercise.source_accepted_values_northwind_categories_category_name__Beverages__Condiments__Confections__Dairy_Products__Grains_Cereals__Meat_Poultry__Produce__Seafood.ea6d0ab2ae
[0m16:43:04.139241 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_exercise.source_accepted_values_northwind_categories_category_name__Beverages__Condiments__Confections__Dairy_Products__Grains_Cereals__Meat_Poultry__Produce__Seafood.ea6d0ab2ae"
[0m16:43:04.140809 [debug] [Thread-1 (]: On test.dbt_exercise.source_accepted_values_northwind_categories_category_name__Beverages__Condiments__Confections__Dairy_Products__Grains_Cereals__Meat_Poultry__Produce__Seafood.ea6d0ab2ae: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "test.dbt_exercise.source_accepted_values_northwind_categories_category_name__Beverages__Condiments__Confections__Dairy_Products__Grains_Cereals__Meat_Poultry__Produce__Seafood.ea6d0ab2ae"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        category_name as value_field,
        count(*) as n_records

    from `corded-sunlight-464012-e2`.`dbt_dw_raw`.`categories`
    group by category_name

)

select *
from all_values
where value_field not in (
    'Beverages','Condiments','Confections','Dairy Products','Grains/Cereals','Meat/Poultry','Produce','Seafood'
)



  
  
      
    ) dbt_internal_test
[0m16:43:04.141783 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:43:04.225900 [info ] [Thread-3 (]: 15 of 55 PASS not_null_fact_orders_sk_orders ................................... [[32mPASS[0m in 1.73s]
[0m16:43:04.227181 [debug] [Thread-3 (]: Finished running node test.dbt_exercise.not_null_fact_orders_sk_orders.c6a2fa98b5
[0m16:43:04.228179 [debug] [Thread-3 (]: Began running node test.dbt_exercise.source_not_null_northwind_categories_category_id.9a6df29828
[0m16:43:04.228943 [info ] [Thread-3 (]: 19 of 55 START test source_not_null_northwind_categories_category_id ........... [RUN]
[0m16:43:04.229814 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_exercise.not_null_fact_orders_sk_orders.c6a2fa98b5, now test.dbt_exercise.source_not_null_northwind_categories_category_id.9a6df29828)
[0m16:43:04.230492 [debug] [Thread-3 (]: Began compiling node test.dbt_exercise.source_not_null_northwind_categories_category_id.9a6df29828
[0m16:43:04.238085 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_exercise.source_not_null_northwind_categories_category_id.9a6df29828"
[0m16:43:04.240869 [debug] [Thread-3 (]: Began executing node test.dbt_exercise.source_not_null_northwind_categories_category_id.9a6df29828
[0m16:43:04.247103 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_exercise.source_not_null_northwind_categories_category_id.9a6df29828"
[0m16:43:04.249710 [debug] [Thread-3 (]: On test.dbt_exercise.source_not_null_northwind_categories_category_id.9a6df29828: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "test.dbt_exercise.source_not_null_northwind_categories_category_id.9a6df29828"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select category_id
from `corded-sunlight-464012-e2`.`dbt_dw_raw`.`categories`
where category_id is null



  
  
      
    ) dbt_internal_test
[0m16:43:04.250573 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:43:04.367778 [info ] [Thread-4 (]: 17 of 55 PASS not_null_fact_orders_sk_ship ..................................... [[32mPASS[0m in 1.72s]
[0m16:43:04.369303 [debug] [Thread-4 (]: Finished running node test.dbt_exercise.not_null_fact_orders_sk_ship.c82a3b72ed
[0m16:43:04.370052 [debug] [Thread-4 (]: Began running node test.dbt_exercise.source_not_null_northwind_country_codes_country_code.c623b5676c
[0m16:43:04.370973 [info ] [Thread-4 (]: 20 of 55 START test source_not_null_northwind_country_codes_country_code ....... [RUN]
[0m16:43:04.371878 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_exercise.not_null_fact_orders_sk_ship.c82a3b72ed, now test.dbt_exercise.source_not_null_northwind_country_codes_country_code.c623b5676c)
[0m16:43:04.372638 [debug] [Thread-4 (]: Began compiling node test.dbt_exercise.source_not_null_northwind_country_codes_country_code.c623b5676c
[0m16:43:04.380274 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_exercise.source_not_null_northwind_country_codes_country_code.c623b5676c"
[0m16:43:04.382216 [debug] [Thread-4 (]: Began executing node test.dbt_exercise.source_not_null_northwind_country_codes_country_code.c623b5676c
[0m16:43:04.388359 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_exercise.source_not_null_northwind_country_codes_country_code.c623b5676c"
[0m16:43:04.390886 [debug] [Thread-4 (]: On test.dbt_exercise.source_not_null_northwind_country_codes_country_code.c623b5676c: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "test.dbt_exercise.source_not_null_northwind_country_codes_country_code.c623b5676c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select country_code
from `corded-sunlight-464012-e2`.`dbt_dw_raw`.`country_codes`
where country_code is null



  
  
      
    ) dbt_internal_test
[0m16:43:04.393825 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:43:04.442290 [info ] [Thread-2 (]: 16 of 55 PASS not_null_fact_orders_sk_product .................................. [[32mPASS[0m in 1.87s]
[0m16:43:04.444358 [debug] [Thread-2 (]: Finished running node test.dbt_exercise.not_null_fact_orders_sk_product.9e0a112d70
[0m16:43:04.445860 [debug] [Thread-2 (]: Began running node test.dbt_exercise.source_not_null_northwind_customers_customer_id.dba99593d2
[0m16:43:04.447080 [info ] [Thread-2 (]: 21 of 55 START test source_not_null_northwind_customers_customer_id ............ [RUN]
[0m16:43:04.448195 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_exercise.not_null_fact_orders_sk_product.9e0a112d70, now test.dbt_exercise.source_not_null_northwind_customers_customer_id.dba99593d2)
[0m16:43:04.449054 [debug] [Thread-2 (]: Began compiling node test.dbt_exercise.source_not_null_northwind_customers_customer_id.dba99593d2
[0m16:43:04.456697 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_exercise.source_not_null_northwind_customers_customer_id.dba99593d2"
[0m16:43:04.458978 [debug] [Thread-2 (]: Began executing node test.dbt_exercise.source_not_null_northwind_customers_customer_id.dba99593d2
[0m16:43:04.464185 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_exercise.source_not_null_northwind_customers_customer_id.dba99593d2"
[0m16:43:04.465801 [debug] [Thread-2 (]: On test.dbt_exercise.source_not_null_northwind_customers_customer_id.dba99593d2: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "test.dbt_exercise.source_not_null_northwind_customers_customer_id.dba99593d2"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select customer_id
from `corded-sunlight-464012-e2`.`dbt_dw_raw`.`customers`
where customer_id is null



  
  
      
    ) dbt_internal_test
[0m16:43:04.467054 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:43:05.059276 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:c4ec3201-8df7-4254-babd-95ded9e033f1&page=queryresults
[0m16:43:05.174988 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:18899c5f-4f6e-4d1b-bb4a-a9da67263310&page=queryresults
[0m16:43:05.278940 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:70616e5d-c8de-4c7e-97c3-05c0375906d5&page=queryresults
[0m16:43:05.421758 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:0cacc815-9ca3-4a38-bd6b-6dbfe3b0280c&page=queryresults
[0m16:43:05.829120 [info ] [Thread-1 (]: 18 of 55 PASS source_accepted_values_northwind_categories_category_name__Beverages__Condiments__Confections__Dairy_Products__Grains_Cereals__Meat_Poultry__Produce__Seafood  [[32mPASS[0m in 1.72s]
[0m16:43:05.830655 [debug] [Thread-1 (]: Finished running node test.dbt_exercise.source_accepted_values_northwind_categories_category_name__Beverages__Condiments__Confections__Dairy_Products__Grains_Cereals__Meat_Poultry__Produce__Seafood.ea6d0ab2ae
[0m16:43:05.831475 [debug] [Thread-1 (]: Began running node test.dbt_exercise.source_not_null_northwind_dados_financeiros_data.cdd6b46fe7
[0m16:43:05.832425 [info ] [Thread-1 (]: 22 of 55 START test source_not_null_northwind_dados_financeiros_data ........... [RUN]
[0m16:43:05.833389 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_exercise.source_accepted_values_northwind_categories_category_name__Beverages__Condiments__Confections__Dairy_Products__Grains_Cereals__Meat_Poultry__Produce__Seafood.ea6d0ab2ae, now test.dbt_exercise.source_not_null_northwind_dados_financeiros_data.cdd6b46fe7)
[0m16:43:05.834111 [debug] [Thread-1 (]: Began compiling node test.dbt_exercise.source_not_null_northwind_dados_financeiros_data.cdd6b46fe7
[0m16:43:05.843079 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_exercise.source_not_null_northwind_dados_financeiros_data.cdd6b46fe7"
[0m16:43:05.845045 [debug] [Thread-1 (]: Began executing node test.dbt_exercise.source_not_null_northwind_dados_financeiros_data.cdd6b46fe7
[0m16:43:05.854411 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_exercise.source_not_null_northwind_dados_financeiros_data.cdd6b46fe7"
[0m16:43:05.857075 [debug] [Thread-1 (]: On test.dbt_exercise.source_not_null_northwind_dados_financeiros_data.cdd6b46fe7: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "test.dbt_exercise.source_not_null_northwind_dados_financeiros_data.cdd6b46fe7"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select data
from `corded-sunlight-464012-e2`.`dbt_dw_raw`.`dados_financeiros`
where data is null



  
  
      
    ) dbt_internal_test
[0m16:43:05.858919 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:43:05.949259 [info ] [Thread-3 (]: 19 of 55 PASS source_not_null_northwind_categories_category_id ................. [[32mPASS[0m in 1.72s]
[0m16:43:05.950566 [debug] [Thread-3 (]: Finished running node test.dbt_exercise.source_not_null_northwind_categories_category_id.9a6df29828
[0m16:43:05.951354 [debug] [Thread-3 (]: Began running node test.dbt_exercise.source_not_null_northwind_employee_territories_employee_id.d7372217ec
[0m16:43:05.952285 [info ] [Thread-3 (]: 23 of 55 START test source_not_null_northwind_employee_territories_employee_id . [RUN]
[0m16:43:05.953193 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_exercise.source_not_null_northwind_categories_category_id.9a6df29828, now test.dbt_exercise.source_not_null_northwind_employee_territories_employee_id.d7372217ec)
[0m16:43:05.954016 [debug] [Thread-3 (]: Began compiling node test.dbt_exercise.source_not_null_northwind_employee_territories_employee_id.d7372217ec
[0m16:43:05.961309 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_exercise.source_not_null_northwind_employee_territories_employee_id.d7372217ec"
[0m16:43:05.962773 [debug] [Thread-3 (]: Began executing node test.dbt_exercise.source_not_null_northwind_employee_territories_employee_id.d7372217ec
[0m16:43:05.970622 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_exercise.source_not_null_northwind_employee_territories_employee_id.d7372217ec"
[0m16:43:05.972723 [debug] [Thread-3 (]: On test.dbt_exercise.source_not_null_northwind_employee_territories_employee_id.d7372217ec: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "test.dbt_exercise.source_not_null_northwind_employee_territories_employee_id.d7372217ec"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select employee_id
from `corded-sunlight-464012-e2`.`dbt_dw_raw`.`employee_territories`
where employee_id is null



  
  
      
    ) dbt_internal_test
[0m16:43:05.973777 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:43:06.094095 [info ] [Thread-4 (]: 20 of 55 PASS source_not_null_northwind_country_codes_country_code ............. [[32mPASS[0m in 1.72s]
[0m16:43:06.095322 [debug] [Thread-4 (]: Finished running node test.dbt_exercise.source_not_null_northwind_country_codes_country_code.c623b5676c
[0m16:43:06.096205 [debug] [Thread-4 (]: Began running node test.dbt_exercise.source_not_null_northwind_employee_territories_territory_id.ae648a0b88
[0m16:43:06.097128 [info ] [Thread-4 (]: 24 of 55 START test source_not_null_northwind_employee_territories_territory_id  [RUN]
[0m16:43:06.097933 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_exercise.source_not_null_northwind_country_codes_country_code.c623b5676c, now test.dbt_exercise.source_not_null_northwind_employee_territories_territory_id.ae648a0b88)
[0m16:43:06.098601 [debug] [Thread-4 (]: Began compiling node test.dbt_exercise.source_not_null_northwind_employee_territories_territory_id.ae648a0b88
[0m16:43:06.106225 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_exercise.source_not_null_northwind_employee_territories_territory_id.ae648a0b88"
[0m16:43:06.108945 [debug] [Thread-4 (]: Began executing node test.dbt_exercise.source_not_null_northwind_employee_territories_territory_id.ae648a0b88
[0m16:43:06.114688 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_exercise.source_not_null_northwind_employee_territories_territory_id.ae648a0b88"
[0m16:43:06.119521 [debug] [Thread-4 (]: On test.dbt_exercise.source_not_null_northwind_employee_territories_territory_id.ae648a0b88: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "test.dbt_exercise.source_not_null_northwind_employee_territories_territory_id.ae648a0b88"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select territory_id
from `corded-sunlight-464012-e2`.`dbt_dw_raw`.`employee_territories`
where territory_id is null



  
  
      
    ) dbt_internal_test
[0m16:43:06.122154 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:43:06.256050 [info ] [Thread-2 (]: 21 of 55 PASS source_not_null_northwind_customers_customer_id .................. [[32mPASS[0m in 1.81s]
[0m16:43:06.257461 [debug] [Thread-2 (]: Finished running node test.dbt_exercise.source_not_null_northwind_customers_customer_id.dba99593d2
[0m16:43:06.258418 [debug] [Thread-2 (]: Began running node test.dbt_exercise.source_not_null_northwind_employees_employee_id.829479a08c
[0m16:43:06.259604 [info ] [Thread-2 (]: 25 of 55 START test source_not_null_northwind_employees_employee_id ............ [RUN]
[0m16:43:06.261124 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_exercise.source_not_null_northwind_customers_customer_id.dba99593d2, now test.dbt_exercise.source_not_null_northwind_employees_employee_id.829479a08c)
[0m16:43:06.262590 [debug] [Thread-2 (]: Began compiling node test.dbt_exercise.source_not_null_northwind_employees_employee_id.829479a08c
[0m16:43:06.271325 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_exercise.source_not_null_northwind_employees_employee_id.829479a08c"
[0m16:43:06.273164 [debug] [Thread-2 (]: Began executing node test.dbt_exercise.source_not_null_northwind_employees_employee_id.829479a08c
[0m16:43:06.278746 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_exercise.source_not_null_northwind_employees_employee_id.829479a08c"
[0m16:43:06.280326 [debug] [Thread-2 (]: On test.dbt_exercise.source_not_null_northwind_employees_employee_id.829479a08c: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "test.dbt_exercise.source_not_null_northwind_employees_employee_id.829479a08c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select employee_id
from `corded-sunlight-464012-e2`.`dbt_dw_raw`.`employees`
where employee_id is null



  
  
      
    ) dbt_internal_test
[0m16:43:06.281327 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:43:06.874001 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:3a8868d5-fd2c-44d3-8345-043ee0419b81&page=queryresults
[0m16:43:06.903949 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:0f71424a-63e3-4e8b-91b1-e6feeab69b82&page=queryresults
[0m16:43:07.050105 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:1b520e99-d9da-41e1-b7b1-e64cce0ce56a&page=queryresults
[0m16:43:07.254657 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:8b86d34f-e4a1-4df4-85a6-aa74b6375370&page=queryresults
[0m16:43:07.623443 [info ] [Thread-1 (]: 22 of 55 PASS source_not_null_northwind_dados_financeiros_data ................. [[32mPASS[0m in 1.79s]
[0m16:43:07.624843 [debug] [Thread-1 (]: Finished running node test.dbt_exercise.source_not_null_northwind_dados_financeiros_data.cdd6b46fe7
[0m16:43:07.625641 [debug] [Thread-1 (]: Began running node test.dbt_exercise.source_not_null_northwind_order_details_order_id.8acd43693e
[0m16:43:07.626535 [info ] [Thread-1 (]: 26 of 55 START test source_not_null_northwind_order_details_order_id ........... [RUN]
[0m16:43:07.627495 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_exercise.source_not_null_northwind_dados_financeiros_data.cdd6b46fe7, now test.dbt_exercise.source_not_null_northwind_order_details_order_id.8acd43693e)
[0m16:43:07.628333 [debug] [Thread-1 (]: Began compiling node test.dbt_exercise.source_not_null_northwind_order_details_order_id.8acd43693e
[0m16:43:07.636768 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_exercise.source_not_null_northwind_order_details_order_id.8acd43693e"
[0m16:43:07.638444 [debug] [Thread-1 (]: Began executing node test.dbt_exercise.source_not_null_northwind_order_details_order_id.8acd43693e
[0m16:43:07.652596 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_exercise.source_not_null_northwind_order_details_order_id.8acd43693e"
[0m16:43:07.654452 [debug] [Thread-1 (]: On test.dbt_exercise.source_not_null_northwind_order_details_order_id.8acd43693e: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "test.dbt_exercise.source_not_null_northwind_order_details_order_id.8acd43693e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select order_id
from `corded-sunlight-464012-e2`.`dbt_dw_raw`.`order_details`
where order_id is null



  
  
      
    ) dbt_internal_test
[0m16:43:07.655619 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:43:07.711111 [info ] [Thread-3 (]: 23 of 55 PASS source_not_null_northwind_employee_territories_employee_id ....... [[32mPASS[0m in 1.76s]
[0m16:43:07.712873 [debug] [Thread-3 (]: Finished running node test.dbt_exercise.source_not_null_northwind_employee_territories_employee_id.d7372217ec
[0m16:43:07.714346 [debug] [Thread-3 (]: Began running node test.dbt_exercise.source_not_null_northwind_order_details_product_id.c084f7ad12
[0m16:43:07.715828 [info ] [Thread-3 (]: 27 of 55 START test source_not_null_northwind_order_details_product_id ......... [RUN]
[0m16:43:07.717973 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_exercise.source_not_null_northwind_employee_territories_employee_id.d7372217ec, now test.dbt_exercise.source_not_null_northwind_order_details_product_id.c084f7ad12)
[0m16:43:07.719838 [debug] [Thread-3 (]: Began compiling node test.dbt_exercise.source_not_null_northwind_order_details_product_id.c084f7ad12
[0m16:43:07.730155 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_exercise.source_not_null_northwind_order_details_product_id.c084f7ad12"
[0m16:43:07.731963 [debug] [Thread-3 (]: Began executing node test.dbt_exercise.source_not_null_northwind_order_details_product_id.c084f7ad12
[0m16:43:07.737649 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_exercise.source_not_null_northwind_order_details_product_id.c084f7ad12"
[0m16:43:07.740094 [debug] [Thread-3 (]: On test.dbt_exercise.source_not_null_northwind_order_details_product_id.c084f7ad12: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "test.dbt_exercise.source_not_null_northwind_order_details_product_id.c084f7ad12"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select product_id
from `corded-sunlight-464012-e2`.`dbt_dw_raw`.`order_details`
where product_id is null



  
  
      
    ) dbt_internal_test
[0m16:43:07.741426 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:43:07.943997 [info ] [Thread-4 (]: 24 of 55 PASS source_not_null_northwind_employee_territories_territory_id ...... [[32mPASS[0m in 1.85s]
[0m16:43:07.945261 [debug] [Thread-4 (]: Finished running node test.dbt_exercise.source_not_null_northwind_employee_territories_territory_id.ae648a0b88
[0m16:43:07.946024 [debug] [Thread-4 (]: Began running node test.dbt_exercise.source_not_null_northwind_orders_customer_id.3e09955b24
[0m16:43:07.946914 [info ] [Thread-4 (]: 28 of 55 START test source_not_null_northwind_orders_customer_id ............... [RUN]
[0m16:43:07.947832 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_exercise.source_not_null_northwind_employee_territories_territory_id.ae648a0b88, now test.dbt_exercise.source_not_null_northwind_orders_customer_id.3e09955b24)
[0m16:43:07.948708 [debug] [Thread-4 (]: Began compiling node test.dbt_exercise.source_not_null_northwind_orders_customer_id.3e09955b24
[0m16:43:07.957313 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_exercise.source_not_null_northwind_orders_customer_id.3e09955b24"
[0m16:43:07.958930 [debug] [Thread-4 (]: Began executing node test.dbt_exercise.source_not_null_northwind_orders_customer_id.3e09955b24
[0m16:43:07.964741 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_exercise.source_not_null_northwind_orders_customer_id.3e09955b24"
[0m16:43:07.966560 [debug] [Thread-4 (]: On test.dbt_exercise.source_not_null_northwind_orders_customer_id.3e09955b24: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "test.dbt_exercise.source_not_null_northwind_orders_customer_id.3e09955b24"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select customer_id
from `corded-sunlight-464012-e2`.`dbt_dw_raw`.`orders`
where customer_id is null



  
  
      
    ) dbt_internal_test
[0m16:43:07.968052 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:43:08.030761 [info ] [Thread-2 (]: 25 of 55 PASS source_not_null_northwind_employees_employee_id .................. [[32mPASS[0m in 1.77s]
[0m16:43:08.032247 [debug] [Thread-2 (]: Finished running node test.dbt_exercise.source_not_null_northwind_employees_employee_id.829479a08c
[0m16:43:08.033075 [debug] [Thread-2 (]: Began running node test.dbt_exercise.source_not_null_northwind_orders_employee_id.a8f4bf5ca3
[0m16:43:08.034231 [info ] [Thread-2 (]: 29 of 55 START test source_not_null_northwind_orders_employee_id ............... [RUN]
[0m16:43:08.035092 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_exercise.source_not_null_northwind_employees_employee_id.829479a08c, now test.dbt_exercise.source_not_null_northwind_orders_employee_id.a8f4bf5ca3)
[0m16:43:08.035838 [debug] [Thread-2 (]: Began compiling node test.dbt_exercise.source_not_null_northwind_orders_employee_id.a8f4bf5ca3
[0m16:43:08.042869 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_exercise.source_not_null_northwind_orders_employee_id.a8f4bf5ca3"
[0m16:43:08.044588 [debug] [Thread-2 (]: Began executing node test.dbt_exercise.source_not_null_northwind_orders_employee_id.a8f4bf5ca3
[0m16:43:08.049689 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_exercise.source_not_null_northwind_orders_employee_id.a8f4bf5ca3"
[0m16:43:08.051661 [debug] [Thread-2 (]: On test.dbt_exercise.source_not_null_northwind_orders_employee_id.a8f4bf5ca3: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "test.dbt_exercise.source_not_null_northwind_orders_employee_id.a8f4bf5ca3"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select employee_id
from `corded-sunlight-464012-e2`.`dbt_dw_raw`.`orders`
where employee_id is null



  
  
      
    ) dbt_internal_test
[0m16:43:08.053540 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:43:08.602917 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:fd7c18f0-190b-4ef9-9e07-e38a6d5dcd37&page=queryresults
[0m16:43:08.695232 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:a4145b28-fd45-44b1-a77b-f04dd0d99afb&page=queryresults
[0m16:43:08.939573 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:75e23aa1-f89c-4c6f-9598-15aa977e7ac1&page=queryresults
[0m16:43:08.994543 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:dd7e59f2-69f5-4411-89e4-d5f9dd01055d&page=queryresults
[0m16:43:09.377354 [info ] [Thread-1 (]: 26 of 55 PASS source_not_null_northwind_order_details_order_id ................. [[32mPASS[0m in 1.75s]
[0m16:43:09.378874 [debug] [Thread-1 (]: Finished running node test.dbt_exercise.source_not_null_northwind_order_details_order_id.8acd43693e
[0m16:43:09.379671 [debug] [Thread-1 (]: Began running node test.dbt_exercise.source_not_null_northwind_orders_order_id.5a7c008c6e
[0m16:43:09.380599 [info ] [Thread-1 (]: 30 of 55 START test source_not_null_northwind_orders_order_id .................. [RUN]
[0m16:43:09.381554 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_exercise.source_not_null_northwind_order_details_order_id.8acd43693e, now test.dbt_exercise.source_not_null_northwind_orders_order_id.5a7c008c6e)
[0m16:43:09.382256 [debug] [Thread-1 (]: Began compiling node test.dbt_exercise.source_not_null_northwind_orders_order_id.5a7c008c6e
[0m16:43:09.390903 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_exercise.source_not_null_northwind_orders_order_id.5a7c008c6e"
[0m16:43:09.392729 [debug] [Thread-1 (]: Began executing node test.dbt_exercise.source_not_null_northwind_orders_order_id.5a7c008c6e
[0m16:43:09.399045 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_exercise.source_not_null_northwind_orders_order_id.5a7c008c6e"
[0m16:43:09.402161 [debug] [Thread-1 (]: On test.dbt_exercise.source_not_null_northwind_orders_order_id.5a7c008c6e: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "test.dbt_exercise.source_not_null_northwind_orders_order_id.5a7c008c6e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select order_id
from `corded-sunlight-464012-e2`.`dbt_dw_raw`.`orders`
where order_id is null



  
  
      
    ) dbt_internal_test
[0m16:43:09.403487 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:43:09.451313 [info ] [Thread-3 (]: 27 of 55 PASS source_not_null_northwind_order_details_product_id ............... [[32mPASS[0m in 1.73s]
[0m16:43:09.452652 [debug] [Thread-3 (]: Finished running node test.dbt_exercise.source_not_null_northwind_order_details_product_id.c084f7ad12
[0m16:43:09.453840 [debug] [Thread-3 (]: Began running node test.dbt_exercise.source_not_null_northwind_products_product_id.1bc1aa1d1c
[0m16:43:09.455256 [info ] [Thread-3 (]: 31 of 55 START test source_not_null_northwind_products_product_id .............. [RUN]
[0m16:43:09.456801 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_exercise.source_not_null_northwind_order_details_product_id.c084f7ad12, now test.dbt_exercise.source_not_null_northwind_products_product_id.1bc1aa1d1c)
[0m16:43:09.458126 [debug] [Thread-3 (]: Began compiling node test.dbt_exercise.source_not_null_northwind_products_product_id.1bc1aa1d1c
[0m16:43:09.474224 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_exercise.source_not_null_northwind_products_product_id.1bc1aa1d1c"
[0m16:43:09.482165 [debug] [Thread-3 (]: Began executing node test.dbt_exercise.source_not_null_northwind_products_product_id.1bc1aa1d1c
[0m16:43:09.486512 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_exercise.source_not_null_northwind_products_product_id.1bc1aa1d1c"
[0m16:43:09.488064 [debug] [Thread-3 (]: On test.dbt_exercise.source_not_null_northwind_products_product_id.1bc1aa1d1c: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "test.dbt_exercise.source_not_null_northwind_products_product_id.1bc1aa1d1c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select product_id
from `corded-sunlight-464012-e2`.`dbt_dw_raw`.`products`
where product_id is null



  
  
      
    ) dbt_internal_test
[0m16:43:09.488981 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:43:09.748242 [info ] [Thread-4 (]: 28 of 55 PASS source_not_null_northwind_orders_customer_id ..................... [[32mPASS[0m in 1.80s]
[0m16:43:09.749587 [debug] [Thread-4 (]: Finished running node test.dbt_exercise.source_not_null_northwind_orders_customer_id.3e09955b24
[0m16:43:09.750265 [debug] [Thread-4 (]: Began running node test.dbt_exercise.source_not_null_northwind_region_region_id.c95367d9e3
[0m16:43:09.751533 [info ] [Thread-4 (]: 32 of 55 START test source_not_null_northwind_region_region_id ................. [RUN]
[0m16:43:09.753400 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_exercise.source_not_null_northwind_orders_customer_id.3e09955b24, now test.dbt_exercise.source_not_null_northwind_region_region_id.c95367d9e3)
[0m16:43:09.754723 [debug] [Thread-4 (]: Began compiling node test.dbt_exercise.source_not_null_northwind_region_region_id.c95367d9e3
[0m16:43:09.765144 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_exercise.source_not_null_northwind_region_region_id.c95367d9e3"
[0m16:43:09.768310 [debug] [Thread-4 (]: Began executing node test.dbt_exercise.source_not_null_northwind_region_region_id.c95367d9e3
[0m16:43:09.776630 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_exercise.source_not_null_northwind_region_region_id.c95367d9e3"
[0m16:43:09.778900 [debug] [Thread-4 (]: On test.dbt_exercise.source_not_null_northwind_region_region_id.c95367d9e3: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "test.dbt_exercise.source_not_null_northwind_region_region_id.c95367d9e3"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select region_id
from `corded-sunlight-464012-e2`.`dbt_dw_raw`.`region`
where region_id is null



  
  
      
    ) dbt_internal_test
[0m16:43:09.780485 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:43:09.828902 [info ] [Thread-2 (]: 29 of 55 PASS source_not_null_northwind_orders_employee_id ..................... [[32mPASS[0m in 1.79s]
[0m16:43:09.831387 [debug] [Thread-2 (]: Finished running node test.dbt_exercise.source_not_null_northwind_orders_employee_id.a8f4bf5ca3
[0m16:43:09.835236 [debug] [Thread-2 (]: Began running node test.dbt_exercise.source_not_null_northwind_shippers_shipper_id.45221752ca
[0m16:43:09.837260 [info ] [Thread-2 (]: 33 of 55 START test source_not_null_northwind_shippers_shipper_id .............. [RUN]
[0m16:43:09.839220 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_exercise.source_not_null_northwind_orders_employee_id.a8f4bf5ca3, now test.dbt_exercise.source_not_null_northwind_shippers_shipper_id.45221752ca)
[0m16:43:09.841399 [debug] [Thread-2 (]: Began compiling node test.dbt_exercise.source_not_null_northwind_shippers_shipper_id.45221752ca
[0m16:43:09.853752 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_exercise.source_not_null_northwind_shippers_shipper_id.45221752ca"
[0m16:43:09.856073 [debug] [Thread-2 (]: Began executing node test.dbt_exercise.source_not_null_northwind_shippers_shipper_id.45221752ca
[0m16:43:09.862547 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_exercise.source_not_null_northwind_shippers_shipper_id.45221752ca"
[0m16:43:09.864502 [debug] [Thread-2 (]: On test.dbt_exercise.source_not_null_northwind_shippers_shipper_id.45221752ca: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "test.dbt_exercise.source_not_null_northwind_shippers_shipper_id.45221752ca"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select shipper_id
from `corded-sunlight-464012-e2`.`dbt_dw_raw`.`shippers`
where shipper_id is null



  
  
      
    ) dbt_internal_test
[0m16:43:09.865378 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:43:10.416656 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:dada37c2-1036-40e4-8f26-10da71d0b28c&page=queryresults
[0m16:43:10.422174 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:2ad2aa89-8b97-477c-bc38-0d5009452f20&page=queryresults
[0m16:43:10.743449 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:32c542f7-0ad8-4534-9ea7-ad3d7d11373d&page=queryresults
[0m16:43:10.777450 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:5dffcb76-3418-410b-9fc4-8e92fc3423eb&page=queryresults
[0m16:43:11.165415 [info ] [Thread-3 (]: 31 of 55 PASS source_not_null_northwind_products_product_id .................... [[32mPASS[0m in 1.71s]
[0m16:43:11.166669 [debug] [Thread-3 (]: Finished running node test.dbt_exercise.source_not_null_northwind_products_product_id.1bc1aa1d1c
[0m16:43:11.167462 [debug] [Thread-3 (]: Began running node test.dbt_exercise.source_not_null_northwind_suppliers_supplier_id.de5c4d0062
[0m16:43:11.168371 [info ] [Thread-3 (]: 34 of 55 START test source_not_null_northwind_suppliers_supplier_id ............ [RUN]
[0m16:43:11.169234 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_exercise.source_not_null_northwind_products_product_id.1bc1aa1d1c, now test.dbt_exercise.source_not_null_northwind_suppliers_supplier_id.de5c4d0062)
[0m16:43:11.169910 [debug] [Thread-3 (]: Began compiling node test.dbt_exercise.source_not_null_northwind_suppliers_supplier_id.de5c4d0062
[0m16:43:11.178141 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_exercise.source_not_null_northwind_suppliers_supplier_id.de5c4d0062"
[0m16:43:11.179808 [debug] [Thread-3 (]: Began executing node test.dbt_exercise.source_not_null_northwind_suppliers_supplier_id.de5c4d0062
[0m16:43:11.186659 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_exercise.source_not_null_northwind_suppliers_supplier_id.de5c4d0062"
[0m16:43:11.192615 [info ] [Thread-1 (]: 30 of 55 PASS source_not_null_northwind_orders_order_id ........................ [[32mPASS[0m in 1.81s]
[0m16:43:11.193733 [debug] [Thread-3 (]: On test.dbt_exercise.source_not_null_northwind_suppliers_supplier_id.de5c4d0062: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "test.dbt_exercise.source_not_null_northwind_suppliers_supplier_id.de5c4d0062"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select supplier_id
from `corded-sunlight-464012-e2`.`dbt_dw_raw`.`suppliers`
where supplier_id is null



  
  
      
    ) dbt_internal_test
[0m16:43:11.194964 [debug] [Thread-1 (]: Finished running node test.dbt_exercise.source_not_null_northwind_orders_order_id.5a7c008c6e
[0m16:43:11.196136 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:43:11.197161 [debug] [Thread-1 (]: Began running node test.dbt_exercise.source_not_null_northwind_territories_region_id.5df71bcf81
[0m16:43:11.198638 [info ] [Thread-1 (]: 35 of 55 START test source_not_null_northwind_territories_region_id ............ [RUN]
[0m16:43:11.200109 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_exercise.source_not_null_northwind_orders_order_id.5a7c008c6e, now test.dbt_exercise.source_not_null_northwind_territories_region_id.5df71bcf81)
[0m16:43:11.204401 [debug] [Thread-1 (]: Began compiling node test.dbt_exercise.source_not_null_northwind_territories_region_id.5df71bcf81
[0m16:43:11.221298 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_exercise.source_not_null_northwind_territories_region_id.5df71bcf81"
[0m16:43:11.231117 [debug] [Thread-1 (]: Began executing node test.dbt_exercise.source_not_null_northwind_territories_region_id.5df71bcf81
[0m16:43:11.278192 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_exercise.source_not_null_northwind_territories_region_id.5df71bcf81"
[0m16:43:11.281468 [debug] [Thread-1 (]: On test.dbt_exercise.source_not_null_northwind_territories_region_id.5df71bcf81: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "test.dbt_exercise.source_not_null_northwind_territories_region_id.5df71bcf81"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select region_id
from `corded-sunlight-464012-e2`.`dbt_dw_raw`.`territories`
where region_id is null



  
  
      
    ) dbt_internal_test
[0m16:43:11.282668 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:43:11.492242 [info ] [Thread-4 (]: 32 of 55 PASS source_not_null_northwind_region_region_id ....................... [[32mPASS[0m in 1.74s]
[0m16:43:11.493512 [debug] [Thread-4 (]: Finished running node test.dbt_exercise.source_not_null_northwind_region_region_id.c95367d9e3
[0m16:43:11.494298 [debug] [Thread-4 (]: Began running node test.dbt_exercise.source_not_null_northwind_territories_territory_id.9b9655b8a9
[0m16:43:11.495213 [info ] [Thread-4 (]: 36 of 55 START test source_not_null_northwind_territories_territory_id ......... [RUN]
[0m16:43:11.496312 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_exercise.source_not_null_northwind_region_region_id.c95367d9e3, now test.dbt_exercise.source_not_null_northwind_territories_territory_id.9b9655b8a9)
[0m16:43:11.497160 [debug] [Thread-4 (]: Began compiling node test.dbt_exercise.source_not_null_northwind_territories_territory_id.9b9655b8a9
[0m16:43:11.505243 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_exercise.source_not_null_northwind_territories_territory_id.9b9655b8a9"
[0m16:43:11.507032 [debug] [Thread-4 (]: Began executing node test.dbt_exercise.source_not_null_northwind_territories_territory_id.9b9655b8a9
[0m16:43:11.514113 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_exercise.source_not_null_northwind_territories_territory_id.9b9655b8a9"
[0m16:43:11.516973 [debug] [Thread-4 (]: On test.dbt_exercise.source_not_null_northwind_territories_territory_id.9b9655b8a9: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "test.dbt_exercise.source_not_null_northwind_territories_territory_id.9b9655b8a9"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select territory_id
from `corded-sunlight-464012-e2`.`dbt_dw_raw`.`territories`
where territory_id is null



  
  
      
    ) dbt_internal_test
[0m16:43:11.518007 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:43:11.592131 [info ] [Thread-2 (]: 33 of 55 PASS source_not_null_northwind_shippers_shipper_id .................... [[32mPASS[0m in 1.75s]
[0m16:43:11.594133 [debug] [Thread-2 (]: Finished running node test.dbt_exercise.source_not_null_northwind_shippers_shipper_id.45221752ca
[0m16:43:11.595267 [debug] [Thread-2 (]: Began running node test.dbt_exercise.source_not_null_northwind_us_states_state_id.2e33a23d78
[0m16:43:11.596744 [info ] [Thread-2 (]: 37 of 55 START test source_not_null_northwind_us_states_state_id ............... [RUN]
[0m16:43:11.598139 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_exercise.source_not_null_northwind_shippers_shipper_id.45221752ca, now test.dbt_exercise.source_not_null_northwind_us_states_state_id.2e33a23d78)
[0m16:43:11.598938 [debug] [Thread-2 (]: Began compiling node test.dbt_exercise.source_not_null_northwind_us_states_state_id.2e33a23d78
[0m16:43:11.606912 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_exercise.source_not_null_northwind_us_states_state_id.2e33a23d78"
[0m16:43:11.609054 [debug] [Thread-2 (]: Began executing node test.dbt_exercise.source_not_null_northwind_us_states_state_id.2e33a23d78
[0m16:43:11.616692 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_exercise.source_not_null_northwind_us_states_state_id.2e33a23d78"
[0m16:43:11.618544 [debug] [Thread-2 (]: On test.dbt_exercise.source_not_null_northwind_us_states_state_id.2e33a23d78: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "test.dbt_exercise.source_not_null_northwind_us_states_state_id.2e33a23d78"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select state_id
from `corded-sunlight-464012-e2`.`dbt_dw_raw`.`us_states`
where state_id is null



  
  
      
    ) dbt_internal_test
[0m16:43:11.619420 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:43:12.237697 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:dd0ef200-67a4-4e8e-ad5e-a90a4e67edc4&page=queryresults
[0m16:43:12.357113 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:a04d3753-d1db-4c02-a769-09066df5892c&page=queryresults
[0m16:43:12.534038 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:f22e4e5e-8cf3-4331-86b4-0435832ccc94&page=queryresults
[0m16:43:12.609498 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:e1a36f9c-e227-4a4b-8ecd-eeec453b764a&page=queryresults
[0m16:43:13.101130 [info ] [Thread-3 (]: 34 of 55 PASS source_not_null_northwind_suppliers_supplier_id .................. [[32mPASS[0m in 1.93s]
[0m16:43:13.102458 [debug] [Thread-3 (]: Finished running node test.dbt_exercise.source_not_null_northwind_suppliers_supplier_id.de5c4d0062
[0m16:43:13.103291 [debug] [Thread-3 (]: Began running node test.dbt_exercise.source_unique_northwind_categories_category_id.17d9baa2e0
[0m16:43:13.104345 [info ] [Thread-3 (]: 38 of 55 START test source_unique_northwind_categories_category_id ............. [RUN]
[0m16:43:13.105416 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_exercise.source_not_null_northwind_suppliers_supplier_id.de5c4d0062, now test.dbt_exercise.source_unique_northwind_categories_category_id.17d9baa2e0)
[0m16:43:13.106286 [debug] [Thread-3 (]: Began compiling node test.dbt_exercise.source_unique_northwind_categories_category_id.17d9baa2e0
[0m16:43:13.121505 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_exercise.source_unique_northwind_categories_category_id.17d9baa2e0"
[0m16:43:13.123231 [debug] [Thread-3 (]: Began executing node test.dbt_exercise.source_unique_northwind_categories_category_id.17d9baa2e0
[0m16:43:13.130087 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_exercise.source_unique_northwind_categories_category_id.17d9baa2e0"
[0m16:43:13.131910 [debug] [Thread-3 (]: On test.dbt_exercise.source_unique_northwind_categories_category_id.17d9baa2e0: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "test.dbt_exercise.source_unique_northwind_categories_category_id.17d9baa2e0"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with dbt_test__target as (

  select category_id as unique_field
  from `corded-sunlight-464012-e2`.`dbt_dw_raw`.`categories`
  where category_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m16:43:13.132852 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:43:13.212222 [info ] [Thread-1 (]: 35 of 55 PASS source_not_null_northwind_territories_region_id .................. [[32mPASS[0m in 2.01s]
[0m16:43:13.213715 [debug] [Thread-1 (]: Finished running node test.dbt_exercise.source_not_null_northwind_territories_region_id.5df71bcf81
[0m16:43:13.214813 [debug] [Thread-1 (]: Began running node test.dbt_exercise.source_unique_northwind_country_codes_country_code.cf83d0431e
[0m16:43:13.216167 [info ] [Thread-1 (]: 39 of 55 START test source_unique_northwind_country_codes_country_code ......... [RUN]
[0m16:43:13.217567 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_exercise.source_not_null_northwind_territories_region_id.5df71bcf81, now test.dbt_exercise.source_unique_northwind_country_codes_country_code.cf83d0431e)
[0m16:43:13.218665 [debug] [Thread-1 (]: Began compiling node test.dbt_exercise.source_unique_northwind_country_codes_country_code.cf83d0431e
[0m16:43:13.232441 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_exercise.source_unique_northwind_country_codes_country_code.cf83d0431e"
[0m16:43:13.238898 [debug] [Thread-1 (]: Began executing node test.dbt_exercise.source_unique_northwind_country_codes_country_code.cf83d0431e
[0m16:43:13.249209 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_exercise.source_unique_northwind_country_codes_country_code.cf83d0431e"
[0m16:43:13.250516 [debug] [Thread-1 (]: On test.dbt_exercise.source_unique_northwind_country_codes_country_code.cf83d0431e: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "test.dbt_exercise.source_unique_northwind_country_codes_country_code.cf83d0431e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with dbt_test__target as (

  select country_code as unique_field
  from `corded-sunlight-464012-e2`.`dbt_dw_raw`.`country_codes`
  where country_code is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m16:43:13.251432 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:43:13.334165 [info ] [Thread-4 (]: 36 of 55 PASS source_not_null_northwind_territories_territory_id ............... [[32mPASS[0m in 1.84s]
[0m16:43:13.335533 [debug] [Thread-4 (]: Finished running node test.dbt_exercise.source_not_null_northwind_territories_territory_id.9b9655b8a9
[0m16:43:13.336489 [debug] [Thread-4 (]: Began running node test.dbt_exercise.source_unique_northwind_customers_customer_id.ff818c137b
[0m16:43:13.337348 [info ] [Thread-4 (]: 40 of 55 START test source_unique_northwind_customers_customer_id .............. [RUN]
[0m16:43:13.338267 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_exercise.source_not_null_northwind_territories_territory_id.9b9655b8a9, now test.dbt_exercise.source_unique_northwind_customers_customer_id.ff818c137b)
[0m16:43:13.338994 [debug] [Thread-4 (]: Began compiling node test.dbt_exercise.source_unique_northwind_customers_customer_id.ff818c137b
[0m16:43:13.346527 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_exercise.source_unique_northwind_customers_customer_id.ff818c137b"
[0m16:43:13.348558 [debug] [Thread-4 (]: Began executing node test.dbt_exercise.source_unique_northwind_customers_customer_id.ff818c137b
[0m16:43:13.354276 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_exercise.source_unique_northwind_customers_customer_id.ff818c137b"
[0m16:43:13.357656 [debug] [Thread-4 (]: On test.dbt_exercise.source_unique_northwind_customers_customer_id.ff818c137b: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "test.dbt_exercise.source_unique_northwind_customers_customer_id.ff818c137b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with dbt_test__target as (

  select customer_id as unique_field
  from `corded-sunlight-464012-e2`.`dbt_dw_raw`.`customers`
  where customer_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m16:43:13.360120 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:43:13.527120 [info ] [Thread-2 (]: 37 of 55 PASS source_not_null_northwind_us_states_state_id ..................... [[32mPASS[0m in 1.93s]
[0m16:43:13.529113 [debug] [Thread-2 (]: Finished running node test.dbt_exercise.source_not_null_northwind_us_states_state_id.2e33a23d78
[0m16:43:13.530353 [debug] [Thread-2 (]: Began running node test.dbt_exercise.source_unique_northwind_employees_employee_id.e63c624594
[0m16:43:13.531537 [info ] [Thread-2 (]: 41 of 55 START test source_unique_northwind_employees_employee_id .............. [RUN]
[0m16:43:13.532749 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_exercise.source_not_null_northwind_us_states_state_id.2e33a23d78, now test.dbt_exercise.source_unique_northwind_employees_employee_id.e63c624594)
[0m16:43:13.533624 [debug] [Thread-2 (]: Began compiling node test.dbt_exercise.source_unique_northwind_employees_employee_id.e63c624594
[0m16:43:13.542991 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_exercise.source_unique_northwind_employees_employee_id.e63c624594"
[0m16:43:13.545156 [debug] [Thread-2 (]: Began executing node test.dbt_exercise.source_unique_northwind_employees_employee_id.e63c624594
[0m16:43:13.550976 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_exercise.source_unique_northwind_employees_employee_id.e63c624594"
[0m16:43:13.553396 [debug] [Thread-2 (]: On test.dbt_exercise.source_unique_northwind_employees_employee_id.e63c624594: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "test.dbt_exercise.source_unique_northwind_employees_employee_id.e63c624594"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with dbt_test__target as (

  select employee_id as unique_field
  from `corded-sunlight-464012-e2`.`dbt_dw_raw`.`employees`
  where employee_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m16:43:13.555764 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:43:14.224966 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:24cf1780-80a7-4df3-bcf2-bcc6ae7e5cbf&page=queryresults
[0m16:43:14.229721 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:72b8a1b0-c356-4c84-8724-5831a756af9d&page=queryresults
[0m16:43:14.350353 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:c41ae79c-acb0-47c1-adff-d852cb14fc97&page=queryresults
[0m16:43:14.521810 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:627a3f27-df34-40d2-b576-46dbc61c6059&page=queryresults
[0m16:43:15.062217 [info ] [Thread-3 (]: 38 of 55 PASS source_unique_northwind_categories_category_id ................... [[32mPASS[0m in 1.96s]
[0m16:43:15.068268 [debug] [Thread-3 (]: Finished running node test.dbt_exercise.source_unique_northwind_categories_category_id.17d9baa2e0
[0m16:43:15.069429 [debug] [Thread-3 (]: Began running node test.dbt_exercise.source_unique_northwind_orders_order_id.4a8a4df128
[0m16:43:15.070663 [info ] [Thread-3 (]: 42 of 55 START test source_unique_northwind_orders_order_id .................... [RUN]
[0m16:43:15.072327 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_exercise.source_unique_northwind_categories_category_id.17d9baa2e0, now test.dbt_exercise.source_unique_northwind_orders_order_id.4a8a4df128)
[0m16:43:15.073656 [debug] [Thread-3 (]: Began compiling node test.dbt_exercise.source_unique_northwind_orders_order_id.4a8a4df128
[0m16:43:15.088442 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_exercise.source_unique_northwind_orders_order_id.4a8a4df128"
[0m16:43:15.090674 [debug] [Thread-3 (]: Began executing node test.dbt_exercise.source_unique_northwind_orders_order_id.4a8a4df128
[0m16:43:15.095786 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_exercise.source_unique_northwind_orders_order_id.4a8a4df128"
[0m16:43:15.101564 [info ] [Thread-1 (]: 39 of 55 PASS source_unique_northwind_country_codes_country_code ............... [[32mPASS[0m in 1.88s]
[0m16:43:15.104292 [debug] [Thread-1 (]: Finished running node test.dbt_exercise.source_unique_northwind_country_codes_country_code.cf83d0431e
[0m16:43:15.105951 [debug] [Thread-1 (]: Began running node test.dbt_exercise.source_unique_northwind_products_product_id.740bf6f9a5
[0m16:43:15.109898 [debug] [Thread-3 (]: On test.dbt_exercise.source_unique_northwind_orders_order_id.4a8a4df128: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "test.dbt_exercise.source_unique_northwind_orders_order_id.4a8a4df128"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with dbt_test__target as (

  select order_id as unique_field
  from `corded-sunlight-464012-e2`.`dbt_dw_raw`.`orders`
  where order_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m16:43:15.111502 [info ] [Thread-1 (]: 43 of 55 START test source_unique_northwind_products_product_id ................ [RUN]
[0m16:43:15.113716 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:43:15.116204 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_exercise.source_unique_northwind_country_codes_country_code.cf83d0431e, now test.dbt_exercise.source_unique_northwind_products_product_id.740bf6f9a5)
[0m16:43:15.118441 [debug] [Thread-1 (]: Began compiling node test.dbt_exercise.source_unique_northwind_products_product_id.740bf6f9a5
[0m16:43:15.130460 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_exercise.source_unique_northwind_products_product_id.740bf6f9a5"
[0m16:43:15.133546 [debug] [Thread-1 (]: Began executing node test.dbt_exercise.source_unique_northwind_products_product_id.740bf6f9a5
[0m16:43:15.141301 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_exercise.source_unique_northwind_products_product_id.740bf6f9a5"
[0m16:43:15.145840 [debug] [Thread-1 (]: On test.dbt_exercise.source_unique_northwind_products_product_id.740bf6f9a5: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "test.dbt_exercise.source_unique_northwind_products_product_id.740bf6f9a5"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with dbt_test__target as (

  select product_id as unique_field
  from `corded-sunlight-464012-e2`.`dbt_dw_raw`.`products`
  where product_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m16:43:15.189773 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:43:15.193724 [info ] [Thread-4 (]: 40 of 55 PASS source_unique_northwind_customers_customer_id .................... [[32mPASS[0m in 1.86s]
[0m16:43:15.195435 [debug] [Thread-4 (]: Finished running node test.dbt_exercise.source_unique_northwind_customers_customer_id.ff818c137b
[0m16:43:15.196772 [debug] [Thread-4 (]: Began running node test.dbt_exercise.source_unique_northwind_region_region_id.9688f1f5fd
[0m16:43:15.198440 [info ] [Thread-4 (]: 44 of 55 START test source_unique_northwind_region_region_id ................... [RUN]
[0m16:43:15.200526 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_exercise.source_unique_northwind_customers_customer_id.ff818c137b, now test.dbt_exercise.source_unique_northwind_region_region_id.9688f1f5fd)
[0m16:43:15.201890 [debug] [Thread-4 (]: Began compiling node test.dbt_exercise.source_unique_northwind_region_region_id.9688f1f5fd
[0m16:43:15.261371 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_exercise.source_unique_northwind_region_region_id.9688f1f5fd"
[0m16:43:15.265421 [debug] [Thread-4 (]: Began executing node test.dbt_exercise.source_unique_northwind_region_region_id.9688f1f5fd
[0m16:43:15.271673 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_exercise.source_unique_northwind_region_region_id.9688f1f5fd"
[0m16:43:15.273775 [debug] [Thread-4 (]: On test.dbt_exercise.source_unique_northwind_region_region_id.9688f1f5fd: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "test.dbt_exercise.source_unique_northwind_region_region_id.9688f1f5fd"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with dbt_test__target as (

  select region_id as unique_field
  from `corded-sunlight-464012-e2`.`dbt_dw_raw`.`region`
  where region_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m16:43:15.274775 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:43:15.324557 [info ] [Thread-2 (]: 41 of 55 PASS source_unique_northwind_employees_employee_id .................... [[32mPASS[0m in 1.79s]
[0m16:43:15.326184 [debug] [Thread-2 (]: Finished running node test.dbt_exercise.source_unique_northwind_employees_employee_id.e63c624594
[0m16:43:15.327490 [debug] [Thread-2 (]: Began running node test.dbt_exercise.source_unique_northwind_shippers_shipper_id.61edb3f736
[0m16:43:15.329392 [info ] [Thread-2 (]: 45 of 55 START test source_unique_northwind_shippers_shipper_id ................ [RUN]
[0m16:43:15.331397 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_exercise.source_unique_northwind_employees_employee_id.e63c624594, now test.dbt_exercise.source_unique_northwind_shippers_shipper_id.61edb3f736)
[0m16:43:15.332748 [debug] [Thread-2 (]: Began compiling node test.dbt_exercise.source_unique_northwind_shippers_shipper_id.61edb3f736
[0m16:43:15.341483 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_exercise.source_unique_northwind_shippers_shipper_id.61edb3f736"
[0m16:43:15.343227 [debug] [Thread-2 (]: Began executing node test.dbt_exercise.source_unique_northwind_shippers_shipper_id.61edb3f736
[0m16:43:15.349120 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_exercise.source_unique_northwind_shippers_shipper_id.61edb3f736"
[0m16:43:15.352484 [debug] [Thread-2 (]: On test.dbt_exercise.source_unique_northwind_shippers_shipper_id.61edb3f736: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "test.dbt_exercise.source_unique_northwind_shippers_shipper_id.61edb3f736"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with dbt_test__target as (

  select shipper_id as unique_field
  from `corded-sunlight-464012-e2`.`dbt_dw_raw`.`shippers`
  where shipper_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m16:43:15.353945 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:43:16.213966 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:dff152cd-4936-4183-8a6c-045dff40e544&page=queryresults
[0m16:43:16.277121 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:62fd002f-6c88-4955-9217-68b5593ddde0&page=queryresults
[0m16:43:16.284291 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:c099ecbd-e773-4909-bd95-405b70726739&page=queryresults
[0m16:43:16.349029 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:d6d91725-d981-4c49-b447-85937671adde&page=queryresults
[0m16:43:17.011477 [info ] [Thread-3 (]: 42 of 55 PASS source_unique_northwind_orders_order_id .......................... [[32mPASS[0m in 1.94s]
[0m16:43:17.013042 [debug] [Thread-3 (]: Finished running node test.dbt_exercise.source_unique_northwind_orders_order_id.4a8a4df128
[0m16:43:17.013945 [debug] [Thread-3 (]: Began running node test.dbt_exercise.source_unique_northwind_suppliers_supplier_id.aa7461739b
[0m16:43:17.014998 [info ] [Thread-3 (]: 46 of 55 START test source_unique_northwind_suppliers_supplier_id .............. [RUN]
[0m16:43:17.016139 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_exercise.source_unique_northwind_orders_order_id.4a8a4df128, now test.dbt_exercise.source_unique_northwind_suppliers_supplier_id.aa7461739b)
[0m16:43:17.016922 [debug] [Thread-3 (]: Began compiling node test.dbt_exercise.source_unique_northwind_suppliers_supplier_id.aa7461739b
[0m16:43:17.025968 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_exercise.source_unique_northwind_suppliers_supplier_id.aa7461739b"
[0m16:43:17.028244 [debug] [Thread-3 (]: Began executing node test.dbt_exercise.source_unique_northwind_suppliers_supplier_id.aa7461739b
[0m16:43:17.035108 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_exercise.source_unique_northwind_suppliers_supplier_id.aa7461739b"
[0m16:43:17.040080 [debug] [Thread-3 (]: On test.dbt_exercise.source_unique_northwind_suppliers_supplier_id.aa7461739b: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "test.dbt_exercise.source_unique_northwind_suppliers_supplier_id.aa7461739b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with dbt_test__target as (

  select supplier_id as unique_field
  from `corded-sunlight-464012-e2`.`dbt_dw_raw`.`suppliers`
  where supplier_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m16:43:17.041998 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:43:17.043630 [info ] [Thread-1 (]: 43 of 55 PASS source_unique_northwind_products_product_id ...................... [[32mPASS[0m in 1.93s]
[0m16:43:17.045830 [debug] [Thread-1 (]: Finished running node test.dbt_exercise.source_unique_northwind_products_product_id.740bf6f9a5
[0m16:43:17.047512 [debug] [Thread-1 (]: Began running node test.dbt_exercise.source_unique_northwind_territories_territory_id.08bc548860
[0m16:43:17.049228 [info ] [Thread-1 (]: 47 of 55 START test source_unique_northwind_territories_territory_id ........... [RUN]
[0m16:43:17.051105 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_exercise.source_unique_northwind_products_product_id.740bf6f9a5, now test.dbt_exercise.source_unique_northwind_territories_territory_id.08bc548860)
[0m16:43:17.052517 [debug] [Thread-1 (]: Began compiling node test.dbt_exercise.source_unique_northwind_territories_territory_id.08bc548860
[0m16:43:17.066118 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_exercise.source_unique_northwind_territories_territory_id.08bc548860"
[0m16:43:17.109086 [debug] [Thread-1 (]: Began executing node test.dbt_exercise.source_unique_northwind_territories_territory_id.08bc548860
[0m16:43:17.111489 [info ] [Thread-4 (]: 44 of 55 PASS source_unique_northwind_region_region_id ......................... [[32mPASS[0m in 1.91s]
[0m16:43:17.118549 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_exercise.source_unique_northwind_territories_territory_id.08bc548860"
[0m16:43:17.120695 [debug] [Thread-4 (]: Finished running node test.dbt_exercise.source_unique_northwind_region_region_id.9688f1f5fd
[0m16:43:17.122586 [debug] [Thread-4 (]: Began running node test.dbt_exercise.source_unique_northwind_us_states_state_id.c374c85cda
[0m16:43:17.124224 [info ] [Thread-4 (]: 48 of 55 START test source_unique_northwind_us_states_state_id ................. [RUN]
[0m16:43:17.126308 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_exercise.source_unique_northwind_region_region_id.9688f1f5fd, now test.dbt_exercise.source_unique_northwind_us_states_state_id.c374c85cda)
[0m16:43:17.127363 [debug] [Thread-1 (]: On test.dbt_exercise.source_unique_northwind_territories_territory_id.08bc548860: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "test.dbt_exercise.source_unique_northwind_territories_territory_id.08bc548860"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with dbt_test__target as (

  select territory_id as unique_field
  from `corded-sunlight-464012-e2`.`dbt_dw_raw`.`territories`
  where territory_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m16:43:17.129206 [debug] [Thread-4 (]: Began compiling node test.dbt_exercise.source_unique_northwind_us_states_state_id.c374c85cda
[0m16:43:17.131228 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:43:17.142468 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_exercise.source_unique_northwind_us_states_state_id.c374c85cda"
[0m16:43:17.149600 [info ] [Thread-2 (]: 45 of 55 PASS source_unique_northwind_shippers_shipper_id ...................... [[32mPASS[0m in 1.82s]
[0m16:43:17.152160 [debug] [Thread-2 (]: Finished running node test.dbt_exercise.source_unique_northwind_shippers_shipper_id.61edb3f736
[0m16:43:17.153821 [debug] [Thread-2 (]: Began running node test.dbt_exercise.unique_dim_employees_employee_id.79828c8f30
[0m16:43:17.157767 [debug] [Thread-4 (]: Began executing node test.dbt_exercise.source_unique_northwind_us_states_state_id.c374c85cda
[0m16:43:17.156121 [info ] [Thread-2 (]: 49 of 55 START test unique_dim_employees_employee_id ........................... [RUN]
[0m16:43:17.174427 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_exercise.source_unique_northwind_us_states_state_id.c374c85cda"
[0m16:43:17.214515 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_exercise.source_unique_northwind_shippers_shipper_id.61edb3f736, now test.dbt_exercise.unique_dim_employees_employee_id.79828c8f30)
[0m16:43:17.219296 [debug] [Thread-2 (]: Began compiling node test.dbt_exercise.unique_dim_employees_employee_id.79828c8f30
[0m16:43:17.226558 [debug] [Thread-4 (]: On test.dbt_exercise.source_unique_northwind_us_states_state_id.c374c85cda: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "test.dbt_exercise.source_unique_northwind_us_states_state_id.c374c85cda"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with dbt_test__target as (

  select state_id as unique_field
  from `corded-sunlight-464012-e2`.`dbt_dw_raw`.`us_states`
  where state_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m16:43:17.229831 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_exercise.unique_dim_employees_employee_id.79828c8f30"
[0m16:43:17.230824 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:43:17.233015 [debug] [Thread-2 (]: Began executing node test.dbt_exercise.unique_dim_employees_employee_id.79828c8f30
[0m16:43:17.237939 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_exercise.unique_dim_employees_employee_id.79828c8f30"
[0m16:43:17.239556 [debug] [Thread-2 (]: On test.dbt_exercise.unique_dim_employees_employee_id.79828c8f30: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "test.dbt_exercise.unique_dim_employees_employee_id.79828c8f30"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with dbt_test__target as (

  select employee_id as unique_field
  from `corded-sunlight-464012-e2`.`dbt_dw_marts`.`dim_employees`
  where employee_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m16:43:17.240790 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:43:18.025092 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:f0ada6c8-335b-4325-ba1c-fe6a6ac356d8&page=queryresults
[0m16:43:18.136187 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:eee03c2c-fa6a-457d-bc4e-e8e78a96621b&page=queryresults
[0m16:43:18.141568 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:aa5d946f-f7e4-4e00-8f13-c945feaf7c9c&page=queryresults
[0m16:43:18.321307 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:2acc7e2b-43ac-415a-8a5f-03693436ae87&page=queryresults
[0m16:43:18.822939 [info ] [Thread-3 (]: 46 of 55 PASS source_unique_northwind_suppliers_supplier_id .................... [[32mPASS[0m in 1.81s]
[0m16:43:18.824502 [debug] [Thread-3 (]: Finished running node test.dbt_exercise.source_unique_northwind_suppliers_supplier_id.aa7461739b
[0m16:43:18.825814 [debug] [Thread-3 (]: Began running node test.dbt_exercise.unique_dim_employees_sk_employee.2c4a61e188
[0m16:43:18.827286 [info ] [Thread-3 (]: 50 of 55 START test unique_dim_employees_sk_employee ........................... [RUN]
[0m16:43:18.829641 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_exercise.source_unique_northwind_suppliers_supplier_id.aa7461739b, now test.dbt_exercise.unique_dim_employees_sk_employee.2c4a61e188)
[0m16:43:18.835578 [debug] [Thread-3 (]: Began compiling node test.dbt_exercise.unique_dim_employees_sk_employee.2c4a61e188
[0m16:43:18.846196 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_exercise.unique_dim_employees_sk_employee.2c4a61e188"
[0m16:43:18.848066 [debug] [Thread-3 (]: Began executing node test.dbt_exercise.unique_dim_employees_sk_employee.2c4a61e188
[0m16:43:18.853207 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_exercise.unique_dim_employees_sk_employee.2c4a61e188"
[0m16:43:18.854459 [debug] [Thread-3 (]: On test.dbt_exercise.unique_dim_employees_sk_employee.2c4a61e188: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "test.dbt_exercise.unique_dim_employees_sk_employee.2c4a61e188"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with dbt_test__target as (

  select sk_employee as unique_field
  from `corded-sunlight-464012-e2`.`dbt_dw_marts`.`dim_employees`
  where sk_employee is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m16:43:18.855468 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:43:18.938821 [info ] [Thread-2 (]: 49 of 55 PASS unique_dim_employees_employee_id ................................. [[32mPASS[0m in 1.72s]
[0m16:43:18.940302 [debug] [Thread-2 (]: Finished running node test.dbt_exercise.unique_dim_employees_employee_id.79828c8f30
[0m16:43:18.941194 [debug] [Thread-2 (]: Began running node test.dbt_exercise.unique_dim_products_product_id.ef7b2a9985
[0m16:43:18.942078 [info ] [Thread-2 (]: 51 of 55 START test unique_dim_products_product_id ............................. [RUN]
[0m16:43:18.943005 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_exercise.unique_dim_employees_employee_id.79828c8f30, now test.dbt_exercise.unique_dim_products_product_id.ef7b2a9985)
[0m16:43:18.944318 [debug] [Thread-2 (]: Began compiling node test.dbt_exercise.unique_dim_products_product_id.ef7b2a9985
[0m16:43:18.955239 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_exercise.unique_dim_products_product_id.ef7b2a9985"
[0m16:43:18.957299 [debug] [Thread-2 (]: Began executing node test.dbt_exercise.unique_dim_products_product_id.ef7b2a9985
[0m16:43:18.964398 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_exercise.unique_dim_products_product_id.ef7b2a9985"
[0m16:43:18.968870 [info ] [Thread-1 (]: 47 of 55 PASS source_unique_northwind_territories_territory_id ................. [[32mPASS[0m in 1.92s]
[0m16:43:18.970688 [debug] [Thread-1 (]: Finished running node test.dbt_exercise.source_unique_northwind_territories_territory_id.08bc548860
[0m16:43:18.971736 [debug] [Thread-1 (]: Began running node test.dbt_exercise.unique_dim_products_sk_product.1658453ef4
[0m16:43:18.973340 [debug] [Thread-2 (]: On test.dbt_exercise.unique_dim_products_product_id.ef7b2a9985: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "test.dbt_exercise.unique_dim_products_product_id.ef7b2a9985"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with dbt_test__target as (

  select product_id as unique_field
  from `corded-sunlight-464012-e2`.`dbt_dw_marts`.`dim_products`
  where product_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m16:43:18.974974 [info ] [Thread-1 (]: 52 of 55 START test unique_dim_products_sk_product ............................. [RUN]
[0m16:43:18.976718 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:43:18.978467 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_exercise.source_unique_northwind_territories_territory_id.08bc548860, now test.dbt_exercise.unique_dim_products_sk_product.1658453ef4)
[0m16:43:18.980488 [debug] [Thread-1 (]: Began compiling node test.dbt_exercise.unique_dim_products_sk_product.1658453ef4
[0m16:43:18.990106 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_exercise.unique_dim_products_sk_product.1658453ef4"
[0m16:43:18.992543 [debug] [Thread-1 (]: Began executing node test.dbt_exercise.unique_dim_products_sk_product.1658453ef4
[0m16:43:18.998532 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_exercise.unique_dim_products_sk_product.1658453ef4"
[0m16:43:19.004129 [debug] [Thread-1 (]: On test.dbt_exercise.unique_dim_products_sk_product.1658453ef4: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "test.dbt_exercise.unique_dim_products_sk_product.1658453ef4"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with dbt_test__target as (

  select sk_product as unique_field
  from `corded-sunlight-464012-e2`.`dbt_dw_marts`.`dim_products`
  where sk_product is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m16:43:19.006673 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:43:19.095613 [info ] [Thread-4 (]: 48 of 55 PASS source_unique_northwind_us_states_state_id ....................... [[32mPASS[0m in 1.97s]
[0m16:43:19.097243 [debug] [Thread-4 (]: Finished running node test.dbt_exercise.source_unique_northwind_us_states_state_id.c374c85cda
[0m16:43:19.098084 [debug] [Thread-4 (]: Began running node test.dbt_exercise.unique_dim_ship_ship_id.8825a91f8e
[0m16:43:19.098992 [info ] [Thread-4 (]: 53 of 55 START test unique_dim_ship_ship_id .................................... [RUN]
[0m16:43:19.100375 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_exercise.source_unique_northwind_us_states_state_id.c374c85cda, now test.dbt_exercise.unique_dim_ship_ship_id.8825a91f8e)
[0m16:43:19.101779 [debug] [Thread-4 (]: Began compiling node test.dbt_exercise.unique_dim_ship_ship_id.8825a91f8e
[0m16:43:19.114992 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_exercise.unique_dim_ship_ship_id.8825a91f8e"
[0m16:43:19.117752 [debug] [Thread-4 (]: Began executing node test.dbt_exercise.unique_dim_ship_ship_id.8825a91f8e
[0m16:43:19.122983 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_exercise.unique_dim_ship_ship_id.8825a91f8e"
[0m16:43:19.124364 [debug] [Thread-4 (]: On test.dbt_exercise.unique_dim_ship_ship_id.8825a91f8e: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "test.dbt_exercise.unique_dim_ship_ship_id.8825a91f8e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with dbt_test__target as (

  select ship_id as unique_field
  from `corded-sunlight-464012-e2`.`dbt_dw_marts`.`dim_ship`
  where ship_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m16:43:19.125132 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:43:19.910623 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:09ed2884-9962-4e7f-b8c1-5a601a118021&page=queryresults
[0m16:43:20.017297 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:562be585-ec6b-49ce-a269-291f7f98fb8a&page=queryresults
[0m16:43:20.082341 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:04595533-b60d-4dbb-bd1d-0bb37c53fbdb&page=queryresults
[0m16:43:20.186051 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:6b3a0729-85da-4520-ba67-b4aaef1fce0d&page=queryresults
[0m16:43:20.759868 [info ] [Thread-2 (]: 51 of 55 PASS unique_dim_products_product_id ................................... [[32mPASS[0m in 1.82s]
[0m16:43:20.761620 [debug] [Thread-2 (]: Finished running node test.dbt_exercise.unique_dim_products_product_id.ef7b2a9985
[0m16:43:20.762570 [debug] [Thread-2 (]: Began running node test.dbt_exercise.unique_dim_ship_sk_ship.14db8b5f73
[0m16:43:20.763556 [info ] [Thread-2 (]: 54 of 55 START test unique_dim_ship_sk_ship .................................... [RUN]
[0m16:43:20.764844 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_exercise.unique_dim_products_product_id.ef7b2a9985, now test.dbt_exercise.unique_dim_ship_sk_ship.14db8b5f73)
[0m16:43:20.765609 [debug] [Thread-2 (]: Began compiling node test.dbt_exercise.unique_dim_ship_sk_ship.14db8b5f73
[0m16:43:20.776712 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_exercise.unique_dim_ship_sk_ship.14db8b5f73"
[0m16:43:20.797429 [debug] [Thread-2 (]: Began executing node test.dbt_exercise.unique_dim_ship_sk_ship.14db8b5f73
[0m16:43:20.802899 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_exercise.unique_dim_ship_sk_ship.14db8b5f73"
[0m16:43:20.804712 [debug] [Thread-2 (]: On test.dbt_exercise.unique_dim_ship_sk_ship.14db8b5f73: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "test.dbt_exercise.unique_dim_ship_sk_ship.14db8b5f73"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with dbt_test__target as (

  select sk_ship as unique_field
  from `corded-sunlight-464012-e2`.`dbt_dw_marts`.`dim_ship`
  where sk_ship is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m16:43:20.805605 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:43:20.885377 [info ] [Thread-1 (]: 52 of 55 PASS unique_dim_products_sk_product ................................... [[32mPASS[0m in 1.91s]
[0m16:43:20.886814 [debug] [Thread-1 (]: Finished running node test.dbt_exercise.unique_dim_products_sk_product.1658453ef4
[0m16:43:20.887831 [debug] [Thread-1 (]: Began running node test.dbt_exercise.unique_fact_orders_sk_orders.072a29dba8
[0m16:43:20.889114 [info ] [Thread-1 (]: 55 of 55 START test unique_fact_orders_sk_orders ............................... [RUN]
[0m16:43:20.890249 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_exercise.unique_dim_products_sk_product.1658453ef4, now test.dbt_exercise.unique_fact_orders_sk_orders.072a29dba8)
[0m16:43:20.891113 [debug] [Thread-1 (]: Began compiling node test.dbt_exercise.unique_fact_orders_sk_orders.072a29dba8
[0m16:43:20.901098 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_exercise.unique_fact_orders_sk_orders.072a29dba8"
[0m16:43:20.904666 [debug] [Thread-1 (]: Began executing node test.dbt_exercise.unique_fact_orders_sk_orders.072a29dba8
[0m16:43:20.912317 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_exercise.unique_fact_orders_sk_orders.072a29dba8"
[0m16:43:20.914038 [debug] [Thread-1 (]: On test.dbt_exercise.unique_fact_orders_sk_orders.072a29dba8: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "test.dbt_exercise.unique_fact_orders_sk_orders.072a29dba8"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with dbt_test__target as (

  select sk_orders as unique_field
  from `corded-sunlight-464012-e2`.`dbt_dw_marts`.`fact_orders`
  where sk_orders is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m16:43:20.915068 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:43:20.970736 [info ] [Thread-4 (]: 53 of 55 PASS unique_dim_ship_ship_id .......................................... [[32mPASS[0m in 1.87s]
[0m16:43:20.973004 [debug] [Thread-4 (]: Finished running node test.dbt_exercise.unique_dim_ship_ship_id.8825a91f8e
[0m16:43:21.028449 [info ] [Thread-3 (]: 50 of 55 PASS unique_dim_employees_sk_employee ................................. [[32mPASS[0m in 2.20s]
[0m16:43:21.030107 [debug] [Thread-3 (]: Finished running node test.dbt_exercise.unique_dim_employees_sk_employee.2c4a61e188
[0m16:43:21.959302 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:f4dbbc4d-61ff-4f11-ad07-f0146c23e25d&page=queryresults
[0m16:43:24.164396 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:66b58432-59c5-4530-b69c-2afec57140d3&page=queryresults
[0m16:43:24.968082 [info ] [Thread-1 (]: 55 of 55 PASS unique_fact_orders_sk_orders ..................................... [[32mPASS[0m in 4.08s]
[0m16:43:24.969534 [debug] [Thread-1 (]: Finished running node test.dbt_exercise.unique_fact_orders_sk_orders.072a29dba8
[0m16:43:25.011784 [error] [Thread-2 (]: 54 of 55 FAIL 3 unique_dim_ship_sk_ship ........................................ [[31mFAIL 3[0m in 4.25s]
[0m16:43:25.013198 [debug] [Thread-2 (]: Finished running node test.dbt_exercise.unique_dim_ship_sk_ship.14db8b5f73
[0m16:43:25.018127 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:43:25.030544 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:43:25.031791 [debug] [MainThread]: Connection 'test.dbt_exercise.unique_dim_ship_sk_ship.14db8b5f73' was properly closed.
[0m16:43:25.032703 [debug] [MainThread]: Connection 'test.dbt_exercise.unique_dim_employees_sk_employee.2c4a61e188' was properly closed.
[0m16:43:25.034081 [debug] [MainThread]: Connection 'test.dbt_exercise.unique_fact_orders_sk_orders.072a29dba8' was properly closed.
[0m16:43:25.035636 [debug] [MainThread]: Connection 'test.dbt_exercise.unique_dim_ship_ship_id.8825a91f8e' was properly closed.
[0m16:43:25.037469 [info ] [MainThread]: 
[0m16:43:25.040707 [info ] [MainThread]: Finished running 55 data tests in 0 hours 0 minutes and 34.38 seconds (34.38s).
[0m16:43:25.063437 [debug] [MainThread]: Command end result
[0m16:43:25.159303 [debug] [MainThread]: Wrote artifact WritableManifest to /home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/target/manifest.json
[0m16:43:25.177935 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/target/semantic_manifest.json
[0m16:43:25.192790 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/target/run_results.json
[0m16:43:25.193650 [info ] [MainThread]: 
[0m16:43:25.194410 [info ] [MainThread]: [31mCompleted with 2 errors, 0 partial successes, and 0 warnings:[0m
[0m16:43:25.195338 [info ] [MainThread]: 
[0m16:43:25.196266 [error] [MainThread]: [31mFailure in test accepted_values_dim_products_is_discontinued__True__False (models/marts/dim_products.yml)[0m
[0m16:43:25.197098 [error] [MainThread]:   Database Error in test accepted_values_dim_products_is_discontinued__True__False (models/marts/dim_products.yml)
  No matching signature for operator IN for argument types BOOL and {STRING} at [27:23]
  compiled code at target/run/dbt_exercise/models/marts/dim_products.yml/accepted_values_dim_products_is_discontinued__True__False.sql
[0m16:43:25.197842 [info ] [MainThread]: 
[0m16:43:25.198611 [info ] [MainThread]:   compiled code at target/compiled/dbt_exercise/models/marts/dim_products.yml/accepted_values_dim_products_is_discontinued__True__False.sql
[0m16:43:25.199389 [info ] [MainThread]: 
[0m16:43:25.200451 [error] [MainThread]: [31mFailure in test unique_dim_ship_sk_ship (models/marts/dim_ship.yml)[0m
[0m16:43:25.201258 [error] [MainThread]:   Got 3 results, configured to fail if != 0
[0m16:43:25.202066 [info ] [MainThread]: 
[0m16:43:25.203219 [info ] [MainThread]:   compiled code at target/compiled/dbt_exercise/models/marts/dim_ship.yml/unique_dim_ship_sk_ship.sql
[0m16:43:25.204732 [info ] [MainThread]: 
[0m16:43:25.206440 [info ] [MainThread]: Done. PASS=53 WARN=0 ERROR=2 SKIP=0 NO-OP=0 TOTAL=55
[0m16:43:25.208764 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- DuplicateYAMLKeysDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m16:43:25.216778 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": false, "command_wall_clock_time": 143.44032, "process_in_blocks": "122920", "process_kernel_time": 16.375717, "process_mem_max_rss": "375124", "process_out_blocks": "5120", "process_user_time": 18.659933}
[0m16:43:25.218203 [debug] [MainThread]: Command `dbt test` failed at 16:43:25.217924 after 143.44 seconds
[0m16:43:25.219256 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x768f53a34f20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x768f0d53cc80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x768f159ff230>]}
[0m16:43:25.220388 [debug] [MainThread]: Flushing usage events
[0m16:43:25.578307 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:54:10.402900 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77546db2fc20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77546dc110d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77546db2e5d0>]}


============================== 16:54:10.420615 | e4b0a4ca-7fc7-49c4-8dd2-1251f7211e3f ==============================
[0m16:54:10.420615 [info ] [MainThread]: Running with dbt=1.10.2
[0m16:54:10.421778 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt test -s dim_ship', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m16:55:05.417550 [warn ] [MainThread]: [[33mWARNING[0m][DuplicateYAMLKeysDeprecation]: Deprecated functionality
Duplicate key 'version' in "<unicode string>", line 4, column 1 in file
`/home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/dbt_project.yml`
[0m16:55:05.418310 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'e4b0a4ca-7fc7-49c4-8dd2-1251f7211e3f', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77542ff024b0>]}
[0m16:55:06.261680 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e4b0a4ca-7fc7-49c4-8dd2-1251f7211e3f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77542fc3cb30>]}
[0m16:55:06.352798 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e4b0a4ca-7fc7-49c4-8dd2-1251f7211e3f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77543048ffb0>]}
[0m16:55:06.357415 [info ] [MainThread]: Registered adapter: bigquery=1.9.2
[0m16:56:00.897636 [debug] [MainThread]: checksum: 1adc40777973ef30f45f80b3b6d04d5013c1edd53d96363881b3b199e612468b, vars: {}, profile: , target: , version: 1.10.2
[0m16:56:06.412519 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:56:06.413270 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:56:06.678169 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e4b0a4ca-7fc7-49c4-8dd2-1251f7211e3f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77546dba4380>]}
[0m16:56:06.852088 [debug] [MainThread]: Wrote artifact WritableManifest to /home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/target/manifest.json
[0m16:56:06.866002 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/target/semantic_manifest.json
[0m16:56:07.394284 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e4b0a4ca-7fc7-49c4-8dd2-1251f7211e3f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77542f634c80>]}
[0m16:56:07.395122 [info ] [MainThread]: Found 14 seeds, 55 data tests, 19 models, 14 sources, 609 macros
[0m16:56:07.396004 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e4b0a4ca-7fc7-49c4-8dd2-1251f7211e3f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77542f965910>]}
[0m16:56:07.399369 [info ] [MainThread]: 
[0m16:56:07.400314 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:56:07.401178 [info ] [MainThread]: 
[0m16:56:07.402568 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m16:56:07.414270 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_corded-sunlight-464012-e2_dbt_dw_intermediate'
[0m16:56:07.415848 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:56:07.417366 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_corded-sunlight-464012-e2_dbt_dw_staging'
[0m16:56:07.419264 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_corded-sunlight-464012-e2_dbt_dw_marts'
[0m16:56:07.421528 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:56:07.422979 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_corded-sunlight-464012-e2_dbt_dw_raw'
[0m16:56:07.424532 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:56:07.426302 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:56:08.383362 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e4b0a4ca-7fc7-49c4-8dd2-1251f7211e3f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77542f966e10>]}
[0m16:56:08.384573 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:56:08.399374 [debug] [Thread-1 (]: Began running node test.dbt_exercise.not_null_dim_ship_ship_id.0e7926966a
[0m16:56:08.400856 [debug] [Thread-2 (]: Began running node test.dbt_exercise.not_null_dim_ship_shipper_id.78acf0f3d3
[0m16:56:08.402178 [debug] [Thread-3 (]: Began running node test.dbt_exercise.not_null_dim_ship_sk_ship.3ae993afec
[0m16:56:08.403252 [debug] [Thread-4 (]: Began running node test.dbt_exercise.unique_dim_ship_ship_id.8825a91f8e
[0m16:56:08.404475 [info ] [Thread-1 (]: 1 of 5 START test not_null_dim_ship_ship_id .................................... [RUN]
[0m16:56:08.405957 [info ] [Thread-2 (]: 2 of 5 START test not_null_dim_ship_shipper_id ................................. [RUN]
[0m16:56:08.407389 [info ] [Thread-3 (]: 3 of 5 START test not_null_dim_ship_sk_ship .................................... [RUN]
[0m16:56:08.409012 [info ] [Thread-4 (]: 4 of 5 START test unique_dim_ship_ship_id ...................................... [RUN]
[0m16:56:08.410640 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_corded-sunlight-464012-e2_dbt_dw_marts, now test.dbt_exercise.not_null_dim_ship_ship_id.0e7926966a)
[0m16:56:08.412055 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_corded-sunlight-464012-e2_dbt_dw_staging, now test.dbt_exercise.not_null_dim_ship_shipper_id.78acf0f3d3)
[0m16:56:08.413499 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_corded-sunlight-464012-e2_dbt_dw_raw, now test.dbt_exercise.not_null_dim_ship_sk_ship.3ae993afec)
[0m16:56:08.415024 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly list_corded-sunlight-464012-e2_dbt_dw_intermediate, now test.dbt_exercise.unique_dim_ship_ship_id.8825a91f8e)
[0m16:56:08.416624 [debug] [Thread-1 (]: Began compiling node test.dbt_exercise.not_null_dim_ship_ship_id.0e7926966a
[0m16:56:08.418247 [debug] [Thread-2 (]: Began compiling node test.dbt_exercise.not_null_dim_ship_shipper_id.78acf0f3d3
[0m16:56:08.420108 [debug] [Thread-3 (]: Began compiling node test.dbt_exercise.not_null_dim_ship_sk_ship.3ae993afec
[0m16:56:08.421728 [debug] [Thread-4 (]: Began compiling node test.dbt_exercise.unique_dim_ship_ship_id.8825a91f8e
[0m16:56:08.509843 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_exercise.not_null_dim_ship_shipper_id.78acf0f3d3"
[0m16:56:08.511225 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_exercise.not_null_dim_ship_ship_id.0e7926966a"
[0m16:56:08.514515 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_exercise.not_null_dim_ship_sk_ship.3ae993afec"
[0m16:56:08.526180 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_exercise.unique_dim_ship_ship_id.8825a91f8e"
[0m16:56:08.528460 [debug] [Thread-1 (]: Began executing node test.dbt_exercise.not_null_dim_ship_ship_id.0e7926966a
[0m16:56:08.529333 [debug] [Thread-2 (]: Began executing node test.dbt_exercise.not_null_dim_ship_shipper_id.78acf0f3d3
[0m16:56:08.542197 [debug] [Thread-4 (]: Began executing node test.dbt_exercise.unique_dim_ship_ship_id.8825a91f8e
[0m16:56:08.543468 [debug] [Thread-3 (]: Began executing node test.dbt_exercise.not_null_dim_ship_sk_ship.3ae993afec
[0m16:56:08.592715 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_exercise.not_null_dim_ship_shipper_id.78acf0f3d3"
[0m16:56:08.607334 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_exercise.not_null_dim_ship_ship_id.0e7926966a"
[0m16:56:08.609350 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_exercise.unique_dim_ship_ship_id.8825a91f8e"
[0m16:56:08.613665 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_exercise.not_null_dim_ship_sk_ship.3ae993afec"
[0m16:56:08.617354 [debug] [Thread-2 (]: On test.dbt_exercise.not_null_dim_ship_shipper_id.78acf0f3d3: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "test.dbt_exercise.not_null_dim_ship_shipper_id.78acf0f3d3"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select shipper_id
from `corded-sunlight-464012-e2`.`dbt_dw_marts`.`dim_ship`
where shipper_id is null



  
  
      
    ) dbt_internal_test
[0m16:56:08.618551 [debug] [Thread-1 (]: On test.dbt_exercise.not_null_dim_ship_ship_id.0e7926966a: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "test.dbt_exercise.not_null_dim_ship_ship_id.0e7926966a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select ship_id
from `corded-sunlight-464012-e2`.`dbt_dw_marts`.`dim_ship`
where ship_id is null



  
  
      
    ) dbt_internal_test
[0m16:56:08.620074 [debug] [Thread-4 (]: On test.dbt_exercise.unique_dim_ship_ship_id.8825a91f8e: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "test.dbt_exercise.unique_dim_ship_ship_id.8825a91f8e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with dbt_test__target as (

  select ship_id as unique_field
  from `corded-sunlight-464012-e2`.`dbt_dw_marts`.`dim_ship`
  where ship_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m16:56:08.621301 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:56:08.622263 [debug] [Thread-3 (]: On test.dbt_exercise.not_null_dim_ship_sk_ship.3ae993afec: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "test.dbt_exercise.not_null_dim_ship_sk_ship.3ae993afec"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select sk_ship
from `corded-sunlight-464012-e2`.`dbt_dw_marts`.`dim_ship`
where sk_ship is null



  
  
      
    ) dbt_internal_test
[0m16:56:08.623214 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:56:08.624217 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m16:56:08.625547 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m16:56:09.713702 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:c5653fbc-7690-4e83-b277-51042a543bd8&page=queryresults
[0m16:56:09.741904 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:a03449e2-0d10-447b-8bf9-7c9c868a3aed&page=queryresults
[0m16:56:09.752556 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:870f0618-0cc2-434b-8f0f-c8e2ae711b6b&page=queryresults
[0m16:56:09.809665 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:c2784a28-0410-4d93-a456-c1e65b117ebe&page=queryresults
[0m16:56:15.016325 [info ] [Thread-1 (]: 1 of 5 PASS not_null_dim_ship_ship_id .......................................... [[32mPASS[0m in 6.61s]
[0m16:56:15.018683 [info ] [Thread-3 (]: 3 of 5 PASS not_null_dim_ship_sk_ship .......................................... [[32mPASS[0m in 6.61s]
[0m16:56:15.022755 [debug] [Thread-1 (]: Finished running node test.dbt_exercise.not_null_dim_ship_ship_id.0e7926966a
[0m16:56:15.024808 [info ] [Thread-2 (]: 2 of 5 PASS not_null_dim_ship_shipper_id ....................................... [[32mPASS[0m in 6.61s]
[0m16:56:15.028685 [debug] [Thread-3 (]: Finished running node test.dbt_exercise.not_null_dim_ship_sk_ship.3ae993afec
[0m16:56:15.032203 [info ] [Thread-4 (]: 4 of 5 PASS unique_dim_ship_ship_id ............................................ [[32mPASS[0m in 6.62s]
[0m16:56:15.033741 [debug] [Thread-1 (]: Began running node test.dbt_exercise.unique_dim_ship_sk_ship.14db8b5f73
[0m16:56:15.035712 [debug] [Thread-2 (]: Finished running node test.dbt_exercise.not_null_dim_ship_shipper_id.78acf0f3d3
[0m16:56:15.037903 [debug] [Thread-4 (]: Finished running node test.dbt_exercise.unique_dim_ship_ship_id.8825a91f8e
[0m16:56:15.038882 [info ] [Thread-1 (]: 5 of 5 START test unique_dim_ship_sk_ship ...................................... [RUN]
[0m16:56:15.042519 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_exercise.not_null_dim_ship_ship_id.0e7926966a, now test.dbt_exercise.unique_dim_ship_sk_ship.14db8b5f73)
[0m16:56:15.044299 [debug] [Thread-1 (]: Began compiling node test.dbt_exercise.unique_dim_ship_sk_ship.14db8b5f73
[0m16:56:15.056177 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_exercise.unique_dim_ship_sk_ship.14db8b5f73"
[0m16:56:15.058481 [debug] [Thread-1 (]: Began executing node test.dbt_exercise.unique_dim_ship_sk_ship.14db8b5f73
[0m16:56:15.067079 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_exercise.unique_dim_ship_sk_ship.14db8b5f73"
[0m16:56:15.068619 [debug] [Thread-1 (]: On test.dbt_exercise.unique_dim_ship_sk_ship.14db8b5f73: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "test.dbt_exercise.unique_dim_ship_sk_ship.14db8b5f73"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with dbt_test__target as (

  select sk_ship as unique_field
  from `corded-sunlight-464012-e2`.`dbt_dw_marts`.`dim_ship`
  where sk_ship is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m16:56:15.070249 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:56:15.982391 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:a03b405a-4ae5-4b7c-b8a8-ba6ad0eaf9b8&page=queryresults
[0m16:56:16.810935 [error] [Thread-1 (]: 5 of 5 FAIL 3 unique_dim_ship_sk_ship .......................................... [[31mFAIL 3[0m in 1.77s]
[0m16:56:16.812621 [debug] [Thread-1 (]: Finished running node test.dbt_exercise.unique_dim_ship_sk_ship.14db8b5f73
[0m16:56:16.816941 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:56:16.827995 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:56:16.828823 [debug] [MainThread]: Connection 'test.dbt_exercise.unique_dim_ship_ship_id.8825a91f8e' was properly closed.
[0m16:56:16.829543 [debug] [MainThread]: Connection 'test.dbt_exercise.not_null_dim_ship_shipper_id.78acf0f3d3' was properly closed.
[0m16:56:16.830383 [debug] [MainThread]: Connection 'test.dbt_exercise.unique_dim_ship_sk_ship.14db8b5f73' was properly closed.
[0m16:56:16.831082 [debug] [MainThread]: Connection 'test.dbt_exercise.not_null_dim_ship_sk_ship.3ae993afec' was properly closed.
[0m16:56:16.832302 [info ] [MainThread]: 
[0m16:56:16.833950 [info ] [MainThread]: Finished running 5 data tests in 0 hours 0 minutes and 9.43 seconds (9.43s).
[0m16:56:16.837424 [debug] [MainThread]: Command end result
[0m16:56:16.935061 [debug] [MainThread]: Wrote artifact WritableManifest to /home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/target/manifest.json
[0m16:56:16.952976 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/target/semantic_manifest.json
[0m16:56:16.966067 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/target/run_results.json
[0m16:56:16.966966 [info ] [MainThread]: 
[0m16:56:16.968283 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m16:56:16.969082 [info ] [MainThread]: 
[0m16:56:16.969807 [error] [MainThread]: [31mFailure in test unique_dim_ship_sk_ship (models/marts/dim_ship.yml)[0m
[0m16:56:16.970553 [error] [MainThread]:   Got 3 results, configured to fail if != 0
[0m16:56:16.971135 [info ] [MainThread]: 
[0m16:56:16.973306 [info ] [MainThread]:   compiled code at target/compiled/dbt_exercise/models/marts/dim_ship.yml/unique_dim_ship_sk_ship.sql
[0m16:56:16.974386 [info ] [MainThread]: 
[0m16:56:16.975309 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=5
[0m16:56:16.976563 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- DuplicateYAMLKeysDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m16:56:16.983119 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": false, "command_wall_clock_time": 118.03924, "process_in_blocks": "122920", "process_kernel_time": 15.613197, "process_mem_max_rss": "369380", "process_out_blocks": "3928", "process_user_time": 13.504724}
[0m16:56:16.984984 [debug] [MainThread]: Command `dbt test` failed at 16:56:16.984485 after 118.04 seconds
[0m16:56:16.986200 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77546ea5cad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77546db51e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77542c2a2cf0>]}
[0m16:56:16.987223 [debug] [MainThread]: Flushing usage events
[0m16:56:17.318022 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:57:11.446061 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75cd691d8980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75cd690cd010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75cd691daa80>]}


============================== 16:57:11.471502 | 99191422-0bac-495c-98bc-1e9cc211fc46 ==============================
[0m16:57:11.471502 [info ] [MainThread]: Running with dbt=1.10.2
[0m16:57:11.472994 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'invocation_command': 'dbt run -s dim_ship', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:58:11.405635 [warn ] [MainThread]: [[33mWARNING[0m][DuplicateYAMLKeysDeprecation]: Deprecated functionality
Duplicate key 'version' in "<unicode string>", line 4, column 1 in file
`/home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/dbt_project.yml`
[0m16:58:11.406993 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '99191422-0bac-495c-98bc-1e9cc211fc46', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75cd6858cd70>]}
[0m16:58:12.442626 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '99191422-0bac-495c-98bc-1e9cc211fc46', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75cd2b3051f0>]}
[0m16:58:12.544282 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '99191422-0bac-495c-98bc-1e9cc211fc46', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75cd6a91ce00>]}
[0m16:58:12.550181 [info ] [MainThread]: Registered adapter: bigquery=1.9.2
[0m16:59:18.882732 [debug] [MainThread]: checksum: 1adc40777973ef30f45f80b3b6d04d5013c1edd53d96363881b3b199e612468b, vars: {}, profile: , target: , version: 1.10.2
[0m16:59:27.961256 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:59:27.962312 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:59:28.368919 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '99191422-0bac-495c-98bc-1e9cc211fc46', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75cd2ae3a2d0>]}
[0m16:59:28.592417 [debug] [MainThread]: Wrote artifact WritableManifest to /home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/target/manifest.json
[0m16:59:28.609530 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/target/semantic_manifest.json
[0m16:59:29.227152 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '99191422-0bac-495c-98bc-1e9cc211fc46', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75cd6817c050>]}
[0m16:59:29.228477 [info ] [MainThread]: Found 14 seeds, 55 data tests, 19 models, 14 sources, 609 macros
[0m16:59:29.229970 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '99191422-0bac-495c-98bc-1e9cc211fc46', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75cd2acf9370>]}
[0m16:59:29.235115 [info ] [MainThread]: 
[0m16:59:29.236139 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:59:29.237018 [info ] [MainThread]: 
[0m16:59:29.238614 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m16:59:29.241729 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_corded-sunlight-464012-e2'
[0m16:59:29.242717 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:59:30.189169 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_corded-sunlight-464012-e2, now list_corded-sunlight-464012-e2_dbt_dw_intermediate)
[0m16:59:30.190979 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_corded-sunlight-464012-e2_dbt_dw_marts'
[0m16:59:30.191822 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m16:59:30.193768 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_corded-sunlight-464012-e2_dbt_dw_staging'
[0m16:59:30.194424 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:59:30.195980 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_corded-sunlight-464012-e2_dbt_dw_raw'
[0m16:59:30.197143 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:59:30.198228 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:59:31.150796 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '99191422-0bac-495c-98bc-1e9cc211fc46', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75cd6862f980>]}
[0m16:59:31.151684 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:59:31.163170 [debug] [Thread-1 (]: Began running node model.dbt_exercise.dim_ship
[0m16:59:31.164506 [info ] [Thread-1 (]: 1 of 1 START sql table model dbt_dw_marts.dim_ship ............................. [RUN]
[0m16:59:31.165611 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_corded-sunlight-464012-e2_dbt_dw_raw, now model.dbt_exercise.dim_ship)
[0m16:59:31.166663 [debug] [Thread-1 (]: Began compiling node model.dbt_exercise.dim_ship
[0m16:59:31.208721 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_exercise.dim_ship"
[0m16:59:31.210575 [debug] [Thread-1 (]: Began executing node model.dbt_exercise.dim_ship
[0m16:59:31.233713 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:59:32.066878 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_exercise.dim_ship"
[0m16:59:32.069409 [debug] [Thread-1 (]: On model.dbt_exercise.dim_ship: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "model.dbt_exercise.dim_ship"} */

  
    

    create or replace table `corded-sunlight-464012-e2`.`dbt_dw_marts`.`dim_ship`
      
    
    

    OPTIONS()
    as (
      with int_shippers_northwind as (
    select *
    from `corded-sunlight-464012-e2`.`dbt_dw_intermediate`.`int_shippers_northwind`
)

, dim_ship as (
    select
        to_hex(md5(cast(coalesce(cast(ship_id as string), '_dbt_utils_surrogate_key_null_') as string))) as sk_ship
        , ship_id
        , shipper_id
        , company_name
        , ship_address
        , ship_city
        , ship_region
        , ship_country
        , ship_continent
    from int_shippers_northwind
)

select *
from dim_ship
    );
  
[0m16:59:32.820962 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:450d8498-903d-4421-92c8-e948b044f274&page=queryresults
[0m16:59:41.997786 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '99191422-0bac-495c-98bc-1e9cc211fc46', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75cd2fdf28d0>]}
[0m16:59:41.999306 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dbt_dw_marts.dim_ship ........................ [[32mCREATE TABLE (242.0 rows, 39.9 KiB processed)[0m in 10.81s]
[0m16:59:42.001521 [debug] [Thread-1 (]: Finished running node model.dbt_exercise.dim_ship
[0m16:59:42.006751 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m16:59:42.019611 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:59:42.020590 [debug] [MainThread]: Connection 'list_corded-sunlight-464012-e2_dbt_dw_intermediate' was properly closed.
[0m16:59:42.022032 [debug] [MainThread]: Connection 'list_corded-sunlight-464012-e2_dbt_dw_marts' was properly closed.
[0m16:59:42.022914 [debug] [MainThread]: Connection 'list_corded-sunlight-464012-e2_dbt_dw_staging' was properly closed.
[0m16:59:42.023824 [debug] [MainThread]: Connection 'model.dbt_exercise.dim_ship' was properly closed.
[0m16:59:42.025266 [info ] [MainThread]: 
[0m16:59:42.026373 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 12.79 seconds (12.79s).
[0m16:59:42.028397 [debug] [MainThread]: Command end result
[0m16:59:42.134632 [debug] [MainThread]: Wrote artifact WritableManifest to /home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/target/manifest.json
[0m16:59:42.151685 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/target/semantic_manifest.json
[0m16:59:42.162291 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/target/run_results.json
[0m16:59:42.162983 [info ] [MainThread]: 
[0m16:59:42.163963 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:59:42.165113 [info ] [MainThread]: 
[0m16:59:42.166936 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m16:59:42.168129 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- DuplicateYAMLKeysDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m16:59:42.173868 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 142.18106, "process_in_blocks": "122920", "process_kernel_time": 18.291203, "process_mem_max_rss": "367316", "process_out_blocks": "3840", "process_user_time": 14.318582}
[0m16:59:42.174960 [debug] [MainThread]: Command `dbt run` succeeded at 16:59:42.174734 after 142.18 seconds
[0m16:59:42.175561 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75cd68d3d5e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75cd2abbe660>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75cd2b1ddd90>]}
[0m16:59:42.176454 [debug] [MainThread]: Flushing usage events
[0m16:59:42.491977 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:00:12.320043 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x799e965d3890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x799e97a23a70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x799e95d261e0>]}


============================== 17:00:12.337118 | f1861aa0-6dc6-43b8-a74e-354bd9ba030c ==============================
[0m17:00:12.337118 [info ] [MainThread]: Running with dbt=1.10.2
[0m17:00:12.338122 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/logs', 'profiles_dir': '/home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt test -s dim_ship', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m17:01:17.725362 [warn ] [MainThread]: [[33mWARNING[0m][DuplicateYAMLKeysDeprecation]: Deprecated functionality
Duplicate key 'version' in "<unicode string>", line 4, column 1 in file
`/home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/dbt_project.yml`
[0m17:01:17.726486 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'f1861aa0-6dc6-43b8-a74e-354bd9ba030c', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x799e58999250>]}
[0m17:01:18.697743 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f1861aa0-6dc6-43b8-a74e-354bd9ba030c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x799e5864e3c0>]}
[0m17:01:18.829343 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f1861aa0-6dc6-43b8-a74e-354bd9ba030c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x799e591af170>]}
[0m17:01:18.835322 [info ] [MainThread]: Registered adapter: bigquery=1.9.2
[0m17:02:24.627373 [debug] [MainThread]: checksum: 1adc40777973ef30f45f80b3b6d04d5013c1edd53d96363881b3b199e612468b, vars: {}, profile: , target: , version: 1.10.2
[0m17:02:30.269610 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:02:30.270229 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:02:30.575220 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f1861aa0-6dc6-43b8-a74e-354bd9ba030c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x799e58366990>]}
[0m17:02:30.774754 [debug] [MainThread]: Wrote artifact WritableManifest to /home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/target/manifest.json
[0m17:02:30.787902 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/target/semantic_manifest.json
[0m17:02:31.321204 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f1861aa0-6dc6-43b8-a74e-354bd9ba030c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x799e580fc890>]}
[0m17:02:31.321999 [info ] [MainThread]: Found 14 seeds, 55 data tests, 19 models, 14 sources, 609 macros
[0m17:02:31.322622 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f1861aa0-6dc6-43b8-a74e-354bd9ba030c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x799e585bf9b0>]}
[0m17:02:31.325709 [info ] [MainThread]: 
[0m17:02:31.326381 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m17:02:31.326918 [info ] [MainThread]: 
[0m17:02:31.327789 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m17:02:31.337242 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_corded-sunlight-464012-e2_dbt_dw_raw'
[0m17:02:31.339170 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_corded-sunlight-464012-e2_dbt_dw_staging'
[0m17:02:31.339921 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:02:31.341121 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_corded-sunlight-464012-e2_dbt_dw_marts'
[0m17:02:31.342518 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:02:31.343459 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_corded-sunlight-464012-e2_dbt_dw_intermediate'
[0m17:02:31.344889 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:02:31.346604 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:02:32.369840 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f1861aa0-6dc6-43b8-a74e-354bd9ba030c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x799e5872af00>]}
[0m17:02:32.371111 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:02:32.385761 [debug] [Thread-1 (]: Began running node test.dbt_exercise.not_null_dim_ship_ship_id.0e7926966a
[0m17:02:32.387059 [debug] [Thread-2 (]: Began running node test.dbt_exercise.not_null_dim_ship_shipper_id.78acf0f3d3
[0m17:02:32.388210 [debug] [Thread-3 (]: Began running node test.dbt_exercise.not_null_dim_ship_sk_ship.3ae993afec
[0m17:02:32.389009 [info ] [Thread-1 (]: 1 of 5 START test not_null_dim_ship_ship_id .................................... [RUN]
[0m17:02:32.390047 [debug] [Thread-4 (]: Began running node test.dbt_exercise.unique_dim_ship_ship_id.8825a91f8e
[0m17:02:32.391051 [info ] [Thread-2 (]: 2 of 5 START test not_null_dim_ship_shipper_id ................................. [RUN]
[0m17:02:32.392194 [info ] [Thread-3 (]: 3 of 5 START test not_null_dim_ship_sk_ship .................................... [RUN]
[0m17:02:32.393313 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_corded-sunlight-464012-e2_dbt_dw_raw, now test.dbt_exercise.not_null_dim_ship_ship_id.0e7926966a)
[0m17:02:32.394334 [info ] [Thread-4 (]: 4 of 5 START test unique_dim_ship_ship_id ...................................... [RUN]
[0m17:02:32.395490 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_corded-sunlight-464012-e2_dbt_dw_intermediate, now test.dbt_exercise.not_null_dim_ship_shipper_id.78acf0f3d3)
[0m17:02:32.396408 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_corded-sunlight-464012-e2_dbt_dw_staging, now test.dbt_exercise.not_null_dim_ship_sk_ship.3ae993afec)
[0m17:02:32.397917 [debug] [Thread-1 (]: Began compiling node test.dbt_exercise.not_null_dim_ship_ship_id.0e7926966a
[0m17:02:32.399464 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly list_corded-sunlight-464012-e2_dbt_dw_marts, now test.dbt_exercise.unique_dim_ship_ship_id.8825a91f8e)
[0m17:02:32.400348 [debug] [Thread-2 (]: Began compiling node test.dbt_exercise.not_null_dim_ship_shipper_id.78acf0f3d3
[0m17:02:32.401644 [debug] [Thread-3 (]: Began compiling node test.dbt_exercise.not_null_dim_ship_sk_ship.3ae993afec
[0m17:02:32.428563 [debug] [Thread-4 (]: Began compiling node test.dbt_exercise.unique_dim_ship_ship_id.8825a91f8e
[0m17:02:32.432173 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_exercise.not_null_dim_ship_ship_id.0e7926966a"
[0m17:02:32.438287 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_exercise.not_null_dim_ship_shipper_id.78acf0f3d3"
[0m17:02:32.444688 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_exercise.not_null_dim_ship_sk_ship.3ae993afec"
[0m17:02:32.456005 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_exercise.unique_dim_ship_ship_id.8825a91f8e"
[0m17:02:32.458635 [debug] [Thread-1 (]: Began executing node test.dbt_exercise.not_null_dim_ship_ship_id.0e7926966a
[0m17:02:32.465895 [debug] [Thread-4 (]: Began executing node test.dbt_exercise.unique_dim_ship_ship_id.8825a91f8e
[0m17:02:32.466602 [debug] [Thread-3 (]: Began executing node test.dbt_exercise.not_null_dim_ship_sk_ship.3ae993afec
[0m17:02:32.467431 [debug] [Thread-2 (]: Began executing node test.dbt_exercise.not_null_dim_ship_shipper_id.78acf0f3d3
[0m17:02:32.528116 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_exercise.not_null_dim_ship_ship_id.0e7926966a"
[0m17:02:32.535455 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_exercise.not_null_dim_ship_sk_ship.3ae993afec"
[0m17:02:32.536855 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_exercise.unique_dim_ship_ship_id.8825a91f8e"
[0m17:02:32.542204 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_exercise.not_null_dim_ship_shipper_id.78acf0f3d3"
[0m17:02:32.543393 [debug] [Thread-1 (]: On test.dbt_exercise.not_null_dim_ship_ship_id.0e7926966a: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "test.dbt_exercise.not_null_dim_ship_ship_id.0e7926966a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select ship_id
from `corded-sunlight-464012-e2`.`dbt_dw_marts`.`dim_ship`
where ship_id is null



  
  
      
    ) dbt_internal_test
[0m17:02:32.546029 [debug] [Thread-3 (]: On test.dbt_exercise.not_null_dim_ship_sk_ship.3ae993afec: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "test.dbt_exercise.not_null_dim_ship_sk_ship.3ae993afec"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select sk_ship
from `corded-sunlight-464012-e2`.`dbt_dw_marts`.`dim_ship`
where sk_ship is null



  
  
      
    ) dbt_internal_test
[0m17:02:32.547137 [debug] [Thread-4 (]: On test.dbt_exercise.unique_dim_ship_ship_id.8825a91f8e: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "test.dbt_exercise.unique_dim_ship_ship_id.8825a91f8e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with dbt_test__target as (

  select ship_id as unique_field
  from `corded-sunlight-464012-e2`.`dbt_dw_marts`.`dim_ship`
  where ship_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m17:02:32.547998 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:02:32.549001 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m17:02:32.549721 [debug] [Thread-2 (]: On test.dbt_exercise.not_null_dim_ship_shipper_id.78acf0f3d3: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "test.dbt_exercise.not_null_dim_ship_shipper_id.78acf0f3d3"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select shipper_id
from `corded-sunlight-464012-e2`.`dbt_dw_marts`.`dim_ship`
where shipper_id is null



  
  
      
    ) dbt_internal_test
[0m17:02:32.550447 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m17:02:32.552060 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:02:33.804395 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:f1b0278d-5f82-478c-a808-1af13e363ec1&page=queryresults
[0m17:02:33.818651 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:5bc9263e-57a7-4ae5-adae-fd57f83e99ff&page=queryresults
[0m17:02:33.868021 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:62e9ac25-8383-46b5-a06e-33ac29ed4265&page=queryresults
[0m17:02:34.123573 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:5714bd1a-f190-4cf7-8196-d53dc1debd48&page=queryresults
[0m17:02:39.342066 [info ] [Thread-3 (]: 3 of 5 PASS not_null_dim_ship_sk_ship .......................................... [[32mPASS[0m in 6.95s]
[0m17:02:39.343479 [debug] [Thread-3 (]: Finished running node test.dbt_exercise.not_null_dim_ship_sk_ship.3ae993afec
[0m17:02:39.344505 [debug] [Thread-3 (]: Began running node test.dbt_exercise.unique_dim_ship_sk_ship.14db8b5f73
[0m17:02:39.345481 [info ] [Thread-3 (]: 5 of 5 START test unique_dim_ship_sk_ship ...................................... [RUN]
[0m17:02:39.346481 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_exercise.not_null_dim_ship_sk_ship.3ae993afec, now test.dbt_exercise.unique_dim_ship_sk_ship.14db8b5f73)
[0m17:02:39.347620 [debug] [Thread-3 (]: Began compiling node test.dbt_exercise.unique_dim_ship_sk_ship.14db8b5f73
[0m17:02:39.357138 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_exercise.unique_dim_ship_sk_ship.14db8b5f73"
[0m17:02:39.369018 [debug] [Thread-3 (]: Began executing node test.dbt_exercise.unique_dim_ship_sk_ship.14db8b5f73
[0m17:02:39.367948 [info ] [Thread-2 (]: 2 of 5 PASS not_null_dim_ship_shipper_id ....................................... [[32mPASS[0m in 6.97s]
[0m17:02:39.373271 [info ] [Thread-1 (]: 1 of 5 PASS not_null_dim_ship_ship_id .......................................... [[32mPASS[0m in 6.98s]
[0m17:02:39.375303 [info ] [Thread-4 (]: 4 of 5 PASS unique_dim_ship_ship_id ............................................ [[32mPASS[0m in 6.98s]
[0m17:02:39.385400 [debug] [Thread-2 (]: Finished running node test.dbt_exercise.not_null_dim_ship_shipper_id.78acf0f3d3
[0m17:02:39.387493 [debug] [Thread-1 (]: Finished running node test.dbt_exercise.not_null_dim_ship_ship_id.0e7926966a
[0m17:02:39.390642 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_exercise.unique_dim_ship_sk_ship.14db8b5f73"
[0m17:02:39.393439 [debug] [Thread-4 (]: Finished running node test.dbt_exercise.unique_dim_ship_ship_id.8825a91f8e
[0m17:02:39.396336 [debug] [Thread-3 (]: On test.dbt_exercise.unique_dim_ship_sk_ship.14db8b5f73: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "test.dbt_exercise.unique_dim_ship_sk_ship.14db8b5f73"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with dbt_test__target as (

  select sk_ship as unique_field
  from `corded-sunlight-464012-e2`.`dbt_dw_marts`.`dim_ship`
  where sk_ship is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m17:02:39.397257 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m17:02:40.693272 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:784c96b0-3a73-47d9-b68f-4c44a5885595&page=queryresults
[0m17:02:41.573302 [info ] [Thread-3 (]: 5 of 5 PASS unique_dim_ship_sk_ship ............................................ [[32mPASS[0m in 2.23s]
[0m17:02:41.574924 [debug] [Thread-3 (]: Finished running node test.dbt_exercise.unique_dim_ship_sk_ship.14db8b5f73
[0m17:02:41.579168 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:02:41.593174 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:02:41.594183 [debug] [MainThread]: Connection 'test.dbt_exercise.not_null_dim_ship_ship_id.0e7926966a' was properly closed.
[0m17:02:41.594831 [debug] [MainThread]: Connection 'test.dbt_exercise.unique_dim_ship_sk_ship.14db8b5f73' was properly closed.
[0m17:02:41.595475 [debug] [MainThread]: Connection 'test.dbt_exercise.unique_dim_ship_ship_id.8825a91f8e' was properly closed.
[0m17:02:41.596055 [debug] [MainThread]: Connection 'test.dbt_exercise.not_null_dim_ship_shipper_id.78acf0f3d3' was properly closed.
[0m17:02:41.596787 [info ] [MainThread]: 
[0m17:02:41.597932 [info ] [MainThread]: Finished running 5 data tests in 0 hours 0 minutes and 10.27 seconds (10.27s).
[0m17:02:41.601686 [debug] [MainThread]: Command end result
[0m17:02:41.707499 [debug] [MainThread]: Wrote artifact WritableManifest to /home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/target/manifest.json
[0m17:02:41.728505 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/target/semantic_manifest.json
[0m17:02:41.739159 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/target/run_results.json
[0m17:02:41.739987 [info ] [MainThread]: 
[0m17:02:41.740734 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:02:41.741719 [info ] [MainThread]: 
[0m17:02:41.742445 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=5
[0m17:02:41.743457 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- DuplicateYAMLKeysDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m17:02:41.749662 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 140.53246, "process_in_blocks": "122920", "process_kernel_time": 18.617971, "process_mem_max_rss": "369508", "process_out_blocks": "3920", "process_user_time": 15.157563}
[0m17:02:41.751199 [debug] [MainThread]: Command `dbt test` succeeded at 17:02:41.750627 after 140.53 seconds
[0m17:02:41.753873 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x799e581531a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x799e54368e30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x799e5827bb90>]}
[0m17:02:41.754829 [debug] [MainThread]: Flushing usage events
[0m17:02:42.100322 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:03:30.279035 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4809afa150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f480b4e5b20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4809fe3e90>]}


============================== 17:03:30.300007 | d7338ab8-c325-4764-92e4-0acc11ad1970 ==============================
[0m17:03:30.300007 [info ] [MainThread]: Running with dbt=1.10.2
[0m17:03:30.301206 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/logs', 'version_check': 'True', 'profiles_dir': '/home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run -s dim_products', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m17:04:30.800551 [warn ] [MainThread]: [[33mWARNING[0m][DuplicateYAMLKeysDeprecation]: Deprecated functionality
Duplicate key 'version' in "<unicode string>", line 4, column 1 in file
`/home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/dbt_project.yml`
[0m17:04:30.801933 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'd7338ab8-c325-4764-92e4-0acc11ad1970', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f47cbb58320>]}
[0m17:04:31.459224 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd7338ab8-c325-4764-92e4-0acc11ad1970', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f47cbbcb800>]}
[0m17:04:31.550771 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd7338ab8-c325-4764-92e4-0acc11ad1970', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f47cc909700>]}
[0m17:04:31.556139 [info ] [MainThread]: Registered adapter: bigquery=1.9.2
[0m17:05:38.050544 [debug] [MainThread]: checksum: 1adc40777973ef30f45f80b3b6d04d5013c1edd53d96363881b3b199e612468b, vars: {}, profile: , target: , version: 1.10.2
[0m17:05:48.374849 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:05:48.375568 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:05:48.735277 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd7338ab8-c325-4764-92e4-0acc11ad1970', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f480aca08f0>]}
[0m17:05:48.941954 [debug] [MainThread]: Wrote artifact WritableManifest to /home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/target/manifest.json
[0m17:05:48.963299 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/target/semantic_manifest.json
[0m17:05:49.606315 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd7338ab8-c325-4764-92e4-0acc11ad1970', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f47cb5d4b00>]}
[0m17:05:49.607146 [info ] [MainThread]: Found 14 seeds, 55 data tests, 19 models, 14 sources, 609 macros
[0m17:05:49.607884 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd7338ab8-c325-4764-92e4-0acc11ad1970', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f47cb49b200>]}
[0m17:05:49.611220 [info ] [MainThread]: 
[0m17:05:49.612040 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m17:05:49.612739 [info ] [MainThread]: 
[0m17:05:49.613892 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m17:05:49.616489 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_corded-sunlight-464012-e2'
[0m17:05:49.617697 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:05:50.670876 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_corded-sunlight-464012-e2, now list_corded-sunlight-464012-e2_dbt_dw_marts)
[0m17:05:50.674286 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:05:50.676032 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_corded-sunlight-464012-e2_dbt_dw_intermediate'
[0m17:05:50.678249 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_corded-sunlight-464012-e2_dbt_dw_staging'
[0m17:05:50.680635 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_corded-sunlight-464012-e2_dbt_dw_raw'
[0m17:05:50.682576 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:05:50.683920 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:05:50.685267 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:05:51.765075 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd7338ab8-c325-4764-92e4-0acc11ad1970', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f47cb48eab0>]}
[0m17:05:51.766142 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:05:51.783916 [debug] [Thread-1 (]: Began running node model.dbt_exercise.dim_products
[0m17:05:51.785013 [info ] [Thread-1 (]: 1 of 1 START sql table model dbt_dw_marts.dim_products ......................... [RUN]
[0m17:05:51.786989 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_corded-sunlight-464012-e2_dbt_dw_raw, now model.dbt_exercise.dim_products)
[0m17:05:51.788558 [debug] [Thread-1 (]: Began compiling node model.dbt_exercise.dim_products
[0m17:05:51.827138 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_exercise.dim_products"
[0m17:05:51.842514 [debug] [Thread-1 (]: Began executing node model.dbt_exercise.dim_products
[0m17:05:51.867623 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:05:52.694302 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_exercise.dim_products"
[0m17:05:52.696581 [debug] [Thread-1 (]: On model.dbt_exercise.dim_products: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "model.dbt_exercise.dim_products"} */

  
    

    create or replace table `corded-sunlight-464012-e2`.`dbt_dw_marts`.`dim_products`
      
    
    

    OPTIONS()
    as (
      with int_products_northwind as (
    select *
    from `corded-sunlight-464012-e2`.`dbt_dw_intermediate`.`int_products_northwind`
)

, dim_products as (
    select
        to_hex(md5(cast(coalesce(cast(product_id as string), '_dbt_utils_surrogate_key_null_') as string))) as sk_product
        , product_id
        , product_name
        , quantity_per_unit
        , category_name
        , supplier_name
        , supplier_city
        , supplier_region
        , supplier_country
        , supplier_continent
        , is_discontinued
    from int_products_northwind
)

select *
from dim_products
    );
  
[0m17:05:53.410207 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:1a771f5d-fb1e-43d0-8390-6f87f06c8839&page=queryresults
[0m17:06:07.759190 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd7338ab8-c325-4764-92e4-0acc11ad1970', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4809af9f10>]}
[0m17:06:07.761607 [info ] [Thread-1 (]: 1 of 1 OK created sql table model dbt_dw_marts.dim_products .................... [[32mCREATE TABLE (77.0 rows, 6.6 KiB processed)[0m in 15.93s]
[0m17:06:07.763452 [debug] [Thread-1 (]: Finished running node model.dbt_exercise.dim_products
[0m17:06:07.769006 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:06:07.778786 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:06:07.783516 [debug] [MainThread]: Connection 'list_corded-sunlight-464012-e2_dbt_dw_marts' was properly closed.
[0m17:06:07.785307 [debug] [MainThread]: Connection 'list_corded-sunlight-464012-e2_dbt_dw_intermediate' was properly closed.
[0m17:06:07.786611 [debug] [MainThread]: Connection 'list_corded-sunlight-464012-e2_dbt_dw_staging' was properly closed.
[0m17:06:07.787882 [debug] [MainThread]: Connection 'model.dbt_exercise.dim_products' was properly closed.
[0m17:06:07.789193 [info ] [MainThread]: 
[0m17:06:07.791130 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 18.18 seconds (18.18s).
[0m17:06:07.794192 [debug] [MainThread]: Command end result
[0m17:06:07.964508 [debug] [MainThread]: Wrote artifact WritableManifest to /home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/target/manifest.json
[0m17:06:07.980566 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/target/semantic_manifest.json
[0m17:06:07.988936 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/target/run_results.json
[0m17:06:07.989821 [info ] [MainThread]: 
[0m17:06:07.990622 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:06:07.991136 [info ] [MainThread]: 
[0m17:06:07.991708 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m17:06:07.992463 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- DuplicateYAMLKeysDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m17:06:07.997612 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 149.14473, "process_in_blocks": "122920", "process_kernel_time": 18.68568, "process_mem_max_rss": "367500", "process_out_blocks": "3832", "process_user_time": 14.369274}
[0m17:06:07.998715 [debug] [MainThread]: Command `dbt run` succeeded at 17:06:07.998342 after 149.15 seconds
[0m17:06:07.999901 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f480cdb73e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f48099282f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4809928bf0>]}
[0m17:06:08.001044 [debug] [MainThread]: Flushing usage events
[0m17:06:08.338932 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:06:46.626076 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x741034007c80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x741033ec90d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74103335bbc0>]}


============================== 17:06:46.646828 | 3e976e03-9132-4ec5-9763-79022330f1de ==============================
[0m17:06:46.646828 [info ] [MainThread]: Running with dbt=1.10.2
[0m17:06:46.647903 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/logs', 'profiles_dir': '/home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt test -s dim_products', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:07:55.381197 [warn ] [MainThread]: [[33mWARNING[0m][DuplicateYAMLKeysDeprecation]: Deprecated functionality
Duplicate key 'version' in "<unicode string>", line 4, column 1 in file
`/home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/dbt_project.yml`
[0m17:07:55.381988 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '3e976e03-9132-4ec5-9763-79022330f1de', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x740ff6514ec0>]}
[0m17:07:56.280566 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3e976e03-9132-4ec5-9763-79022330f1de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7410357ae510>]}
[0m17:07:56.396454 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3e976e03-9132-4ec5-9763-79022330f1de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x740ff61dee70>]}
[0m17:07:56.402145 [info ] [MainThread]: Registered adapter: bigquery=1.9.2
[0m17:08:57.483949 [debug] [MainThread]: checksum: 1adc40777973ef30f45f80b3b6d04d5013c1edd53d96363881b3b199e612468b, vars: {}, profile: , target: , version: 1.10.2
[0m17:09:03.324940 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:09:03.325628 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:09:03.610933 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3e976e03-9132-4ec5-9763-79022330f1de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74103372a0f0>]}
[0m17:09:03.823099 [debug] [MainThread]: Wrote artifact WritableManifest to /home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/target/manifest.json
[0m17:09:03.838039 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/target/semantic_manifest.json
[0m17:09:04.397714 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3e976e03-9132-4ec5-9763-79022330f1de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x740ff58046b0>]}
[0m17:09:04.398864 [info ] [MainThread]: Found 14 seeds, 55 data tests, 19 models, 14 sources, 609 macros
[0m17:09:04.399944 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3e976e03-9132-4ec5-9763-79022330f1de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x741032f4f920>]}
[0m17:09:04.403654 [info ] [MainThread]: 
[0m17:09:04.404582 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m17:09:04.405341 [info ] [MainThread]: 
[0m17:09:04.406800 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m17:09:04.420892 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_corded-sunlight-464012-e2_dbt_dw_marts'
[0m17:09:04.423227 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_corded-sunlight-464012-e2_dbt_dw_staging'
[0m17:09:04.424440 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:09:04.426977 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_corded-sunlight-464012-e2_dbt_dw_raw'
[0m17:09:04.429575 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:09:04.431196 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_corded-sunlight-464012-e2_dbt_dw_intermediate'
[0m17:09:04.432724 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:09:04.434049 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:09:05.465348 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3e976e03-9132-4ec5-9763-79022330f1de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x740ff5c5cda0>]}
[0m17:09:05.466311 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:09:05.480966 [debug] [Thread-1 (]: Began running node test.dbt_exercise.accepted_values_dim_products_is_discontinued__True__False.b53ac91bb6
[0m17:09:05.481946 [debug] [Thread-2 (]: Began running node test.dbt_exercise.not_null_dim_products_product_id.c8aba288d1
[0m17:09:05.483868 [debug] [Thread-3 (]: Began running node test.dbt_exercise.not_null_dim_products_sk_product.7ce7792ece
[0m17:09:05.483129 [info ] [Thread-1 (]: 1 of 5 START test accepted_values_dim_products_is_discontinued__True__False .... [RUN]
[0m17:09:05.485134 [debug] [Thread-4 (]: Began running node test.dbt_exercise.unique_dim_products_product_id.ef7b2a9985
[0m17:09:05.485803 [info ] [Thread-2 (]: 2 of 5 START test not_null_dim_products_product_id ............................. [RUN]
[0m17:09:05.487627 [info ] [Thread-3 (]: 3 of 5 START test not_null_dim_products_sk_product ............................. [RUN]
[0m17:09:05.489392 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_corded-sunlight-464012-e2_dbt_dw_marts, now test.dbt_exercise.accepted_values_dim_products_is_discontinued__True__False.b53ac91bb6)
[0m17:09:05.490628 [info ] [Thread-4 (]: 4 of 5 START test unique_dim_products_product_id ............................... [RUN]
[0m17:09:05.491892 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_corded-sunlight-464012-e2_dbt_dw_intermediate, now test.dbt_exercise.not_null_dim_products_product_id.c8aba288d1)
[0m17:09:05.492979 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_corded-sunlight-464012-e2_dbt_dw_staging, now test.dbt_exercise.not_null_dim_products_sk_product.7ce7792ece)
[0m17:09:05.494024 [debug] [Thread-1 (]: Began compiling node test.dbt_exercise.accepted_values_dim_products_is_discontinued__True__False.b53ac91bb6
[0m17:09:05.495042 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly list_corded-sunlight-464012-e2_dbt_dw_raw, now test.dbt_exercise.unique_dim_products_product_id.ef7b2a9985)
[0m17:09:05.495897 [debug] [Thread-2 (]: Began compiling node test.dbt_exercise.not_null_dim_products_product_id.c8aba288d1
[0m17:09:05.496690 [debug] [Thread-3 (]: Began compiling node test.dbt_exercise.not_null_dim_products_sk_product.7ce7792ece
[0m17:09:05.519944 [debug] [Thread-4 (]: Began compiling node test.dbt_exercise.unique_dim_products_product_id.ef7b2a9985
[0m17:09:05.529560 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_exercise.accepted_values_dim_products_is_discontinued__True__False.b53ac91bb6"
[0m17:09:05.543885 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_exercise.not_null_dim_products_product_id.c8aba288d1"
[0m17:09:05.552887 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_exercise.not_null_dim_products_sk_product.7ce7792ece"
[0m17:09:05.563231 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_exercise.unique_dim_products_product_id.ef7b2a9985"
[0m17:09:05.566227 [debug] [Thread-1 (]: Began executing node test.dbt_exercise.accepted_values_dim_products_is_discontinued__True__False.b53ac91bb6
[0m17:09:05.568044 [debug] [Thread-3 (]: Began executing node test.dbt_exercise.not_null_dim_products_sk_product.7ce7792ece
[0m17:09:05.569088 [debug] [Thread-2 (]: Began executing node test.dbt_exercise.not_null_dim_products_product_id.c8aba288d1
[0m17:09:05.588982 [debug] [Thread-4 (]: Began executing node test.dbt_exercise.unique_dim_products_product_id.ef7b2a9985
[0m17:09:05.635686 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_exercise.accepted_values_dim_products_is_discontinued__True__False.b53ac91bb6"
[0m17:09:05.638723 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_exercise.not_null_dim_products_sk_product.7ce7792ece"
[0m17:09:05.641193 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_exercise.not_null_dim_products_product_id.c8aba288d1"
[0m17:09:05.645242 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_exercise.unique_dim_products_product_id.ef7b2a9985"
[0m17:09:05.647515 [debug] [Thread-1 (]: On test.dbt_exercise.accepted_values_dim_products_is_discontinued__True__False.b53ac91bb6: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "test.dbt_exercise.accepted_values_dim_products_is_discontinued__True__False.b53ac91bb6"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        is_discontinued as value_field,
        count(*) as n_records

    from `corded-sunlight-464012-e2`.`dbt_dw_marts`.`dim_products`
    group by is_discontinued

)

select *
from all_values
where value_field not in (
    'True','False'
)



  
  
      
    ) dbt_internal_test
[0m17:09:05.648821 [debug] [Thread-3 (]: On test.dbt_exercise.not_null_dim_products_sk_product.7ce7792ece: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "test.dbt_exercise.not_null_dim_products_sk_product.7ce7792ece"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select sk_product
from `corded-sunlight-464012-e2`.`dbt_dw_marts`.`dim_products`
where sk_product is null



  
  
      
    ) dbt_internal_test
[0m17:09:05.650019 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:09:05.650920 [debug] [Thread-2 (]: On test.dbt_exercise.not_null_dim_products_product_id.c8aba288d1: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "test.dbt_exercise.not_null_dim_products_product_id.c8aba288d1"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select product_id
from `corded-sunlight-464012-e2`.`dbt_dw_marts`.`dim_products`
where product_id is null



  
  
      
    ) dbt_internal_test
[0m17:09:05.651786 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m17:09:05.652711 [debug] [Thread-4 (]: On test.dbt_exercise.unique_dim_products_product_id.ef7b2a9985: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "test.dbt_exercise.unique_dim_products_product_id.ef7b2a9985"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with dbt_test__target as (

  select product_id as unique_field
  from `corded-sunlight-464012-e2`.`dbt_dw_marts`.`dim_products`
  where product_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m17:09:05.653793 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:09:05.655347 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m17:09:06.883291 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:c9629a76-29b3-4562-b8d3-8f402b73d592&page=queryresults
[0m17:09:06.885162 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:c9629a76-29b3-4562-b8d3-8f402b73d592&page=queryresults
[0m17:09:07.003841 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:98240b37-33e2-480a-a76d-8881c536a50e&page=queryresults
[0m17:09:07.031965 [debug] [Thread-1 (]: Database Error in test accepted_values_dim_products_is_discontinued__True__False (models/marts/dim_products.yml)
  No matching signature for operator IN for argument types BOOL and {STRING} at [27:23]
  compiled code at target/run/dbt_exercise/models/marts/dim_products.yml/accepted_values_dim_products_is_discontinued__True__False.sql
[0m17:09:07.033876 [error] [Thread-1 (]: 1 of 5 ERROR accepted_values_dim_products_is_discontinued__True__False ......... [[31mERROR[0m in 1.54s]
[0m17:09:07.036176 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:01b4cac0-0d2c-4a60-b490-88e128fa8cc0&page=queryresults
[0m17:09:07.037340 [debug] [Thread-1 (]: Finished running node test.dbt_exercise.accepted_values_dim_products_is_discontinued__True__False.b53ac91bb6
[0m17:09:07.040140 [debug] [Thread-1 (]: Began running node test.dbt_exercise.unique_dim_products_sk_product.1658453ef4
[0m17:09:07.041553 [debug] [Thread-7 (]: Marking all children of 'test.dbt_exercise.accepted_values_dim_products_is_discontinued__True__False.b53ac91bb6' to be skipped because of status 'error'.  Reason: Database Error in test accepted_values_dim_products_is_discontinued__True__False (models/marts/dim_products.yml)
  No matching signature for operator IN for argument types BOOL and {STRING} at [27:23]
  compiled code at target/run/dbt_exercise/models/marts/dim_products.yml/accepted_values_dim_products_is_discontinued__True__False.sql.
[0m17:09:07.042859 [info ] [Thread-1 (]: 5 of 5 START test unique_dim_products_sk_product ............................... [RUN]
[0m17:09:07.046212 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_exercise.accepted_values_dim_products_is_discontinued__True__False.b53ac91bb6, now test.dbt_exercise.unique_dim_products_sk_product.1658453ef4)
[0m17:09:07.047994 [debug] [Thread-1 (]: Began compiling node test.dbt_exercise.unique_dim_products_sk_product.1658453ef4
[0m17:09:07.058002 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_exercise.unique_dim_products_sk_product.1658453ef4"
[0m17:09:07.059661 [debug] [Thread-1 (]: Began executing node test.dbt_exercise.unique_dim_products_sk_product.1658453ef4
[0m17:09:07.069062 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_exercise.unique_dim_products_sk_product.1658453ef4"
[0m17:09:07.070538 [debug] [Thread-1 (]: On test.dbt_exercise.unique_dim_products_sk_product.1658453ef4: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "test.dbt_exercise.unique_dim_products_sk_product.1658453ef4"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with dbt_test__target as (

  select sk_product as unique_field
  from `corded-sunlight-464012-e2`.`dbt_dw_marts`.`dim_products`
  where sk_product is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m17:09:07.071428 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:09:07.198076 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:e2b35764-6347-4d7b-a8c6-46bfd7b62390&page=queryresults
[0m17:09:08.389501 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:1f86fb9e-bbfa-45f5-a5a5-84bacbf2a7e0&page=queryresults
[0m17:09:15.813423 [info ] [Thread-4 (]: 4 of 5 PASS unique_dim_products_product_id ..................................... [[32mPASS[0m in 10.32s]
[0m17:09:15.815006 [info ] [Thread-2 (]: 2 of 5 PASS not_null_dim_products_product_id ................................... [[32mPASS[0m in 10.32s]
[0m17:09:15.821621 [debug] [Thread-4 (]: Finished running node test.dbt_exercise.unique_dim_products_product_id.ef7b2a9985
[0m17:09:15.817681 [info ] [Thread-3 (]: 3 of 5 PASS not_null_dim_products_sk_product ................................... [[32mPASS[0m in 10.32s]
[0m17:09:15.826209 [debug] [Thread-2 (]: Finished running node test.dbt_exercise.not_null_dim_products_product_id.c8aba288d1
[0m17:09:15.828741 [info ] [Thread-1 (]: 5 of 5 PASS unique_dim_products_sk_product ..................................... [[32mPASS[0m in 8.78s]
[0m17:09:15.832531 [debug] [Thread-3 (]: Finished running node test.dbt_exercise.not_null_dim_products_sk_product.7ce7792ece
[0m17:09:15.835256 [debug] [Thread-1 (]: Finished running node test.dbt_exercise.unique_dim_products_sk_product.1658453ef4
[0m17:09:15.840231 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:09:15.853291 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:09:15.854147 [debug] [MainThread]: Connection 'test.dbt_exercise.unique_dim_products_sk_product.1658453ef4' was properly closed.
[0m17:09:15.855244 [debug] [MainThread]: Connection 'test.dbt_exercise.not_null_dim_products_sk_product.7ce7792ece' was properly closed.
[0m17:09:15.857016 [debug] [MainThread]: Connection 'test.dbt_exercise.unique_dim_products_product_id.ef7b2a9985' was properly closed.
[0m17:09:15.858565 [debug] [MainThread]: Connection 'test.dbt_exercise.not_null_dim_products_product_id.c8aba288d1' was properly closed.
[0m17:09:15.860492 [info ] [MainThread]: 
[0m17:09:15.862762 [info ] [MainThread]: Finished running 5 data tests in 0 hours 0 minutes and 11.45 seconds (11.45s).
[0m17:09:15.867661 [debug] [MainThread]: Command end result
[0m17:09:15.974096 [debug] [MainThread]: Wrote artifact WritableManifest to /home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/target/manifest.json
[0m17:09:15.992930 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/target/semantic_manifest.json
[0m17:09:16.002306 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/target/run_results.json
[0m17:09:16.004553 [info ] [MainThread]: 
[0m17:09:16.005711 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m17:09:16.006750 [info ] [MainThread]: 
[0m17:09:16.007913 [error] [MainThread]: [31mFailure in test accepted_values_dim_products_is_discontinued__True__False (models/marts/dim_products.yml)[0m
[0m17:09:16.008911 [error] [MainThread]:   Database Error in test accepted_values_dim_products_is_discontinued__True__False (models/marts/dim_products.yml)
  No matching signature for operator IN for argument types BOOL and {STRING} at [27:23]
  compiled code at target/run/dbt_exercise/models/marts/dim_products.yml/accepted_values_dim_products_is_discontinued__True__False.sql
[0m17:09:16.009903 [info ] [MainThread]: 
[0m17:09:16.010738 [info ] [MainThread]:   compiled code at target/compiled/dbt_exercise/models/marts/dim_products.yml/accepted_values_dim_products_is_discontinued__True__False.sql
[0m17:09:16.011511 [info ] [MainThread]: 
[0m17:09:16.012418 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=5
[0m17:09:16.013639 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- DuplicateYAMLKeysDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m17:09:16.021169 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": false, "command_wall_clock_time": 137.91946, "process_in_blocks": "122920", "process_kernel_time": 18.375454, "process_mem_max_rss": "370268", "process_out_blocks": "3936", "process_user_time": 14.662862}
[0m17:09:16.022223 [debug] [MainThread]: Command `dbt test` failed at 17:09:16.022022 after 137.92 seconds
[0m17:09:16.022897 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x741033cc5370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x740ff63d7a70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x740ff5b35bb0>]}
[0m17:09:16.023528 [debug] [MainThread]: Flushing usage events
[0m17:09:16.346364 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:14:10.746054 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72c88b85e6f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72c88b27b800>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72c88bd13fe0>]}


============================== 17:14:10.766182 | e786d543-6393-4d82-80b3-0ffcfd2947b1 ==============================
[0m17:14:10.766182 [info ] [MainThread]: Running with dbt=1.10.2
[0m17:14:10.767213 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/logs', 'debug': 'False', 'profiles_dir': '/home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'invocation_command': 'dbt clean', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:14:10.768998 [warn ] [MainThread]: [[33mWARNING[0m][DuplicateYAMLKeysDeprecation]: Deprecated functionality
Duplicate key 'version' in "<unicode string>", line 4, column 1 in file
`/home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/dbt_project.yml`
[0m17:14:10.769788 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'e786d543-6393-4d82-80b3-0ffcfd2947b1', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72c88ad31df0>]}
[0m17:14:11.623441 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e786d543-6393-4d82-80b3-0ffcfd2947b1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72c88ad178f0>]}
[0m17:14:12.161743 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- DuplicateYAMLKeysDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m17:14:12.167370 [debug] [MainThread]: Resource report: {"command_name": "clean", "command_success": true, "command_wall_clock_time": 1.5156213, "process_in_blocks": "10392", "process_kernel_time": 3.158627, "process_mem_max_rss": "100036", "process_out_blocks": "8", "process_user_time": 3.293531}
[0m17:14:12.168500 [debug] [MainThread]: Command `dbt clean` succeeded at 17:14:12.168270 after 1.52 seconds
[0m17:14:12.169197 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72c88b3792b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72c88ac02c30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x72c88d50a660>]}
[0m17:14:12.170129 [debug] [MainThread]: Flushing usage events
[0m17:14:12.515628 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:15:05.350740 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bdbca32f380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bdbca3c2f90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bdbc9ef49b0>]}


============================== 17:15:05.373355 | 1386e4b7-3345-4fc8-a307-770d8228f3f0 ==============================
[0m17:15:05.373355 [info ] [MainThread]: Running with dbt=1.10.2
[0m17:15:05.374598 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m17:16:10.060165 [warn ] [MainThread]: [[33mWARNING[0m][DuplicateYAMLKeysDeprecation]: Deprecated functionality
Duplicate key 'version' in "<unicode string>", line 4, column 1 in file
`/home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/dbt_project.yml`
[0m17:16:10.061053 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '1386e4b7-3345-4fc8-a307-770d8228f3f0', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bdb8c78dfd0>]}
[0m17:16:10.918088 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1386e4b7-3345-4fc8-a307-770d8228f3f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bdb8c3e3800>]}
[0m17:16:11.017670 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1386e4b7-3345-4fc8-a307-770d8228f3f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bdbca4a6240>]}
[0m17:16:11.022775 [info ] [MainThread]: Registered adapter: bigquery=1.9.2
[0m17:17:10.129120 [error] [MainThread]: Encountered an error:
Compilation Error
  dbt found 1 package(s) specified in packages.yml, but only 0 package(s) installed in dbt_packages. Run "dbt deps" to install package dependencies.
[0m17:17:10.130363 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- DuplicateYAMLKeysDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m17:17:10.136100 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 118.58079, "process_in_blocks": "122824", "process_kernel_time": 16.613789, "process_mem_max_rss": "353592", "process_out_blocks": "24", "process_user_time": 12.814646}
[0m17:17:10.138379 [debug] [MainThread]: Command `dbt run` failed at 17:17:10.137739 after 118.58 seconds
[0m17:17:10.139763 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bdbc9c22ed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bdb8c758bc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bdb8c41f560>]}
[0m17:17:10.141126 [debug] [MainThread]: Flushing usage events
[0m17:17:10.480300 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:18:02.405626 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7637de143530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7637ddfa4f80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7637ddfa6db0>]}


============================== 17:18:02.432429 | 9989ac0f-3f6c-48d7-ba21-f35e2c730b49 ==============================
[0m17:18:02.432429 [info ] [MainThread]: Running with dbt=1.10.2
[0m17:18:02.433492 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt deps', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m17:18:02.435239 [warn ] [MainThread]: [[33mWARNING[0m][DuplicateYAMLKeysDeprecation]: Deprecated functionality
Duplicate key 'version' in "<unicode string>", line 4, column 1 in file
`/home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/dbt_project.yml`
[0m17:18:02.436025 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '9989ac0f-3f6c-48d7-ba21-f35e2c730b49', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7637ddf4d3a0>]}
[0m17:18:03.654135 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9989ac0f-3f6c-48d7-ba21-f35e2c730b49', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7637dd839d60>]}
[0m17:18:04.644690 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-q6kwq7kj'
[0m17:18:04.645317 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m17:18:04.877113 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m17:18:04.878345 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m17:18:04.907688 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m17:18:04.913755 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m17:18:05.427742 [info ] [MainThread]: Installed from version 1.3.0
[0m17:18:05.429950 [info ] [MainThread]: Up to date!
[0m17:18:05.431500 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '9989ac0f-3f6c-48d7-ba21-f35e2c730b49', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7637ddc48410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7637dd7bcfe0>]}
[0m17:18:05.433717 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- DuplicateYAMLKeysDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m17:18:05.441805 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 3.1560955, "process_in_blocks": "8520", "process_kernel_time": 3.247095, "process_mem_max_rss": "100956", "process_out_blocks": "2304", "process_user_time": 3.602022}
[0m17:18:05.443267 [debug] [MainThread]: Command `dbt deps` succeeded at 17:18:05.442739 after 3.16 seconds
[0m17:18:05.444358 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7637de4118e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7637dd78aa80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7637ddfa4f80>]}
[0m17:18:05.445882 [debug] [MainThread]: Flushing usage events
[0m17:18:05.767287 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:18:43.185160 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7edda8d8d040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7edda8711b80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7edda7d5d5e0>]}


============================== 17:18:43.212489 | 959ddc46-28fb-44a5-95f4-e73306dd3a01 ==============================
[0m17:18:43.212489 [info ] [MainThread]: Running with dbt=1.10.2
[0m17:18:43.213640 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise', 'log_path': '/home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:19:46.437891 [warn ] [MainThread]: [[33mWARNING[0m][DuplicateYAMLKeysDeprecation]: Deprecated functionality
Duplicate key 'version' in "<unicode string>", line 4, column 1 in file
`/home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/dbt_project.yml`
[0m17:19:46.439070 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '959ddc46-28fb-44a5-95f4-e73306dd3a01', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7edd6a59fd70>]}
[0m17:19:47.327906 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '959ddc46-28fb-44a5-95f4-e73306dd3a01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7edd6a22c0e0>]}
[0m17:19:47.467253 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '959ddc46-28fb-44a5-95f4-e73306dd3a01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7edd6a9d3bc0>]}
[0m17:19:47.472908 [info ] [MainThread]: Registered adapter: bigquery=1.9.2
[0m17:20:55.539581 [debug] [MainThread]: checksum: 1adc40777973ef30f45f80b3b6d04d5013c1edd53d96363881b3b199e612468b, vars: {}, profile: , target: , version: 1.10.2
[0m17:20:55.556034 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m17:20:55.556927 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '959ddc46-28fb-44a5-95f4-e73306dd3a01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7edd6a36b500>]}
[0m17:21:05.433439 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '959ddc46-28fb-44a5-95f4-e73306dd3a01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7edd680eb620>]}
[0m17:21:05.674397 [debug] [MainThread]: Wrote artifact WritableManifest to /home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/target/manifest.json
[0m17:21:05.694844 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/target/semantic_manifest.json
[0m17:21:06.336198 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '959ddc46-28fb-44a5-95f4-e73306dd3a01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7edd3b723380>]}
[0m17:21:06.337242 [info ] [MainThread]: Found 19 models, 14 seeds, 59 data tests, 14 sources, 609 macros
[0m17:21:06.338187 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '959ddc46-28fb-44a5-95f4-e73306dd3a01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7edd3b73ebd0>]}
[0m17:21:06.343034 [info ] [MainThread]: 
[0m17:21:06.343946 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m17:21:06.344907 [info ] [MainThread]: 
[0m17:21:06.347182 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m17:21:06.357191 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_corded-sunlight-464012-e2'
[0m17:21:06.358868 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:21:06.360535 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_corded-sunlight-464012-e2'
[0m17:21:06.362688 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_corded-sunlight-464012-e2'
[0m17:21:06.363766 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:21:06.364674 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:21:07.651548 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_corded-sunlight-464012-e2, now list_corded-sunlight-464012-e2_dbt_dw_staging)
[0m17:21:07.653487 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:21:07.654867 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_corded-sunlight-464012-e2, now list_corded-sunlight-464012-e2_dbt_dw_marts)
[0m17:21:07.656520 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_corded-sunlight-464012-e2, now list_corded-sunlight-464012-e2_dbt_dw_intermediate)
[0m17:21:07.658420 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_corded-sunlight-464012-e2_dbt_dw_raw'
[0m17:21:07.659098 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:21:07.660197 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:21:07.661140 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:21:08.621610 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '959ddc46-28fb-44a5-95f4-e73306dd3a01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7edd3b7794f0>]}
[0m17:21:08.622477 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:21:08.634343 [debug] [Thread-1 (]: Began running node model.dbt_exercise.stg_categories_northwind
[0m17:21:08.635232 [debug] [Thread-2 (]: Began running node model.dbt_exercise.stg_customers_northwind
[0m17:21:08.636234 [info ] [Thread-1 (]: 1 of 19 START sql view model dbt_dw_staging.stg_categories_northwind ........... [RUN]
[0m17:21:08.637283 [debug] [Thread-3 (]: Began running node model.dbt_exercise.stg_employee_territories
[0m17:21:08.638125 [debug] [Thread-4 (]: Began running node model.dbt_exercise.stg_employees_northwind
[0m17:21:08.639004 [info ] [Thread-2 (]: 2 of 19 START sql view model dbt_dw_staging.stg_customers_northwind ............ [RUN]
[0m17:21:08.640338 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_corded-sunlight-464012-e2_dbt_dw_marts, now model.dbt_exercise.stg_categories_northwind)
[0m17:21:08.641366 [info ] [Thread-3 (]: 3 of 19 START sql view model dbt_dw_staging.stg_employee_territories ........... [RUN]
[0m17:21:08.642538 [info ] [Thread-4 (]: 4 of 19 START sql view model dbt_dw_staging.stg_employees_northwind ............ [RUN]
[0m17:21:08.643592 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_corded-sunlight-464012-e2_dbt_dw_intermediate, now model.dbt_exercise.stg_customers_northwind)
[0m17:21:08.644896 [debug] [Thread-1 (]: Began compiling node model.dbt_exercise.stg_categories_northwind
[0m17:21:08.646171 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_corded-sunlight-464012-e2_dbt_dw_staging, now model.dbt_exercise.stg_employee_territories)
[0m17:21:08.647427 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly list_corded-sunlight-464012-e2_dbt_dw_raw, now model.dbt_exercise.stg_employees_northwind)
[0m17:21:08.648629 [debug] [Thread-2 (]: Began compiling node model.dbt_exercise.stg_customers_northwind
[0m17:21:08.666543 [debug] [Thread-3 (]: Began compiling node model.dbt_exercise.stg_employee_territories
[0m17:21:08.671189 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_exercise.stg_categories_northwind"
[0m17:21:08.672734 [debug] [Thread-4 (]: Began compiling node model.dbt_exercise.stg_employees_northwind
[0m17:21:08.678344 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_exercise.stg_customers_northwind"
[0m17:21:08.682853 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_exercise.stg_employee_territories"
[0m17:21:08.690021 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_exercise.stg_employees_northwind"
[0m17:21:08.695893 [debug] [Thread-4 (]: Began executing node model.dbt_exercise.stg_employees_northwind
[0m17:21:08.715322 [debug] [Thread-3 (]: Began executing node model.dbt_exercise.stg_employee_territories
[0m17:21:08.728415 [debug] [Thread-2 (]: Began executing node model.dbt_exercise.stg_customers_northwind
[0m17:21:08.729319 [debug] [Thread-1 (]: Began executing node model.dbt_exercise.stg_categories_northwind
[0m17:21:08.850603 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_exercise.stg_categories_northwind"
[0m17:21:08.854835 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_exercise.stg_employees_northwind"
[0m17:21:08.855372 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_exercise.stg_customers_northwind"
[0m17:21:08.857846 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_exercise.stg_employee_territories"
[0m17:21:08.864124 [debug] [Thread-3 (]: On model.dbt_exercise.stg_employee_territories: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "model.dbt_exercise.stg_employee_territories"} */


  create or replace view `corded-sunlight-464012-e2`.`dbt_dw_staging`.`stg_employee_territories`
  OPTIONS()
  as with raw_employee_territories as (
    select *
    from `corded-sunlight-464012-e2`.`dbt_dw_raw`.`employee_territories`
)

, stg_employee_territories as (
    select
        cast(employee_id as string) as employee_id
        , cast(territory_id as string) as territory_id
    from raw_employee_territories
)

select *
from stg_employee_territories;


[0m17:21:08.865356 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m17:21:08.866677 [debug] [Thread-1 (]: On model.dbt_exercise.stg_categories_northwind: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "model.dbt_exercise.stg_categories_northwind"} */


  create or replace view `corded-sunlight-464012-e2`.`dbt_dw_staging`.`stg_categories_northwind`
  OPTIONS()
  as with raw_categories as (
    select *
    from `corded-sunlight-464012-e2`.`dbt_dw_raw`.`categories`
)

/* Ao construir a staging não vamos trazer a coluna picture, pois ela não traz informação relevante */
, stg_categories_northwind as (
    select
        cast(category_id as string) as category_id
        , cast(category_name as string) as category_name
        , cast(description as string) as description
    from raw_categories
)

select *
from stg_categories_northwind;


[0m17:21:08.867524 [debug] [Thread-2 (]: On model.dbt_exercise.stg_customers_northwind: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "model.dbt_exercise.stg_customers_northwind"} */


  create or replace view `corded-sunlight-464012-e2`.`dbt_dw_staging`.`stg_customers_northwind`
  OPTIONS()
  as with raw_customers as (
    select *
    from `corded-sunlight-464012-e2`.`dbt_dw_raw`.`customers`
)

, stg_customers_northwind as (
    select
        cast(customer_id as string) as customer_id
        , cast(company_name as string) as company_name
        , cast(contact_name as string) as contact_name
        , cast(contact_title as string) as contact_title
        , cast(address as string) as address
        , cast(city as string) as city
        , cast(region as string) as region
        , cast(postal_code as string) as postal_code
        , cast(country as string) as country
        , cast(phone as string) as phone
        , cast(fax as string) as fax
    from raw_customers
)

select *
from stg_customers_northwind;


[0m17:21:08.868568 [debug] [Thread-4 (]: On model.dbt_exercise.stg_employees_northwind: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "model.dbt_exercise.stg_employees_northwind"} */


  create or replace view `corded-sunlight-464012-e2`.`dbt_dw_staging`.`stg_employees_northwind`
  OPTIONS()
  as with raw_employees as (
    select *
    from `corded-sunlight-464012-e2`.`dbt_dw_raw`.`employees`
)

/* Os campos photo, notes e reports_to e photo_path não são carregadas na staging */

, stg_employees_northwind as (
    select
        cast(employee_id as string) as employee_id
        , cast(first_name as string) as first_name
        , cast(last_name as string) as last_name
        , cast(title as string) as title
        , cast(title_of_courtesy as string) as title_of_courtesy
        , cast(birth_date as date) as birth_date
        , cast(hire_date as date) as hire_date
        , cast(address as string) as address
        , cast(city as string) as city
        , cast(region as string) as region
        , cast(postal_code as string) as postal_code
        , cast(country as string) as country
        , cast(home_phone as string) as home_phone
        , cast(extension as string) as extension
    from raw_employees
)

select *
from stg_employees_northwind;


[0m17:21:08.869699 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:21:08.870894 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:21:08.872167 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m17:21:10.035407 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:2d971b12-2cb0-466e-8587-6f0599d4a596&page=queryresults
[0m17:21:10.041361 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:b6c887e4-47f6-4d72-9c52-7bad299621c2&page=queryresults
[0m17:21:10.045158 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:2b093e41-a2e5-438b-98bf-54e33c2eda7d&page=queryresults
[0m17:21:10.048188 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:eb0b16fa-b2a2-4bd2-a0d7-ef1f27eadc40&page=queryresults
[0m17:21:17.985153 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '959ddc46-28fb-44a5-95f4-e73306dd3a01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7edd3b89a4e0>]}
[0m17:21:17.986107 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '959ddc46-28fb-44a5-95f4-e73306dd3a01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7edd69ce0ad0>]}
[0m17:21:17.986903 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '959ddc46-28fb-44a5-95f4-e73306dd3a01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7edd383ce630>]}
[0m17:21:17.989082 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '959ddc46-28fb-44a5-95f4-e73306dd3a01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7edd3b6e1460>]}
[0m17:21:17.988132 [info ] [Thread-4 (]: 4 of 19 OK created sql view model dbt_dw_staging.stg_employees_northwind ....... [[32mCREATE VIEW (0 processed)[0m in 9.32s]
[0m17:21:17.990993 [info ] [Thread-2 (]: 2 of 19 OK created sql view model dbt_dw_staging.stg_customers_northwind ....... [[32mCREATE VIEW (0 processed)[0m in 9.33s]
[0m17:21:17.993150 [info ] [Thread-1 (]: 1 of 19 OK created sql view model dbt_dw_staging.stg_categories_northwind ...... [[32mCREATE VIEW (0 processed)[0m in 9.33s]
[0m17:21:17.994833 [info ] [Thread-3 (]: 3 of 19 OK created sql view model dbt_dw_staging.stg_employee_territories ...... [[32mCREATE VIEW (0 processed)[0m in 9.33s]
[0m17:21:17.996192 [debug] [Thread-4 (]: Finished running node model.dbt_exercise.stg_employees_northwind
[0m17:21:17.997651 [debug] [Thread-2 (]: Finished running node model.dbt_exercise.stg_customers_northwind
[0m17:21:17.998810 [debug] [Thread-1 (]: Finished running node model.dbt_exercise.stg_categories_northwind
[0m17:21:17.999951 [debug] [Thread-3 (]: Finished running node model.dbt_exercise.stg_employee_territories
[0m17:21:18.000925 [debug] [Thread-4 (]: Began running node model.dbt_exercise.stg_order_details_northwind
[0m17:21:18.002268 [debug] [Thread-2 (]: Began running node model.dbt_exercise.stg_orders_northwind
[0m17:21:18.003587 [debug] [Thread-1 (]: Began running node model.dbt_exercise.stg_products_northwind
[0m17:21:18.005374 [debug] [Thread-3 (]: Began running node model.dbt_exercise.stg_shippers_northwind
[0m17:21:18.006879 [info ] [Thread-4 (]: 5 of 19 START sql view model dbt_dw_staging.stg_order_details_northwind ........ [RUN]
[0m17:21:18.008657 [info ] [Thread-2 (]: 6 of 19 START sql view model dbt_dw_staging.stg_orders_northwind ............... [RUN]
[0m17:21:18.010524 [info ] [Thread-1 (]: 7 of 19 START sql view model dbt_dw_staging.stg_products_northwind ............. [RUN]
[0m17:21:18.012243 [info ] [Thread-3 (]: 8 of 19 START sql view model dbt_dw_staging.stg_shippers_northwind ............. [RUN]
[0m17:21:18.014422 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.dbt_exercise.stg_employees_northwind, now model.dbt_exercise.stg_order_details_northwind)
[0m17:21:18.015811 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_exercise.stg_customers_northwind, now model.dbt_exercise.stg_orders_northwind)
[0m17:21:18.017268 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_exercise.stg_categories_northwind, now model.dbt_exercise.stg_products_northwind)
[0m17:21:18.018716 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_exercise.stg_employee_territories, now model.dbt_exercise.stg_shippers_northwind)
[0m17:21:18.020123 [debug] [Thread-4 (]: Began compiling node model.dbt_exercise.stg_order_details_northwind
[0m17:21:18.021330 [debug] [Thread-2 (]: Began compiling node model.dbt_exercise.stg_orders_northwind
[0m17:21:18.022447 [debug] [Thread-1 (]: Began compiling node model.dbt_exercise.stg_products_northwind
[0m17:21:18.023573 [debug] [Thread-3 (]: Began compiling node model.dbt_exercise.stg_shippers_northwind
[0m17:21:18.030766 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_exercise.stg_order_details_northwind"
[0m17:21:18.040477 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_exercise.stg_orders_northwind"
[0m17:21:18.047939 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_exercise.stg_products_northwind"
[0m17:21:18.052910 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_exercise.stg_shippers_northwind"
[0m17:21:18.057328 [debug] [Thread-4 (]: Began executing node model.dbt_exercise.stg_order_details_northwind
[0m17:21:18.060027 [debug] [Thread-2 (]: Began executing node model.dbt_exercise.stg_orders_northwind
[0m17:21:18.061294 [debug] [Thread-1 (]: Began executing node model.dbt_exercise.stg_products_northwind
[0m17:21:18.069019 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_exercise.stg_order_details_northwind"
[0m17:21:18.076362 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_exercise.stg_orders_northwind"
[0m17:21:18.077292 [debug] [Thread-3 (]: Began executing node model.dbt_exercise.stg_shippers_northwind
[0m17:21:18.081921 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_exercise.stg_products_northwind"
[0m17:21:18.084147 [debug] [Thread-4 (]: On model.dbt_exercise.stg_order_details_northwind: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "model.dbt_exercise.stg_order_details_northwind"} */


  create or replace view `corded-sunlight-464012-e2`.`dbt_dw_staging`.`stg_order_details_northwind`
  OPTIONS()
  as with raw_order_details as (
    select *
    from `corded-sunlight-464012-e2`.`dbt_dw_raw`.`order_details`
)

, stg_order_details_northwind as (
    select
        cast(order_id as string) as order_id
        , cast(product_id as string) as product_id
        , cast(unit_price as numeric) as unit_price
        , cast(quantity as integer) as quantity
        , cast(discount as numeric) as discount
    from raw_order_details
)

select *
from stg_order_details_northwind;


[0m17:21:18.094452 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_exercise.stg_shippers_northwind"
[0m17:21:18.095785 [debug] [Thread-2 (]: On model.dbt_exercise.stg_orders_northwind: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "model.dbt_exercise.stg_orders_northwind"} */


  create or replace view `corded-sunlight-464012-e2`.`dbt_dw_staging`.`stg_orders_northwind`
  OPTIONS()
  as with raw_orders as (
    select *
    from `corded-sunlight-464012-e2`.`dbt_dw_raw`.`orders`
)

, stg_orders_northwind as (
    select
        cast(order_id as string) as order_id
        , cast(customer_id as string) as customer_id
        , cast(employee_id as string) as employee_id
        , cast(order_date as timestamp) as order_date
        , cast(required_date as timestamp) as required_date
        , cast(shipped_date as timestamp) as shipped_date
        , cast(ship_via as string) as ship_via
        , cast(freight as numeric) as freight
        , cast(ship_name as string) as ship_name
        , cast(ship_address as string) as ship_address
        , cast(ship_city as string) as ship_city
        , cast(ship_region as string) as ship_region
        , cast(ship_postal_code as string) as ship_postal_code
        , cast(ship_country as string) as ship_country
    from raw_orders
)

select *
from stg_orders_northwind;


[0m17:21:18.097339 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m17:21:18.098736 [debug] [Thread-1 (]: On model.dbt_exercise.stg_products_northwind: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "model.dbt_exercise.stg_products_northwind"} */


  create or replace view `corded-sunlight-464012-e2`.`dbt_dw_staging`.`stg_products_northwind`
  OPTIONS()
  as with raw_products as (
    select *
    from `corded-sunlight-464012-e2`.`dbt_dw_raw`.`products`
)

, stg_products_northwind as (
    select
        cast(product_id as string) as product_id
        , cast(product_name as string) as product_name
        , cast(supplier_id as string) as supplier_id
        , cast(category_id as string) as category_id
        , cast(quantity_per_unit as string) as quantity_per_unit
        , cast(unit_price as numeric) as unit_price
        , cast(units_in_stock as numeric) as units_in_stock
        , cast(units_on_order as numeric) as units_on_order
        , cast(reorder_level as numeric) as reorder_level
        , cast(discontinued as integer) as discontinued
    from raw_products
)

select *
from stg_products_northwind;


[0m17:21:18.099816 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:21:18.100808 [debug] [Thread-3 (]: On model.dbt_exercise.stg_shippers_northwind: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "model.dbt_exercise.stg_shippers_northwind"} */


  create or replace view `corded-sunlight-464012-e2`.`dbt_dw_staging`.`stg_shippers_northwind`
  OPTIONS()
  as with raw_shippers as (
    select *
    from `corded-sunlight-464012-e2`.`dbt_dw_raw`.`shippers`
)

, stg_shippers_northwind as (
    select
        cast(shipper_id as string) as shipper_id
        , cast(company_name as string) as company_name
        , cast(phone as string) as phone
    from raw_shippers
)

select *
from stg_shippers_northwind;


[0m17:21:18.102138 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:21:18.104337 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m17:21:19.147411 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:53008289-06b4-4a7e-8e9a-54590e796674&page=queryresults
[0m17:21:19.207159 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:1e574956-7e42-434a-ac75-573d242569e8&page=queryresults
[0m17:21:19.219657 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:b3d1a9a6-bc64-402a-b7f7-e2c0b1bef8a2&page=queryresults
[0m17:21:19.229683 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:0e4e04d9-770f-40f2-b302-097dc47ded9e&page=queryresults
[0m17:21:19.751718 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '959ddc46-28fb-44a5-95f4-e73306dd3a01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7edd382afec0>]}
[0m17:21:19.753570 [info ] [Thread-1 (]: 7 of 19 OK created sql view model dbt_dw_staging.stg_products_northwind ........ [[32mCREATE VIEW (0 processed)[0m in 1.73s]
[0m17:21:19.756615 [debug] [Thread-1 (]: Finished running node model.dbt_exercise.stg_products_northwind
[0m17:21:19.761699 [debug] [Thread-1 (]: Began running node model.dbt_exercise.stg_suppliers_northwind
[0m17:21:19.765683 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '959ddc46-28fb-44a5-95f4-e73306dd3a01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7edd3827ae10>]}
[0m17:21:19.763738 [info ] [Thread-1 (]: 9 of 19 START sql view model dbt_dw_staging.stg_suppliers_northwind ............ [RUN]
[0m17:21:19.771703 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_exercise.stg_products_northwind, now model.dbt_exercise.stg_suppliers_northwind)
[0m17:21:19.768282 [info ] [Thread-4 (]: 5 of 19 OK created sql view model dbt_dw_staging.stg_order_details_northwind ... [[32mCREATE VIEW (0 processed)[0m in 1.75s]
[0m17:21:19.777954 [debug] [Thread-1 (]: Began compiling node model.dbt_exercise.stg_suppliers_northwind
[0m17:21:19.779375 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '959ddc46-28fb-44a5-95f4-e73306dd3a01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7edd3827cdd0>]}
[0m17:21:19.782491 [debug] [Thread-4 (]: Finished running node model.dbt_exercise.stg_order_details_northwind
[0m17:21:19.794394 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_exercise.stg_suppliers_northwind"
[0m17:21:19.796273 [info ] [Thread-3 (]: 8 of 19 OK created sql view model dbt_dw_staging.stg_shippers_northwind ........ [[32mCREATE VIEW (0 processed)[0m in 1.76s]
[0m17:21:19.798961 [debug] [Thread-4 (]: Began running node model.dbt_exercise.int_customers_northwind
[0m17:21:19.802522 [debug] [Thread-3 (]: Finished running node model.dbt_exercise.stg_shippers_northwind
[0m17:21:19.804199 [debug] [Thread-1 (]: Began executing node model.dbt_exercise.stg_suppliers_northwind
[0m17:21:19.805549 [info ] [Thread-4 (]: 10 of 19 START sql view model dbt_dw_intermediate.int_customers_northwind ...... [RUN]
[0m17:21:19.814148 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_exercise.stg_suppliers_northwind"
[0m17:21:19.816598 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.dbt_exercise.stg_order_details_northwind, now model.dbt_exercise.int_customers_northwind)
[0m17:21:19.819056 [debug] [Thread-4 (]: Began compiling node model.dbt_exercise.int_customers_northwind
[0m17:21:19.827138 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_exercise.int_customers_northwind"
[0m17:21:19.828695 [debug] [Thread-1 (]: On model.dbt_exercise.stg_suppliers_northwind: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "model.dbt_exercise.stg_suppliers_northwind"} */


  create or replace view `corded-sunlight-464012-e2`.`dbt_dw_staging`.`stg_suppliers_northwind`
  OPTIONS()
  as with raw_suppliers as (
    select *
    from `corded-sunlight-464012-e2`.`dbt_dw_raw`.`suppliers`
)

, stg_suppliers_northwind as (
    select
        cast(supplier_id as string) as supplier_id
        , cast(company_name as string) as company_name
        , cast(contact_name as string) as contact_name
        , cast(contact_title as string) as contact_title
        , cast(address as string) as address
        , cast(city as string) as city
        , cast(region as string) as region
        , cast(postal_code as string) as postal_code
        , cast(country as string) as country
        , cast(phone as string) as phone
        , cast(fax as string) as fax
        , cast(homepage as string) as home_page
    from raw_suppliers
)

select *
from stg_suppliers_northwind;


[0m17:21:19.831308 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:21:19.834049 [debug] [Thread-4 (]: Began executing node model.dbt_exercise.int_customers_northwind
[0m17:21:19.841943 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_exercise.int_customers_northwind"
[0m17:21:19.848050 [debug] [Thread-4 (]: On model.dbt_exercise.int_customers_northwind: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "model.dbt_exercise.int_customers_northwind"} */


  create or replace view `corded-sunlight-464012-e2`.`dbt_dw_intermediate`.`int_customers_northwind`
  OPTIONS()
  as with stg_customers_northwind as (
    select *
    from `corded-sunlight-464012-e2`.`dbt_dw_staging`.`stg_customers_northwind`
)

, int_customers_northwind as (
    select 
        customer_id
        , company_name
        , contact_name
        , contact_title
        , address
        , city
        , region
        , country
        , case 
            when country in ('USA', 'Canada', 'Mexico') then 'North America'
            when country in ('UK', 'France', 'Germany', 'Austria', 'Belgium', 'Denmark', 'Ireland'
            , 'Finland', 'Italy', 'Norway', 'Poland', 'Portugal', 'Spain', 'Sweden', 'Switzerland') then 'Europe'
            when country in ('Brazil', 'Argentina', 'Venezuela') then 'South America'
            else 'Other'
        end as continent
    from stg_customers_northwind
)

select *
from int_customers_northwind;


[0m17:21:19.889608 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m17:21:19.942615 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '959ddc46-28fb-44a5-95f4-e73306dd3a01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7edd3827c110>]}
[0m17:21:19.944050 [info ] [Thread-2 (]: 6 of 19 OK created sql view model dbt_dw_staging.stg_orders_northwind .......... [[32mCREATE VIEW (0 processed)[0m in 1.93s]
[0m17:21:19.945911 [debug] [Thread-2 (]: Finished running node model.dbt_exercise.stg_orders_northwind
[0m17:21:19.948013 [debug] [Thread-3 (]: Began running node model.dbt_exercise.int_employees_northwind
[0m17:21:19.949132 [debug] [Thread-2 (]: Began running node model.dbt_exercise.int_orders_northwind
[0m17:21:19.950764 [info ] [Thread-3 (]: 11 of 19 START sql view model dbt_dw_intermediate.int_employees_northwind ...... [RUN]
[0m17:21:19.952544 [info ] [Thread-2 (]: 12 of 19 START sql view model dbt_dw_intermediate.int_orders_northwind ......... [RUN]
[0m17:21:19.954479 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_exercise.stg_shippers_northwind, now model.dbt_exercise.int_employees_northwind)
[0m17:21:19.956030 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_exercise.stg_orders_northwind, now model.dbt_exercise.int_orders_northwind)
[0m17:21:19.957309 [debug] [Thread-3 (]: Began compiling node model.dbt_exercise.int_employees_northwind
[0m17:21:19.958473 [debug] [Thread-2 (]: Began compiling node model.dbt_exercise.int_orders_northwind
[0m17:21:19.966439 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_exercise.int_employees_northwind"
[0m17:21:19.974847 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_exercise.int_orders_northwind"
[0m17:21:19.977855 [debug] [Thread-3 (]: Began executing node model.dbt_exercise.int_employees_northwind
[0m17:21:19.983569 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_exercise.int_employees_northwind"
[0m17:21:19.984571 [debug] [Thread-2 (]: Began executing node model.dbt_exercise.int_orders_northwind
[0m17:21:19.994716 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_exercise.int_orders_northwind"
[0m17:21:19.997354 [debug] [Thread-3 (]: On model.dbt_exercise.int_employees_northwind: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "model.dbt_exercise.int_employees_northwind"} */


  create or replace view `corded-sunlight-464012-e2`.`dbt_dw_intermediate`.`int_employees_northwind`
  OPTIONS()
  as with raw_employees as (
    select *
    from `corded-sunlight-464012-e2`.`dbt_dw_staging`.`stg_employees_northwind`
)

, max_fact_date as (
    select 
        cast(
            case 
                when max(order_date) >= max(shipped_date) then max(order_date)
                else max(shipped_date)
            end 
        as date) as max_date
    from `corded-sunlight-464012-e2`.`dbt_dw_staging`.`stg_orders_northwind`
)

, int_employees_northwind as (
    select
        employee_id
        , concat(first_name, ' ', last_name) as employee_name
        , title
        , birth_date
        , date_diff((select * from max_fact_date), birth_date, year) as age
        , hire_date
        , date_diff((select * from max_fact_date), hire_date, year) as years_hired
        , address
        , city
        , region
        , country
    from raw_employees
)

select *
from int_employees_northwind;


[0m17:21:19.999118 [debug] [Thread-2 (]: On model.dbt_exercise.int_orders_northwind: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "model.dbt_exercise.int_orders_northwind"} */


  create or replace view `corded-sunlight-464012-e2`.`dbt_dw_intermediate`.`int_orders_northwind`
  OPTIONS()
  as with stg_orders_northwind as (
    select *
    from `corded-sunlight-464012-e2`.`dbt_dw_staging`.`stg_orders_northwind`
)

, stg_order_details_northwind as (
    select *
    from `corded-sunlight-464012-e2`.`dbt_dw_staging`.`stg_order_details_northwind`
)

, stg_shippers_northwind as (
    select *
    from `corded-sunlight-464012-e2`.`dbt_dw_staging`.`stg_shippers_northwind`
)

, transformed_table as (    
    select
        stg_orders_northwind.order_id 
        , stg_orders_northwind.customer_id
        , stg_orders_northwind.employee_id
        , stg_orders_northwind.order_date
        , stg_orders_northwind.required_date
        , stg_orders_northwind.shipped_date
        , date_diff(stg_orders_northwind.shipped_date, stg_orders_northwind.order_date, day) as days_to_ship
        , concat(
            coalesce(stg_orders_northwind.ship_via, '')
            , '-'
            , coalesce(stg_shippers_northwind.company_name, '')
            , '-'
            , coalesce(stg_orders_northwind.ship_address, '')
        ) as ship_id
        , stg_orders_northwind.ship_via      
        , stg_shippers_northwind.company_name as shipper_name
        , stg_order_details_northwind.product_id
        , sum(stg_order_details_northwind.unit_price * stg_order_details_northwind.quantity * (1 - stg_order_details_northwind.discount)) as amount
        /* O frete na stg_orders_northwind corresponde ao valor total do pedido, no entanto, como o grão da tabela é o produto no pedido
        , o valor do frete é racionado, sendo o total a soma do valor racionado por order_id */
        , (stg_orders_northwind.freight) / count(stg_order_details_northwind.product_id) over (partition by stg_orders_northwind.order_id) as rationed_shipping        
        , stg_orders_northwind.ship_name
        , stg_orders_northwind.ship_address
        , stg_orders_northwind.ship_city
        , stg_orders_northwind.ship_region
        , stg_orders_northwind.ship_country
        , case
            when stg_orders_northwind.ship_country in ('USA', 'Canada', 'Mexico') then 'North America'
            when stg_orders_northwind.ship_country in ('UK', 'France', 'Germany', 'Austria', 'Belgium', 
            'Denmark', 'Ireland', 'Finland', 'Italy', 'Norway', 'Poland', 'Portugal', 'Spain', 'Sweden', 'Switzerland') then 'Europe'
            when stg_orders_northwind.ship_country in ('Brazil', 'Argentina', 'Venezuela') then 'South America'
            else 'Other'
        end as ship_continent
    from stg_orders_northwind
    left join stg_order_details_northwind
        on stg_orders_northwind.order_id = stg_order_details_northwind.order_id
    left join stg_shippers_northwind
        on stg_orders_northwind.ship_via = stg_shippers_northwind.shipper_id
    group by 
        stg_orders_northwind.order_id
        , stg_orders_northwind.customer_id
        , stg_orders_northwind.employee_id
        , stg_orders_northwind.order_date
        , stg_orders_northwind.required_date
        , stg_orders_northwind.shipped_date
        , stg_orders_northwind.ship_via
        , stg_shippers_northwind.company_name
        , stg_order_details_northwind.product_id
        , stg_orders_northwind.freight
        , stg_orders_northwind.ship_name
        , stg_orders_northwind.ship_address
        , stg_orders_northwind.ship_city
        , stg_orders_northwind.ship_region
        , stg_orders_northwind.ship_country
)

, int_orders_northwind as (
    select
        transformed_table.order_id
        , transformed_table.customer_id
        , transformed_table.employee_id
        , transformed_table.order_date
        , transformed_table.required_date
        , transformed_table.shipped_date
        , transformed_table.days_to_ship
        , transformed_table.ship_id
        , transformed_table.ship_via
        , transformed_table.shipper_name
        , transformed_table.product_id
        , transformed_table.amount
        , round(transformed_table.rationed_shipping, 2) as rationed_shipping
        , transformed_table.ship_name
        , transformed_table.ship_address
        , transformed_table.ship_city
        , transformed_table.ship_region
        , transformed_table.ship_country
        , transformed_table.ship_continent
        , case 
            when transformed_table.days_to_ship is null then False
            else True
          end as is_shipped
    from transformed_table
)

select *
from int_orders_northwind;


[0m17:21:20.000170 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m17:21:20.001571 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:21:21.006601 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:d6ef4c32-e461-4a88-ad86-4a881609ede7&page=queryresults
[0m17:21:21.010495 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:2fce157a-9cb8-4a79-a1f1-10fa3ede75f8&page=queryresults
[0m17:21:21.261260 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:77eb28fb-fa0b-4e9c-873f-bf921b4a6065&page=queryresults
[0m17:21:21.335014 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:1c551f36-5914-4b02-90a0-edb1e6b8bf36&page=queryresults
[0m17:21:21.554434 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '959ddc46-28fb-44a5-95f4-e73306dd3a01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7edd38266570>]}
[0m17:21:21.555715 [info ] [Thread-1 (]: 9 of 19 OK created sql view model dbt_dw_staging.stg_suppliers_northwind ....... [[32mCREATE VIEW (0 processed)[0m in 1.78s]
[0m17:21:21.556859 [debug] [Thread-1 (]: Finished running node model.dbt_exercise.stg_suppliers_northwind
[0m17:21:21.557659 [debug] [Thread-1 (]: Began running node model.dbt_exercise.int_shippers_northwind
[0m17:21:21.558648 [info ] [Thread-1 (]: 13 of 19 START sql view model dbt_dw_intermediate.int_shippers_northwind ....... [RUN]
[0m17:21:21.559943 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_exercise.stg_suppliers_northwind, now model.dbt_exercise.int_shippers_northwind)
[0m17:21:21.560705 [debug] [Thread-1 (]: Began compiling node model.dbt_exercise.int_shippers_northwind
[0m17:21:21.568458 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_exercise.int_shippers_northwind"
[0m17:21:21.570177 [debug] [Thread-1 (]: Began executing node model.dbt_exercise.int_shippers_northwind
[0m17:21:21.578111 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_exercise.int_shippers_northwind"
[0m17:21:21.580187 [debug] [Thread-1 (]: On model.dbt_exercise.int_shippers_northwind: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "model.dbt_exercise.int_shippers_northwind"} */


  create or replace view `corded-sunlight-464012-e2`.`dbt_dw_intermediate`.`int_shippers_northwind`
  OPTIONS()
  as with stg_shippers_northwind as (
    select *
    from `corded-sunlight-464012-e2`.`dbt_dw_staging`.`stg_shippers_northwind`
)

, stg_orders_northwind as (
    select *
    from `corded-sunlight-464012-e2`.`dbt_dw_staging`.`stg_orders_northwind`
)

, transformed_table as (
    select
        concat(
            coalesce(stg_shippers_northwind.shipper_id, '')
            , '-'
            , coalesce(stg_shippers_northwind.company_name, '')
            , '-'
            , coalesce(stg_orders_northwind.ship_address, '')
        ) as ship_id
        , stg_shippers_northwind.shipper_id
        , stg_shippers_northwind.company_name
        , stg_orders_northwind.ship_address
        , stg_orders_northwind.ship_city
        , stg_orders_northwind.ship_region
        , stg_orders_northwind.ship_country
    from stg_shippers_northwind
    left join stg_orders_northwind
        on stg_shippers_northwind.shipper_id = stg_orders_northwind.ship_via
)

/* Aqui é feita a deduplicação da transformed_table */
, dedup_table as (
    select distinct *
    from transformed_table
)

, int_shippers_northwind as (
    select 
        *
        , case
            when dedup_table.ship_country in ('USA', 'Canada', 'Mexico') then 'North America'
            when dedup_table.ship_country in ('UK', 'France', 'Germany', 'Austria', 'Belgium', 
            'Denmark', 'Ireland', 'Finland', 'Italy', 'Norway', 'Poland', 'Portugal', 'Spain', 'Sweden', 'Switzerland') then 'Europe'
            when dedup_table.ship_country in ('Brazil', 'Argentina', 'Venezuela') then 'South America'
            else 'Other'
        end as ship_continent
    from dedup_table
)

select *
from int_shippers_northwind;


[0m17:21:21.581845 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:21:21.594542 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '959ddc46-28fb-44a5-95f4-e73306dd3a01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7edd38266f60>]}
[0m17:21:21.598896 [info ] [Thread-4 (]: 10 of 19 OK created sql view model dbt_dw_intermediate.int_customers_northwind . [[32mCREATE VIEW (0 processed)[0m in 1.78s]
[0m17:21:21.646533 [debug] [Thread-4 (]: Finished running node model.dbt_exercise.int_customers_northwind
[0m17:21:21.647989 [debug] [Thread-4 (]: Began running node model.dbt_exercise.int_products_northwind
[0m17:21:21.650766 [info ] [Thread-4 (]: 14 of 19 START sql view model dbt_dw_intermediate.int_products_northwind ....... [RUN]
[0m17:21:21.652576 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.dbt_exercise.int_customers_northwind, now model.dbt_exercise.int_products_northwind)
[0m17:21:21.653992 [debug] [Thread-4 (]: Began compiling node model.dbt_exercise.int_products_northwind
[0m17:21:21.664156 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_exercise.int_products_northwind"
[0m17:21:21.666832 [debug] [Thread-4 (]: Began executing node model.dbt_exercise.int_products_northwind
[0m17:21:21.673745 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_exercise.int_products_northwind"
[0m17:21:21.676363 [debug] [Thread-4 (]: On model.dbt_exercise.int_products_northwind: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "model.dbt_exercise.int_products_northwind"} */


  create or replace view `corded-sunlight-464012-e2`.`dbt_dw_intermediate`.`int_products_northwind`
  OPTIONS()
  as with stg_products_northwind as (
    select *
    from `corded-sunlight-464012-e2`.`dbt_dw_staging`.`stg_products_northwind`
)

, stg_categories_northwind as (
    select *
    from `corded-sunlight-464012-e2`.`dbt_dw_staging`.`stg_categories_northwind`
)

, stg_suppliers_northwind as (
    select *
    from `corded-sunlight-464012-e2`.`dbt_dw_staging`.`stg_suppliers_northwind`
)

, int_products_northwind as (
    select
        stg_products_northwind.product_id
        , stg_products_northwind.product_name
        , stg_products_northwind.quantity_per_unit
        , stg_categories_northwind.category_name
        , stg_suppliers_northwind.company_name as supplier_name
        , stg_suppliers_northwind.city as supplier_city
        , stg_suppliers_northwind.region as supplier_region
        , stg_suppliers_northwind.country as supplier_country
        , case
            when stg_suppliers_northwind.country in ('USA', 'Canada') then 'North America'
            when stg_suppliers_northwind.country in ('Brazil') then 'South America'
            when stg_suppliers_northwind.country in ('UK', 'Germany', 'Netherlands', 'Spain', 'France', 'Norway', 'Italy', 'Denmark', 'Sweden', 'Finland') then 'Europe'
            when stg_suppliers_northwind.country in ('Singapore', 'Japan') then 'Asia'
            when stg_suppliers_northwind.country in ('Australia') then 'Oceania'
            else 'Other'
          end as supplier_continent
        , case 
            when stg_products_northwind.discontinued = 1 then True
            else False
        end as is_discontinued
    from stg_products_northwind
    left join stg_categories_northwind
        on stg_products_northwind.category_id = stg_categories_northwind.category_id
    left join stg_suppliers_northwind
        on stg_products_northwind.supplier_id = stg_suppliers_northwind.supplier_id
)

select *
from int_products_northwind;


[0m17:21:21.677646 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m17:21:21.788717 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '959ddc46-28fb-44a5-95f4-e73306dd3a01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7edd382bbad0>]}
[0m17:21:21.789906 [info ] [Thread-2 (]: 12 of 19 OK created sql view model dbt_dw_intermediate.int_orders_northwind .... [[32mCREATE VIEW (0 processed)[0m in 1.83s]
[0m17:21:21.790935 [debug] [Thread-2 (]: Finished running node model.dbt_exercise.int_orders_northwind
[0m17:21:21.791688 [debug] [Thread-2 (]: Began running node model.dbt_exercise.dim_customers
[0m17:21:21.792707 [info ] [Thread-2 (]: 15 of 19 START sql table model dbt_dw_marts.dim_customers ...................... [RUN]
[0m17:21:21.793593 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_exercise.int_orders_northwind, now model.dbt_exercise.dim_customers)
[0m17:21:21.794261 [debug] [Thread-2 (]: Began compiling node model.dbt_exercise.dim_customers
[0m17:21:21.801224 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_exercise.dim_customers"
[0m17:21:21.804271 [debug] [Thread-2 (]: Began executing node model.dbt_exercise.dim_customers
[0m17:21:21.833926 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:21:21.914498 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '959ddc46-28fb-44a5-95f4-e73306dd3a01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7edd38336540>]}
[0m17:21:21.915837 [info ] [Thread-3 (]: 11 of 19 OK created sql view model dbt_dw_intermediate.int_employees_northwind . [[32mCREATE VIEW (0 processed)[0m in 1.96s]
[0m17:21:21.917063 [debug] [Thread-3 (]: Finished running node model.dbt_exercise.int_employees_northwind
[0m17:21:21.918528 [debug] [Thread-3 (]: Began running node model.dbt_exercise.dim_employees
[0m17:21:21.919619 [info ] [Thread-3 (]: 16 of 19 START sql table model dbt_dw_marts.dim_employees ...................... [RUN]
[0m17:21:21.920710 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_exercise.int_employees_northwind, now model.dbt_exercise.dim_employees)
[0m17:21:21.921450 [debug] [Thread-3 (]: Began compiling node model.dbt_exercise.dim_employees
[0m17:21:21.931625 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_exercise.dim_employees"
[0m17:21:21.933178 [debug] [Thread-3 (]: Began executing node model.dbt_exercise.dim_employees
[0m17:21:21.940056 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m17:21:22.689886 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_exercise.dim_customers"
[0m17:21:22.692399 [debug] [Thread-2 (]: On model.dbt_exercise.dim_customers: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "model.dbt_exercise.dim_customers"} */

  
    

    create or replace table `corded-sunlight-464012-e2`.`dbt_dw_marts`.`dim_customers`
      
    
    

    OPTIONS()
    as (
      with int_customers_northwind as (
    select *
    from `corded-sunlight-464012-e2`.`dbt_dw_intermediate`.`int_customers_northwind`
)

, dim_customers as (
    select
        to_hex(md5(cast(coalesce(cast(customer_id as string), '_dbt_utils_surrogate_key_null_') as string))) as sk_customer
        , customer_id
        , company_name
        , contact_name
        , contact_title
        , address
        , city
        , region
        , country
        , continent
    from int_customers_northwind
)

select *
from dim_customers
    );
  
[0m17:21:22.725669 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_exercise.dim_employees"
[0m17:21:22.727525 [debug] [Thread-3 (]: On model.dbt_exercise.dim_employees: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "model.dbt_exercise.dim_employees"} */

  
    

    create or replace table `corded-sunlight-464012-e2`.`dbt_dw_marts`.`dim_employees`
      
    
    

    OPTIONS()
    as (
      with int_employees_northwind as (
    select *
    from `corded-sunlight-464012-e2`.`dbt_dw_intermediate`.`int_employees_northwind`
)

, dim_employees as (
    select
        to_hex(md5(cast(coalesce(cast(employee_id as string), '_dbt_utils_surrogate_key_null_') as string))) as sk_employee
        , employee_id
        , employee_name
        , title
        , birth_date
        , age
        , hire_date
        , years_hired
        , address
        , city
        , region
        , country
    from int_employees_northwind
)
select *
from dim_employees
    );
  
[0m17:21:22.777777 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:e7b198f0-4b9a-46b9-9213-7cb4ff0815a1&page=queryresults
[0m17:21:22.809172 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:72787200-9a55-4488-8f15-16ab328ec7d8&page=queryresults
[0m17:21:23.325288 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '959ddc46-28fb-44a5-95f4-e73306dd3a01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7edd3b8e37d0>]}
[0m17:21:23.326935 [info ] [Thread-1 (]: 13 of 19 OK created sql view model dbt_dw_intermediate.int_shippers_northwind .. [[32mCREATE VIEW (0 processed)[0m in 1.77s]
[0m17:21:23.329671 [debug] [Thread-1 (]: Finished running node model.dbt_exercise.int_shippers_northwind
[0m17:21:23.339786 [debug] [Thread-1 (]: Began running node model.dbt_exercise.dim_ship
[0m17:21:23.342327 [info ] [Thread-1 (]: 17 of 19 START sql table model dbt_dw_marts.dim_ship ........................... [RUN]
[0m17:21:23.344090 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_exercise.int_shippers_northwind, now model.dbt_exercise.dim_ship)
[0m17:21:23.345771 [debug] [Thread-1 (]: Began compiling node model.dbt_exercise.dim_ship
[0m17:21:23.353994 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '959ddc46-28fb-44a5-95f4-e73306dd3a01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7edd382dc650>]}
[0m17:21:23.355979 [info ] [Thread-4 (]: 14 of 19 OK created sql view model dbt_dw_intermediate.int_products_northwind .. [[32mCREATE VIEW (0 processed)[0m in 1.70s]
[0m17:21:23.369395 [debug] [Thread-4 (]: Finished running node model.dbt_exercise.int_products_northwind
[0m17:21:23.371939 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_exercise.dim_ship"
[0m17:21:23.374246 [debug] [Thread-4 (]: Began running node model.dbt_exercise.dim_products
[0m17:21:23.375990 [info ] [Thread-4 (]: 18 of 19 START sql table model dbt_dw_marts.dim_products ....................... [RUN]
[0m17:21:23.377509 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.dbt_exercise.int_products_northwind, now model.dbt_exercise.dim_products)
[0m17:21:23.378428 [debug] [Thread-1 (]: Began executing node model.dbt_exercise.dim_ship
[0m17:21:23.379356 [debug] [Thread-4 (]: Began compiling node model.dbt_exercise.dim_products
[0m17:21:23.386279 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:21:23.401157 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_exercise.dim_products"
[0m17:21:23.402860 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:374e30e8-2c64-4eb0-904d-3643c1f78398&page=queryresults
[0m17:21:23.406334 [debug] [Thread-4 (]: Began executing node model.dbt_exercise.dim_products
[0m17:21:23.416843 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m17:21:23.637676 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:048c864b-d971-4ea8-b452-0e59d2dbd7ca&page=queryresults
[0m17:21:24.274889 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_exercise.dim_ship"
[0m17:21:24.277854 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_exercise.dim_products"
[0m17:21:24.279479 [debug] [Thread-4 (]: On model.dbt_exercise.dim_products: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "model.dbt_exercise.dim_products"} */

  
    

    create or replace table `corded-sunlight-464012-e2`.`dbt_dw_marts`.`dim_products`
      
    
    

    OPTIONS()
    as (
      with int_products_northwind as (
    select *
    from `corded-sunlight-464012-e2`.`dbt_dw_intermediate`.`int_products_northwind`
)

, dim_products as (
    select
        to_hex(md5(cast(coalesce(cast(product_id as string), '_dbt_utils_surrogate_key_null_') as string))) as sk_product
        , product_id
        , product_name
        , quantity_per_unit
        , category_name
        , supplier_name
        , supplier_city
        , supplier_region
        , supplier_country
        , supplier_continent
        , is_discontinued
    from int_products_northwind
)

select *
from dim_products
    );
  
[0m17:21:24.282260 [debug] [Thread-1 (]: On model.dbt_exercise.dim_ship: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "model.dbt_exercise.dim_ship"} */

  
    

    create or replace table `corded-sunlight-464012-e2`.`dbt_dw_marts`.`dim_ship`
      
    
    

    OPTIONS()
    as (
      with int_shippers_northwind as (
    select *
    from `corded-sunlight-464012-e2`.`dbt_dw_intermediate`.`int_shippers_northwind`
)

, dim_ship as (
    select
        to_hex(md5(cast(coalesce(cast(ship_id as string), '_dbt_utils_surrogate_key_null_') as string))) as sk_ship
        , ship_id
        , shipper_id
        , company_name
        , ship_address
        , ship_city
        , ship_region
        , ship_country
        , ship_continent
    from int_shippers_northwind
)

select *
from dim_ship
    );
  
[0m17:21:24.817886 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:96386969-fad4-45ee-aacb-70d5eab634fc&page=queryresults
[0m17:21:24.934249 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:d619d559-76f7-4937-9c2b-b8342c28ea7a&page=queryresults
[0m17:21:25.685199 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '959ddc46-28fb-44a5-95f4-e73306dd3a01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7edd381ad070>]}
[0m17:21:25.687734 [info ] [Thread-3 (]: 16 of 19 OK created sql table model dbt_dw_marts.dim_employees ................. [[32mCREATE TABLE (9.0 rows, 13.7 KiB processed)[0m in 3.76s]
[0m17:21:25.689560 [debug] [Thread-3 (]: Finished running node model.dbt_exercise.dim_employees
[0m17:21:25.732106 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '959ddc46-28fb-44a5-95f4-e73306dd3a01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7edd69d495e0>]}
[0m17:21:25.734369 [info ] [Thread-2 (]: 15 of 19 OK created sql table model dbt_dw_marts.dim_customers ................. [[32mCREATE TABLE (91.0 rows, 9.1 KiB processed)[0m in 3.94s]
[0m17:21:25.735911 [debug] [Thread-2 (]: Finished running node model.dbt_exercise.dim_customers
[0m17:21:27.274195 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '959ddc46-28fb-44a5-95f4-e73306dd3a01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7edd38171bb0>]}
[0m17:21:27.275767 [info ] [Thread-1 (]: 17 of 19 OK created sql table model dbt_dw_marts.dim_ship ...................... [[32mCREATE TABLE (242.0 rows, 39.9 KiB processed)[0m in 3.93s]
[0m17:21:27.277278 [debug] [Thread-1 (]: Finished running node model.dbt_exercise.dim_ship
[0m17:21:28.221490 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '959ddc46-28fb-44a5-95f4-e73306dd3a01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7edd381d80e0>]}
[0m17:21:28.222779 [info ] [Thread-4 (]: 18 of 19 OK created sql table model dbt_dw_marts.dim_products .................. [[32mCREATE TABLE (77.0 rows, 6.6 KiB processed)[0m in 4.84s]
[0m17:21:28.223875 [debug] [Thread-4 (]: Finished running node model.dbt_exercise.dim_products
[0m17:21:28.226663 [debug] [Thread-3 (]: Began running node model.dbt_exercise.fact_orders
[0m17:21:28.227817 [info ] [Thread-3 (]: 19 of 19 START sql table model dbt_dw_marts.fact_orders ........................ [RUN]
[0m17:21:28.230799 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_exercise.dim_employees, now model.dbt_exercise.fact_orders)
[0m17:21:28.232299 [debug] [Thread-3 (]: Began compiling node model.dbt_exercise.fact_orders
[0m17:21:28.252960 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_exercise.fact_orders"
[0m17:21:28.255876 [debug] [Thread-3 (]: Began executing node model.dbt_exercise.fact_orders
[0m17:21:28.264610 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m17:21:29.038936 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_exercise.fact_orders"
[0m17:21:29.041459 [debug] [Thread-3 (]: On model.dbt_exercise.fact_orders: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "model.dbt_exercise.fact_orders"} */

  
    

    create or replace table `corded-sunlight-464012-e2`.`dbt_dw_marts`.`fact_orders`
      
    
    

    OPTIONS()
    as (
      with int_orders_northwind as (
    select *
    from `corded-sunlight-464012-e2`.`dbt_dw_intermediate`.`int_orders_northwind`
)

, dim_products as (
    select *
    from `corded-sunlight-464012-e2`.`dbt_dw_marts`.`dim_products`
)

, dim_customers as (
    select *
    from `corded-sunlight-464012-e2`.`dbt_dw_marts`.`dim_customers`
)

, dim_ship as (
    select *
    from `corded-sunlight-464012-e2`.`dbt_dw_marts`.`dim_ship`
)

, dim_employees as (
    select *
    from `corded-sunlight-464012-e2`.`dbt_dw_marts`.`dim_employees`
)

, fact_orders as (
    select 
        to_hex(md5(cast(coalesce(cast(int_orders_northwind.order_id as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(dim_customers.customer_id as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(dim_employees.employee_id as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(dim_products.product_id as string), '_dbt_utils_surrogate_key_null_') as string))) as sk_orders
        , int_orders_northwind.order_id
        , dim_customers.sk_customer
        , int_orders_northwind.customer_id
        , dim_employees.sk_employee
        , int_orders_northwind.employee_id
        , int_orders_northwind.order_date
        , int_orders_northwind.required_date
        , dim_ship.sk_ship
        , int_orders_northwind.ship_id
        , int_orders_northwind.shipped_date
        , int_orders_northwind.days_to_ship
        , dim_products.sk_product
        , int_orders_northwind.product_id
        , int_orders_northwind.amount
        , int_orders_northwind.rationed_shipping
        , int_orders_northwind.is_shipped
    from int_orders_northwind
    left join dim_products
        on int_orders_northwind.product_id = dim_products.product_id
    left join dim_customers
        on int_orders_northwind.customer_id = dim_customers.customer_id
    left join dim_employees
        on int_orders_northwind.employee_id = dim_employees.employee_id
    left join dim_ship
        on int_orders_northwind.ship_id = dim_ship.ship_id
)

select *
from fact_orders
    );
  
[0m17:21:30.036637 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:0dbd9a35-15ca-4973-8f36-121049991092&page=queryresults
[0m17:21:32.825485 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '959ddc46-28fb-44a5-95f4-e73306dd3a01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7edd382d4d40>]}
[0m17:21:32.826860 [info ] [Thread-3 (]: 19 of 19 OK created sql table model dbt_dw_marts.fact_orders ................... [[32mCREATE TABLE (2.2k rows, 208.5 KiB processed)[0m in 4.60s]
[0m17:21:32.828202 [debug] [Thread-3 (]: Finished running node model.dbt_exercise.fact_orders
[0m17:21:32.832721 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:21:32.842389 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:21:32.844230 [debug] [MainThread]: Connection 'model.dbt_exercise.dim_customers' was properly closed.
[0m17:21:32.845794 [debug] [MainThread]: Connection 'model.dbt_exercise.dim_ship' was properly closed.
[0m17:21:32.847057 [debug] [MainThread]: Connection 'model.dbt_exercise.fact_orders' was properly closed.
[0m17:21:32.848706 [debug] [MainThread]: Connection 'model.dbt_exercise.dim_products' was properly closed.
[0m17:21:32.850132 [info ] [MainThread]: 
[0m17:21:32.851715 [info ] [MainThread]: Finished running 5 table models, 14 view models in 0 hours 0 minutes and 26.50 seconds (26.50s).
[0m17:21:32.863890 [debug] [MainThread]: Command end result
[0m17:21:32.981956 [debug] [MainThread]: Wrote artifact WritableManifest to /home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/target/manifest.json
[0m17:21:33.000511 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/target/semantic_manifest.json
[0m17:21:33.013733 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/target/run_results.json
[0m17:21:33.014478 [info ] [MainThread]: 
[0m17:21:33.015227 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:21:33.016026 [info ] [MainThread]: 
[0m17:21:33.017051 [info ] [MainThread]: Done. PASS=19 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=19
[0m17:21:33.018815 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- DuplicateYAMLKeysDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m17:21:33.025788 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 159.44016, "process_in_blocks": "123528", "process_kernel_time": 17.91192, "process_mem_max_rss": "378352", "process_out_blocks": "6064", "process_user_time": 21.531128}
[0m17:21:33.027491 [debug] [MainThread]: Command `dbt run` succeeded at 17:21:33.027009 after 159.44 seconds
[0m17:21:33.029172 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7edda8d8d040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7edd3b67cf20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7edd3b79d820>]}
[0m17:21:33.031354 [debug] [MainThread]: Flushing usage events
[0m17:21:33.475946 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:23:08.664057 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71cf69ebe0c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71cf6bcc0ce0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71cf69ebe180>]}


============================== 17:23:08.682894 | d4fd25c6-e1d1-4773-ac30-aeaf1466b21f ==============================
[0m17:23:08.682894 [info ] [MainThread]: Running with dbt=1.10.2
[0m17:23:08.683774 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'invocation_command': 'dbt test', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True'}
[0m17:24:10.182393 [warn ] [MainThread]: [[33mWARNING[0m][DuplicateYAMLKeysDeprecation]: Deprecated functionality
Duplicate key 'version' in "<unicode string>", line 4, column 1 in file
`/home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/dbt_project.yml`
[0m17:24:10.184026 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': 'd4fd25c6-e1d1-4773-ac30-aeaf1466b21f', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71cf2c51e720>]}
[0m17:24:11.034381 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd4fd25c6-e1d1-4773-ac30-aeaf1466b21f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71cf69d5b320>]}
[0m17:24:11.133790 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd4fd25c6-e1d1-4773-ac30-aeaf1466b21f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71cf6bc7c050>]}
[0m17:24:11.138602 [info ] [MainThread]: Registered adapter: bigquery=1.9.2
[0m17:25:19.737778 [debug] [MainThread]: checksum: 1adc40777973ef30f45f80b3b6d04d5013c1edd53d96363881b3b199e612468b, vars: {}, profile: , target: , version: 1.10.2
[0m17:25:26.107968 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:25:26.108906 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:25:26.418540 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd4fd25c6-e1d1-4773-ac30-aeaf1466b21f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71cf2c47a510>]}
[0m17:25:26.611392 [debug] [MainThread]: Wrote artifact WritableManifest to /home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/target/manifest.json
[0m17:25:26.627255 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/target/semantic_manifest.json
[0m17:25:27.232096 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd4fd25c6-e1d1-4773-ac30-aeaf1466b21f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71cf2bddf950>]}
[0m17:25:27.232871 [info ] [MainThread]: Found 19 models, 14 seeds, 59 data tests, 14 sources, 609 macros
[0m17:25:27.234242 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd4fd25c6-e1d1-4773-ac30-aeaf1466b21f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71cf2c240fb0>]}
[0m17:25:27.242462 [info ] [MainThread]: 
[0m17:25:27.243793 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m17:25:27.244651 [info ] [MainThread]: 
[0m17:25:27.245567 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m17:25:27.257784 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_corded-sunlight-464012-e2_dbt_dw_intermediate'
[0m17:25:27.260152 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_corded-sunlight-464012-e2_dbt_dw_marts'
[0m17:25:27.260932 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:25:27.262568 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_corded-sunlight-464012-e2_dbt_dw_staging'
[0m17:25:27.263245 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:25:27.265196 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_corded-sunlight-464012-e2_dbt_dw_raw'
[0m17:25:27.268013 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:25:27.270210 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:25:28.272800 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd4fd25c6-e1d1-4773-ac30-aeaf1466b21f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71cf2c479d90>]}
[0m17:25:28.273602 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:25:28.288859 [debug] [Thread-1 (]: Began running node test.dbt_exercise.accepted_values_dim_products_is_discontinued__True__False.b53ac91bb6
[0m17:25:28.289674 [debug] [Thread-2 (]: Began running node test.dbt_exercise.not_null_dim_customers_customer_id.dd91cd1c8d
[0m17:25:28.290906 [debug] [Thread-3 (]: Began running node test.dbt_exercise.not_null_dim_customers_customer_sk.8ae5836863
[0m17:25:28.292366 [debug] [Thread-4 (]: Began running node test.dbt_exercise.not_null_dim_employees_employee_id.ef83a0c291
[0m17:25:28.291739 [info ] [Thread-1 (]: 1 of 59 START test accepted_values_dim_products_is_discontinued__True__False ... [RUN]
[0m17:25:28.293629 [info ] [Thread-2 (]: 2 of 59 START test not_null_dim_customers_customer_id .......................... [RUN]
[0m17:25:28.294649 [info ] [Thread-3 (]: 3 of 59 START test not_null_dim_customers_customer_sk .......................... [RUN]
[0m17:25:28.295738 [info ] [Thread-4 (]: 4 of 59 START test not_null_dim_employees_employee_id .......................... [RUN]
[0m17:25:28.296689 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_corded-sunlight-464012-e2_dbt_dw_intermediate, now test.dbt_exercise.accepted_values_dim_products_is_discontinued__True__False.b53ac91bb6)
[0m17:25:28.297899 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_corded-sunlight-464012-e2_dbt_dw_staging, now test.dbt_exercise.not_null_dim_customers_customer_id.dd91cd1c8d)
[0m17:25:28.298991 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_corded-sunlight-464012-e2_dbt_dw_marts, now test.dbt_exercise.not_null_dim_customers_customer_sk.8ae5836863)
[0m17:25:28.300218 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly list_corded-sunlight-464012-e2_dbt_dw_raw, now test.dbt_exercise.not_null_dim_employees_employee_id.ef83a0c291)
[0m17:25:28.301859 [debug] [Thread-1 (]: Began compiling node test.dbt_exercise.accepted_values_dim_products_is_discontinued__True__False.b53ac91bb6
[0m17:25:28.303103 [debug] [Thread-2 (]: Began compiling node test.dbt_exercise.not_null_dim_customers_customer_id.dd91cd1c8d
[0m17:25:28.304054 [debug] [Thread-3 (]: Began compiling node test.dbt_exercise.not_null_dim_customers_customer_sk.8ae5836863
[0m17:25:28.304855 [debug] [Thread-4 (]: Began compiling node test.dbt_exercise.not_null_dim_employees_employee_id.ef83a0c291
[0m17:25:28.341261 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_exercise.accepted_values_dim_products_is_discontinued__True__False.b53ac91bb6"
[0m17:25:28.346045 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_exercise.not_null_dim_customers_customer_id.dd91cd1c8d"
[0m17:25:28.353482 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_exercise.not_null_dim_customers_customer_sk.8ae5836863"
[0m17:25:28.360086 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_exercise.not_null_dim_employees_employee_id.ef83a0c291"
[0m17:25:28.364119 [debug] [Thread-1 (]: Began executing node test.dbt_exercise.accepted_values_dim_products_is_discontinued__True__False.b53ac91bb6
[0m17:25:28.390469 [debug] [Thread-2 (]: Began executing node test.dbt_exercise.not_null_dim_customers_customer_id.dd91cd1c8d
[0m17:25:28.392096 [debug] [Thread-4 (]: Began executing node test.dbt_exercise.not_null_dim_employees_employee_id.ef83a0c291
[0m17:25:28.393016 [debug] [Thread-3 (]: Began executing node test.dbt_exercise.not_null_dim_customers_customer_sk.8ae5836863
[0m17:25:28.401950 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_exercise.accepted_values_dim_products_is_discontinued__True__False.b53ac91bb6"
[0m17:25:28.406693 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_exercise.not_null_dim_customers_customer_id.dd91cd1c8d"
[0m17:25:28.410180 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_exercise.not_null_dim_employees_employee_id.ef83a0c291"
[0m17:25:28.414085 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_exercise.not_null_dim_customers_customer_sk.8ae5836863"
[0m17:25:28.417489 [debug] [Thread-1 (]: On test.dbt_exercise.accepted_values_dim_products_is_discontinued__True__False.b53ac91bb6: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "test.dbt_exercise.accepted_values_dim_products_is_discontinued__True__False.b53ac91bb6"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        is_discontinued as value_field,
        count(*) as n_records

    from `corded-sunlight-464012-e2`.`dbt_dw_marts`.`dim_products`
    group by is_discontinued

)

select *
from all_values
where value_field not in (
    'True','False'
)



  
  
      
    ) dbt_internal_test
[0m17:25:28.418219 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:25:28.420557 [debug] [Thread-4 (]: On test.dbt_exercise.not_null_dim_employees_employee_id.ef83a0c291: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "test.dbt_exercise.not_null_dim_employees_employee_id.ef83a0c291"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select employee_id
from `corded-sunlight-464012-e2`.`dbt_dw_marts`.`dim_employees`
where employee_id is null



  
  
      
    ) dbt_internal_test
[0m17:25:28.422008 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m17:25:28.423233 [debug] [Thread-2 (]: On test.dbt_exercise.not_null_dim_customers_customer_id.dd91cd1c8d: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "test.dbt_exercise.not_null_dim_customers_customer_id.dd91cd1c8d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select customer_id
from `corded-sunlight-464012-e2`.`dbt_dw_marts`.`dim_customers`
where customer_id is null



  
  
      
    ) dbt_internal_test
[0m17:25:28.424433 [debug] [Thread-3 (]: On test.dbt_exercise.not_null_dim_customers_customer_sk.8ae5836863: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "test.dbt_exercise.not_null_dim_customers_customer_sk.8ae5836863"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select customer_sk
from `corded-sunlight-464012-e2`.`dbt_dw_marts`.`dim_customers`
where customer_sk is null



  
  
      
    ) dbt_internal_test
[0m17:25:28.425488 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:25:28.426878 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m17:25:29.430307 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:0136b5e1-a8a4-4bbd-bb8c-b048bcad32a9&page=queryresults
[0m17:25:29.431422 [error] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:0136b5e1-a8a4-4bbd-bb8c-b048bcad32a9&page=queryresults
[0m17:25:29.437177 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:4237415e-34b5-4f1a-9202-e37dd929b04d&page=queryresults
[0m17:25:29.438213 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:4237415e-34b5-4f1a-9202-e37dd929b04d&page=queryresults
[0m17:25:29.523808 [debug] [Thread-3 (]: Database Error in test not_null_dim_customers_customer_sk (models/marts/dim_customers.yml)
  Unrecognized name: customer_sk; Did you mean customer_id? at [18:7]
  compiled code at target/run/dbt_exercise/models/marts/dim_customers.yml/not_null_dim_customers_customer_sk.sql
[0m17:25:29.525959 [debug] [Thread-1 (]: Database Error in test accepted_values_dim_products_is_discontinued__True__False (models/marts/dim_products.yml)
  No matching signature for operator IN for argument types BOOL and {STRING} at [27:23]
  compiled code at target/run/dbt_exercise/models/marts/dim_products.yml/accepted_values_dim_products_is_discontinued__True__False.sql
[0m17:25:29.527247 [error] [Thread-3 (]: 3 of 59 ERROR not_null_dim_customers_customer_sk ............................... [[31mERROR[0m in 1.23s]
[0m17:25:29.528382 [error] [Thread-1 (]: 1 of 59 ERROR accepted_values_dim_products_is_discontinued__True__False ........ [[31mERROR[0m in 1.23s]
[0m17:25:29.530046 [debug] [Thread-3 (]: Finished running node test.dbt_exercise.not_null_dim_customers_customer_sk.8ae5836863
[0m17:25:29.531738 [debug] [Thread-1 (]: Finished running node test.dbt_exercise.accepted_values_dim_products_is_discontinued__True__False.b53ac91bb6
[0m17:25:29.532878 [debug] [Thread-3 (]: Began running node test.dbt_exercise.not_null_dim_employees_sk_employee.92381e9313
[0m17:25:29.533766 [debug] [Thread-7 (]: Marking all children of 'test.dbt_exercise.not_null_dim_customers_customer_sk.8ae5836863' to be skipped because of status 'error'.  Reason: Database Error in test not_null_dim_customers_customer_sk (models/marts/dim_customers.yml)
  Unrecognized name: customer_sk; Did you mean customer_id? at [18:7]
  compiled code at target/run/dbt_exercise/models/marts/dim_customers.yml/not_null_dim_customers_customer_sk.sql.
[0m17:25:29.534678 [debug] [Thread-1 (]: Began running node test.dbt_exercise.not_null_dim_products_product_id.c8aba288d1
[0m17:25:29.535768 [info ] [Thread-3 (]: 5 of 59 START test not_null_dim_employees_sk_employee .......................... [RUN]
[0m17:25:29.537938 [debug] [Thread-7 (]: Marking all children of 'test.dbt_exercise.accepted_values_dim_products_is_discontinued__True__False.b53ac91bb6' to be skipped because of status 'error'.  Reason: Database Error in test accepted_values_dim_products_is_discontinued__True__False (models/marts/dim_products.yml)
  No matching signature for operator IN for argument types BOOL and {STRING} at [27:23]
  compiled code at target/run/dbt_exercise/models/marts/dim_products.yml/accepted_values_dim_products_is_discontinued__True__False.sql.
[0m17:25:29.539019 [info ] [Thread-1 (]: 6 of 59 START test not_null_dim_products_product_id ............................ [RUN]
[0m17:25:29.540062 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_exercise.not_null_dim_customers_customer_sk.8ae5836863, now test.dbt_exercise.not_null_dim_employees_sk_employee.92381e9313)
[0m17:25:29.541149 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_exercise.accepted_values_dim_products_is_discontinued__True__False.b53ac91bb6, now test.dbt_exercise.not_null_dim_products_product_id.c8aba288d1)
[0m17:25:29.541927 [debug] [Thread-3 (]: Began compiling node test.dbt_exercise.not_null_dim_employees_sk_employee.92381e9313
[0m17:25:29.542730 [debug] [Thread-1 (]: Began compiling node test.dbt_exercise.not_null_dim_products_product_id.c8aba288d1
[0m17:25:29.551421 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_exercise.not_null_dim_employees_sk_employee.92381e9313"
[0m17:25:29.559298 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_exercise.not_null_dim_products_product_id.c8aba288d1"
[0m17:25:29.561530 [debug] [Thread-1 (]: Began executing node test.dbt_exercise.not_null_dim_products_product_id.c8aba288d1
[0m17:25:29.565647 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_exercise.not_null_dim_products_product_id.c8aba288d1"
[0m17:25:29.566603 [debug] [Thread-1 (]: On test.dbt_exercise.not_null_dim_products_product_id.c8aba288d1: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "test.dbt_exercise.not_null_dim_products_product_id.c8aba288d1"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select product_id
from `corded-sunlight-464012-e2`.`dbt_dw_marts`.`dim_products`
where product_id is null



  
  
      
    ) dbt_internal_test
[0m17:25:29.567702 [debug] [Thread-3 (]: Began executing node test.dbt_exercise.not_null_dim_employees_sk_employee.92381e9313
[0m17:25:29.568658 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:25:29.573129 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_exercise.not_null_dim_employees_sk_employee.92381e9313"
[0m17:25:29.575683 [debug] [Thread-3 (]: On test.dbt_exercise.not_null_dim_employees_sk_employee.92381e9313: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "test.dbt_exercise.not_null_dim_employees_sk_employee.92381e9313"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select sk_employee
from `corded-sunlight-464012-e2`.`dbt_dw_marts`.`dim_employees`
where sk_employee is null



  
  
      
    ) dbt_internal_test
[0m17:25:29.577343 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m17:25:29.663814 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:ad862ca8-13b4-4674-adb8-d0ce4045ddd4&page=queryresults
[0m17:25:29.667535 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:60498221-792e-4d7e-82e9-3d0e1fd87ffa&page=queryresults
[0m17:25:30.695450 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:84b4c2fc-ef0d-4689-8879-e09bff86c2fa&page=queryresults
[0m17:25:30.800192 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:dbc9fea5-8883-4d45-b65d-ded825153a18&page=queryresults
[0m17:25:36.782030 [info ] [Thread-4 (]: 4 of 59 PASS not_null_dim_employees_employee_id ................................ [[32mPASS[0m in 8.48s]
[0m17:25:36.783572 [debug] [Thread-4 (]: Finished running node test.dbt_exercise.not_null_dim_employees_employee_id.ef83a0c291
[0m17:25:36.787159 [debug] [Thread-4 (]: Began running node test.dbt_exercise.not_null_dim_products_sk_product.7ce7792ece
[0m17:25:36.789105 [info ] [Thread-4 (]: 7 of 59 START test not_null_dim_products_sk_product ............................ [RUN]
[0m17:25:36.792926 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_exercise.not_null_dim_employees_employee_id.ef83a0c291, now test.dbt_exercise.not_null_dim_products_sk_product.7ce7792ece)
[0m17:25:36.794171 [debug] [Thread-4 (]: Began compiling node test.dbt_exercise.not_null_dim_products_sk_product.7ce7792ece
[0m17:25:36.812576 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_exercise.not_null_dim_products_sk_product.7ce7792ece"
[0m17:25:36.816114 [info ] [Thread-1 (]: 6 of 59 PASS not_null_dim_products_product_id .................................. [[32mPASS[0m in 7.27s]
[0m17:25:36.817393 [info ] [Thread-3 (]: 5 of 59 PASS not_null_dim_employees_sk_employee ................................ [[32mPASS[0m in 7.28s]
[0m17:25:36.823913 [debug] [Thread-4 (]: Began executing node test.dbt_exercise.not_null_dim_products_sk_product.7ce7792ece
[0m17:25:36.821336 [info ] [Thread-2 (]: 2 of 59 PASS not_null_dim_customers_customer_id ................................ [[32mPASS[0m in 8.52s]
[0m17:25:36.828066 [debug] [Thread-1 (]: Finished running node test.dbt_exercise.not_null_dim_products_product_id.c8aba288d1
[0m17:25:36.829819 [debug] [Thread-3 (]: Finished running node test.dbt_exercise.not_null_dim_employees_sk_employee.92381e9313
[0m17:25:36.833917 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_exercise.not_null_dim_products_sk_product.7ce7792ece"
[0m17:25:36.835856 [debug] [Thread-2 (]: Finished running node test.dbt_exercise.not_null_dim_customers_customer_id.dd91cd1c8d
[0m17:25:36.837645 [debug] [Thread-1 (]: Began running node test.dbt_exercise.not_null_dim_ship_ship_id.0e7926966a
[0m17:25:36.839888 [debug] [Thread-3 (]: Began running node test.dbt_exercise.not_null_dim_ship_shipper_id.78acf0f3d3
[0m17:25:36.843085 [debug] [Thread-2 (]: Began running node test.dbt_exercise.not_null_dim_ship_sk_ship.3ae993afec
[0m17:25:36.845818 [debug] [Thread-4 (]: On test.dbt_exercise.not_null_dim_products_sk_product.7ce7792ece: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "test.dbt_exercise.not_null_dim_products_sk_product.7ce7792ece"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select sk_product
from `corded-sunlight-464012-e2`.`dbt_dw_marts`.`dim_products`
where sk_product is null



  
  
      
    ) dbt_internal_test
[0m17:25:36.844654 [info ] [Thread-1 (]: 8 of 59 START test not_null_dim_ship_ship_id ................................... [RUN]
[0m17:25:36.847652 [info ] [Thread-3 (]: 9 of 59 START test not_null_dim_ship_shipper_id ................................ [RUN]
[0m17:25:36.848532 [info ] [Thread-2 (]: 10 of 59 START test not_null_dim_ship_sk_ship .................................. [RUN]
[0m17:25:36.849384 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m17:25:36.850666 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_exercise.not_null_dim_products_product_id.c8aba288d1, now test.dbt_exercise.not_null_dim_ship_ship_id.0e7926966a)
[0m17:25:36.852582 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_exercise.not_null_dim_employees_sk_employee.92381e9313, now test.dbt_exercise.not_null_dim_ship_shipper_id.78acf0f3d3)
[0m17:25:36.855076 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_exercise.not_null_dim_customers_customer_id.dd91cd1c8d, now test.dbt_exercise.not_null_dim_ship_sk_ship.3ae993afec)
[0m17:25:36.856447 [debug] [Thread-1 (]: Began compiling node test.dbt_exercise.not_null_dim_ship_ship_id.0e7926966a
[0m17:25:36.857726 [debug] [Thread-3 (]: Began compiling node test.dbt_exercise.not_null_dim_ship_shipper_id.78acf0f3d3
[0m17:25:36.859068 [debug] [Thread-2 (]: Began compiling node test.dbt_exercise.not_null_dim_ship_sk_ship.3ae993afec
[0m17:25:36.880395 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_exercise.not_null_dim_ship_shipper_id.78acf0f3d3"
[0m17:25:36.882179 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_exercise.not_null_dim_ship_ship_id.0e7926966a"
[0m17:25:36.892445 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_exercise.not_null_dim_ship_sk_ship.3ae993afec"
[0m17:25:36.932374 [debug] [Thread-1 (]: Began executing node test.dbt_exercise.not_null_dim_ship_ship_id.0e7926966a
[0m17:25:36.937853 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_exercise.not_null_dim_ship_ship_id.0e7926966a"
[0m17:25:36.938953 [debug] [Thread-3 (]: Began executing node test.dbt_exercise.not_null_dim_ship_shipper_id.78acf0f3d3
[0m17:25:36.940403 [debug] [Thread-2 (]: Began executing node test.dbt_exercise.not_null_dim_ship_sk_ship.3ae993afec
[0m17:25:36.950793 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_exercise.not_null_dim_ship_shipper_id.78acf0f3d3"
[0m17:25:36.955297 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_exercise.not_null_dim_ship_sk_ship.3ae993afec"
[0m17:25:36.956504 [debug] [Thread-1 (]: On test.dbt_exercise.not_null_dim_ship_ship_id.0e7926966a: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "test.dbt_exercise.not_null_dim_ship_ship_id.0e7926966a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select ship_id
from `corded-sunlight-464012-e2`.`dbt_dw_marts`.`dim_ship`
where ship_id is null



  
  
      
    ) dbt_internal_test
[0m17:25:36.959818 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:25:36.962049 [debug] [Thread-2 (]: On test.dbt_exercise.not_null_dim_ship_sk_ship.3ae993afec: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "test.dbt_exercise.not_null_dim_ship_sk_ship.3ae993afec"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select sk_ship
from `corded-sunlight-464012-e2`.`dbt_dw_marts`.`dim_ship`
where sk_ship is null



  
  
      
    ) dbt_internal_test
[0m17:25:36.963462 [debug] [Thread-3 (]: On test.dbt_exercise.not_null_dim_ship_shipper_id.78acf0f3d3: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "test.dbt_exercise.not_null_dim_ship_shipper_id.78acf0f3d3"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select shipper_id
from `corded-sunlight-464012-e2`.`dbt_dw_marts`.`dim_ship`
where shipper_id is null



  
  
      
    ) dbt_internal_test
[0m17:25:36.964733 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:25:36.966098 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m17:25:38.232400 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:42eacfb7-3d45-4113-ae80-3f5d9a6575e3&page=queryresults
[0m17:25:38.239683 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:5c7d7181-1fbe-4028-a0e7-9ba81b604106&page=queryresults
[0m17:25:38.241380 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:ca6106d1-3ca6-4859-8065-3b56eb571a6e&page=queryresults
[0m17:25:38.245436 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:7a53bed2-50bc-499c-b5ea-50f5acc0a74c&page=queryresults
[0m17:25:39.052987 [info ] [Thread-1 (]: 8 of 59 PASS not_null_dim_ship_ship_id ......................................... [[32mPASS[0m in 2.20s]
[0m17:25:39.055539 [debug] [Thread-1 (]: Finished running node test.dbt_exercise.not_null_dim_ship_ship_id.0e7926966a
[0m17:25:39.056750 [debug] [Thread-1 (]: Began running node test.dbt_exercise.not_null_fact_orders_customer_id.9c2270d0dc
[0m17:25:39.057576 [info ] [Thread-1 (]: 11 of 59 START test not_null_fact_orders_customer_id ........................... [RUN]
[0m17:25:39.058378 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_exercise.not_null_dim_ship_ship_id.0e7926966a, now test.dbt_exercise.not_null_fact_orders_customer_id.9c2270d0dc)
[0m17:25:39.059099 [debug] [Thread-1 (]: Began compiling node test.dbt_exercise.not_null_fact_orders_customer_id.9c2270d0dc
[0m17:25:39.066652 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_exercise.not_null_fact_orders_customer_id.9c2270d0dc"
[0m17:25:39.070704 [debug] [Thread-1 (]: Began executing node test.dbt_exercise.not_null_fact_orders_customer_id.9c2270d0dc
[0m17:25:39.076193 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_exercise.not_null_fact_orders_customer_id.9c2270d0dc"
[0m17:25:39.078909 [debug] [Thread-1 (]: On test.dbt_exercise.not_null_fact_orders_customer_id.9c2270d0dc: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "test.dbt_exercise.not_null_fact_orders_customer_id.9c2270d0dc"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select customer_id
from `corded-sunlight-464012-e2`.`dbt_dw_marts`.`fact_orders`
where customer_id is null



  
  
      
    ) dbt_internal_test
[0m17:25:39.080411 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:25:39.143901 [info ] [Thread-4 (]: 7 of 59 PASS not_null_dim_products_sk_product .................................. [[32mPASS[0m in 2.35s]
[0m17:25:39.151916 [debug] [Thread-4 (]: Finished running node test.dbt_exercise.not_null_dim_products_sk_product.7ce7792ece
[0m17:25:39.149004 [info ] [Thread-2 (]: 10 of 59 PASS not_null_dim_ship_sk_ship ........................................ [[32mPASS[0m in 2.29s]
[0m17:25:39.157232 [debug] [Thread-4 (]: Began running node test.dbt_exercise.not_null_fact_orders_employee_id.4d01f9cb32
[0m17:25:39.154662 [info ] [Thread-3 (]: 9 of 59 PASS not_null_dim_ship_shipper_id ...................................... [[32mPASS[0m in 2.30s]
[0m17:25:39.159444 [debug] [Thread-2 (]: Finished running node test.dbt_exercise.not_null_dim_ship_sk_ship.3ae993afec
[0m17:25:39.160381 [info ] [Thread-4 (]: 12 of 59 START test not_null_fact_orders_employee_id ........................... [RUN]
[0m17:25:39.161667 [debug] [Thread-3 (]: Finished running node test.dbt_exercise.not_null_dim_ship_shipper_id.78acf0f3d3
[0m17:25:39.163043 [debug] [Thread-2 (]: Began running node test.dbt_exercise.not_null_fact_orders_order_id.6ba6d3f0a0
[0m17:25:39.165240 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_exercise.not_null_dim_products_sk_product.7ce7792ece, now test.dbt_exercise.not_null_fact_orders_employee_id.4d01f9cb32)
[0m17:25:39.166970 [debug] [Thread-3 (]: Began running node test.dbt_exercise.not_null_fact_orders_product_id.346126b727
[0m17:25:39.169159 [info ] [Thread-2 (]: 13 of 59 START test not_null_fact_orders_order_id .............................. [RUN]
[0m17:25:39.172006 [debug] [Thread-4 (]: Began compiling node test.dbt_exercise.not_null_fact_orders_employee_id.4d01f9cb32
[0m17:25:39.173671 [info ] [Thread-3 (]: 14 of 59 START test not_null_fact_orders_product_id ............................ [RUN]
[0m17:25:39.175830 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_exercise.not_null_dim_ship_sk_ship.3ae993afec, now test.dbt_exercise.not_null_fact_orders_order_id.6ba6d3f0a0)
[0m17:25:39.184754 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_exercise.not_null_fact_orders_employee_id.4d01f9cb32"
[0m17:25:39.187536 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_exercise.not_null_dim_ship_shipper_id.78acf0f3d3, now test.dbt_exercise.not_null_fact_orders_product_id.346126b727)
[0m17:25:39.189500 [debug] [Thread-2 (]: Began compiling node test.dbt_exercise.not_null_fact_orders_order_id.6ba6d3f0a0
[0m17:25:39.191328 [debug] [Thread-3 (]: Began compiling node test.dbt_exercise.not_null_fact_orders_product_id.346126b727
[0m17:25:39.192230 [debug] [Thread-4 (]: Began executing node test.dbt_exercise.not_null_fact_orders_employee_id.4d01f9cb32
[0m17:25:39.198325 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_exercise.not_null_fact_orders_order_id.6ba6d3f0a0"
[0m17:25:39.207310 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_exercise.not_null_fact_orders_product_id.346126b727"
[0m17:25:39.211765 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_exercise.not_null_fact_orders_employee_id.4d01f9cb32"
[0m17:25:39.214514 [debug] [Thread-2 (]: Began executing node test.dbt_exercise.not_null_fact_orders_order_id.6ba6d3f0a0
[0m17:25:39.215509 [debug] [Thread-3 (]: Began executing node test.dbt_exercise.not_null_fact_orders_product_id.346126b727
[0m17:25:39.222666 [debug] [Thread-4 (]: On test.dbt_exercise.not_null_fact_orders_employee_id.4d01f9cb32: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "test.dbt_exercise.not_null_fact_orders_employee_id.4d01f9cb32"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select employee_id
from `corded-sunlight-464012-e2`.`dbt_dw_marts`.`fact_orders`
where employee_id is null



  
  
      
    ) dbt_internal_test
[0m17:25:39.225198 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_exercise.not_null_fact_orders_order_id.6ba6d3f0a0"
[0m17:25:39.229208 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_exercise.not_null_fact_orders_product_id.346126b727"
[0m17:25:39.230356 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m17:25:39.232136 [debug] [Thread-2 (]: On test.dbt_exercise.not_null_fact_orders_order_id.6ba6d3f0a0: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "test.dbt_exercise.not_null_fact_orders_order_id.6ba6d3f0a0"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select order_id
from `corded-sunlight-464012-e2`.`dbt_dw_marts`.`fact_orders`
where order_id is null



  
  
      
    ) dbt_internal_test
[0m17:25:39.233865 [debug] [Thread-3 (]: On test.dbt_exercise.not_null_fact_orders_product_id.346126b727: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "test.dbt_exercise.not_null_fact_orders_product_id.346126b727"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select product_id
from `corded-sunlight-464012-e2`.`dbt_dw_marts`.`fact_orders`
where product_id is null



  
  
      
    ) dbt_internal_test
[0m17:25:39.236711 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:25:39.238531 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m17:25:40.406267 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:7da74bca-2ee7-48ab-a039-2277668622c7&page=queryresults
[0m17:25:40.425496 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:4b151b83-3398-4b87-889c-51d04058e605&page=queryresults
[0m17:25:40.470762 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:5ac63f69-997b-4ca4-921e-c6728d4518f6&page=queryresults
[0m17:25:40.796993 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:00d64878-bcbf-416a-b600-d166f9cff758&page=queryresults
[0m17:25:41.281235 [info ] [Thread-1 (]: 11 of 59 PASS not_null_fact_orders_customer_id ................................. [[32mPASS[0m in 2.22s]
[0m17:25:41.282679 [debug] [Thread-1 (]: Finished running node test.dbt_exercise.not_null_fact_orders_customer_id.9c2270d0dc
[0m17:25:41.283913 [debug] [Thread-1 (]: Began running node test.dbt_exercise.not_null_fact_orders_sk_customer.6134ecd4cd
[0m17:25:41.285309 [info ] [Thread-1 (]: 15 of 59 START test not_null_fact_orders_sk_customer ........................... [RUN]
[0m17:25:41.286605 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_exercise.not_null_fact_orders_customer_id.9c2270d0dc, now test.dbt_exercise.not_null_fact_orders_sk_customer.6134ecd4cd)
[0m17:25:41.287398 [debug] [Thread-1 (]: Began compiling node test.dbt_exercise.not_null_fact_orders_sk_customer.6134ecd4cd
[0m17:25:41.297798 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_exercise.not_null_fact_orders_sk_customer.6134ecd4cd"
[0m17:25:41.302709 [debug] [Thread-1 (]: Began executing node test.dbt_exercise.not_null_fact_orders_sk_customer.6134ecd4cd
[0m17:25:41.304609 [info ] [Thread-3 (]: 14 of 59 PASS not_null_fact_orders_product_id .................................. [[32mPASS[0m in 2.12s]
[0m17:25:41.311519 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_exercise.not_null_fact_orders_sk_customer.6134ecd4cd"
[0m17:25:41.313239 [debug] [Thread-3 (]: Finished running node test.dbt_exercise.not_null_fact_orders_product_id.346126b727
[0m17:25:41.315869 [debug] [Thread-3 (]: Began running node test.dbt_exercise.not_null_fact_orders_sk_employee.cf36d136ff
[0m17:25:41.317719 [info ] [Thread-3 (]: 16 of 59 START test not_null_fact_orders_sk_employee ........................... [RUN]
[0m17:25:41.320295 [debug] [Thread-1 (]: On test.dbt_exercise.not_null_fact_orders_sk_customer.6134ecd4cd: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "test.dbt_exercise.not_null_fact_orders_sk_customer.6134ecd4cd"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select sk_customer
from `corded-sunlight-464012-e2`.`dbt_dw_marts`.`fact_orders`
where sk_customer is null



  
  
      
    ) dbt_internal_test
[0m17:25:41.321969 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_exercise.not_null_fact_orders_product_id.346126b727, now test.dbt_exercise.not_null_fact_orders_sk_employee.cf36d136ff)
[0m17:25:41.326350 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:25:41.329151 [info ] [Thread-4 (]: 12 of 59 PASS not_null_fact_orders_employee_id ................................. [[32mPASS[0m in 2.16s]
[0m17:25:41.330540 [debug] [Thread-3 (]: Began compiling node test.dbt_exercise.not_null_fact_orders_sk_employee.cf36d136ff
[0m17:25:41.332394 [debug] [Thread-4 (]: Finished running node test.dbt_exercise.not_null_fact_orders_employee_id.4d01f9cb32
[0m17:25:41.343654 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_exercise.not_null_fact_orders_sk_employee.cf36d136ff"
[0m17:25:41.345487 [debug] [Thread-4 (]: Began running node test.dbt_exercise.not_null_fact_orders_sk_orders.c6a2fa98b5
[0m17:25:41.348156 [info ] [Thread-4 (]: 17 of 59 START test not_null_fact_orders_sk_orders ............................. [RUN]
[0m17:25:41.350918 [debug] [Thread-3 (]: Began executing node test.dbt_exercise.not_null_fact_orders_sk_employee.cf36d136ff
[0m17:25:41.354223 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_exercise.not_null_fact_orders_employee_id.4d01f9cb32, now test.dbt_exercise.not_null_fact_orders_sk_orders.c6a2fa98b5)
[0m17:25:41.408301 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_exercise.not_null_fact_orders_sk_employee.cf36d136ff"
[0m17:25:41.409940 [debug] [Thread-4 (]: Began compiling node test.dbt_exercise.not_null_fact_orders_sk_orders.c6a2fa98b5
[0m17:25:41.425129 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_exercise.not_null_fact_orders_sk_orders.c6a2fa98b5"
[0m17:25:41.426765 [debug] [Thread-3 (]: On test.dbt_exercise.not_null_fact_orders_sk_employee.cf36d136ff: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "test.dbt_exercise.not_null_fact_orders_sk_employee.cf36d136ff"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select sk_employee
from `corded-sunlight-464012-e2`.`dbt_dw_marts`.`fact_orders`
where sk_employee is null



  
  
      
    ) dbt_internal_test
[0m17:25:41.428762 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m17:25:41.430171 [debug] [Thread-4 (]: Began executing node test.dbt_exercise.not_null_fact_orders_sk_orders.c6a2fa98b5
[0m17:25:41.437247 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_exercise.not_null_fact_orders_sk_orders.c6a2fa98b5"
[0m17:25:41.439725 [debug] [Thread-4 (]: On test.dbt_exercise.not_null_fact_orders_sk_orders.c6a2fa98b5: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "test.dbt_exercise.not_null_fact_orders_sk_orders.c6a2fa98b5"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select sk_orders
from `corded-sunlight-464012-e2`.`dbt_dw_marts`.`fact_orders`
where sk_orders is null



  
  
      
    ) dbt_internal_test
[0m17:25:41.441253 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m17:25:41.763983 [info ] [Thread-2 (]: 13 of 59 PASS not_null_fact_orders_order_id .................................... [[32mPASS[0m in 2.59s]
[0m17:25:41.765200 [debug] [Thread-2 (]: Finished running node test.dbt_exercise.not_null_fact_orders_order_id.6ba6d3f0a0
[0m17:25:41.765905 [debug] [Thread-2 (]: Began running node test.dbt_exercise.not_null_fact_orders_sk_product.9e0a112d70
[0m17:25:41.766749 [info ] [Thread-2 (]: 18 of 59 START test not_null_fact_orders_sk_product ............................ [RUN]
[0m17:25:41.767838 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_exercise.not_null_fact_orders_order_id.6ba6d3f0a0, now test.dbt_exercise.not_null_fact_orders_sk_product.9e0a112d70)
[0m17:25:41.768478 [debug] [Thread-2 (]: Began compiling node test.dbt_exercise.not_null_fact_orders_sk_product.9e0a112d70
[0m17:25:41.776060 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_exercise.not_null_fact_orders_sk_product.9e0a112d70"
[0m17:25:41.778294 [debug] [Thread-2 (]: Began executing node test.dbt_exercise.not_null_fact_orders_sk_product.9e0a112d70
[0m17:25:41.784356 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_exercise.not_null_fact_orders_sk_product.9e0a112d70"
[0m17:25:41.785642 [debug] [Thread-2 (]: On test.dbt_exercise.not_null_fact_orders_sk_product.9e0a112d70: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "test.dbt_exercise.not_null_fact_orders_sk_product.9e0a112d70"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select sk_product
from `corded-sunlight-464012-e2`.`dbt_dw_marts`.`fact_orders`
where sk_product is null



  
  
      
    ) dbt_internal_test
[0m17:25:41.786476 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:25:42.657776 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:b5cbcc22-cb96-405b-bc33-c4da195af038&page=queryresults
[0m17:25:42.659852 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:d5f8e143-d93c-40f0-a0cf-a01266bca17c&page=queryresults
[0m17:25:42.663922 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:c004c661-d7c6-4d80-994f-27c1bc1ae1fe&page=queryresults
[0m17:25:42.928391 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:92832795-ea63-4713-8260-04ab3968c7c6&page=queryresults
[0m17:25:43.479021 [info ] [Thread-4 (]: 17 of 59 PASS not_null_fact_orders_sk_orders ................................... [[32mPASS[0m in 2.12s]
[0m17:25:43.480125 [debug] [Thread-4 (]: Finished running node test.dbt_exercise.not_null_fact_orders_sk_orders.c6a2fa98b5
[0m17:25:43.480900 [debug] [Thread-4 (]: Began running node test.dbt_exercise.not_null_fact_orders_sk_ship.c82a3b72ed
[0m17:25:43.481714 [info ] [Thread-4 (]: 19 of 59 START test not_null_fact_orders_sk_ship ............................... [RUN]
[0m17:25:43.483395 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_exercise.not_null_fact_orders_sk_orders.c6a2fa98b5, now test.dbt_exercise.not_null_fact_orders_sk_ship.c82a3b72ed)
[0m17:25:43.484587 [debug] [Thread-4 (]: Began compiling node test.dbt_exercise.not_null_fact_orders_sk_ship.c82a3b72ed
[0m17:25:43.494025 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_exercise.not_null_fact_orders_sk_ship.c82a3b72ed"
[0m17:25:43.495464 [debug] [Thread-4 (]: Began executing node test.dbt_exercise.not_null_fact_orders_sk_ship.c82a3b72ed
[0m17:25:43.501329 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_exercise.not_null_fact_orders_sk_ship.c82a3b72ed"
[0m17:25:43.505445 [debug] [Thread-4 (]: On test.dbt_exercise.not_null_fact_orders_sk_ship.c82a3b72ed: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "test.dbt_exercise.not_null_fact_orders_sk_ship.c82a3b72ed"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select sk_ship
from `corded-sunlight-464012-e2`.`dbt_dw_marts`.`fact_orders`
where sk_ship is null



  
  
      
    ) dbt_internal_test
[0m17:25:43.507212 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m17:25:43.509385 [info ] [Thread-3 (]: 16 of 59 PASS not_null_fact_orders_sk_employee ................................. [[32mPASS[0m in 2.19s]
[0m17:25:43.511430 [debug] [Thread-3 (]: Finished running node test.dbt_exercise.not_null_fact_orders_sk_employee.cf36d136ff
[0m17:25:43.512580 [debug] [Thread-3 (]: Began running node test.dbt_exercise.source_accepted_values_northwind_categories_category_name__Beverages__Condiments__Confections__Dairy_Products__Grains_Cereals__Meat_Poultry__Produce__Seafood.ea6d0ab2ae
[0m17:25:43.513615 [info ] [Thread-3 (]: 20 of 59 START test source_accepted_values_northwind_categories_category_name__Beverages__Condiments__Confections__Dairy_Products__Grains_Cereals__Meat_Poultry__Produce__Seafood  [RUN]
[0m17:25:43.515228 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_exercise.not_null_fact_orders_sk_employee.cf36d136ff, now test.dbt_exercise.source_accepted_values_northwind_categories_category_name__Beverages__Condiments__Confections__Dairy_Products__Grains_Cereals__Meat_Poultry__Produce__Seafood.ea6d0ab2ae)
[0m17:25:43.516604 [debug] [Thread-3 (]: Began compiling node test.dbt_exercise.source_accepted_values_northwind_categories_category_name__Beverages__Condiments__Confections__Dairy_Products__Grains_Cereals__Meat_Poultry__Produce__Seafood.ea6d0ab2ae
[0m17:25:43.540780 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_exercise.source_accepted_values_northwind_categories_category_name__Beverages__Condiments__Confections__Dairy_Products__Grains_Cereals__Meat_Poultry__Produce__Seafood.ea6d0ab2ae"
[0m17:25:43.610297 [debug] [Thread-3 (]: Began executing node test.dbt_exercise.source_accepted_values_northwind_categories_category_name__Beverages__Condiments__Confections__Dairy_Products__Grains_Cereals__Meat_Poultry__Produce__Seafood.ea6d0ab2ae
[0m17:25:43.615156 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_exercise.source_accepted_values_northwind_categories_category_name__Beverages__Condiments__Confections__Dairy_Products__Grains_Cereals__Meat_Poultry__Produce__Seafood.ea6d0ab2ae"
[0m17:25:43.619004 [debug] [Thread-3 (]: On test.dbt_exercise.source_accepted_values_northwind_categories_category_name__Beverages__Condiments__Confections__Dairy_Products__Grains_Cereals__Meat_Poultry__Produce__Seafood.ea6d0ab2ae: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "test.dbt_exercise.source_accepted_values_northwind_categories_category_name__Beverages__Condiments__Confections__Dairy_Products__Grains_Cereals__Meat_Poultry__Produce__Seafood.ea6d0ab2ae"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        category_name as value_field,
        count(*) as n_records

    from `corded-sunlight-464012-e2`.`dbt_dw_raw`.`categories`
    group by category_name

)

select *
from all_values
where value_field not in (
    'Beverages','Condiments','Confections','Dairy Products','Grains/Cereals','Meat/Poultry','Produce','Seafood'
)



  
  
      
    ) dbt_internal_test
[0m17:25:43.620211 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m17:25:43.675169 [info ] [Thread-1 (]: 15 of 59 PASS not_null_fact_orders_sk_customer ................................. [[32mPASS[0m in 2.39s]
[0m17:25:43.676820 [debug] [Thread-1 (]: Finished running node test.dbt_exercise.not_null_fact_orders_sk_customer.6134ecd4cd
[0m17:25:43.677702 [debug] [Thread-1 (]: Began running node test.dbt_exercise.source_not_null_northwind_categories_category_id.9a6df29828
[0m17:25:43.679192 [info ] [Thread-1 (]: 21 of 59 START test source_not_null_northwind_categories_category_id ........... [RUN]
[0m17:25:43.683682 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_exercise.not_null_fact_orders_sk_customer.6134ecd4cd, now test.dbt_exercise.source_not_null_northwind_categories_category_id.9a6df29828)
[0m17:25:43.685640 [debug] [Thread-1 (]: Began compiling node test.dbt_exercise.source_not_null_northwind_categories_category_id.9a6df29828
[0m17:25:43.694581 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_exercise.source_not_null_northwind_categories_category_id.9a6df29828"
[0m17:25:43.697969 [debug] [Thread-1 (]: Began executing node test.dbt_exercise.source_not_null_northwind_categories_category_id.9a6df29828
[0m17:25:43.703512 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_exercise.source_not_null_northwind_categories_category_id.9a6df29828"
[0m17:25:43.704818 [debug] [Thread-1 (]: On test.dbt_exercise.source_not_null_northwind_categories_category_id.9a6df29828: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "test.dbt_exercise.source_not_null_northwind_categories_category_id.9a6df29828"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select category_id
from `corded-sunlight-464012-e2`.`dbt_dw_raw`.`categories`
where category_id is null



  
  
      
    ) dbt_internal_test
[0m17:25:43.705819 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:25:43.864631 [info ] [Thread-2 (]: 18 of 59 PASS not_null_fact_orders_sk_product .................................. [[32mPASS[0m in 2.10s]
[0m17:25:43.866265 [debug] [Thread-2 (]: Finished running node test.dbt_exercise.not_null_fact_orders_sk_product.9e0a112d70
[0m17:25:43.867543 [debug] [Thread-2 (]: Began running node test.dbt_exercise.source_not_null_northwind_country_codes_country_code.c623b5676c
[0m17:25:43.868777 [info ] [Thread-2 (]: 22 of 59 START test source_not_null_northwind_country_codes_country_code ....... [RUN]
[0m17:25:43.869696 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_exercise.not_null_fact_orders_sk_product.9e0a112d70, now test.dbt_exercise.source_not_null_northwind_country_codes_country_code.c623b5676c)
[0m17:25:43.870264 [debug] [Thread-2 (]: Began compiling node test.dbt_exercise.source_not_null_northwind_country_codes_country_code.c623b5676c
[0m17:25:43.880282 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_exercise.source_not_null_northwind_country_codes_country_code.c623b5676c"
[0m17:25:43.882190 [debug] [Thread-2 (]: Began executing node test.dbt_exercise.source_not_null_northwind_country_codes_country_code.c623b5676c
[0m17:25:43.887834 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_exercise.source_not_null_northwind_country_codes_country_code.c623b5676c"
[0m17:25:43.889583 [debug] [Thread-2 (]: On test.dbt_exercise.source_not_null_northwind_country_codes_country_code.c623b5676c: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "test.dbt_exercise.source_not_null_northwind_country_codes_country_code.c623b5676c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select country_code
from `corded-sunlight-464012-e2`.`dbt_dw_raw`.`country_codes`
where country_code is null



  
  
      
    ) dbt_internal_test
[0m17:25:43.890492 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:25:44.668229 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:edea98b5-91d2-4870-83d7-73882c83bec2&page=queryresults
[0m17:25:44.699948 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:89cd86a8-1be2-4fc0-a688-b0f0c4ca5cce&page=queryresults
[0m17:25:44.757954 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:3f85aada-6da7-4b56-a67a-3bab734c9f83&page=queryresults
[0m17:25:44.921188 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:a3a1b943-d058-492c-95b1-b163055f2700&page=queryresults
[0m17:25:45.515200 [info ] [Thread-4 (]: 19 of 59 PASS not_null_fact_orders_sk_ship ..................................... [[32mPASS[0m in 2.03s]
[0m17:25:45.518195 [debug] [Thread-4 (]: Finished running node test.dbt_exercise.not_null_fact_orders_sk_ship.c82a3b72ed
[0m17:25:45.521197 [debug] [Thread-4 (]: Began running node test.dbt_exercise.source_not_null_northwind_customers_customer_id.dba99593d2
[0m17:25:45.519879 [info ] [Thread-3 (]: 20 of 59 PASS source_accepted_values_northwind_categories_category_name__Beverages__Condiments__Confections__Dairy_Products__Grains_Cereals__Meat_Poultry__Produce__Seafood  [[32mPASS[0m in 2.00s]
[0m17:25:45.526030 [info ] [Thread-1 (]: 21 of 59 PASS source_not_null_northwind_categories_category_id ................. [[32mPASS[0m in 1.84s]
[0m17:25:45.535742 [info ] [Thread-4 (]: 23 of 59 START test source_not_null_northwind_customers_customer_id ............ [RUN]
[0m17:25:45.538312 [debug] [Thread-3 (]: Finished running node test.dbt_exercise.source_accepted_values_northwind_categories_category_name__Beverages__Condiments__Confections__Dairy_Products__Grains_Cereals__Meat_Poultry__Produce__Seafood.ea6d0ab2ae
[0m17:25:45.540267 [debug] [Thread-1 (]: Finished running node test.dbt_exercise.source_not_null_northwind_categories_category_id.9a6df29828
[0m17:25:45.541601 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_exercise.not_null_fact_orders_sk_ship.c82a3b72ed, now test.dbt_exercise.source_not_null_northwind_customers_customer_id.dba99593d2)
[0m17:25:45.543271 [debug] [Thread-3 (]: Began running node test.dbt_exercise.source_not_null_northwind_dados_financeiros_data.cdd6b46fe7
[0m17:25:45.545034 [debug] [Thread-1 (]: Began running node test.dbt_exercise.source_not_null_northwind_employee_territories_employee_id.d7372217ec
[0m17:25:45.546421 [debug] [Thread-4 (]: Began compiling node test.dbt_exercise.source_not_null_northwind_customers_customer_id.dba99593d2
[0m17:25:45.547734 [info ] [Thread-3 (]: 24 of 59 START test source_not_null_northwind_dados_financeiros_data ........... [RUN]
[0m17:25:45.549095 [info ] [Thread-1 (]: 25 of 59 START test source_not_null_northwind_employee_territories_employee_id . [RUN]
[0m17:25:45.564596 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_exercise.source_not_null_northwind_customers_customer_id.dba99593d2"
[0m17:25:45.567077 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_exercise.source_accepted_values_northwind_categories_category_name__Beverages__Condiments__Confections__Dairy_Products__Grains_Cereals__Meat_Poultry__Produce__Seafood.ea6d0ab2ae, now test.dbt_exercise.source_not_null_northwind_dados_financeiros_data.cdd6b46fe7)
[0m17:25:45.568651 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_exercise.source_not_null_northwind_categories_category_id.9a6df29828, now test.dbt_exercise.source_not_null_northwind_employee_territories_employee_id.d7372217ec)
[0m17:25:45.570588 [debug] [Thread-3 (]: Began compiling node test.dbt_exercise.source_not_null_northwind_dados_financeiros_data.cdd6b46fe7
[0m17:25:45.572392 [debug] [Thread-1 (]: Began compiling node test.dbt_exercise.source_not_null_northwind_employee_territories_employee_id.d7372217ec
[0m17:25:45.573799 [debug] [Thread-4 (]: Began executing node test.dbt_exercise.source_not_null_northwind_customers_customer_id.dba99593d2
[0m17:25:45.592469 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_exercise.source_not_null_northwind_dados_financeiros_data.cdd6b46fe7"
[0m17:25:45.593624 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_exercise.source_not_null_northwind_employee_territories_employee_id.d7372217ec"
[0m17:25:45.597726 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_exercise.source_not_null_northwind_customers_customer_id.dba99593d2"
[0m17:25:45.601442 [debug] [Thread-1 (]: Began executing node test.dbt_exercise.source_not_null_northwind_employee_territories_employee_id.d7372217ec
[0m17:25:45.602414 [debug] [Thread-3 (]: Began executing node test.dbt_exercise.source_not_null_northwind_dados_financeiros_data.cdd6b46fe7
[0m17:25:45.607218 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_exercise.source_not_null_northwind_employee_territories_employee_id.d7372217ec"
[0m17:25:45.611404 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_exercise.source_not_null_northwind_dados_financeiros_data.cdd6b46fe7"
[0m17:25:45.612077 [debug] [Thread-4 (]: On test.dbt_exercise.source_not_null_northwind_customers_customer_id.dba99593d2: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "test.dbt_exercise.source_not_null_northwind_customers_customer_id.dba99593d2"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select customer_id
from `corded-sunlight-464012-e2`.`dbt_dw_raw`.`customers`
where customer_id is null



  
  
      
    ) dbt_internal_test
[0m17:25:45.614331 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m17:25:45.617830 [debug] [Thread-3 (]: On test.dbt_exercise.source_not_null_northwind_dados_financeiros_data.cdd6b46fe7: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "test.dbt_exercise.source_not_null_northwind_dados_financeiros_data.cdd6b46fe7"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select data
from `corded-sunlight-464012-e2`.`dbt_dw_raw`.`dados_financeiros`
where data is null



  
  
      
    ) dbt_internal_test
[0m17:25:45.618840 [debug] [Thread-1 (]: On test.dbt_exercise.source_not_null_northwind_employee_territories_employee_id.d7372217ec: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "test.dbt_exercise.source_not_null_northwind_employee_territories_employee_id.d7372217ec"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select employee_id
from `corded-sunlight-464012-e2`.`dbt_dw_raw`.`employee_territories`
where employee_id is null



  
  
      
    ) dbt_internal_test
[0m17:25:45.620025 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m17:25:45.621261 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:25:45.751328 [info ] [Thread-2 (]: 22 of 59 PASS source_not_null_northwind_country_codes_country_code ............. [[32mPASS[0m in 1.88s]
[0m17:25:45.753125 [debug] [Thread-2 (]: Finished running node test.dbt_exercise.source_not_null_northwind_country_codes_country_code.c623b5676c
[0m17:25:45.754508 [debug] [Thread-2 (]: Began running node test.dbt_exercise.source_not_null_northwind_employee_territories_territory_id.ae648a0b88
[0m17:25:45.756061 [info ] [Thread-2 (]: 26 of 59 START test source_not_null_northwind_employee_territories_territory_id  [RUN]
[0m17:25:45.757416 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_exercise.source_not_null_northwind_country_codes_country_code.c623b5676c, now test.dbt_exercise.source_not_null_northwind_employee_territories_territory_id.ae648a0b88)
[0m17:25:45.758953 [debug] [Thread-2 (]: Began compiling node test.dbt_exercise.source_not_null_northwind_employee_territories_territory_id.ae648a0b88
[0m17:25:45.769985 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_exercise.source_not_null_northwind_employee_territories_territory_id.ae648a0b88"
[0m17:25:45.772819 [debug] [Thread-2 (]: Began executing node test.dbt_exercise.source_not_null_northwind_employee_territories_territory_id.ae648a0b88
[0m17:25:45.779484 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_exercise.source_not_null_northwind_employee_territories_territory_id.ae648a0b88"
[0m17:25:45.780582 [debug] [Thread-2 (]: On test.dbt_exercise.source_not_null_northwind_employee_territories_territory_id.ae648a0b88: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "test.dbt_exercise.source_not_null_northwind_employee_territories_territory_id.ae648a0b88"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select territory_id
from `corded-sunlight-464012-e2`.`dbt_dw_raw`.`employee_territories`
where territory_id is null



  
  
      
    ) dbt_internal_test
[0m17:25:45.781214 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:25:46.694488 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:e89ebdcb-13b7-4bff-957a-f9b38093fdc6&page=queryresults
[0m17:25:46.696918 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:6ff5b8de-e1c0-425f-aad1-a510e758243d&page=queryresults
[0m17:25:46.705854 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:13c6591d-07ed-4fe1-bc1b-c3f1ccfc8ad3&page=queryresults
[0m17:25:46.910608 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:585f88d1-b168-4324-9e4d-5e4bcf8b76da&page=queryresults
[0m17:25:47.486614 [info ] [Thread-1 (]: 25 of 59 PASS source_not_null_northwind_employee_territories_employee_id ....... [[32mPASS[0m in 1.92s]
[0m17:25:47.487917 [debug] [Thread-1 (]: Finished running node test.dbt_exercise.source_not_null_northwind_employee_territories_employee_id.d7372217ec
[0m17:25:47.488759 [debug] [Thread-1 (]: Began running node test.dbt_exercise.source_not_null_northwind_employees_employee_id.829479a08c
[0m17:25:47.489591 [info ] [Thread-1 (]: 27 of 59 START test source_not_null_northwind_employees_employee_id ............ [RUN]
[0m17:25:47.490385 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_exercise.source_not_null_northwind_employee_territories_employee_id.d7372217ec, now test.dbt_exercise.source_not_null_northwind_employees_employee_id.829479a08c)
[0m17:25:47.491347 [debug] [Thread-1 (]: Began compiling node test.dbt_exercise.source_not_null_northwind_employees_employee_id.829479a08c
[0m17:25:47.500780 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_exercise.source_not_null_northwind_employees_employee_id.829479a08c"
[0m17:25:47.502390 [debug] [Thread-1 (]: Began executing node test.dbt_exercise.source_not_null_northwind_employees_employee_id.829479a08c
[0m17:25:47.506873 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_exercise.source_not_null_northwind_employees_employee_id.829479a08c"
[0m17:25:47.508655 [debug] [Thread-1 (]: On test.dbt_exercise.source_not_null_northwind_employees_employee_id.829479a08c: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "test.dbt_exercise.source_not_null_northwind_employees_employee_id.829479a08c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select employee_id
from `corded-sunlight-464012-e2`.`dbt_dw_raw`.`employees`
where employee_id is null



  
  
      
    ) dbt_internal_test
[0m17:25:47.512835 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:25:47.563554 [info ] [Thread-3 (]: 24 of 59 PASS source_not_null_northwind_dados_financeiros_data ................. [[32mPASS[0m in 2.00s]
[0m17:25:47.565154 [debug] [Thread-3 (]: Finished running node test.dbt_exercise.source_not_null_northwind_dados_financeiros_data.cdd6b46fe7
[0m17:25:47.566154 [debug] [Thread-3 (]: Began running node test.dbt_exercise.source_not_null_northwind_order_details_order_id.8acd43693e
[0m17:25:47.567888 [info ] [Thread-3 (]: 28 of 59 START test source_not_null_northwind_order_details_order_id ........... [RUN]
[0m17:25:47.572095 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_exercise.source_not_null_northwind_dados_financeiros_data.cdd6b46fe7, now test.dbt_exercise.source_not_null_northwind_order_details_order_id.8acd43693e)
[0m17:25:47.573780 [debug] [Thread-3 (]: Began compiling node test.dbt_exercise.source_not_null_northwind_order_details_order_id.8acd43693e
[0m17:25:47.583750 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_exercise.source_not_null_northwind_order_details_order_id.8acd43693e"
[0m17:25:47.585627 [debug] [Thread-3 (]: Began executing node test.dbt_exercise.source_not_null_northwind_order_details_order_id.8acd43693e
[0m17:25:47.591740 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_exercise.source_not_null_northwind_order_details_order_id.8acd43693e"
[0m17:25:47.593939 [debug] [Thread-3 (]: On test.dbt_exercise.source_not_null_northwind_order_details_order_id.8acd43693e: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "test.dbt_exercise.source_not_null_northwind_order_details_order_id.8acd43693e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select order_id
from `corded-sunlight-464012-e2`.`dbt_dw_raw`.`order_details`
where order_id is null



  
  
      
    ) dbt_internal_test
[0m17:25:47.595390 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m17:25:47.649012 [info ] [Thread-4 (]: 23 of 59 PASS source_not_null_northwind_customers_customer_id .................. [[32mPASS[0m in 2.11s]
[0m17:25:47.651154 [debug] [Thread-4 (]: Finished running node test.dbt_exercise.source_not_null_northwind_customers_customer_id.dba99593d2
[0m17:25:47.652562 [debug] [Thread-4 (]: Began running node test.dbt_exercise.source_not_null_northwind_order_details_product_id.c084f7ad12
[0m17:25:47.654125 [info ] [Thread-4 (]: 29 of 59 START test source_not_null_northwind_order_details_product_id ......... [RUN]
[0m17:25:47.656290 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_exercise.source_not_null_northwind_customers_customer_id.dba99593d2, now test.dbt_exercise.source_not_null_northwind_order_details_product_id.c084f7ad12)
[0m17:25:47.657745 [debug] [Thread-4 (]: Began compiling node test.dbt_exercise.source_not_null_northwind_order_details_product_id.c084f7ad12
[0m17:25:47.665578 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_exercise.source_not_null_northwind_order_details_product_id.c084f7ad12"
[0m17:25:47.667443 [debug] [Thread-4 (]: Began executing node test.dbt_exercise.source_not_null_northwind_order_details_product_id.c084f7ad12
[0m17:25:47.671243 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_exercise.source_not_null_northwind_order_details_product_id.c084f7ad12"
[0m17:25:47.672755 [debug] [Thread-4 (]: On test.dbt_exercise.source_not_null_northwind_order_details_product_id.c084f7ad12: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "test.dbt_exercise.source_not_null_northwind_order_details_product_id.c084f7ad12"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select product_id
from `corded-sunlight-464012-e2`.`dbt_dw_raw`.`order_details`
where product_id is null



  
  
      
    ) dbt_internal_test
[0m17:25:47.674298 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m17:25:47.724303 [info ] [Thread-2 (]: 26 of 59 PASS source_not_null_northwind_employee_territories_territory_id ...... [[32mPASS[0m in 1.97s]
[0m17:25:47.726166 [debug] [Thread-2 (]: Finished running node test.dbt_exercise.source_not_null_northwind_employee_territories_territory_id.ae648a0b88
[0m17:25:47.727703 [debug] [Thread-2 (]: Began running node test.dbt_exercise.source_not_null_northwind_orders_customer_id.3e09955b24
[0m17:25:47.729026 [info ] [Thread-2 (]: 30 of 59 START test source_not_null_northwind_orders_customer_id ............... [RUN]
[0m17:25:47.730426 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_exercise.source_not_null_northwind_employee_territories_territory_id.ae648a0b88, now test.dbt_exercise.source_not_null_northwind_orders_customer_id.3e09955b24)
[0m17:25:47.731589 [debug] [Thread-2 (]: Began compiling node test.dbt_exercise.source_not_null_northwind_orders_customer_id.3e09955b24
[0m17:25:47.741880 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_exercise.source_not_null_northwind_orders_customer_id.3e09955b24"
[0m17:25:47.743859 [debug] [Thread-2 (]: Began executing node test.dbt_exercise.source_not_null_northwind_orders_customer_id.3e09955b24
[0m17:25:47.749772 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_exercise.source_not_null_northwind_orders_customer_id.3e09955b24"
[0m17:25:47.751860 [debug] [Thread-2 (]: On test.dbt_exercise.source_not_null_northwind_orders_customer_id.3e09955b24: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "test.dbt_exercise.source_not_null_northwind_orders_customer_id.3e09955b24"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select customer_id
from `corded-sunlight-464012-e2`.`dbt_dw_raw`.`orders`
where customer_id is null



  
  
      
    ) dbt_internal_test
[0m17:25:47.753209 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:25:50.731054 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:25a20087-3b54-4915-afbe-bee48f819e2e&page=queryresults
[0m17:25:50.738961 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:b3b11bc9-0f88-4f51-bb61-9dfeb99ebae8&page=queryresults
[0m17:25:50.748560 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:523d74c0-716d-41cd-89bc-fbdee06241bb&page=queryresults
[0m17:25:50.887065 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:0e0ade45-1a0b-4403-a6b4-91613ac7da1e&page=queryresults
[0m17:25:51.537694 [info ] [Thread-4 (]: 29 of 59 PASS source_not_null_northwind_order_details_product_id ............... [[32mPASS[0m in 3.88s]
[0m17:25:51.538871 [debug] [Thread-4 (]: Finished running node test.dbt_exercise.source_not_null_northwind_order_details_product_id.c084f7ad12
[0m17:25:51.539582 [debug] [Thread-4 (]: Began running node test.dbt_exercise.source_not_null_northwind_orders_employee_id.a8f4bf5ca3
[0m17:25:51.540426 [info ] [Thread-4 (]: 31 of 59 START test source_not_null_northwind_orders_employee_id ............... [RUN]
[0m17:25:51.542164 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_exercise.source_not_null_northwind_order_details_product_id.c084f7ad12, now test.dbt_exercise.source_not_null_northwind_orders_employee_id.a8f4bf5ca3)
[0m17:25:51.543506 [debug] [Thread-4 (]: Began compiling node test.dbt_exercise.source_not_null_northwind_orders_employee_id.a8f4bf5ca3
[0m17:25:51.551167 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_exercise.source_not_null_northwind_orders_employee_id.a8f4bf5ca3"
[0m17:25:51.552050 [debug] [Thread-4 (]: Began executing node test.dbt_exercise.source_not_null_northwind_orders_employee_id.a8f4bf5ca3
[0m17:25:51.555669 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_exercise.source_not_null_northwind_orders_employee_id.a8f4bf5ca3"
[0m17:25:51.556962 [debug] [Thread-4 (]: On test.dbt_exercise.source_not_null_northwind_orders_employee_id.a8f4bf5ca3: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "test.dbt_exercise.source_not_null_northwind_orders_employee_id.a8f4bf5ca3"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select employee_id
from `corded-sunlight-464012-e2`.`dbt_dw_raw`.`orders`
where employee_id is null



  
  
      
    ) dbt_internal_test
[0m17:25:51.558282 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m17:25:51.614491 [info ] [Thread-3 (]: 28 of 59 PASS source_not_null_northwind_order_details_order_id ................. [[32mPASS[0m in 4.04s]
[0m17:25:51.616563 [info ] [Thread-1 (]: 27 of 59 PASS source_not_null_northwind_employees_employee_id .................. [[32mPASS[0m in 4.13s]
[0m17:25:51.618796 [debug] [Thread-3 (]: Finished running node test.dbt_exercise.source_not_null_northwind_order_details_order_id.8acd43693e
[0m17:25:51.620851 [debug] [Thread-1 (]: Finished running node test.dbt_exercise.source_not_null_northwind_employees_employee_id.829479a08c
[0m17:25:51.623251 [debug] [Thread-3 (]: Began running node test.dbt_exercise.source_not_null_northwind_orders_order_id.5a7c008c6e
[0m17:25:51.625236 [debug] [Thread-1 (]: Began running node test.dbt_exercise.source_not_null_northwind_products_product_id.1bc1aa1d1c
[0m17:25:51.626999 [info ] [Thread-3 (]: 32 of 59 START test source_not_null_northwind_orders_order_id .................. [RUN]
[0m17:25:51.628553 [info ] [Thread-1 (]: 33 of 59 START test source_not_null_northwind_products_product_id .............. [RUN]
[0m17:25:51.630021 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_exercise.source_not_null_northwind_order_details_order_id.8acd43693e, now test.dbt_exercise.source_not_null_northwind_orders_order_id.5a7c008c6e)
[0m17:25:51.631344 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_exercise.source_not_null_northwind_employees_employee_id.829479a08c, now test.dbt_exercise.source_not_null_northwind_products_product_id.1bc1aa1d1c)
[0m17:25:51.632543 [debug] [Thread-3 (]: Began compiling node test.dbt_exercise.source_not_null_northwind_orders_order_id.5a7c008c6e
[0m17:25:51.633523 [debug] [Thread-1 (]: Began compiling node test.dbt_exercise.source_not_null_northwind_products_product_id.1bc1aa1d1c
[0m17:25:51.643123 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_exercise.source_not_null_northwind_orders_order_id.5a7c008c6e"
[0m17:25:51.649353 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_exercise.source_not_null_northwind_products_product_id.1bc1aa1d1c"
[0m17:25:51.651019 [debug] [Thread-3 (]: Began executing node test.dbt_exercise.source_not_null_northwind_orders_order_id.5a7c008c6e
[0m17:25:51.656065 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_exercise.source_not_null_northwind_orders_order_id.5a7c008c6e"
[0m17:25:51.657266 [debug] [Thread-1 (]: Began executing node test.dbt_exercise.source_not_null_northwind_products_product_id.1bc1aa1d1c
[0m17:25:51.661965 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_exercise.source_not_null_northwind_products_product_id.1bc1aa1d1c"
[0m17:25:51.663016 [debug] [Thread-1 (]: On test.dbt_exercise.source_not_null_northwind_products_product_id.1bc1aa1d1c: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "test.dbt_exercise.source_not_null_northwind_products_product_id.1bc1aa1d1c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select product_id
from `corded-sunlight-464012-e2`.`dbt_dw_raw`.`products`
where product_id is null



  
  
      
    ) dbt_internal_test
[0m17:25:51.663811 [debug] [Thread-3 (]: On test.dbt_exercise.source_not_null_northwind_orders_order_id.5a7c008c6e: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "test.dbt_exercise.source_not_null_northwind_orders_order_id.5a7c008c6e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select order_id
from `corded-sunlight-464012-e2`.`dbt_dw_raw`.`orders`
where order_id is null



  
  
      
    ) dbt_internal_test
[0m17:25:51.664679 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:25:51.665366 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m17:25:51.754225 [info ] [Thread-2 (]: 30 of 59 PASS source_not_null_northwind_orders_customer_id ..................... [[32mPASS[0m in 4.02s]
[0m17:25:51.755507 [debug] [Thread-2 (]: Finished running node test.dbt_exercise.source_not_null_northwind_orders_customer_id.3e09955b24
[0m17:25:51.756198 [debug] [Thread-2 (]: Began running node test.dbt_exercise.source_not_null_northwind_region_region_id.c95367d9e3
[0m17:25:51.757052 [info ] [Thread-2 (]: 34 of 59 START test source_not_null_northwind_region_region_id ................. [RUN]
[0m17:25:51.758341 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_exercise.source_not_null_northwind_orders_customer_id.3e09955b24, now test.dbt_exercise.source_not_null_northwind_region_region_id.c95367d9e3)
[0m17:25:51.759342 [debug] [Thread-2 (]: Began compiling node test.dbt_exercise.source_not_null_northwind_region_region_id.c95367d9e3
[0m17:25:51.767030 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_exercise.source_not_null_northwind_region_region_id.c95367d9e3"
[0m17:25:51.768843 [debug] [Thread-2 (]: Began executing node test.dbt_exercise.source_not_null_northwind_region_region_id.c95367d9e3
[0m17:25:51.772818 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_exercise.source_not_null_northwind_region_region_id.c95367d9e3"
[0m17:25:51.774654 [debug] [Thread-2 (]: On test.dbt_exercise.source_not_null_northwind_region_region_id.c95367d9e3: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "test.dbt_exercise.source_not_null_northwind_region_region_id.c95367d9e3"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select region_id
from `corded-sunlight-464012-e2`.`dbt_dw_raw`.`region`
where region_id is null



  
  
      
    ) dbt_internal_test
[0m17:25:51.775354 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:25:52.770670 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:97e64e1e-d17a-4e4d-b909-fc94222e1ed8&page=queryresults
[0m17:25:52.771999 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:bcc8bda9-5611-4e31-b9d4-2d70e8f90ca1&page=queryresults
[0m17:25:52.775234 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:a96b34f8-24f8-4889-a2d6-ba657f0e652c&page=queryresults
[0m17:25:52.886465 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:92e51593-e612-4a94-9be6-40e21d89d968&page=queryresults
[0m17:25:53.594601 [info ] [Thread-3 (]: 32 of 59 PASS source_not_null_northwind_orders_order_id ........................ [[32mPASS[0m in 1.96s]
[0m17:25:53.600221 [debug] [Thread-3 (]: Finished running node test.dbt_exercise.source_not_null_northwind_orders_order_id.5a7c008c6e
[0m17:25:53.598352 [info ] [Thread-4 (]: 31 of 59 PASS source_not_null_northwind_orders_employee_id ..................... [[32mPASS[0m in 2.06s]
[0m17:25:53.602516 [debug] [Thread-3 (]: Began running node test.dbt_exercise.source_not_null_northwind_shippers_shipper_id.45221752ca
[0m17:25:53.604489 [debug] [Thread-4 (]: Finished running node test.dbt_exercise.source_not_null_northwind_orders_employee_id.a8f4bf5ca3
[0m17:25:53.606170 [info ] [Thread-3 (]: 35 of 59 START test source_not_null_northwind_shippers_shipper_id .............. [RUN]
[0m17:25:53.608146 [debug] [Thread-4 (]: Began running node test.dbt_exercise.source_not_null_northwind_suppliers_supplier_id.de5c4d0062
[0m17:25:53.609611 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_exercise.source_not_null_northwind_orders_order_id.5a7c008c6e, now test.dbt_exercise.source_not_null_northwind_shippers_shipper_id.45221752ca)
[0m17:25:53.610738 [info ] [Thread-4 (]: 36 of 59 START test source_not_null_northwind_suppliers_supplier_id ............ [RUN]
[0m17:25:53.612228 [debug] [Thread-3 (]: Began compiling node test.dbt_exercise.source_not_null_northwind_shippers_shipper_id.45221752ca
[0m17:25:53.613831 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_exercise.source_not_null_northwind_orders_employee_id.a8f4bf5ca3, now test.dbt_exercise.source_not_null_northwind_suppliers_supplier_id.de5c4d0062)
[0m17:25:53.643212 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_exercise.source_not_null_northwind_shippers_shipper_id.45221752ca"
[0m17:25:53.648350 [debug] [Thread-4 (]: Began compiling node test.dbt_exercise.source_not_null_northwind_suppliers_supplier_id.de5c4d0062
[0m17:25:53.646865 [info ] [Thread-1 (]: 33 of 59 PASS source_not_null_northwind_products_product_id .................... [[32mPASS[0m in 2.02s]
[0m17:25:53.663550 [debug] [Thread-3 (]: Began executing node test.dbt_exercise.source_not_null_northwind_shippers_shipper_id.45221752ca
[0m17:25:53.667908 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_exercise.source_not_null_northwind_suppliers_supplier_id.de5c4d0062"
[0m17:25:53.670269 [debug] [Thread-1 (]: Finished running node test.dbt_exercise.source_not_null_northwind_products_product_id.1bc1aa1d1c
[0m17:25:53.675810 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_exercise.source_not_null_northwind_shippers_shipper_id.45221752ca"
[0m17:25:53.679043 [debug] [Thread-1 (]: Began running node test.dbt_exercise.source_not_null_northwind_territories_region_id.5df71bcf81
[0m17:25:53.682015 [debug] [Thread-4 (]: Began executing node test.dbt_exercise.source_not_null_northwind_suppliers_supplier_id.de5c4d0062
[0m17:25:53.684156 [info ] [Thread-1 (]: 37 of 59 START test source_not_null_northwind_territories_region_id ............ [RUN]
[0m17:25:53.688924 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_exercise.source_not_null_northwind_suppliers_supplier_id.de5c4d0062"
[0m17:25:53.690547 [debug] [Thread-3 (]: On test.dbt_exercise.source_not_null_northwind_shippers_shipper_id.45221752ca: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "test.dbt_exercise.source_not_null_northwind_shippers_shipper_id.45221752ca"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select shipper_id
from `corded-sunlight-464012-e2`.`dbt_dw_raw`.`shippers`
where shipper_id is null



  
  
      
    ) dbt_internal_test
[0m17:25:53.692117 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_exercise.source_not_null_northwind_products_product_id.1bc1aa1d1c, now test.dbt_exercise.source_not_null_northwind_territories_region_id.5df71bcf81)
[0m17:25:53.694166 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m17:25:53.695797 [debug] [Thread-1 (]: Began compiling node test.dbt_exercise.source_not_null_northwind_territories_region_id.5df71bcf81
[0m17:25:53.698826 [debug] [Thread-4 (]: On test.dbt_exercise.source_not_null_northwind_suppliers_supplier_id.de5c4d0062: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "test.dbt_exercise.source_not_null_northwind_suppliers_supplier_id.de5c4d0062"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select supplier_id
from `corded-sunlight-464012-e2`.`dbt_dw_raw`.`suppliers`
where supplier_id is null



  
  
      
    ) dbt_internal_test
[0m17:25:53.710436 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_exercise.source_not_null_northwind_territories_region_id.5df71bcf81"
[0m17:25:53.715456 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m17:25:53.718271 [info ] [Thread-2 (]: 34 of 59 PASS source_not_null_northwind_region_region_id ....................... [[32mPASS[0m in 1.96s]
[0m17:25:53.722701 [debug] [Thread-1 (]: Began executing node test.dbt_exercise.source_not_null_northwind_territories_region_id.5df71bcf81
[0m17:25:53.766425 [debug] [Thread-2 (]: Finished running node test.dbt_exercise.source_not_null_northwind_region_region_id.c95367d9e3
[0m17:25:53.770674 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_exercise.source_not_null_northwind_territories_region_id.5df71bcf81"
[0m17:25:53.771993 [debug] [Thread-2 (]: Began running node test.dbt_exercise.source_not_null_northwind_territories_territory_id.9b9655b8a9
[0m17:25:53.776868 [debug] [Thread-1 (]: On test.dbt_exercise.source_not_null_northwind_territories_region_id.5df71bcf81: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "test.dbt_exercise.source_not_null_northwind_territories_region_id.5df71bcf81"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select region_id
from `corded-sunlight-464012-e2`.`dbt_dw_raw`.`territories`
where region_id is null



  
  
      
    ) dbt_internal_test
[0m17:25:53.815289 [info ] [Thread-2 (]: 38 of 59 START test source_not_null_northwind_territories_territory_id ......... [RUN]
[0m17:25:53.818087 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:25:53.819101 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_exercise.source_not_null_northwind_region_region_id.c95367d9e3, now test.dbt_exercise.source_not_null_northwind_territories_territory_id.9b9655b8a9)
[0m17:25:53.820368 [debug] [Thread-2 (]: Began compiling node test.dbt_exercise.source_not_null_northwind_territories_territory_id.9b9655b8a9
[0m17:25:53.827700 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_exercise.source_not_null_northwind_territories_territory_id.9b9655b8a9"
[0m17:25:53.873397 [debug] [Thread-2 (]: Began executing node test.dbt_exercise.source_not_null_northwind_territories_territory_id.9b9655b8a9
[0m17:25:53.877973 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_exercise.source_not_null_northwind_territories_territory_id.9b9655b8a9"
[0m17:25:53.879659 [debug] [Thread-2 (]: On test.dbt_exercise.source_not_null_northwind_territories_territory_id.9b9655b8a9: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "test.dbt_exercise.source_not_null_northwind_territories_territory_id.9b9655b8a9"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select territory_id
from `corded-sunlight-464012-e2`.`dbt_dw_raw`.`territories`
where territory_id is null



  
  
      
    ) dbt_internal_test
[0m17:25:53.880484 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:25:54.713287 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:84eb2e28-14f0-4d32-b322-27bd4b13a059&page=queryresults
[0m17:25:54.760688 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:f9a49005-14c2-473f-b6db-c84be9b849b1&page=queryresults
[0m17:25:54.844627 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:422aa213-6448-4d3e-9f57-19195f1e556a&page=queryresults
[0m17:25:54.950912 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:45174349-6083-49a6-ad96-326f41195946&page=queryresults
[0m17:25:55.475979 [info ] [Thread-3 (]: 35 of 59 PASS source_not_null_northwind_shippers_shipper_id .................... [[32mPASS[0m in 1.87s]
[0m17:25:55.477930 [debug] [Thread-3 (]: Finished running node test.dbt_exercise.source_not_null_northwind_shippers_shipper_id.45221752ca
[0m17:25:55.478764 [debug] [Thread-3 (]: Began running node test.dbt_exercise.source_not_null_northwind_us_states_state_id.2e33a23d78
[0m17:25:55.479541 [info ] [Thread-3 (]: 39 of 59 START test source_not_null_northwind_us_states_state_id ............... [RUN]
[0m17:25:55.480456 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_exercise.source_not_null_northwind_shippers_shipper_id.45221752ca, now test.dbt_exercise.source_not_null_northwind_us_states_state_id.2e33a23d78)
[0m17:25:55.481460 [debug] [Thread-3 (]: Began compiling node test.dbt_exercise.source_not_null_northwind_us_states_state_id.2e33a23d78
[0m17:25:55.489330 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_exercise.source_not_null_northwind_us_states_state_id.2e33a23d78"
[0m17:25:55.490732 [debug] [Thread-3 (]: Began executing node test.dbt_exercise.source_not_null_northwind_us_states_state_id.2e33a23d78
[0m17:25:55.498169 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_exercise.source_not_null_northwind_us_states_state_id.2e33a23d78"
[0m17:25:55.500175 [debug] [Thread-3 (]: On test.dbt_exercise.source_not_null_northwind_us_states_state_id.2e33a23d78: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "test.dbt_exercise.source_not_null_northwind_us_states_state_id.2e33a23d78"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select state_id
from `corded-sunlight-464012-e2`.`dbt_dw_raw`.`us_states`
where state_id is null



  
  
      
    ) dbt_internal_test
[0m17:25:55.500982 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m17:25:55.584953 [info ] [Thread-4 (]: 36 of 59 PASS source_not_null_northwind_suppliers_supplier_id .................. [[32mPASS[0m in 1.97s]
[0m17:25:55.586216 [debug] [Thread-4 (]: Finished running node test.dbt_exercise.source_not_null_northwind_suppliers_supplier_id.de5c4d0062
[0m17:25:55.586964 [debug] [Thread-4 (]: Began running node test.dbt_exercise.source_unique_northwind_categories_category_id.17d9baa2e0
[0m17:25:55.587733 [info ] [Thread-4 (]: 40 of 59 START test source_unique_northwind_categories_category_id ............. [RUN]
[0m17:25:55.588503 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_exercise.source_not_null_northwind_suppliers_supplier_id.de5c4d0062, now test.dbt_exercise.source_unique_northwind_categories_category_id.17d9baa2e0)
[0m17:25:55.589105 [debug] [Thread-4 (]: Began compiling node test.dbt_exercise.source_unique_northwind_categories_category_id.17d9baa2e0
[0m17:25:55.602959 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_exercise.source_unique_northwind_categories_category_id.17d9baa2e0"
[0m17:25:55.604110 [debug] [Thread-4 (]: Began executing node test.dbt_exercise.source_unique_northwind_categories_category_id.17d9baa2e0
[0m17:25:55.608125 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_exercise.source_unique_northwind_categories_category_id.17d9baa2e0"
[0m17:25:55.610093 [debug] [Thread-4 (]: On test.dbt_exercise.source_unique_northwind_categories_category_id.17d9baa2e0: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "test.dbt_exercise.source_unique_northwind_categories_category_id.17d9baa2e0"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with dbt_test__target as (

  select category_id as unique_field
  from `corded-sunlight-464012-e2`.`dbt_dw_raw`.`categories`
  where category_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m17:25:55.612384 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m17:25:55.615486 [info ] [Thread-1 (]: 37 of 59 PASS source_not_null_northwind_territories_region_id .................. [[32mPASS[0m in 1.92s]
[0m17:25:55.617279 [debug] [Thread-1 (]: Finished running node test.dbt_exercise.source_not_null_northwind_territories_region_id.5df71bcf81
[0m17:25:55.618495 [debug] [Thread-1 (]: Began running node test.dbt_exercise.source_unique_northwind_country_codes_country_code.cf83d0431e
[0m17:25:55.619488 [info ] [Thread-1 (]: 41 of 59 START test source_unique_northwind_country_codes_country_code ......... [RUN]
[0m17:25:55.620469 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_exercise.source_not_null_northwind_territories_region_id.5df71bcf81, now test.dbt_exercise.source_unique_northwind_country_codes_country_code.cf83d0431e)
[0m17:25:55.622970 [debug] [Thread-1 (]: Began compiling node test.dbt_exercise.source_unique_northwind_country_codes_country_code.cf83d0431e
[0m17:25:55.671539 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_exercise.source_unique_northwind_country_codes_country_code.cf83d0431e"
[0m17:25:55.673077 [debug] [Thread-1 (]: Began executing node test.dbt_exercise.source_unique_northwind_country_codes_country_code.cf83d0431e
[0m17:25:55.677831 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_exercise.source_unique_northwind_country_codes_country_code.cf83d0431e"
[0m17:25:55.679216 [debug] [Thread-1 (]: On test.dbt_exercise.source_unique_northwind_country_codes_country_code.cf83d0431e: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "test.dbt_exercise.source_unique_northwind_country_codes_country_code.cf83d0431e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with dbt_test__target as (

  select country_code as unique_field
  from `corded-sunlight-464012-e2`.`dbt_dw_raw`.`country_codes`
  where country_code is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m17:25:55.679955 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:25:55.747329 [info ] [Thread-2 (]: 38 of 59 PASS source_not_null_northwind_territories_territory_id ............... [[32mPASS[0m in 1.93s]
[0m17:25:55.748470 [debug] [Thread-2 (]: Finished running node test.dbt_exercise.source_not_null_northwind_territories_territory_id.9b9655b8a9
[0m17:25:55.749124 [debug] [Thread-2 (]: Began running node test.dbt_exercise.source_unique_northwind_customers_customer_id.ff818c137b
[0m17:25:55.749961 [info ] [Thread-2 (]: 42 of 59 START test source_unique_northwind_customers_customer_id .............. [RUN]
[0m17:25:55.750794 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_exercise.source_not_null_northwind_territories_territory_id.9b9655b8a9, now test.dbt_exercise.source_unique_northwind_customers_customer_id.ff818c137b)
[0m17:25:55.751429 [debug] [Thread-2 (]: Began compiling node test.dbt_exercise.source_unique_northwind_customers_customer_id.ff818c137b
[0m17:25:55.761011 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_exercise.source_unique_northwind_customers_customer_id.ff818c137b"
[0m17:25:55.762448 [debug] [Thread-2 (]: Began executing node test.dbt_exercise.source_unique_northwind_customers_customer_id.ff818c137b
[0m17:25:55.767662 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_exercise.source_unique_northwind_customers_customer_id.ff818c137b"
[0m17:25:55.771202 [debug] [Thread-2 (]: On test.dbt_exercise.source_unique_northwind_customers_customer_id.ff818c137b: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "test.dbt_exercise.source_unique_northwind_customers_customer_id.ff818c137b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with dbt_test__target as (

  select customer_id as unique_field
  from `corded-sunlight-464012-e2`.`dbt_dw_raw`.`customers`
  where customer_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m17:25:55.772852 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:25:56.490216 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:0334e24a-68ae-4fa1-89f5-f072337f5e91&page=queryresults
[0m17:25:56.577117 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:0707b284-9495-47a1-9d42-4d1f8c249258&page=queryresults
[0m17:25:56.614712 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:570c0c18-9b47-4abc-a674-316cfa64ac75&page=queryresults
[0m17:25:56.719825 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:2a127d90-0522-4ac2-b2ff-f45ae5ef0c83&page=queryresults
[0m17:25:57.212736 [info ] [Thread-3 (]: 39 of 59 PASS source_not_null_northwind_us_states_state_id ..................... [[32mPASS[0m in 1.73s]
[0m17:25:57.214087 [debug] [Thread-3 (]: Finished running node test.dbt_exercise.source_not_null_northwind_us_states_state_id.2e33a23d78
[0m17:25:57.214955 [debug] [Thread-3 (]: Began running node test.dbt_exercise.source_unique_northwind_employees_employee_id.e63c624594
[0m17:25:57.215881 [info ] [Thread-3 (]: 43 of 59 START test source_unique_northwind_employees_employee_id .............. [RUN]
[0m17:25:57.216841 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_exercise.source_not_null_northwind_us_states_state_id.2e33a23d78, now test.dbt_exercise.source_unique_northwind_employees_employee_id.e63c624594)
[0m17:25:57.217745 [debug] [Thread-3 (]: Began compiling node test.dbt_exercise.source_unique_northwind_employees_employee_id.e63c624594
[0m17:25:57.226508 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_exercise.source_unique_northwind_employees_employee_id.e63c624594"
[0m17:25:57.229236 [debug] [Thread-3 (]: Began executing node test.dbt_exercise.source_unique_northwind_employees_employee_id.e63c624594
[0m17:25:57.234468 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_exercise.source_unique_northwind_employees_employee_id.e63c624594"
[0m17:25:57.235717 [debug] [Thread-3 (]: On test.dbt_exercise.source_unique_northwind_employees_employee_id.e63c624594: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "test.dbt_exercise.source_unique_northwind_employees_employee_id.e63c624594"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with dbt_test__target as (

  select employee_id as unique_field
  from `corded-sunlight-464012-e2`.`dbt_dw_raw`.`employees`
  where employee_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m17:25:57.236689 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m17:25:57.351753 [info ] [Thread-4 (]: 40 of 59 PASS source_unique_northwind_categories_category_id ................... [[32mPASS[0m in 1.76s]
[0m17:25:57.353189 [debug] [Thread-4 (]: Finished running node test.dbt_exercise.source_unique_northwind_categories_category_id.17d9baa2e0
[0m17:25:57.354346 [debug] [Thread-4 (]: Began running node test.dbt_exercise.source_unique_northwind_orders_order_id.4a8a4df128
[0m17:25:57.355379 [info ] [Thread-4 (]: 44 of 59 START test source_unique_northwind_orders_order_id .................... [RUN]
[0m17:25:57.356475 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_exercise.source_unique_northwind_categories_category_id.17d9baa2e0, now test.dbt_exercise.source_unique_northwind_orders_order_id.4a8a4df128)
[0m17:25:57.357189 [debug] [Thread-4 (]: Began compiling node test.dbt_exercise.source_unique_northwind_orders_order_id.4a8a4df128
[0m17:25:57.366891 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_exercise.source_unique_northwind_orders_order_id.4a8a4df128"
[0m17:25:57.368420 [debug] [Thread-4 (]: Began executing node test.dbt_exercise.source_unique_northwind_orders_order_id.4a8a4df128
[0m17:25:57.373558 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_exercise.source_unique_northwind_orders_order_id.4a8a4df128"
[0m17:25:57.376825 [debug] [Thread-4 (]: On test.dbt_exercise.source_unique_northwind_orders_order_id.4a8a4df128: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "test.dbt_exercise.source_unique_northwind_orders_order_id.4a8a4df128"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with dbt_test__target as (

  select order_id as unique_field
  from `corded-sunlight-464012-e2`.`dbt_dw_raw`.`orders`
  where order_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m17:25:57.378884 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m17:25:57.384559 [info ] [Thread-1 (]: 41 of 59 PASS source_unique_northwind_country_codes_country_code ............... [[32mPASS[0m in 1.76s]
[0m17:25:57.386252 [debug] [Thread-1 (]: Finished running node test.dbt_exercise.source_unique_northwind_country_codes_country_code.cf83d0431e
[0m17:25:57.387472 [debug] [Thread-1 (]: Began running node test.dbt_exercise.source_unique_northwind_products_product_id.740bf6f9a5
[0m17:25:57.388562 [info ] [Thread-1 (]: 45 of 59 START test source_unique_northwind_products_product_id ................ [RUN]
[0m17:25:57.390532 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_exercise.source_unique_northwind_country_codes_country_code.cf83d0431e, now test.dbt_exercise.source_unique_northwind_products_product_id.740bf6f9a5)
[0m17:25:57.392515 [debug] [Thread-1 (]: Began compiling node test.dbt_exercise.source_unique_northwind_products_product_id.740bf6f9a5
[0m17:25:57.401962 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_exercise.source_unique_northwind_products_product_id.740bf6f9a5"
[0m17:25:57.439953 [debug] [Thread-1 (]: Began executing node test.dbt_exercise.source_unique_northwind_products_product_id.740bf6f9a5
[0m17:25:57.443849 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_exercise.source_unique_northwind_products_product_id.740bf6f9a5"
[0m17:25:57.445064 [debug] [Thread-1 (]: On test.dbt_exercise.source_unique_northwind_products_product_id.740bf6f9a5: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "test.dbt_exercise.source_unique_northwind_products_product_id.740bf6f9a5"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with dbt_test__target as (

  select product_id as unique_field
  from `corded-sunlight-464012-e2`.`dbt_dw_raw`.`products`
  where product_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m17:25:57.445928 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:25:57.513412 [info ] [Thread-2 (]: 42 of 59 PASS source_unique_northwind_customers_customer_id .................... [[32mPASS[0m in 1.76s]
[0m17:25:57.514443 [debug] [Thread-2 (]: Finished running node test.dbt_exercise.source_unique_northwind_customers_customer_id.ff818c137b
[0m17:25:57.515065 [debug] [Thread-2 (]: Began running node test.dbt_exercise.source_unique_northwind_region_region_id.9688f1f5fd
[0m17:25:57.516033 [info ] [Thread-2 (]: 46 of 59 START test source_unique_northwind_region_region_id ................... [RUN]
[0m17:25:57.517180 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_exercise.source_unique_northwind_customers_customer_id.ff818c137b, now test.dbt_exercise.source_unique_northwind_region_region_id.9688f1f5fd)
[0m17:25:57.517840 [debug] [Thread-2 (]: Began compiling node test.dbt_exercise.source_unique_northwind_region_region_id.9688f1f5fd
[0m17:25:57.523870 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_exercise.source_unique_northwind_region_region_id.9688f1f5fd"
[0m17:25:57.525596 [debug] [Thread-2 (]: Began executing node test.dbt_exercise.source_unique_northwind_region_region_id.9688f1f5fd
[0m17:25:57.530205 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_exercise.source_unique_northwind_region_region_id.9688f1f5fd"
[0m17:25:57.531473 [debug] [Thread-2 (]: On test.dbt_exercise.source_unique_northwind_region_region_id.9688f1f5fd: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "test.dbt_exercise.source_unique_northwind_region_region_id.9688f1f5fd"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with dbt_test__target as (

  select region_id as unique_field
  from `corded-sunlight-464012-e2`.`dbt_dw_raw`.`region`
  where region_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m17:25:57.532346 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:25:58.198445 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:65941558-a7d4-483a-99f9-b08ca919b368&page=queryresults
[0m17:25:58.264437 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:faaf9306-5fb3-44cb-bd9c-aa1d5d09e93f&page=queryresults
[0m17:25:58.341009 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:4cc65cfa-f1b1-457d-9d50-f28838acb71d&page=queryresults
[0m17:25:58.467561 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:9e22bf28-17e1-4297-aa91-1564a3508358&page=queryresults
[0m17:25:58.960525 [info ] [Thread-3 (]: 43 of 59 PASS source_unique_northwind_employees_employee_id .................... [[32mPASS[0m in 1.74s]
[0m17:25:58.962947 [debug] [Thread-3 (]: Finished running node test.dbt_exercise.source_unique_northwind_employees_employee_id.e63c624594
[0m17:25:58.963948 [debug] [Thread-3 (]: Began running node test.dbt_exercise.source_unique_northwind_shippers_shipper_id.61edb3f736
[0m17:25:58.965368 [info ] [Thread-3 (]: 47 of 59 START test source_unique_northwind_shippers_shipper_id ................ [RUN]
[0m17:25:58.966954 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_exercise.source_unique_northwind_employees_employee_id.e63c624594, now test.dbt_exercise.source_unique_northwind_shippers_shipper_id.61edb3f736)
[0m17:25:58.967877 [debug] [Thread-3 (]: Began compiling node test.dbt_exercise.source_unique_northwind_shippers_shipper_id.61edb3f736
[0m17:25:58.978447 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_exercise.source_unique_northwind_shippers_shipper_id.61edb3f736"
[0m17:25:58.985526 [debug] [Thread-3 (]: Began executing node test.dbt_exercise.source_unique_northwind_shippers_shipper_id.61edb3f736
[0m17:25:58.990516 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_exercise.source_unique_northwind_shippers_shipper_id.61edb3f736"
[0m17:25:58.991739 [debug] [Thread-3 (]: On test.dbt_exercise.source_unique_northwind_shippers_shipper_id.61edb3f736: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "test.dbt_exercise.source_unique_northwind_shippers_shipper_id.61edb3f736"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with dbt_test__target as (

  select shipper_id as unique_field
  from `corded-sunlight-464012-e2`.`dbt_dw_raw`.`shippers`
  where shipper_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m17:25:58.992587 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m17:25:59.075084 [info ] [Thread-4 (]: 44 of 59 PASS source_unique_northwind_orders_order_id .......................... [[32mPASS[0m in 1.72s]
[0m17:25:59.076323 [debug] [Thread-4 (]: Finished running node test.dbt_exercise.source_unique_northwind_orders_order_id.4a8a4df128
[0m17:25:59.077198 [debug] [Thread-4 (]: Began running node test.dbt_exercise.source_unique_northwind_suppliers_supplier_id.aa7461739b
[0m17:25:59.078297 [info ] [Thread-4 (]: 48 of 59 START test source_unique_northwind_suppliers_supplier_id .............. [RUN]
[0m17:25:59.079162 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_exercise.source_unique_northwind_orders_order_id.4a8a4df128, now test.dbt_exercise.source_unique_northwind_suppliers_supplier_id.aa7461739b)
[0m17:25:59.079766 [debug] [Thread-4 (]: Began compiling node test.dbt_exercise.source_unique_northwind_suppliers_supplier_id.aa7461739b
[0m17:25:59.089867 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_exercise.source_unique_northwind_suppliers_supplier_id.aa7461739b"
[0m17:25:59.092305 [info ] [Thread-1 (]: 45 of 59 PASS source_unique_northwind_products_product_id ...................... [[32mPASS[0m in 1.70s]
[0m17:25:59.093343 [debug] [Thread-4 (]: Began executing node test.dbt_exercise.source_unique_northwind_suppliers_supplier_id.aa7461739b
[0m17:25:59.094357 [debug] [Thread-1 (]: Finished running node test.dbt_exercise.source_unique_northwind_products_product_id.740bf6f9a5
[0m17:25:59.097925 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_exercise.source_unique_northwind_suppliers_supplier_id.aa7461739b"
[0m17:25:59.098910 [debug] [Thread-1 (]: Began running node test.dbt_exercise.source_unique_northwind_territories_territory_id.08bc548860
[0m17:25:59.101047 [info ] [Thread-1 (]: 49 of 59 START test source_unique_northwind_territories_territory_id ........... [RUN]
[0m17:25:59.103015 [debug] [Thread-4 (]: On test.dbt_exercise.source_unique_northwind_suppliers_supplier_id.aa7461739b: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "test.dbt_exercise.source_unique_northwind_suppliers_supplier_id.aa7461739b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with dbt_test__target as (

  select supplier_id as unique_field
  from `corded-sunlight-464012-e2`.`dbt_dw_raw`.`suppliers`
  where supplier_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m17:25:59.104270 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_exercise.source_unique_northwind_products_product_id.740bf6f9a5, now test.dbt_exercise.source_unique_northwind_territories_territory_id.08bc548860)
[0m17:25:59.105609 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m17:25:59.106877 [debug] [Thread-1 (]: Began compiling node test.dbt_exercise.source_unique_northwind_territories_territory_id.08bc548860
[0m17:25:59.113479 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_exercise.source_unique_northwind_territories_territory_id.08bc548860"
[0m17:25:59.115186 [debug] [Thread-1 (]: Began executing node test.dbt_exercise.source_unique_northwind_territories_territory_id.08bc548860
[0m17:25:59.120437 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_exercise.source_unique_northwind_territories_territory_id.08bc548860"
[0m17:25:59.122691 [debug] [Thread-1 (]: On test.dbt_exercise.source_unique_northwind_territories_territory_id.08bc548860: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "test.dbt_exercise.source_unique_northwind_territories_territory_id.08bc548860"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with dbt_test__target as (

  select territory_id as unique_field
  from `corded-sunlight-464012-e2`.`dbt_dw_raw`.`territories`
  where territory_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m17:25:59.124070 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:25:59.234629 [info ] [Thread-2 (]: 46 of 59 PASS source_unique_northwind_region_region_id ......................... [[32mPASS[0m in 1.72s]
[0m17:25:59.237115 [debug] [Thread-2 (]: Finished running node test.dbt_exercise.source_unique_northwind_region_region_id.9688f1f5fd
[0m17:25:59.238040 [debug] [Thread-2 (]: Began running node test.dbt_exercise.source_unique_northwind_us_states_state_id.c374c85cda
[0m17:25:59.238798 [info ] [Thread-2 (]: 50 of 59 START test source_unique_northwind_us_states_state_id ................. [RUN]
[0m17:25:59.239539 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_exercise.source_unique_northwind_region_region_id.9688f1f5fd, now test.dbt_exercise.source_unique_northwind_us_states_state_id.c374c85cda)
[0m17:25:59.240143 [debug] [Thread-2 (]: Began compiling node test.dbt_exercise.source_unique_northwind_us_states_state_id.c374c85cda
[0m17:25:59.246411 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_exercise.source_unique_northwind_us_states_state_id.c374c85cda"
[0m17:25:59.247354 [debug] [Thread-2 (]: Began executing node test.dbt_exercise.source_unique_northwind_us_states_state_id.c374c85cda
[0m17:25:59.253424 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_exercise.source_unique_northwind_us_states_state_id.c374c85cda"
[0m17:25:59.255046 [debug] [Thread-2 (]: On test.dbt_exercise.source_unique_northwind_us_states_state_id.c374c85cda: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "test.dbt_exercise.source_unique_northwind_us_states_state_id.c374c85cda"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with dbt_test__target as (

  select state_id as unique_field
  from `corded-sunlight-464012-e2`.`dbt_dw_raw`.`us_states`
  where state_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m17:25:59.255822 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:26:00.074874 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:20a03c6f-d638-490f-93db-3eee988111ce&page=queryresults
[0m17:26:00.175792 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:9e51d324-49cd-4fa9-93a1-e772c603a133&page=queryresults
[0m17:26:00.178757 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:88774675-2875-4cf9-8ec8-3413101f4c58&page=queryresults
[0m17:26:00.826183 [info ] [Thread-4 (]: 48 of 59 PASS source_unique_northwind_suppliers_supplier_id .................... [[32mPASS[0m in 1.75s]
[0m17:26:00.827808 [debug] [Thread-4 (]: Finished running node test.dbt_exercise.source_unique_northwind_suppliers_supplier_id.aa7461739b
[0m17:26:00.828871 [debug] [Thread-4 (]: Began running node test.dbt_exercise.unique_dim_customers_customer_id.15c9f1e2fd
[0m17:26:00.829955 [info ] [Thread-4 (]: 51 of 59 START test unique_dim_customers_customer_id ........................... [RUN]
[0m17:26:00.830802 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_exercise.source_unique_northwind_suppliers_supplier_id.aa7461739b, now test.dbt_exercise.unique_dim_customers_customer_id.15c9f1e2fd)
[0m17:26:00.831382 [debug] [Thread-4 (]: Began compiling node test.dbt_exercise.unique_dim_customers_customer_id.15c9f1e2fd
[0m17:26:00.838490 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_exercise.unique_dim_customers_customer_id.15c9f1e2fd"
[0m17:26:00.840126 [debug] [Thread-4 (]: Began executing node test.dbt_exercise.unique_dim_customers_customer_id.15c9f1e2fd
[0m17:26:00.847193 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_exercise.unique_dim_customers_customer_id.15c9f1e2fd"
[0m17:26:00.848507 [debug] [Thread-4 (]: On test.dbt_exercise.unique_dim_customers_customer_id.15c9f1e2fd: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "test.dbt_exercise.unique_dim_customers_customer_id.15c9f1e2fd"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with dbt_test__target as (

  select customer_id as unique_field
  from `corded-sunlight-464012-e2`.`dbt_dw_marts`.`dim_customers`
  where customer_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m17:26:00.850188 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m17:26:00.905948 [info ] [Thread-2 (]: 50 of 59 PASS source_unique_northwind_us_states_state_id ....................... [[32mPASS[0m in 1.67s]
[0m17:26:00.908295 [debug] [Thread-2 (]: Finished running node test.dbt_exercise.source_unique_northwind_us_states_state_id.c374c85cda
[0m17:26:00.909581 [debug] [Thread-2 (]: Began running node test.dbt_exercise.unique_dim_customers_customer_sk.22a014df62
[0m17:26:00.910705 [info ] [Thread-2 (]: 52 of 59 START test unique_dim_customers_customer_sk ........................... [RUN]
[0m17:26:00.911704 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_exercise.source_unique_northwind_us_states_state_id.c374c85cda, now test.dbt_exercise.unique_dim_customers_customer_sk.22a014df62)
[0m17:26:00.912455 [debug] [Thread-2 (]: Began compiling node test.dbt_exercise.unique_dim_customers_customer_sk.22a014df62
[0m17:26:00.922076 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_exercise.unique_dim_customers_customer_sk.22a014df62"
[0m17:26:00.924069 [debug] [Thread-2 (]: Began executing node test.dbt_exercise.unique_dim_customers_customer_sk.22a014df62
[0m17:26:00.931588 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_exercise.unique_dim_customers_customer_sk.22a014df62"
[0m17:26:00.933425 [debug] [Thread-2 (]: On test.dbt_exercise.unique_dim_customers_customer_sk.22a014df62: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "test.dbt_exercise.unique_dim_customers_customer_sk.22a014df62"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with dbt_test__target as (

  select customer_sk as unique_field
  from `corded-sunlight-464012-e2`.`dbt_dw_marts`.`dim_customers`
  where customer_sk is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m17:26:00.935028 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:26:00.984231 [info ] [Thread-1 (]: 49 of 59 PASS source_unique_northwind_territories_territory_id ................. [[32mPASS[0m in 1.88s]
[0m17:26:00.985782 [debug] [Thread-1 (]: Finished running node test.dbt_exercise.source_unique_northwind_territories_territory_id.08bc548860
[0m17:26:00.986811 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:96646a7d-313f-4bf0-bd4f-1707f56fdec7&page=queryresults
[0m17:26:00.987962 [debug] [Thread-1 (]: Began running node test.dbt_exercise.unique_dim_employees_employee_id.79828c8f30
[0m17:26:00.992736 [info ] [Thread-1 (]: 53 of 59 START test unique_dim_employees_employee_id ........................... [RUN]
[0m17:26:00.994143 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_exercise.source_unique_northwind_territories_territory_id.08bc548860, now test.dbt_exercise.unique_dim_employees_employee_id.79828c8f30)
[0m17:26:00.994871 [debug] [Thread-1 (]: Began compiling node test.dbt_exercise.unique_dim_employees_employee_id.79828c8f30
[0m17:26:01.000890 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_exercise.unique_dim_employees_employee_id.79828c8f30"
[0m17:26:01.002586 [debug] [Thread-1 (]: Began executing node test.dbt_exercise.unique_dim_employees_employee_id.79828c8f30
[0m17:26:01.007896 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_exercise.unique_dim_employees_employee_id.79828c8f30"
[0m17:26:01.009258 [debug] [Thread-1 (]: On test.dbt_exercise.unique_dim_employees_employee_id.79828c8f30: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "test.dbt_exercise.unique_dim_employees_employee_id.79828c8f30"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with dbt_test__target as (

  select employee_id as unique_field
  from `corded-sunlight-464012-e2`.`dbt_dw_marts`.`dim_employees`
  where employee_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m17:26:01.010341 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:26:01.714901 [info ] [Thread-3 (]: 47 of 59 PASS source_unique_northwind_shippers_shipper_id ...................... [[32mPASS[0m in 2.75s]
[0m17:26:01.716075 [debug] [Thread-3 (]: Finished running node test.dbt_exercise.source_unique_northwind_shippers_shipper_id.61edb3f736
[0m17:26:01.716798 [debug] [Thread-3 (]: Began running node test.dbt_exercise.unique_dim_employees_sk_employee.2c4a61e188
[0m17:26:01.717693 [info ] [Thread-3 (]: 54 of 59 START test unique_dim_employees_sk_employee ........................... [RUN]
[0m17:26:01.718586 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_exercise.source_unique_northwind_shippers_shipper_id.61edb3f736, now test.dbt_exercise.unique_dim_employees_sk_employee.2c4a61e188)
[0m17:26:01.719145 [debug] [Thread-3 (]: Began compiling node test.dbt_exercise.unique_dim_employees_sk_employee.2c4a61e188
[0m17:26:01.726918 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_exercise.unique_dim_employees_sk_employee.2c4a61e188"
[0m17:26:01.728215 [debug] [Thread-3 (]: Began executing node test.dbt_exercise.unique_dim_employees_sk_employee.2c4a61e188
[0m17:26:01.731246 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_exercise.unique_dim_employees_sk_employee.2c4a61e188"
[0m17:26:01.732273 [debug] [Thread-3 (]: On test.dbt_exercise.unique_dim_employees_sk_employee.2c4a61e188: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "test.dbt_exercise.unique_dim_employees_sk_employee.2c4a61e188"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with dbt_test__target as (

  select sk_employee as unique_field
  from `corded-sunlight-464012-e2`.`dbt_dw_marts`.`dim_employees`
  where sk_employee is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m17:26:01.733005 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m17:26:01.829443 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:7979d099-71c2-42e1-afd8-30fc54b126a4&page=queryresults
[0m17:26:01.830918 [error] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:7979d099-71c2-42e1-afd8-30fc54b126a4&page=queryresults
[0m17:26:01.877068 [debug] [Thread-2 (]: Database Error in test unique_dim_customers_customer_sk (models/marts/dim_customers.yml)
  Unrecognized name: customer_sk; Did you mean customer_id? at [18:9]
  compiled code at target/run/dbt_exercise/models/marts/dim_customers.yml/unique_dim_customers_customer_sk.sql
[0m17:26:01.878805 [error] [Thread-2 (]: 52 of 59 ERROR unique_dim_customers_customer_sk ................................ [[31mERROR[0m in 0.97s]
[0m17:26:01.879875 [debug] [Thread-2 (]: Finished running node test.dbt_exercise.unique_dim_customers_customer_sk.22a014df62
[0m17:26:01.880548 [debug] [Thread-2 (]: Began running node test.dbt_exercise.unique_dim_products_product_id.ef7b2a9985
[0m17:26:01.881233 [debug] [Thread-7 (]: Marking all children of 'test.dbt_exercise.unique_dim_customers_customer_sk.22a014df62' to be skipped because of status 'error'.  Reason: Database Error in test unique_dim_customers_customer_sk (models/marts/dim_customers.yml)
  Unrecognized name: customer_sk; Did you mean customer_id? at [18:9]
  compiled code at target/run/dbt_exercise/models/marts/dim_customers.yml/unique_dim_customers_customer_sk.sql.
[0m17:26:01.881972 [info ] [Thread-2 (]: 55 of 59 START test unique_dim_products_product_id ............................. [RUN]
[0m17:26:01.883279 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_exercise.unique_dim_customers_customer_sk.22a014df62, now test.dbt_exercise.unique_dim_products_product_id.ef7b2a9985)
[0m17:26:01.883894 [debug] [Thread-2 (]: Began compiling node test.dbt_exercise.unique_dim_products_product_id.ef7b2a9985
[0m17:26:01.891972 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_exercise.unique_dim_products_product_id.ef7b2a9985"
[0m17:26:01.894296 [debug] [Thread-2 (]: Began executing node test.dbt_exercise.unique_dim_products_product_id.ef7b2a9985
[0m17:26:01.898835 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_exercise.unique_dim_products_product_id.ef7b2a9985"
[0m17:26:01.900011 [debug] [Thread-2 (]: On test.dbt_exercise.unique_dim_products_product_id.ef7b2a9985: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "test.dbt_exercise.unique_dim_products_product_id.ef7b2a9985"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with dbt_test__target as (

  select product_id as unique_field
  from `corded-sunlight-464012-e2`.`dbt_dw_marts`.`dim_products`
  where product_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m17:26:01.900746 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:26:01.963735 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:f0470de5-987e-405f-a14c-c05b8dd866d2&page=queryresults
[0m17:26:02.099522 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:470f3fa9-c856-46d8-b897-56c7755243a4&page=queryresults
[0m17:26:02.754978 [info ] [Thread-4 (]: 51 of 59 PASS unique_dim_customers_customer_id ................................. [[32mPASS[0m in 1.92s]
[0m17:26:02.756061 [debug] [Thread-4 (]: Finished running node test.dbt_exercise.unique_dim_customers_customer_id.15c9f1e2fd
[0m17:26:02.756839 [debug] [Thread-4 (]: Began running node test.dbt_exercise.unique_dim_products_sk_product.1658453ef4
[0m17:26:02.757564 [info ] [Thread-4 (]: 56 of 59 START test unique_dim_products_sk_product ............................. [RUN]
[0m17:26:02.758722 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_exercise.unique_dim_customers_customer_id.15c9f1e2fd, now test.dbt_exercise.unique_dim_products_sk_product.1658453ef4)
[0m17:26:02.759618 [debug] [Thread-4 (]: Began compiling node test.dbt_exercise.unique_dim_products_sk_product.1658453ef4
[0m17:26:02.767593 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_exercise.unique_dim_products_sk_product.1658453ef4"
[0m17:26:02.768893 [debug] [Thread-4 (]: Began executing node test.dbt_exercise.unique_dim_products_sk_product.1658453ef4
[0m17:26:02.772223 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_exercise.unique_dim_products_sk_product.1658453ef4"
[0m17:26:02.773326 [debug] [Thread-4 (]: On test.dbt_exercise.unique_dim_products_sk_product.1658453ef4: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "test.dbt_exercise.unique_dim_products_sk_product.1658453ef4"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with dbt_test__target as (

  select sk_product as unique_field
  from `corded-sunlight-464012-e2`.`dbt_dw_marts`.`dim_products`
  where sk_product is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m17:26:02.774231 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m17:26:02.823549 [info ] [Thread-1 (]: 53 of 59 PASS unique_dim_employees_employee_id ................................. [[32mPASS[0m in 1.83s]
[0m17:26:02.825462 [debug] [Thread-1 (]: Finished running node test.dbt_exercise.unique_dim_employees_employee_id.79828c8f30
[0m17:26:02.826775 [debug] [Thread-1 (]: Began running node test.dbt_exercise.unique_dim_ship_ship_id.8825a91f8e
[0m17:26:02.828057 [info ] [Thread-1 (]: 57 of 59 START test unique_dim_ship_ship_id .................................... [RUN]
[0m17:26:02.829856 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_exercise.unique_dim_employees_employee_id.79828c8f30, now test.dbt_exercise.unique_dim_ship_ship_id.8825a91f8e)
[0m17:26:02.831345 [debug] [Thread-1 (]: Began compiling node test.dbt_exercise.unique_dim_ship_ship_id.8825a91f8e
[0m17:26:02.846659 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_exercise.unique_dim_ship_ship_id.8825a91f8e"
[0m17:26:02.847997 [debug] [Thread-1 (]: Began executing node test.dbt_exercise.unique_dim_ship_ship_id.8825a91f8e
[0m17:26:02.853280 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_exercise.unique_dim_ship_ship_id.8825a91f8e"
[0m17:26:02.854687 [debug] [Thread-1 (]: On test.dbt_exercise.unique_dim_ship_ship_id.8825a91f8e: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "test.dbt_exercise.unique_dim_ship_ship_id.8825a91f8e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with dbt_test__target as (

  select ship_id as unique_field
  from `corded-sunlight-464012-e2`.`dbt_dw_marts`.`dim_ship`
  where ship_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m17:26:02.855290 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:26:02.900789 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:dc681890-a182-44c5-9034-e32e6e3458f9&page=queryresults
[0m17:26:03.096705 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:741b9936-d90d-4923-9f6c-a8c7968255a3&page=queryresults
[0m17:26:03.594598 [info ] [Thread-3 (]: 54 of 59 PASS unique_dim_employees_sk_employee ................................. [[32mPASS[0m in 1.88s]
[0m17:26:03.595832 [debug] [Thread-3 (]: Finished running node test.dbt_exercise.unique_dim_employees_sk_employee.2c4a61e188
[0m17:26:03.596635 [debug] [Thread-3 (]: Began running node test.dbt_exercise.unique_dim_ship_sk_ship.14db8b5f73
[0m17:26:03.597357 [info ] [Thread-3 (]: 58 of 59 START test unique_dim_ship_sk_ship .................................... [RUN]
[0m17:26:03.598524 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_exercise.unique_dim_employees_sk_employee.2c4a61e188, now test.dbt_exercise.unique_dim_ship_sk_ship.14db8b5f73)
[0m17:26:03.599586 [debug] [Thread-3 (]: Began compiling node test.dbt_exercise.unique_dim_ship_sk_ship.14db8b5f73
[0m17:26:03.608421 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_exercise.unique_dim_ship_sk_ship.14db8b5f73"
[0m17:26:03.609278 [debug] [Thread-3 (]: Began executing node test.dbt_exercise.unique_dim_ship_sk_ship.14db8b5f73
[0m17:26:03.612400 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_exercise.unique_dim_ship_sk_ship.14db8b5f73"
[0m17:26:03.613530 [debug] [Thread-3 (]: On test.dbt_exercise.unique_dim_ship_sk_ship.14db8b5f73: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "test.dbt_exercise.unique_dim_ship_sk_ship.14db8b5f73"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with dbt_test__target as (

  select sk_ship as unique_field
  from `corded-sunlight-464012-e2`.`dbt_dw_marts`.`dim_ship`
  where sk_ship is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m17:26:03.614944 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m17:26:03.871408 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:f57e03a5-4c37-4bdd-8248-8c30c5f38cb1&page=queryresults
[0m17:26:03.911511 [info ] [Thread-2 (]: 55 of 59 PASS unique_dim_products_product_id ................................... [[32mPASS[0m in 2.03s]
[0m17:26:03.912640 [debug] [Thread-2 (]: Finished running node test.dbt_exercise.unique_dim_products_product_id.ef7b2a9985
[0m17:26:03.913354 [debug] [Thread-2 (]: Began running node test.dbt_exercise.unique_fact_orders_sk_orders.072a29dba8
[0m17:26:03.914148 [info ] [Thread-2 (]: 59 of 59 START test unique_fact_orders_sk_orders ............................... [RUN]
[0m17:26:03.915575 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_exercise.unique_dim_products_product_id.ef7b2a9985, now test.dbt_exercise.unique_fact_orders_sk_orders.072a29dba8)
[0m17:26:03.916557 [debug] [Thread-2 (]: Began compiling node test.dbt_exercise.unique_fact_orders_sk_orders.072a29dba8
[0m17:26:03.923938 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_exercise.unique_fact_orders_sk_orders.072a29dba8"
[0m17:26:03.924911 [debug] [Thread-2 (]: Began executing node test.dbt_exercise.unique_fact_orders_sk_orders.072a29dba8
[0m17:26:03.929106 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_exercise.unique_fact_orders_sk_orders.072a29dba8"
[0m17:26:03.931002 [debug] [Thread-2 (]: On test.dbt_exercise.unique_fact_orders_sk_orders.072a29dba8: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "test.dbt_exercise.unique_fact_orders_sk_orders.072a29dba8"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with dbt_test__target as (

  select sk_orders as unique_field
  from `corded-sunlight-464012-e2`.`dbt_dw_marts`.`fact_orders`
  where sk_orders is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m17:26:03.932793 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:26:03.980729 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:af23d82a-1cde-4f1f-bae2-4fca4c3a6e58&page=queryresults
[0m17:26:04.616052 [info ] [Thread-4 (]: 56 of 59 PASS unique_dim_products_sk_product ................................... [[32mPASS[0m in 1.86s]
[0m17:26:04.617082 [debug] [Thread-4 (]: Finished running node test.dbt_exercise.unique_dim_products_sk_product.1658453ef4
[0m17:26:04.790052 [info ] [Thread-1 (]: 57 of 59 PASS unique_dim_ship_ship_id .......................................... [[32mPASS[0m in 1.96s]
[0m17:26:04.791199 [debug] [Thread-1 (]: Finished running node test.dbt_exercise.unique_dim_ship_ship_id.8825a91f8e
[0m17:26:04.908618 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:d9b1955e-7820-4219-bbcd-adb276925143&page=queryresults
[0m17:26:05.133916 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:92ad7880-2d1c-4f8a-9ef2-530800f6c88f&page=queryresults
[0m17:26:05.635820 [info ] [Thread-3 (]: 58 of 59 PASS unique_dim_ship_sk_ship .......................................... [[32mPASS[0m in 2.04s]
[0m17:26:05.636888 [debug] [Thread-3 (]: Finished running node test.dbt_exercise.unique_dim_ship_sk_ship.14db8b5f73
[0m17:26:05.847646 [info ] [Thread-2 (]: 59 of 59 PASS unique_fact_orders_sk_orders ..................................... [[32mPASS[0m in 1.93s]
[0m17:26:05.848700 [debug] [Thread-2 (]: Finished running node test.dbt_exercise.unique_fact_orders_sk_orders.072a29dba8
[0m17:26:05.853765 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:26:05.861554 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:26:05.862427 [debug] [MainThread]: Connection 'test.dbt_exercise.unique_dim_ship_ship_id.8825a91f8e' was properly closed.
[0m17:26:05.863248 [debug] [MainThread]: Connection 'test.dbt_exercise.unique_dim_ship_sk_ship.14db8b5f73' was properly closed.
[0m17:26:05.864228 [debug] [MainThread]: Connection 'test.dbt_exercise.unique_fact_orders_sk_orders.072a29dba8' was properly closed.
[0m17:26:05.865274 [debug] [MainThread]: Connection 'test.dbt_exercise.unique_dim_products_sk_product.1658453ef4' was properly closed.
[0m17:26:05.866731 [info ] [MainThread]: 
[0m17:26:05.868351 [info ] [MainThread]: Finished running 59 data tests in 0 hours 0 minutes and 38.62 seconds (38.62s).
[0m17:26:05.883082 [debug] [MainThread]: Command end result
[0m17:26:05.967576 [debug] [MainThread]: Wrote artifact WritableManifest to /home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/target/manifest.json
[0m17:26:05.984197 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/target/semantic_manifest.json
[0m17:26:05.998943 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/target/run_results.json
[0m17:26:05.999901 [info ] [MainThread]: 
[0m17:26:06.001372 [info ] [MainThread]: [31mCompleted with 3 errors, 0 partial successes, and 0 warnings:[0m
[0m17:26:06.002584 [info ] [MainThread]: 
[0m17:26:06.003502 [error] [MainThread]: [31mFailure in test not_null_dim_customers_customer_sk (models/marts/dim_customers.yml)[0m
[0m17:26:06.004534 [error] [MainThread]:   Database Error in test not_null_dim_customers_customer_sk (models/marts/dim_customers.yml)
  Unrecognized name: customer_sk; Did you mean customer_id? at [18:7]
  compiled code at target/run/dbt_exercise/models/marts/dim_customers.yml/not_null_dim_customers_customer_sk.sql
[0m17:26:06.005166 [info ] [MainThread]: 
[0m17:26:06.005938 [info ] [MainThread]:   compiled code at target/compiled/dbt_exercise/models/marts/dim_customers.yml/not_null_dim_customers_customer_sk.sql
[0m17:26:06.006589 [info ] [MainThread]: 
[0m17:26:06.007318 [error] [MainThread]: [31mFailure in test accepted_values_dim_products_is_discontinued__True__False (models/marts/dim_products.yml)[0m
[0m17:26:06.008290 [error] [MainThread]:   Database Error in test accepted_values_dim_products_is_discontinued__True__False (models/marts/dim_products.yml)
  No matching signature for operator IN for argument types BOOL and {STRING} at [27:23]
  compiled code at target/run/dbt_exercise/models/marts/dim_products.yml/accepted_values_dim_products_is_discontinued__True__False.sql
[0m17:26:06.009245 [info ] [MainThread]: 
[0m17:26:06.010355 [info ] [MainThread]:   compiled code at target/compiled/dbt_exercise/models/marts/dim_products.yml/accepted_values_dim_products_is_discontinued__True__False.sql
[0m17:26:06.011100 [info ] [MainThread]: 
[0m17:26:06.011811 [error] [MainThread]: [31mFailure in test unique_dim_customers_customer_sk (models/marts/dim_customers.yml)[0m
[0m17:26:06.012492 [error] [MainThread]:   Database Error in test unique_dim_customers_customer_sk (models/marts/dim_customers.yml)
  Unrecognized name: customer_sk; Did you mean customer_id? at [18:9]
  compiled code at target/run/dbt_exercise/models/marts/dim_customers.yml/unique_dim_customers_customer_sk.sql
[0m17:26:06.013184 [info ] [MainThread]: 
[0m17:26:06.014084 [info ] [MainThread]:   compiled code at target/compiled/dbt_exercise/models/marts/dim_customers.yml/unique_dim_customers_customer_sk.sql
[0m17:26:06.015568 [info ] [MainThread]: 
[0m17:26:06.019328 [info ] [MainThread]: Done. PASS=56 WARN=0 ERROR=3 SKIP=0 NO-OP=0 TOTAL=59
[0m17:26:06.022357 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- DuplicateYAMLKeysDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m17:26:06.028567 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": false, "command_wall_clock_time": 166.7243, "process_in_blocks": "122920", "process_kernel_time": 19.073853, "process_mem_max_rss": "375124", "process_out_blocks": "5304", "process_user_time": 20.327843}
[0m17:26:06.029664 [debug] [MainThread]: Command `dbt test` failed at 17:26:06.029281 after 166.73 seconds
[0m17:26:06.031418 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71cf69a82ea0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71cf6a4340e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x71cf6a434a40>]}
[0m17:26:06.032844 [debug] [MainThread]: Flushing usage events
[0m17:26:06.342781 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:28:17.022288 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e21c2094890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e21c1bf1760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e21c1b9ae40>]}


============================== 17:28:17.043159 | 175aaf23-fea5-496b-be61-00d9576113f7 ==============================
[0m17:28:17.043159 [info ] [MainThread]: Running with dbt=1.10.2
[0m17:28:17.044677 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt test', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m17:29:19.778120 [warn ] [MainThread]: [[33mWARNING[0m][DuplicateYAMLKeysDeprecation]: Deprecated functionality
Duplicate key 'version' in "<unicode string>", line 4, column 1 in file
`/home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/dbt_project.yml`
[0m17:29:19.778971 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '175aaf23-fea5-496b-be61-00d9576113f7', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e21847e6a80>]}
[0m17:29:20.798753 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '175aaf23-fea5-496b-be61-00d9576113f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e21c16c3a10>]}
[0m17:29:20.916575 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '175aaf23-fea5-496b-be61-00d9576113f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e21848bed80>]}
[0m17:29:20.921179 [info ] [MainThread]: Registered adapter: bigquery=1.9.2
[0m17:30:13.277605 [debug] [MainThread]: checksum: 1adc40777973ef30f45f80b3b6d04d5013c1edd53d96363881b3b199e612468b, vars: {}, profile: , target: , version: 1.10.2
[0m17:30:20.020246 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:30:20.020872 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:30:20.275456 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '175aaf23-fea5-496b-be61-00d9576113f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e21848bf0e0>]}
[0m17:30:20.453018 [debug] [MainThread]: Wrote artifact WritableManifest to /home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/target/manifest.json
[0m17:30:20.466756 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/target/semantic_manifest.json
[0m17:30:20.963205 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '175aaf23-fea5-496b-be61-00d9576113f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e2183fb3ad0>]}
[0m17:30:20.964270 [info ] [MainThread]: Found 19 models, 14 seeds, 59 data tests, 14 sources, 609 macros
[0m17:30:20.965110 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '175aaf23-fea5-496b-be61-00d9576113f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e21841e7260>]}
[0m17:30:20.974480 [info ] [MainThread]: 
[0m17:30:20.975602 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m17:30:20.976470 [info ] [MainThread]: 
[0m17:30:20.977581 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m17:30:20.990624 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_corded-sunlight-464012-e2_dbt_dw_intermediate'
[0m17:30:20.992397 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:30:20.993700 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_corded-sunlight-464012-e2_dbt_dw_marts'
[0m17:30:20.995621 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_corded-sunlight-464012-e2_dbt_dw_raw'
[0m17:30:20.997284 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:30:20.998222 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_corded-sunlight-464012-e2_dbt_dw_staging'
[0m17:30:20.999346 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:30:21.000991 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:30:22.162045 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '175aaf23-fea5-496b-be61-00d9576113f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e218443ed50>]}
[0m17:30:22.163523 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:30:22.180866 [debug] [Thread-1 (]: Began running node test.dbt_exercise.accepted_values_dim_products_is_discontinued__true__false.f780058e64
[0m17:30:22.182087 [debug] [Thread-2 (]: Began running node test.dbt_exercise.not_null_dim_customers_customer_id.dd91cd1c8d
[0m17:30:22.183364 [info ] [Thread-1 (]: 1 of 59 START test accepted_values_dim_products_is_discontinued__true__false ... [RUN]
[0m17:30:22.185410 [debug] [Thread-3 (]: Began running node test.dbt_exercise.not_null_dim_customers_sk_customer.2dc07dc070
[0m17:30:22.186527 [debug] [Thread-4 (]: Began running node test.dbt_exercise.not_null_dim_employees_employee_id.ef83a0c291
[0m17:30:22.187622 [info ] [Thread-2 (]: 2 of 59 START test not_null_dim_customers_customer_id .......................... [RUN]
[0m17:30:22.189468 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_corded-sunlight-464012-e2_dbt_dw_marts, now test.dbt_exercise.accepted_values_dim_products_is_discontinued__true__false.f780058e64)
[0m17:30:22.190819 [info ] [Thread-3 (]: 3 of 59 START test not_null_dim_customers_sk_customer .......................... [RUN]
[0m17:30:22.192504 [info ] [Thread-4 (]: 4 of 59 START test not_null_dim_employees_employee_id .......................... [RUN]
[0m17:30:22.194547 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_corded-sunlight-464012-e2_dbt_dw_intermediate, now test.dbt_exercise.not_null_dim_customers_customer_id.dd91cd1c8d)
[0m17:30:22.196072 [debug] [Thread-1 (]: Began compiling node test.dbt_exercise.accepted_values_dim_products_is_discontinued__true__false.f780058e64
[0m17:30:22.197470 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_corded-sunlight-464012-e2_dbt_dw_staging, now test.dbt_exercise.not_null_dim_customers_sk_customer.2dc07dc070)
[0m17:30:22.199314 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly list_corded-sunlight-464012-e2_dbt_dw_raw, now test.dbt_exercise.not_null_dim_employees_employee_id.ef83a0c291)
[0m17:30:22.200995 [debug] [Thread-2 (]: Began compiling node test.dbt_exercise.not_null_dim_customers_customer_id.dd91cd1c8d
[0m17:30:22.228540 [debug] [Thread-3 (]: Began compiling node test.dbt_exercise.not_null_dim_customers_sk_customer.2dc07dc070
[0m17:30:22.250192 [debug] [Thread-4 (]: Began compiling node test.dbt_exercise.not_null_dim_employees_employee_id.ef83a0c291
[0m17:30:22.251961 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_exercise.accepted_values_dim_products_is_discontinued__true__false.f780058e64"
[0m17:30:22.283823 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_exercise.not_null_dim_customers_sk_customer.2dc07dc070"
[0m17:30:22.285694 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_exercise.not_null_dim_customers_customer_id.dd91cd1c8d"
[0m17:30:22.292823 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_exercise.not_null_dim_employees_employee_id.ef83a0c291"
[0m17:30:22.294833 [debug] [Thread-1 (]: Began executing node test.dbt_exercise.accepted_values_dim_products_is_discontinued__true__false.f780058e64
[0m17:30:22.297638 [debug] [Thread-3 (]: Began executing node test.dbt_exercise.not_null_dim_customers_sk_customer.2dc07dc070
[0m17:30:22.304665 [debug] [Thread-4 (]: Began executing node test.dbt_exercise.not_null_dim_employees_employee_id.ef83a0c291
[0m17:30:22.311111 [debug] [Thread-2 (]: Began executing node test.dbt_exercise.not_null_dim_customers_customer_id.dd91cd1c8d
[0m17:30:22.350273 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_exercise.not_null_dim_customers_sk_customer.2dc07dc070"
[0m17:30:22.353001 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_exercise.accepted_values_dim_products_is_discontinued__true__false.f780058e64"
[0m17:30:22.358034 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_exercise.not_null_dim_employees_employee_id.ef83a0c291"
[0m17:30:22.362163 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_exercise.not_null_dim_customers_customer_id.dd91cd1c8d"
[0m17:30:22.364889 [debug] [Thread-3 (]: On test.dbt_exercise.not_null_dim_customers_sk_customer.2dc07dc070: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "test.dbt_exercise.not_null_dim_customers_sk_customer.2dc07dc070"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select sk_customer
from `corded-sunlight-464012-e2`.`dbt_dw_marts`.`dim_customers`
where sk_customer is null



  
  
      
    ) dbt_internal_test
[0m17:30:22.366520 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m17:30:22.367968 [debug] [Thread-4 (]: On test.dbt_exercise.not_null_dim_employees_employee_id.ef83a0c291: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "test.dbt_exercise.not_null_dim_employees_employee_id.ef83a0c291"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select employee_id
from `corded-sunlight-464012-e2`.`dbt_dw_marts`.`dim_employees`
where employee_id is null



  
  
      
    ) dbt_internal_test
[0m17:30:22.369215 [debug] [Thread-1 (]: On test.dbt_exercise.accepted_values_dim_products_is_discontinued__true__false.f780058e64: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "test.dbt_exercise.accepted_values_dim_products_is_discontinued__true__false.f780058e64"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        is_discontinued as value_field,
        count(*) as n_records

    from `corded-sunlight-464012-e2`.`dbt_dw_marts`.`dim_products`
    group by is_discontinued

)

select *
from all_values
where value_field not in (
    'true','false'
)



  
  
      
    ) dbt_internal_test
[0m17:30:22.370071 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m17:30:22.371231 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:30:22.372413 [debug] [Thread-2 (]: On test.dbt_exercise.not_null_dim_customers_customer_id.dd91cd1c8d: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "test.dbt_exercise.not_null_dim_customers_customer_id.dd91cd1c8d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select customer_id
from `corded-sunlight-464012-e2`.`dbt_dw_marts`.`dim_customers`
where customer_id is null



  
  
      
    ) dbt_internal_test
[0m17:30:22.373744 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:30:23.574088 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:b61fe8e9-8f56-4ebf-989c-20d217e1453d&page=queryresults
[0m17:30:23.575302 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:b61fe8e9-8f56-4ebf-989c-20d217e1453d&page=queryresults
[0m17:30:23.580722 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:91a2fbe1-dffe-4cd9-9338-e3e0788eeee4&page=queryresults
[0m17:30:23.614467 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:5566de66-4787-4cb3-a4ad-4ab9d8eb803b&page=queryresults
[0m17:30:23.735256 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:83632f56-1151-40db-9325-fb223556b549&page=queryresults
[0m17:30:23.823865 [debug] [Thread-1 (]: Database Error in test accepted_values_dim_products_is_discontinued__true__false (models/marts/dim_products.yml)
  No matching signature for operator IN for argument types BOOL and {STRING} at [27:23]
  compiled code at target/run/dbt_exercise/models/marts/dim_products.yml/accepted_values_dim_products_is_discontinued__true__false.sql
[0m17:30:23.824931 [error] [Thread-1 (]: 1 of 59 ERROR accepted_values_dim_products_is_discontinued__true__false ........ [[31mERROR[0m in 1.64s]
[0m17:30:23.825931 [debug] [Thread-1 (]: Finished running node test.dbt_exercise.accepted_values_dim_products_is_discontinued__true__false.f780058e64
[0m17:30:23.826610 [debug] [Thread-1 (]: Began running node test.dbt_exercise.not_null_dim_employees_sk_employee.92381e9313
[0m17:30:23.827400 [debug] [Thread-7 (]: Marking all children of 'test.dbt_exercise.accepted_values_dim_products_is_discontinued__true__false.f780058e64' to be skipped because of status 'error'.  Reason: Database Error in test accepted_values_dim_products_is_discontinued__true__false (models/marts/dim_products.yml)
  No matching signature for operator IN for argument types BOOL and {STRING} at [27:23]
  compiled code at target/run/dbt_exercise/models/marts/dim_products.yml/accepted_values_dim_products_is_discontinued__true__false.sql.
[0m17:30:23.828206 [info ] [Thread-1 (]: 5 of 59 START test not_null_dim_employees_sk_employee .......................... [RUN]
[0m17:30:23.830763 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_exercise.accepted_values_dim_products_is_discontinued__true__false.f780058e64, now test.dbt_exercise.not_null_dim_employees_sk_employee.92381e9313)
[0m17:30:23.831498 [debug] [Thread-1 (]: Began compiling node test.dbt_exercise.not_null_dim_employees_sk_employee.92381e9313
[0m17:30:23.838940 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_exercise.not_null_dim_employees_sk_employee.92381e9313"
[0m17:30:23.840515 [debug] [Thread-1 (]: Began executing node test.dbt_exercise.not_null_dim_employees_sk_employee.92381e9313
[0m17:30:23.844495 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_exercise.not_null_dim_employees_sk_employee.92381e9313"
[0m17:30:23.846207 [debug] [Thread-1 (]: On test.dbt_exercise.not_null_dim_employees_sk_employee.92381e9313: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "test.dbt_exercise.not_null_dim_employees_sk_employee.92381e9313"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select sk_employee
from `corded-sunlight-464012-e2`.`dbt_dw_marts`.`dim_employees`
where sk_employee is null



  
  
      
    ) dbt_internal_test
[0m17:30:23.847380 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:30:24.888095 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:c2a10dff-ad06-49b4-bec8-941601896d5f&page=queryresults
[0m17:30:29.253295 [info ] [Thread-2 (]: 2 of 59 PASS not_null_dim_customers_customer_id ................................ [[32mPASS[0m in 7.06s]
[0m17:30:29.256442 [debug] [Thread-2 (]: Finished running node test.dbt_exercise.not_null_dim_customers_customer_id.dd91cd1c8d
[0m17:30:29.257614 [debug] [Thread-2 (]: Began running node test.dbt_exercise.not_null_dim_products_product_id.c8aba288d1
[0m17:30:29.259261 [info ] [Thread-4 (]: 4 of 59 PASS not_null_dim_employees_employee_id ................................ [[32mPASS[0m in 7.06s]
[0m17:30:29.262692 [debug] [Thread-4 (]: Finished running node test.dbt_exercise.not_null_dim_employees_employee_id.ef83a0c291
[0m17:30:29.260161 [info ] [Thread-2 (]: 6 of 59 START test not_null_dim_products_product_id ............................ [RUN]
[0m17:30:29.264443 [debug] [Thread-4 (]: Began running node test.dbt_exercise.not_null_dim_products_sk_product.7ce7792ece
[0m17:30:29.269227 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_exercise.not_null_dim_customers_customer_id.dd91cd1c8d, now test.dbt_exercise.not_null_dim_products_product_id.c8aba288d1)
[0m17:30:29.268301 [info ] [Thread-1 (]: 5 of 59 PASS not_null_dim_employees_sk_employee ................................ [[32mPASS[0m in 5.44s]
[0m17:30:29.271556 [info ] [Thread-4 (]: 7 of 59 START test not_null_dim_products_sk_product ............................ [RUN]
[0m17:30:29.275205 [info ] [Thread-3 (]: 3 of 59 PASS not_null_dim_customers_sk_customer ................................ [[32mPASS[0m in 7.08s]
[0m17:30:29.276831 [debug] [Thread-2 (]: Began compiling node test.dbt_exercise.not_null_dim_products_product_id.c8aba288d1
[0m17:30:29.278734 [debug] [Thread-1 (]: Finished running node test.dbt_exercise.not_null_dim_employees_sk_employee.92381e9313
[0m17:30:29.280177 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_exercise.not_null_dim_employees_employee_id.ef83a0c291, now test.dbt_exercise.not_null_dim_products_sk_product.7ce7792ece)
[0m17:30:29.282018 [debug] [Thread-3 (]: Finished running node test.dbt_exercise.not_null_dim_customers_sk_customer.2dc07dc070
[0m17:30:29.292145 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_exercise.not_null_dim_products_product_id.c8aba288d1"
[0m17:30:29.293156 [debug] [Thread-1 (]: Began running node test.dbt_exercise.not_null_dim_ship_ship_id.0e7926966a
[0m17:30:29.294505 [debug] [Thread-4 (]: Began compiling node test.dbt_exercise.not_null_dim_products_sk_product.7ce7792ece
[0m17:30:29.295651 [debug] [Thread-3 (]: Began running node test.dbt_exercise.not_null_dim_ship_shipper_id.78acf0f3d3
[0m17:30:29.297690 [info ] [Thread-1 (]: 8 of 59 START test not_null_dim_ship_ship_id ................................... [RUN]
[0m17:30:29.313912 [debug] [Thread-2 (]: Began executing node test.dbt_exercise.not_null_dim_products_product_id.c8aba288d1
[0m17:30:29.319220 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_exercise.not_null_dim_products_sk_product.7ce7792ece"
[0m17:30:29.320288 [info ] [Thread-3 (]: 9 of 59 START test not_null_dim_ship_shipper_id ................................ [RUN]
[0m17:30:29.321651 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_exercise.not_null_dim_employees_sk_employee.92381e9313, now test.dbt_exercise.not_null_dim_ship_ship_id.0e7926966a)
[0m17:30:29.327396 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_exercise.not_null_dim_products_product_id.c8aba288d1"
[0m17:30:29.329598 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_exercise.not_null_dim_customers_sk_customer.2dc07dc070, now test.dbt_exercise.not_null_dim_ship_shipper_id.78acf0f3d3)
[0m17:30:29.330918 [debug] [Thread-1 (]: Began compiling node test.dbt_exercise.not_null_dim_ship_ship_id.0e7926966a
[0m17:30:29.331960 [debug] [Thread-4 (]: Began executing node test.dbt_exercise.not_null_dim_products_sk_product.7ce7792ece
[0m17:30:29.333407 [debug] [Thread-3 (]: Began compiling node test.dbt_exercise.not_null_dim_ship_shipper_id.78acf0f3d3
[0m17:30:29.344142 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_exercise.not_null_dim_ship_ship_id.0e7926966a"
[0m17:30:29.346091 [debug] [Thread-2 (]: On test.dbt_exercise.not_null_dim_products_product_id.c8aba288d1: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "test.dbt_exercise.not_null_dim_products_product_id.c8aba288d1"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select product_id
from `corded-sunlight-464012-e2`.`dbt_dw_marts`.`dim_products`
where product_id is null



  
  
      
    ) dbt_internal_test
[0m17:30:29.349498 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_exercise.not_null_dim_products_sk_product.7ce7792ece"
[0m17:30:29.357653 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:30:29.361665 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_exercise.not_null_dim_ship_shipper_id.78acf0f3d3"
[0m17:30:29.363496 [debug] [Thread-1 (]: Began executing node test.dbt_exercise.not_null_dim_ship_ship_id.0e7926966a
[0m17:30:29.364822 [debug] [Thread-4 (]: On test.dbt_exercise.not_null_dim_products_sk_product.7ce7792ece: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "test.dbt_exercise.not_null_dim_products_sk_product.7ce7792ece"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select sk_product
from `corded-sunlight-464012-e2`.`dbt_dw_marts`.`dim_products`
where sk_product is null



  
  
      
    ) dbt_internal_test
[0m17:30:29.368887 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_exercise.not_null_dim_ship_ship_id.0e7926966a"
[0m17:30:29.370018 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m17:30:29.371412 [debug] [Thread-3 (]: Began executing node test.dbt_exercise.not_null_dim_ship_shipper_id.78acf0f3d3
[0m17:30:29.377021 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_exercise.not_null_dim_ship_shipper_id.78acf0f3d3"
[0m17:30:29.378244 [debug] [Thread-1 (]: On test.dbt_exercise.not_null_dim_ship_ship_id.0e7926966a: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "test.dbt_exercise.not_null_dim_ship_ship_id.0e7926966a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select ship_id
from `corded-sunlight-464012-e2`.`dbt_dw_marts`.`dim_ship`
where ship_id is null



  
  
      
    ) dbt_internal_test
[0m17:30:29.381110 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:30:29.382170 [debug] [Thread-3 (]: On test.dbt_exercise.not_null_dim_ship_shipper_id.78acf0f3d3: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "test.dbt_exercise.not_null_dim_ship_shipper_id.78acf0f3d3"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select shipper_id
from `corded-sunlight-464012-e2`.`dbt_dw_marts`.`dim_ship`
where shipper_id is null



  
  
      
    ) dbt_internal_test
[0m17:30:29.460141 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m17:30:30.380716 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:ab49442a-88fe-40e1-8757-1d29f10afbab&page=queryresults
[0m17:30:30.385350 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:dddd8dec-2b6e-4a88-99dc-977064973df3&page=queryresults
[0m17:30:30.412641 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:7fa373ab-81e2-4f15-8f80-f0b48f899796&page=queryresults
[0m17:30:30.473483 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:c4d91358-d1c2-46f7-be46-541ecf3f9900&page=queryresults
[0m17:30:31.173882 [info ] [Thread-3 (]: 9 of 59 PASS not_null_dim_ship_shipper_id ...................................... [[32mPASS[0m in 1.84s]
[0m17:30:31.175419 [debug] [Thread-3 (]: Finished running node test.dbt_exercise.not_null_dim_ship_shipper_id.78acf0f3d3
[0m17:30:31.176400 [debug] [Thread-3 (]: Began running node test.dbt_exercise.not_null_dim_ship_sk_ship.3ae993afec
[0m17:30:31.177299 [info ] [Thread-3 (]: 10 of 59 START test not_null_dim_ship_sk_ship .................................. [RUN]
[0m17:30:31.178247 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_exercise.not_null_dim_ship_shipper_id.78acf0f3d3, now test.dbt_exercise.not_null_dim_ship_sk_ship.3ae993afec)
[0m17:30:31.178900 [debug] [Thread-3 (]: Began compiling node test.dbt_exercise.not_null_dim_ship_sk_ship.3ae993afec
[0m17:30:31.187541 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_exercise.not_null_dim_ship_sk_ship.3ae993afec"
[0m17:30:31.189415 [debug] [Thread-3 (]: Began executing node test.dbt_exercise.not_null_dim_ship_sk_ship.3ae993afec
[0m17:30:31.195069 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_exercise.not_null_dim_ship_sk_ship.3ae993afec"
[0m17:30:31.196891 [debug] [Thread-3 (]: On test.dbt_exercise.not_null_dim_ship_sk_ship.3ae993afec: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "test.dbt_exercise.not_null_dim_ship_sk_ship.3ae993afec"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select sk_ship
from `corded-sunlight-464012-e2`.`dbt_dw_marts`.`dim_ship`
where sk_ship is null



  
  
      
    ) dbt_internal_test
[0m17:30:31.198562 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m17:30:31.204956 [info ] [Thread-4 (]: 7 of 59 PASS not_null_dim_products_sk_product .................................. [[32mPASS[0m in 1.92s]
[0m17:30:31.207029 [debug] [Thread-4 (]: Finished running node test.dbt_exercise.not_null_dim_products_sk_product.7ce7792ece
[0m17:30:31.208233 [debug] [Thread-4 (]: Began running node test.dbt_exercise.not_null_fact_orders_customer_id.9c2270d0dc
[0m17:30:31.212370 [info ] [Thread-4 (]: 11 of 59 START test not_null_fact_orders_customer_id ........................... [RUN]
[0m17:30:31.219185 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_exercise.not_null_dim_products_sk_product.7ce7792ece, now test.dbt_exercise.not_null_fact_orders_customer_id.9c2270d0dc)
[0m17:30:31.220755 [debug] [Thread-4 (]: Began compiling node test.dbt_exercise.not_null_fact_orders_customer_id.9c2270d0dc
[0m17:30:31.232113 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_exercise.not_null_fact_orders_customer_id.9c2270d0dc"
[0m17:30:31.278534 [info ] [Thread-2 (]: 6 of 59 PASS not_null_dim_products_product_id .................................. [[32mPASS[0m in 2.01s]
[0m17:30:31.280763 [debug] [Thread-2 (]: Finished running node test.dbt_exercise.not_null_dim_products_product_id.c8aba288d1
[0m17:30:31.282405 [debug] [Thread-4 (]: Began executing node test.dbt_exercise.not_null_fact_orders_customer_id.9c2270d0dc
[0m17:30:31.284508 [debug] [Thread-2 (]: Began running node test.dbt_exercise.not_null_fact_orders_employee_id.4d01f9cb32
[0m17:30:31.293250 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_exercise.not_null_fact_orders_customer_id.9c2270d0dc"
[0m17:30:31.295556 [info ] [Thread-2 (]: 12 of 59 START test not_null_fact_orders_employee_id ........................... [RUN]
[0m17:30:31.298451 [info ] [Thread-1 (]: 8 of 59 PASS not_null_dim_ship_ship_id ......................................... [[32mPASS[0m in 1.98s]
[0m17:30:31.300569 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_exercise.not_null_dim_products_product_id.c8aba288d1, now test.dbt_exercise.not_null_fact_orders_employee_id.4d01f9cb32)
[0m17:30:31.302507 [debug] [Thread-1 (]: Finished running node test.dbt_exercise.not_null_dim_ship_ship_id.0e7926966a
[0m17:30:31.303473 [debug] [Thread-4 (]: On test.dbt_exercise.not_null_fact_orders_customer_id.9c2270d0dc: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "test.dbt_exercise.not_null_fact_orders_customer_id.9c2270d0dc"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select customer_id
from `corded-sunlight-464012-e2`.`dbt_dw_marts`.`fact_orders`
where customer_id is null



  
  
      
    ) dbt_internal_test
[0m17:30:31.304579 [debug] [Thread-2 (]: Began compiling node test.dbt_exercise.not_null_fact_orders_employee_id.4d01f9cb32
[0m17:30:31.305579 [debug] [Thread-1 (]: Began running node test.dbt_exercise.not_null_fact_orders_order_id.6ba6d3f0a0
[0m17:30:31.306775 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m17:30:31.319339 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_exercise.not_null_fact_orders_employee_id.4d01f9cb32"
[0m17:30:31.320643 [info ] [Thread-1 (]: 13 of 59 START test not_null_fact_orders_order_id .............................. [RUN]
[0m17:30:31.323413 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_exercise.not_null_dim_ship_ship_id.0e7926966a, now test.dbt_exercise.not_null_fact_orders_order_id.6ba6d3f0a0)
[0m17:30:31.324780 [debug] [Thread-1 (]: Began compiling node test.dbt_exercise.not_null_fact_orders_order_id.6ba6d3f0a0
[0m17:30:31.331552 [debug] [Thread-2 (]: Began executing node test.dbt_exercise.not_null_fact_orders_employee_id.4d01f9cb32
[0m17:30:31.335496 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_exercise.not_null_fact_orders_order_id.6ba6d3f0a0"
[0m17:30:31.340687 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_exercise.not_null_fact_orders_employee_id.4d01f9cb32"
[0m17:30:31.345534 [debug] [Thread-2 (]: On test.dbt_exercise.not_null_fact_orders_employee_id.4d01f9cb32: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "test.dbt_exercise.not_null_fact_orders_employee_id.4d01f9cb32"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select employee_id
from `corded-sunlight-464012-e2`.`dbt_dw_marts`.`fact_orders`
where employee_id is null



  
  
      
    ) dbt_internal_test
[0m17:30:31.346853 [debug] [Thread-1 (]: Began executing node test.dbt_exercise.not_null_fact_orders_order_id.6ba6d3f0a0
[0m17:30:31.391234 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:30:31.396856 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_exercise.not_null_fact_orders_order_id.6ba6d3f0a0"
[0m17:30:31.400485 [debug] [Thread-1 (]: On test.dbt_exercise.not_null_fact_orders_order_id.6ba6d3f0a0: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "test.dbt_exercise.not_null_fact_orders_order_id.6ba6d3f0a0"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select order_id
from `corded-sunlight-464012-e2`.`dbt_dw_marts`.`fact_orders`
where order_id is null



  
  
      
    ) dbt_internal_test
[0m17:30:31.402001 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:30:32.350065 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:275f187c-a36c-43b0-9b9f-57cd877d71fd&page=queryresults
[0m17:30:32.467465 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:cb208994-74a8-42f8-b840-e2d530581316&page=queryresults
[0m17:30:32.471216 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:a385b2ef-9ee2-498a-b036-76d9a95565ce&page=queryresults
[0m17:30:32.495342 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:814a9e15-a6ea-4009-85c5-0408a8d78dbd&page=queryresults
[0m17:30:33.202623 [info ] [Thread-3 (]: 10 of 59 PASS not_null_dim_ship_sk_ship ........................................ [[32mPASS[0m in 2.02s]
[0m17:30:33.204100 [debug] [Thread-3 (]: Finished running node test.dbt_exercise.not_null_dim_ship_sk_ship.3ae993afec
[0m17:30:33.205004 [debug] [Thread-3 (]: Began running node test.dbt_exercise.not_null_fact_orders_product_id.346126b727
[0m17:30:33.205881 [info ] [Thread-3 (]: 14 of 59 START test not_null_fact_orders_product_id ............................ [RUN]
[0m17:30:33.206741 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_exercise.not_null_dim_ship_sk_ship.3ae993afec, now test.dbt_exercise.not_null_fact_orders_product_id.346126b727)
[0m17:30:33.207475 [debug] [Thread-3 (]: Began compiling node test.dbt_exercise.not_null_fact_orders_product_id.346126b727
[0m17:30:33.215952 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_exercise.not_null_fact_orders_product_id.346126b727"
[0m17:30:33.218159 [debug] [Thread-3 (]: Began executing node test.dbt_exercise.not_null_fact_orders_product_id.346126b727
[0m17:30:33.224479 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_exercise.not_null_fact_orders_product_id.346126b727"
[0m17:30:33.227406 [debug] [Thread-3 (]: On test.dbt_exercise.not_null_fact_orders_product_id.346126b727: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "test.dbt_exercise.not_null_fact_orders_product_id.346126b727"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select product_id
from `corded-sunlight-464012-e2`.`dbt_dw_marts`.`fact_orders`
where product_id is null



  
  
      
    ) dbt_internal_test
[0m17:30:33.228810 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m17:30:33.281518 [info ] [Thread-2 (]: 12 of 59 PASS not_null_fact_orders_employee_id ................................. [[32mPASS[0m in 1.98s]
[0m17:30:33.283338 [debug] [Thread-2 (]: Finished running node test.dbt_exercise.not_null_fact_orders_employee_id.4d01f9cb32
[0m17:30:33.284985 [debug] [Thread-2 (]: Began running node test.dbt_exercise.not_null_fact_orders_sk_customer.6134ecd4cd
[0m17:30:33.286687 [info ] [Thread-2 (]: 15 of 59 START test not_null_fact_orders_sk_customer ........................... [RUN]
[0m17:30:33.289440 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_exercise.not_null_fact_orders_employee_id.4d01f9cb32, now test.dbt_exercise.not_null_fact_orders_sk_customer.6134ecd4cd)
[0m17:30:33.292488 [debug] [Thread-2 (]: Began compiling node test.dbt_exercise.not_null_fact_orders_sk_customer.6134ecd4cd
[0m17:30:33.301164 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_exercise.not_null_fact_orders_sk_customer.6134ecd4cd"
[0m17:30:33.302762 [debug] [Thread-2 (]: Began executing node test.dbt_exercise.not_null_fact_orders_sk_customer.6134ecd4cd
[0m17:30:33.308352 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_exercise.not_null_fact_orders_sk_customer.6134ecd4cd"
[0m17:30:33.310493 [debug] [Thread-2 (]: On test.dbt_exercise.not_null_fact_orders_sk_customer.6134ecd4cd: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "test.dbt_exercise.not_null_fact_orders_sk_customer.6134ecd4cd"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select sk_customer
from `corded-sunlight-464012-e2`.`dbt_dw_marts`.`fact_orders`
where sk_customer is null



  
  
      
    ) dbt_internal_test
[0m17:30:33.311583 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:30:33.362683 [info ] [Thread-4 (]: 11 of 59 PASS not_null_fact_orders_customer_id ................................. [[32mPASS[0m in 2.14s]
[0m17:30:33.364594 [debug] [Thread-4 (]: Finished running node test.dbt_exercise.not_null_fact_orders_customer_id.9c2270d0dc
[0m17:30:33.365855 [debug] [Thread-4 (]: Began running node test.dbt_exercise.not_null_fact_orders_sk_employee.cf36d136ff
[0m17:30:33.367512 [info ] [Thread-4 (]: 16 of 59 START test not_null_fact_orders_sk_employee ........................... [RUN]
[0m17:30:33.369766 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_exercise.not_null_fact_orders_customer_id.9c2270d0dc, now test.dbt_exercise.not_null_fact_orders_sk_employee.cf36d136ff)
[0m17:30:33.371957 [debug] [Thread-4 (]: Began compiling node test.dbt_exercise.not_null_fact_orders_sk_employee.cf36d136ff
[0m17:30:33.387125 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_exercise.not_null_fact_orders_sk_employee.cf36d136ff"
[0m17:30:33.389912 [info ] [Thread-1 (]: 13 of 59 PASS not_null_fact_orders_order_id .................................... [[32mPASS[0m in 2.07s]
[0m17:30:33.393820 [debug] [Thread-1 (]: Finished running node test.dbt_exercise.not_null_fact_orders_order_id.6ba6d3f0a0
[0m17:30:33.394919 [debug] [Thread-1 (]: Began running node test.dbt_exercise.not_null_fact_orders_sk_orders.c6a2fa98b5
[0m17:30:33.397149 [debug] [Thread-4 (]: Began executing node test.dbt_exercise.not_null_fact_orders_sk_employee.cf36d136ff
[0m17:30:33.396210 [info ] [Thread-1 (]: 17 of 59 START test not_null_fact_orders_sk_orders ............................. [RUN]
[0m17:30:33.404971 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_exercise.not_null_fact_orders_sk_employee.cf36d136ff"
[0m17:30:33.406561 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_exercise.not_null_fact_orders_order_id.6ba6d3f0a0, now test.dbt_exercise.not_null_fact_orders_sk_orders.c6a2fa98b5)
[0m17:30:33.408294 [debug] [Thread-1 (]: Began compiling node test.dbt_exercise.not_null_fact_orders_sk_orders.c6a2fa98b5
[0m17:30:33.417792 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_exercise.not_null_fact_orders_sk_orders.c6a2fa98b5"
[0m17:30:33.419444 [debug] [Thread-4 (]: On test.dbt_exercise.not_null_fact_orders_sk_employee.cf36d136ff: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "test.dbt_exercise.not_null_fact_orders_sk_employee.cf36d136ff"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select sk_employee
from `corded-sunlight-464012-e2`.`dbt_dw_marts`.`fact_orders`
where sk_employee is null



  
  
      
    ) dbt_internal_test
[0m17:30:33.421987 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m17:30:33.423482 [debug] [Thread-1 (]: Began executing node test.dbt_exercise.not_null_fact_orders_sk_orders.c6a2fa98b5
[0m17:30:33.427768 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_exercise.not_null_fact_orders_sk_orders.c6a2fa98b5"
[0m17:30:33.430458 [debug] [Thread-1 (]: On test.dbt_exercise.not_null_fact_orders_sk_orders.c6a2fa98b5: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "test.dbt_exercise.not_null_fact_orders_sk_orders.c6a2fa98b5"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select sk_orders
from `corded-sunlight-464012-e2`.`dbt_dw_marts`.`fact_orders`
where sk_orders is null



  
  
      
    ) dbt_internal_test
[0m17:30:33.432247 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:30:34.204506 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:7ce6a630-3ad3-4252-8db5-f1536c119899&page=queryresults
[0m17:30:34.317259 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:5f5fc589-d458-420e-a62f-5c03fae0d538&page=queryresults
[0m17:30:34.490927 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:480a8711-f321-411a-9f14-656782c62ed9&page=queryresults
[0m17:30:34.570075 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:f6d61895-8b08-47e4-819b-7cb060da80c6&page=queryresults
[0m17:30:34.965827 [info ] [Thread-3 (]: 14 of 59 PASS not_null_fact_orders_product_id .................................. [[32mPASS[0m in 1.76s]
[0m17:30:34.967256 [debug] [Thread-3 (]: Finished running node test.dbt_exercise.not_null_fact_orders_product_id.346126b727
[0m17:30:34.968138 [debug] [Thread-3 (]: Began running node test.dbt_exercise.not_null_fact_orders_sk_product.9e0a112d70
[0m17:30:34.969061 [info ] [Thread-3 (]: 18 of 59 START test not_null_fact_orders_sk_product ............................ [RUN]
[0m17:30:34.970135 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_exercise.not_null_fact_orders_product_id.346126b727, now test.dbt_exercise.not_null_fact_orders_sk_product.9e0a112d70)
[0m17:30:34.970904 [debug] [Thread-3 (]: Began compiling node test.dbt_exercise.not_null_fact_orders_sk_product.9e0a112d70
[0m17:30:34.982839 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_exercise.not_null_fact_orders_sk_product.9e0a112d70"
[0m17:30:34.985208 [debug] [Thread-3 (]: Began executing node test.dbt_exercise.not_null_fact_orders_sk_product.9e0a112d70
[0m17:30:34.990855 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_exercise.not_null_fact_orders_sk_product.9e0a112d70"
[0m17:30:34.992661 [debug] [Thread-3 (]: On test.dbt_exercise.not_null_fact_orders_sk_product.9e0a112d70: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "test.dbt_exercise.not_null_fact_orders_sk_product.9e0a112d70"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select sk_product
from `corded-sunlight-464012-e2`.`dbt_dw_marts`.`fact_orders`
where sk_product is null



  
  
      
    ) dbt_internal_test
[0m17:30:34.993727 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m17:30:35.167286 [info ] [Thread-2 (]: 15 of 59 PASS not_null_fact_orders_sk_customer ................................. [[32mPASS[0m in 1.88s]
[0m17:30:35.168750 [debug] [Thread-2 (]: Finished running node test.dbt_exercise.not_null_fact_orders_sk_customer.6134ecd4cd
[0m17:30:35.169566 [debug] [Thread-2 (]: Began running node test.dbt_exercise.not_null_fact_orders_sk_ship.c82a3b72ed
[0m17:30:35.170417 [info ] [Thread-2 (]: 19 of 59 START test not_null_fact_orders_sk_ship ............................... [RUN]
[0m17:30:35.171459 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_exercise.not_null_fact_orders_sk_customer.6134ecd4cd, now test.dbt_exercise.not_null_fact_orders_sk_ship.c82a3b72ed)
[0m17:30:35.172312 [debug] [Thread-2 (]: Began compiling node test.dbt_exercise.not_null_fact_orders_sk_ship.c82a3b72ed
[0m17:30:35.180932 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_exercise.not_null_fact_orders_sk_ship.c82a3b72ed"
[0m17:30:35.182863 [debug] [Thread-2 (]: Began executing node test.dbt_exercise.not_null_fact_orders_sk_ship.c82a3b72ed
[0m17:30:35.188920 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_exercise.not_null_fact_orders_sk_ship.c82a3b72ed"
[0m17:30:35.191770 [debug] [Thread-2 (]: On test.dbt_exercise.not_null_fact_orders_sk_ship.c82a3b72ed: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "test.dbt_exercise.not_null_fact_orders_sk_ship.c82a3b72ed"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select sk_ship
from `corded-sunlight-464012-e2`.`dbt_dw_marts`.`fact_orders`
where sk_ship is null



  
  
      
    ) dbt_internal_test
[0m17:30:35.193452 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:30:35.322937 [info ] [Thread-1 (]: 17 of 59 PASS not_null_fact_orders_sk_orders ................................... [[32mPASS[0m in 1.92s]
[0m17:30:35.324876 [debug] [Thread-1 (]: Finished running node test.dbt_exercise.not_null_fact_orders_sk_orders.c6a2fa98b5
[0m17:30:35.326225 [debug] [Thread-1 (]: Began running node test.dbt_exercise.source_accepted_values_northwind_categories_category_name__Beverages__Condiments__Confections__Dairy_Products__Grains_Cereals__Meat_Poultry__Produce__Seafood.ea6d0ab2ae
[0m17:30:35.327823 [info ] [Thread-1 (]: 20 of 59 START test source_accepted_values_northwind_categories_category_name__Beverages__Condiments__Confections__Dairy_Products__Grains_Cereals__Meat_Poultry__Produce__Seafood  [RUN]
[0m17:30:35.329489 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_exercise.not_null_fact_orders_sk_orders.c6a2fa98b5, now test.dbt_exercise.source_accepted_values_northwind_categories_category_name__Beverages__Condiments__Confections__Dairy_Products__Grains_Cereals__Meat_Poultry__Produce__Seafood.ea6d0ab2ae)
[0m17:30:35.330674 [debug] [Thread-1 (]: Began compiling node test.dbt_exercise.source_accepted_values_northwind_categories_category_name__Beverages__Condiments__Confections__Dairy_Products__Grains_Cereals__Meat_Poultry__Produce__Seafood.ea6d0ab2ae
[0m17:30:35.356281 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_exercise.source_accepted_values_northwind_categories_category_name__Beverages__Condiments__Confections__Dairy_Products__Grains_Cereals__Meat_Poultry__Produce__Seafood.ea6d0ab2ae"
[0m17:30:35.364990 [info ] [Thread-4 (]: 16 of 59 PASS not_null_fact_orders_sk_employee ................................. [[32mPASS[0m in 2.00s]
[0m17:30:35.366258 [debug] [Thread-4 (]: Finished running node test.dbt_exercise.not_null_fact_orders_sk_employee.cf36d136ff
[0m17:30:35.367138 [debug] [Thread-4 (]: Began running node test.dbt_exercise.source_not_null_northwind_categories_category_id.9a6df29828
[0m17:30:35.368280 [info ] [Thread-4 (]: 21 of 59 START test source_not_null_northwind_categories_category_id ........... [RUN]
[0m17:30:35.369808 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_exercise.not_null_fact_orders_sk_employee.cf36d136ff, now test.dbt_exercise.source_not_null_northwind_categories_category_id.9a6df29828)
[0m17:30:35.371134 [debug] [Thread-4 (]: Began compiling node test.dbt_exercise.source_not_null_northwind_categories_category_id.9a6df29828
[0m17:30:35.385497 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_exercise.source_not_null_northwind_categories_category_id.9a6df29828"
[0m17:30:35.387000 [debug] [Thread-1 (]: Began executing node test.dbt_exercise.source_accepted_values_northwind_categories_category_name__Beverages__Condiments__Confections__Dairy_Products__Grains_Cereals__Meat_Poultry__Produce__Seafood.ea6d0ab2ae
[0m17:30:35.391655 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_exercise.source_accepted_values_northwind_categories_category_name__Beverages__Condiments__Confections__Dairy_Products__Grains_Cereals__Meat_Poultry__Produce__Seafood.ea6d0ab2ae"
[0m17:30:35.393461 [debug] [Thread-4 (]: Began executing node test.dbt_exercise.source_not_null_northwind_categories_category_id.9a6df29828
[0m17:30:35.398622 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_exercise.source_not_null_northwind_categories_category_id.9a6df29828"
[0m17:30:35.399718 [debug] [Thread-1 (]: On test.dbt_exercise.source_accepted_values_northwind_categories_category_name__Beverages__Condiments__Confections__Dairy_Products__Grains_Cereals__Meat_Poultry__Produce__Seafood.ea6d0ab2ae: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "test.dbt_exercise.source_accepted_values_northwind_categories_category_name__Beverages__Condiments__Confections__Dairy_Products__Grains_Cereals__Meat_Poultry__Produce__Seafood.ea6d0ab2ae"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        category_name as value_field,
        count(*) as n_records

    from `corded-sunlight-464012-e2`.`dbt_dw_raw`.`categories`
    group by category_name

)

select *
from all_values
where value_field not in (
    'Beverages','Condiments','Confections','Dairy Products','Grains/Cereals','Meat/Poultry','Produce','Seafood'
)



  
  
      
    ) dbt_internal_test
[0m17:30:35.401337 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:30:35.403125 [debug] [Thread-4 (]: On test.dbt_exercise.source_not_null_northwind_categories_category_id.9a6df29828: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "test.dbt_exercise.source_not_null_northwind_categories_category_id.9a6df29828"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select category_id
from `corded-sunlight-464012-e2`.`dbt_dw_raw`.`categories`
where category_id is null



  
  
      
    ) dbt_internal_test
[0m17:30:35.404395 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m17:30:35.988244 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:fa512bda-58ed-4073-afc2-6a001b698d78&page=queryresults
[0m17:30:36.282610 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:e5be8bdb-7aac-4d9a-93c6-a97a531b73b1&page=queryresults
[0m17:30:36.405256 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:3d7b6d63-e204-4a7b-921f-a24c86c7bd82&page=queryresults
[0m17:30:36.563957 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:17154a13-738e-47da-89b5-d611981b1e95&page=queryresults
[0m17:30:36.821244 [info ] [Thread-3 (]: 18 of 59 PASS not_null_fact_orders_sk_product .................................. [[32mPASS[0m in 1.85s]
[0m17:30:36.822760 [debug] [Thread-3 (]: Finished running node test.dbt_exercise.not_null_fact_orders_sk_product.9e0a112d70
[0m17:30:36.823751 [debug] [Thread-3 (]: Began running node test.dbt_exercise.source_not_null_northwind_country_codes_country_code.c623b5676c
[0m17:30:36.824653 [info ] [Thread-3 (]: 22 of 59 START test source_not_null_northwind_country_codes_country_code ....... [RUN]
[0m17:30:36.825506 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_exercise.not_null_fact_orders_sk_product.9e0a112d70, now test.dbt_exercise.source_not_null_northwind_country_codes_country_code.c623b5676c)
[0m17:30:36.826219 [debug] [Thread-3 (]: Began compiling node test.dbt_exercise.source_not_null_northwind_country_codes_country_code.c623b5676c
[0m17:30:36.834691 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_exercise.source_not_null_northwind_country_codes_country_code.c623b5676c"
[0m17:30:36.841749 [debug] [Thread-3 (]: Began executing node test.dbt_exercise.source_not_null_northwind_country_codes_country_code.c623b5676c
[0m17:30:36.852780 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_exercise.source_not_null_northwind_country_codes_country_code.c623b5676c"
[0m17:30:36.854819 [debug] [Thread-3 (]: On test.dbt_exercise.source_not_null_northwind_country_codes_country_code.c623b5676c: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "test.dbt_exercise.source_not_null_northwind_country_codes_country_code.c623b5676c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select country_code
from `corded-sunlight-464012-e2`.`dbt_dw_raw`.`country_codes`
where country_code is null



  
  
      
    ) dbt_internal_test
[0m17:30:36.856187 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m17:30:37.047017 [info ] [Thread-2 (]: 19 of 59 PASS not_null_fact_orders_sk_ship ..................................... [[32mPASS[0m in 1.88s]
[0m17:30:37.048677 [debug] [Thread-2 (]: Finished running node test.dbt_exercise.not_null_fact_orders_sk_ship.c82a3b72ed
[0m17:30:37.049630 [debug] [Thread-2 (]: Began running node test.dbt_exercise.source_not_null_northwind_customers_customer_id.dba99593d2
[0m17:30:37.050615 [info ] [Thread-2 (]: 23 of 59 START test source_not_null_northwind_customers_customer_id ............ [RUN]
[0m17:30:37.051512 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_exercise.not_null_fact_orders_sk_ship.c82a3b72ed, now test.dbt_exercise.source_not_null_northwind_customers_customer_id.dba99593d2)
[0m17:30:37.052391 [debug] [Thread-2 (]: Began compiling node test.dbt_exercise.source_not_null_northwind_customers_customer_id.dba99593d2
[0m17:30:37.060308 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_exercise.source_not_null_northwind_customers_customer_id.dba99593d2"
[0m17:30:37.061869 [debug] [Thread-2 (]: Began executing node test.dbt_exercise.source_not_null_northwind_customers_customer_id.dba99593d2
[0m17:30:37.067713 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_exercise.source_not_null_northwind_customers_customer_id.dba99593d2"
[0m17:30:37.070168 [debug] [Thread-2 (]: On test.dbt_exercise.source_not_null_northwind_customers_customer_id.dba99593d2: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "test.dbt_exercise.source_not_null_northwind_customers_customer_id.dba99593d2"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select customer_id
from `corded-sunlight-464012-e2`.`dbt_dw_raw`.`customers`
where customer_id is null



  
  
      
    ) dbt_internal_test
[0m17:30:37.071774 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:30:37.299703 [info ] [Thread-4 (]: 21 of 59 PASS source_not_null_northwind_categories_category_id ................. [[32mPASS[0m in 1.93s]
[0m17:30:37.301176 [debug] [Thread-4 (]: Finished running node test.dbt_exercise.source_not_null_northwind_categories_category_id.9a6df29828
[0m17:30:37.301949 [debug] [Thread-4 (]: Began running node test.dbt_exercise.source_not_null_northwind_dados_financeiros_data.cdd6b46fe7
[0m17:30:37.303093 [info ] [Thread-4 (]: 24 of 59 START test source_not_null_northwind_dados_financeiros_data ........... [RUN]
[0m17:30:37.304290 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_exercise.source_not_null_northwind_categories_category_id.9a6df29828, now test.dbt_exercise.source_not_null_northwind_dados_financeiros_data.cdd6b46fe7)
[0m17:30:37.305068 [debug] [Thread-4 (]: Began compiling node test.dbt_exercise.source_not_null_northwind_dados_financeiros_data.cdd6b46fe7
[0m17:30:37.313878 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_exercise.source_not_null_northwind_dados_financeiros_data.cdd6b46fe7"
[0m17:30:37.316032 [debug] [Thread-4 (]: Began executing node test.dbt_exercise.source_not_null_northwind_dados_financeiros_data.cdd6b46fe7
[0m17:30:37.324335 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_exercise.source_not_null_northwind_dados_financeiros_data.cdd6b46fe7"
[0m17:30:37.327576 [debug] [Thread-4 (]: On test.dbt_exercise.source_not_null_northwind_dados_financeiros_data.cdd6b46fe7: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "test.dbt_exercise.source_not_null_northwind_dados_financeiros_data.cdd6b46fe7"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select data
from `corded-sunlight-464012-e2`.`dbt_dw_raw`.`dados_financeiros`
where data is null



  
  
      
    ) dbt_internal_test
[0m17:30:37.328900 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m17:30:37.390522 [info ] [Thread-1 (]: 20 of 59 PASS source_accepted_values_northwind_categories_category_name__Beverages__Condiments__Confections__Dairy_Products__Grains_Cereals__Meat_Poultry__Produce__Seafood  [[32mPASS[0m in 2.06s]
[0m17:30:37.391839 [debug] [Thread-1 (]: Finished running node test.dbt_exercise.source_accepted_values_northwind_categories_category_name__Beverages__Condiments__Confections__Dairy_Products__Grains_Cereals__Meat_Poultry__Produce__Seafood.ea6d0ab2ae
[0m17:30:37.392840 [debug] [Thread-1 (]: Began running node test.dbt_exercise.source_not_null_northwind_employee_territories_employee_id.d7372217ec
[0m17:30:37.393665 [info ] [Thread-1 (]: 25 of 59 START test source_not_null_northwind_employee_territories_employee_id . [RUN]
[0m17:30:37.394503 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_exercise.source_accepted_values_northwind_categories_category_name__Beverages__Condiments__Confections__Dairy_Products__Grains_Cereals__Meat_Poultry__Produce__Seafood.ea6d0ab2ae, now test.dbt_exercise.source_not_null_northwind_employee_territories_employee_id.d7372217ec)
[0m17:30:37.395271 [debug] [Thread-1 (]: Began compiling node test.dbt_exercise.source_not_null_northwind_employee_territories_employee_id.d7372217ec
[0m17:30:37.403203 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_exercise.source_not_null_northwind_employee_territories_employee_id.d7372217ec"
[0m17:30:37.405351 [debug] [Thread-1 (]: Began executing node test.dbt_exercise.source_not_null_northwind_employee_territories_employee_id.d7372217ec
[0m17:30:37.410976 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_exercise.source_not_null_northwind_employee_territories_employee_id.d7372217ec"
[0m17:30:37.413282 [debug] [Thread-1 (]: On test.dbt_exercise.source_not_null_northwind_employee_territories_employee_id.d7372217ec: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "test.dbt_exercise.source_not_null_northwind_employee_territories_employee_id.d7372217ec"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select employee_id
from `corded-sunlight-464012-e2`.`dbt_dw_raw`.`employee_territories`
where employee_id is null



  
  
      
    ) dbt_internal_test
[0m17:30:37.414182 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:30:37.842044 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:88ccf75b-5b74-40b1-a56a-03c6d1bca1ea&page=queryresults
[0m17:30:38.097824 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:b085b204-6eec-49fb-bdb9-88d8adec43fe&page=queryresults
[0m17:30:38.365806 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:9036dcf6-a06e-41be-aa61-11d01b68ffd9&page=queryresults
[0m17:30:38.454676 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:6d7346dd-6851-4144-8183-cfaae025a67d&page=queryresults
[0m17:30:38.832283 [info ] [Thread-3 (]: 22 of 59 PASS source_not_null_northwind_country_codes_country_code ............. [[32mPASS[0m in 2.01s]
[0m17:30:38.833947 [debug] [Thread-3 (]: Finished running node test.dbt_exercise.source_not_null_northwind_country_codes_country_code.c623b5676c
[0m17:30:38.834942 [debug] [Thread-3 (]: Began running node test.dbt_exercise.source_not_null_northwind_employee_territories_territory_id.ae648a0b88
[0m17:30:38.835872 [info ] [Thread-3 (]: 26 of 59 START test source_not_null_northwind_employee_territories_territory_id  [RUN]
[0m17:30:38.836906 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_exercise.source_not_null_northwind_country_codes_country_code.c623b5676c, now test.dbt_exercise.source_not_null_northwind_employee_territories_territory_id.ae648a0b88)
[0m17:30:38.837599 [debug] [Thread-3 (]: Began compiling node test.dbt_exercise.source_not_null_northwind_employee_territories_territory_id.ae648a0b88
[0m17:30:38.847254 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_exercise.source_not_null_northwind_employee_territories_territory_id.ae648a0b88"
[0m17:30:38.849190 [debug] [Thread-3 (]: Began executing node test.dbt_exercise.source_not_null_northwind_employee_territories_territory_id.ae648a0b88
[0m17:30:38.860519 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_exercise.source_not_null_northwind_employee_territories_territory_id.ae648a0b88"
[0m17:30:38.862772 [debug] [Thread-3 (]: On test.dbt_exercise.source_not_null_northwind_employee_territories_territory_id.ae648a0b88: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "test.dbt_exercise.source_not_null_northwind_employee_territories_territory_id.ae648a0b88"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select territory_id
from `corded-sunlight-464012-e2`.`dbt_dw_raw`.`employee_territories`
where territory_id is null



  
  
      
    ) dbt_internal_test
[0m17:30:38.864547 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m17:30:38.980672 [info ] [Thread-2 (]: 23 of 59 PASS source_not_null_northwind_customers_customer_id .................. [[32mPASS[0m in 1.93s]
[0m17:30:38.982111 [debug] [Thread-2 (]: Finished running node test.dbt_exercise.source_not_null_northwind_customers_customer_id.dba99593d2
[0m17:30:38.982897 [debug] [Thread-2 (]: Began running node test.dbt_exercise.source_not_null_northwind_employees_employee_id.829479a08c
[0m17:30:38.983762 [info ] [Thread-2 (]: 27 of 59 START test source_not_null_northwind_employees_employee_id ............ [RUN]
[0m17:30:38.984925 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_exercise.source_not_null_northwind_customers_customer_id.dba99593d2, now test.dbt_exercise.source_not_null_northwind_employees_employee_id.829479a08c)
[0m17:30:38.986100 [debug] [Thread-2 (]: Began compiling node test.dbt_exercise.source_not_null_northwind_employees_employee_id.829479a08c
[0m17:30:38.994160 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_exercise.source_not_null_northwind_employees_employee_id.829479a08c"
[0m17:30:38.995866 [debug] [Thread-2 (]: Began executing node test.dbt_exercise.source_not_null_northwind_employees_employee_id.829479a08c
[0m17:30:39.001386 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_exercise.source_not_null_northwind_employees_employee_id.829479a08c"
[0m17:30:39.003644 [debug] [Thread-2 (]: On test.dbt_exercise.source_not_null_northwind_employees_employee_id.829479a08c: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "test.dbt_exercise.source_not_null_northwind_employees_employee_id.829479a08c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select employee_id
from `corded-sunlight-464012-e2`.`dbt_dw_raw`.`employees`
where employee_id is null



  
  
      
    ) dbt_internal_test
[0m17:30:39.005292 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:30:39.283513 [info ] [Thread-4 (]: 24 of 59 PASS source_not_null_northwind_dados_financeiros_data ................. [[32mPASS[0m in 1.98s]
[0m17:30:39.285158 [debug] [Thread-4 (]: Finished running node test.dbt_exercise.source_not_null_northwind_dados_financeiros_data.cdd6b46fe7
[0m17:30:39.285975 [debug] [Thread-4 (]: Began running node test.dbt_exercise.source_not_null_northwind_order_details_order_id.8acd43693e
[0m17:30:39.286994 [info ] [Thread-4 (]: 28 of 59 START test source_not_null_northwind_order_details_order_id ........... [RUN]
[0m17:30:39.288210 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_exercise.source_not_null_northwind_dados_financeiros_data.cdd6b46fe7, now test.dbt_exercise.source_not_null_northwind_order_details_order_id.8acd43693e)
[0m17:30:39.289137 [debug] [Thread-4 (]: Began compiling node test.dbt_exercise.source_not_null_northwind_order_details_order_id.8acd43693e
[0m17:30:39.298165 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_exercise.source_not_null_northwind_order_details_order_id.8acd43693e"
[0m17:30:39.300215 [debug] [Thread-4 (]: Began executing node test.dbt_exercise.source_not_null_northwind_order_details_order_id.8acd43693e
[0m17:30:39.307458 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_exercise.source_not_null_northwind_order_details_order_id.8acd43693e"
[0m17:30:39.309633 [debug] [Thread-4 (]: On test.dbt_exercise.source_not_null_northwind_order_details_order_id.8acd43693e: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "test.dbt_exercise.source_not_null_northwind_order_details_order_id.8acd43693e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select order_id
from `corded-sunlight-464012-e2`.`dbt_dw_raw`.`order_details`
where order_id is null



  
  
      
    ) dbt_internal_test
[0m17:30:39.310565 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m17:30:39.362538 [info ] [Thread-1 (]: 25 of 59 PASS source_not_null_northwind_employee_territories_employee_id ....... [[32mPASS[0m in 1.97s]
[0m17:30:39.363808 [debug] [Thread-1 (]: Finished running node test.dbt_exercise.source_not_null_northwind_employee_territories_employee_id.d7372217ec
[0m17:30:39.364748 [debug] [Thread-1 (]: Began running node test.dbt_exercise.source_not_null_northwind_order_details_product_id.c084f7ad12
[0m17:30:39.366353 [info ] [Thread-1 (]: 29 of 59 START test source_not_null_northwind_order_details_product_id ......... [RUN]
[0m17:30:39.368401 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_exercise.source_not_null_northwind_employee_territories_employee_id.d7372217ec, now test.dbt_exercise.source_not_null_northwind_order_details_product_id.c084f7ad12)
[0m17:30:39.369820 [debug] [Thread-1 (]: Began compiling node test.dbt_exercise.source_not_null_northwind_order_details_product_id.c084f7ad12
[0m17:30:39.378385 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_exercise.source_not_null_northwind_order_details_product_id.c084f7ad12"
[0m17:30:39.381267 [debug] [Thread-1 (]: Began executing node test.dbt_exercise.source_not_null_northwind_order_details_product_id.c084f7ad12
[0m17:30:39.389461 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_exercise.source_not_null_northwind_order_details_product_id.c084f7ad12"
[0m17:30:39.395073 [debug] [Thread-1 (]: On test.dbt_exercise.source_not_null_northwind_order_details_product_id.c084f7ad12: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "test.dbt_exercise.source_not_null_northwind_order_details_product_id.c084f7ad12"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select product_id
from `corded-sunlight-464012-e2`.`dbt_dw_raw`.`order_details`
where product_id is null



  
  
      
    ) dbt_internal_test
[0m17:30:39.396866 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:30:40.088860 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:b9ae0d9c-ba98-445a-928f-6c0c46ea9e47&page=queryresults
[0m17:30:40.111717 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:44ff7733-3154-491e-8b28-d640985b74de&page=queryresults
[0m17:30:40.399421 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:4eb54447-088a-40e0-80d7-883656443dc4&page=queryresults
[0m17:30:40.459230 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:2d5b6b82-f2b3-4795-b5e3-c54054eeeb4c&page=queryresults
[0m17:30:40.943634 [info ] [Thread-3 (]: 26 of 59 PASS source_not_null_northwind_employee_territories_territory_id ...... [[32mPASS[0m in 2.11s]
[0m17:30:40.945260 [debug] [Thread-3 (]: Finished running node test.dbt_exercise.source_not_null_northwind_employee_territories_territory_id.ae648a0b88
[0m17:30:40.946201 [debug] [Thread-3 (]: Began running node test.dbt_exercise.source_not_null_northwind_orders_customer_id.3e09955b24
[0m17:30:40.947271 [info ] [Thread-3 (]: 30 of 59 START test source_not_null_northwind_orders_customer_id ............... [RUN]
[0m17:30:40.948524 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_exercise.source_not_null_northwind_employee_territories_territory_id.ae648a0b88, now test.dbt_exercise.source_not_null_northwind_orders_customer_id.3e09955b24)
[0m17:30:40.949360 [debug] [Thread-3 (]: Began compiling node test.dbt_exercise.source_not_null_northwind_orders_customer_id.3e09955b24
[0m17:30:40.965637 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_exercise.source_not_null_northwind_orders_customer_id.3e09955b24"
[0m17:30:40.963493 [info ] [Thread-2 (]: 27 of 59 PASS source_not_null_northwind_employees_employee_id .................. [[32mPASS[0m in 1.98s]
[0m17:30:40.968642 [debug] [Thread-2 (]: Finished running node test.dbt_exercise.source_not_null_northwind_employees_employee_id.829479a08c
[0m17:30:40.970497 [debug] [Thread-2 (]: Began running node test.dbt_exercise.source_not_null_northwind_orders_employee_id.a8f4bf5ca3
[0m17:30:40.972526 [debug] [Thread-3 (]: Began executing node test.dbt_exercise.source_not_null_northwind_orders_customer_id.3e09955b24
[0m17:30:40.973964 [info ] [Thread-2 (]: 31 of 59 START test source_not_null_northwind_orders_employee_id ............... [RUN]
[0m17:30:40.985046 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_exercise.source_not_null_northwind_orders_customer_id.3e09955b24"
[0m17:30:40.987049 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_exercise.source_not_null_northwind_employees_employee_id.829479a08c, now test.dbt_exercise.source_not_null_northwind_orders_employee_id.a8f4bf5ca3)
[0m17:30:40.989851 [debug] [Thread-2 (]: Began compiling node test.dbt_exercise.source_not_null_northwind_orders_employee_id.a8f4bf5ca3
[0m17:30:40.998811 [debug] [Thread-3 (]: On test.dbt_exercise.source_not_null_northwind_orders_customer_id.3e09955b24: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "test.dbt_exercise.source_not_null_northwind_orders_customer_id.3e09955b24"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select customer_id
from `corded-sunlight-464012-e2`.`dbt_dw_raw`.`orders`
where customer_id is null



  
  
      
    ) dbt_internal_test
[0m17:30:41.005400 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m17:30:41.008495 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_exercise.source_not_null_northwind_orders_employee_id.a8f4bf5ca3"
[0m17:30:41.010654 [debug] [Thread-2 (]: Began executing node test.dbt_exercise.source_not_null_northwind_orders_employee_id.a8f4bf5ca3
[0m17:30:41.016562 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_exercise.source_not_null_northwind_orders_employee_id.a8f4bf5ca3"
[0m17:30:41.018420 [debug] [Thread-2 (]: On test.dbt_exercise.source_not_null_northwind_orders_employee_id.a8f4bf5ca3: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "test.dbt_exercise.source_not_null_northwind_orders_employee_id.a8f4bf5ca3"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select employee_id
from `corded-sunlight-464012-e2`.`dbt_dw_raw`.`orders`
where employee_id is null



  
  
      
    ) dbt_internal_test
[0m17:30:41.019494 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:30:41.336819 [info ] [Thread-1 (]: 29 of 59 PASS source_not_null_northwind_order_details_product_id ............... [[32mPASS[0m in 1.97s]
[0m17:30:41.340471 [debug] [Thread-1 (]: Finished running node test.dbt_exercise.source_not_null_northwind_order_details_product_id.c084f7ad12
[0m17:30:41.342157 [debug] [Thread-1 (]: Began running node test.dbt_exercise.source_not_null_northwind_orders_order_id.5a7c008c6e
[0m17:30:41.343506 [info ] [Thread-1 (]: 32 of 59 START test source_not_null_northwind_orders_order_id .................. [RUN]
[0m17:30:41.344913 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_exercise.source_not_null_northwind_order_details_product_id.c084f7ad12, now test.dbt_exercise.source_not_null_northwind_orders_order_id.5a7c008c6e)
[0m17:30:41.346719 [debug] [Thread-1 (]: Began compiling node test.dbt_exercise.source_not_null_northwind_orders_order_id.5a7c008c6e
[0m17:30:41.359236 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_exercise.source_not_null_northwind_orders_order_id.5a7c008c6e"
[0m17:30:41.360879 [debug] [Thread-1 (]: Began executing node test.dbt_exercise.source_not_null_northwind_orders_order_id.5a7c008c6e
[0m17:30:41.368884 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_exercise.source_not_null_northwind_orders_order_id.5a7c008c6e"
[0m17:30:41.373077 [debug] [Thread-1 (]: On test.dbt_exercise.source_not_null_northwind_orders_order_id.5a7c008c6e: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "test.dbt_exercise.source_not_null_northwind_orders_order_id.5a7c008c6e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select order_id
from `corded-sunlight-464012-e2`.`dbt_dw_raw`.`orders`
where order_id is null



  
  
      
    ) dbt_internal_test
[0m17:30:41.375797 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:30:41.379406 [info ] [Thread-4 (]: 28 of 59 PASS source_not_null_northwind_order_details_order_id ................. [[32mPASS[0m in 2.09s]
[0m17:30:41.381366 [debug] [Thread-4 (]: Finished running node test.dbt_exercise.source_not_null_northwind_order_details_order_id.8acd43693e
[0m17:30:41.383048 [debug] [Thread-4 (]: Began running node test.dbt_exercise.source_not_null_northwind_products_product_id.1bc1aa1d1c
[0m17:30:41.385665 [info ] [Thread-4 (]: 33 of 59 START test source_not_null_northwind_products_product_id .............. [RUN]
[0m17:30:41.388393 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_exercise.source_not_null_northwind_order_details_order_id.8acd43693e, now test.dbt_exercise.source_not_null_northwind_products_product_id.1bc1aa1d1c)
[0m17:30:41.390649 [debug] [Thread-4 (]: Began compiling node test.dbt_exercise.source_not_null_northwind_products_product_id.1bc1aa1d1c
[0m17:30:41.448592 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_exercise.source_not_null_northwind_products_product_id.1bc1aa1d1c"
[0m17:30:41.459419 [debug] [Thread-4 (]: Began executing node test.dbt_exercise.source_not_null_northwind_products_product_id.1bc1aa1d1c
[0m17:30:41.468504 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_exercise.source_not_null_northwind_products_product_id.1bc1aa1d1c"
[0m17:30:41.473098 [debug] [Thread-4 (]: On test.dbt_exercise.source_not_null_northwind_products_product_id.1bc1aa1d1c: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "test.dbt_exercise.source_not_null_northwind_products_product_id.1bc1aa1d1c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select product_id
from `corded-sunlight-464012-e2`.`dbt_dw_raw`.`products`
where product_id is null



  
  
      
    ) dbt_internal_test
[0m17:30:41.475427 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m17:30:42.229980 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:832dd754-742e-401e-89df-db3d99729a08&page=queryresults
[0m17:30:42.317539 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:3d6fb180-a312-4ba9-8110-3b629627c917&page=queryresults
[0m17:30:42.356765 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:ed033a5a-6f68-408f-9a6c-3e75c07b2c51&page=queryresults
[0m17:30:42.537235 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:1422b8f8-ce02-4d9b-943c-a3921e0b9f7f&page=queryresults
[0m17:30:43.046903 [info ] [Thread-2 (]: 31 of 59 PASS source_not_null_northwind_orders_employee_id ..................... [[32mPASS[0m in 2.06s]
[0m17:30:43.049439 [debug] [Thread-2 (]: Finished running node test.dbt_exercise.source_not_null_northwind_orders_employee_id.a8f4bf5ca3
[0m17:30:43.051016 [debug] [Thread-2 (]: Began running node test.dbt_exercise.source_not_null_northwind_region_region_id.c95367d9e3
[0m17:30:43.052567 [info ] [Thread-2 (]: 34 of 59 START test source_not_null_northwind_region_region_id ................. [RUN]
[0m17:30:43.054091 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_exercise.source_not_null_northwind_orders_employee_id.a8f4bf5ca3, now test.dbt_exercise.source_not_null_northwind_region_region_id.c95367d9e3)
[0m17:30:43.055252 [debug] [Thread-2 (]: Began compiling node test.dbt_exercise.source_not_null_northwind_region_region_id.c95367d9e3
[0m17:30:43.067241 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_exercise.source_not_null_northwind_region_region_id.c95367d9e3"
[0m17:30:43.068860 [debug] [Thread-2 (]: Began executing node test.dbt_exercise.source_not_null_northwind_region_region_id.c95367d9e3
[0m17:30:43.074042 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_exercise.source_not_null_northwind_region_region_id.c95367d9e3"
[0m17:30:43.077786 [debug] [Thread-2 (]: On test.dbt_exercise.source_not_null_northwind_region_region_id.c95367d9e3: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "test.dbt_exercise.source_not_null_northwind_region_region_id.c95367d9e3"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select region_id
from `corded-sunlight-464012-e2`.`dbt_dw_raw`.`region`
where region_id is null



  
  
      
    ) dbt_internal_test
[0m17:30:43.079228 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:30:43.136941 [info ] [Thread-1 (]: 32 of 59 PASS source_not_null_northwind_orders_order_id ........................ [[32mPASS[0m in 1.79s]
[0m17:30:43.139025 [debug] [Thread-1 (]: Finished running node test.dbt_exercise.source_not_null_northwind_orders_order_id.5a7c008c6e
[0m17:30:43.140180 [debug] [Thread-1 (]: Began running node test.dbt_exercise.source_not_null_northwind_shippers_shipper_id.45221752ca
[0m17:30:43.142156 [info ] [Thread-1 (]: 35 of 59 START test source_not_null_northwind_shippers_shipper_id .............. [RUN]
[0m17:30:43.145239 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_exercise.source_not_null_northwind_orders_order_id.5a7c008c6e, now test.dbt_exercise.source_not_null_northwind_shippers_shipper_id.45221752ca)
[0m17:30:43.146444 [debug] [Thread-1 (]: Began compiling node test.dbt_exercise.source_not_null_northwind_shippers_shipper_id.45221752ca
[0m17:30:43.156727 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_exercise.source_not_null_northwind_shippers_shipper_id.45221752ca"
[0m17:30:43.163905 [info ] [Thread-3 (]: 30 of 59 PASS source_not_null_northwind_orders_customer_id ..................... [[32mPASS[0m in 2.22s]
[0m17:30:43.165477 [debug] [Thread-1 (]: Began executing node test.dbt_exercise.source_not_null_northwind_shippers_shipper_id.45221752ca
[0m17:30:43.167390 [debug] [Thread-3 (]: Finished running node test.dbt_exercise.source_not_null_northwind_orders_customer_id.3e09955b24
[0m17:30:43.178804 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_exercise.source_not_null_northwind_shippers_shipper_id.45221752ca"
[0m17:30:43.180526 [debug] [Thread-3 (]: Began running node test.dbt_exercise.source_not_null_northwind_suppliers_supplier_id.de5c4d0062
[0m17:30:43.183236 [info ] [Thread-3 (]: 36 of 59 START test source_not_null_northwind_suppliers_supplier_id ............ [RUN]
[0m17:30:43.186131 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_exercise.source_not_null_northwind_orders_customer_id.3e09955b24, now test.dbt_exercise.source_not_null_northwind_suppliers_supplier_id.de5c4d0062)
[0m17:30:43.187490 [debug] [Thread-3 (]: Began compiling node test.dbt_exercise.source_not_null_northwind_suppliers_supplier_id.de5c4d0062
[0m17:30:43.188933 [debug] [Thread-1 (]: On test.dbt_exercise.source_not_null_northwind_shippers_shipper_id.45221752ca: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "test.dbt_exercise.source_not_null_northwind_shippers_shipper_id.45221752ca"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select shipper_id
from `corded-sunlight-464012-e2`.`dbt_dw_raw`.`shippers`
where shipper_id is null



  
  
      
    ) dbt_internal_test
[0m17:30:43.199600 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_exercise.source_not_null_northwind_suppliers_supplier_id.de5c4d0062"
[0m17:30:43.201662 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:30:43.209645 [debug] [Thread-3 (]: Began executing node test.dbt_exercise.source_not_null_northwind_suppliers_supplier_id.de5c4d0062
[0m17:30:43.215293 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_exercise.source_not_null_northwind_suppliers_supplier_id.de5c4d0062"
[0m17:30:43.217257 [debug] [Thread-3 (]: On test.dbt_exercise.source_not_null_northwind_suppliers_supplier_id.de5c4d0062: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "test.dbt_exercise.source_not_null_northwind_suppliers_supplier_id.de5c4d0062"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select supplier_id
from `corded-sunlight-464012-e2`.`dbt_dw_raw`.`suppliers`
where supplier_id is null



  
  
      
    ) dbt_internal_test
[0m17:30:43.218908 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m17:30:43.468444 [info ] [Thread-4 (]: 33 of 59 PASS source_not_null_northwind_products_product_id .................... [[32mPASS[0m in 2.08s]
[0m17:30:43.471811 [debug] [Thread-4 (]: Finished running node test.dbt_exercise.source_not_null_northwind_products_product_id.1bc1aa1d1c
[0m17:30:43.473695 [debug] [Thread-4 (]: Began running node test.dbt_exercise.source_not_null_northwind_territories_region_id.5df71bcf81
[0m17:30:43.474789 [info ] [Thread-4 (]: 37 of 59 START test source_not_null_northwind_territories_region_id ............ [RUN]
[0m17:30:43.476368 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_exercise.source_not_null_northwind_products_product_id.1bc1aa1d1c, now test.dbt_exercise.source_not_null_northwind_territories_region_id.5df71bcf81)
[0m17:30:43.477891 [debug] [Thread-4 (]: Began compiling node test.dbt_exercise.source_not_null_northwind_territories_region_id.5df71bcf81
[0m17:30:43.487840 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_exercise.source_not_null_northwind_territories_region_id.5df71bcf81"
[0m17:30:43.490660 [debug] [Thread-4 (]: Began executing node test.dbt_exercise.source_not_null_northwind_territories_region_id.5df71bcf81
[0m17:30:43.494997 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_exercise.source_not_null_northwind_territories_region_id.5df71bcf81"
[0m17:30:43.498944 [debug] [Thread-4 (]: On test.dbt_exercise.source_not_null_northwind_territories_region_id.5df71bcf81: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "test.dbt_exercise.source_not_null_northwind_territories_region_id.5df71bcf81"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select region_id
from `corded-sunlight-464012-e2`.`dbt_dw_raw`.`territories`
where region_id is null



  
  
      
    ) dbt_internal_test
[0m17:30:43.500804 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m17:30:44.126178 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:617cd6c2-7202-4397-8ed1-1effe64d76e9&page=queryresults
[0m17:30:44.250233 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:6b9bd251-3049-4273-9f40-bb57bb1d7129&page=queryresults
[0m17:30:44.271395 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:e3cda535-141f-42c4-8fdc-9c0baf6c5bd9&page=queryresults
[0m17:30:44.448415 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:b8f25f3d-1965-404e-89f9-e1754e2a91a9&page=queryresults
[0m17:30:44.972967 [info ] [Thread-2 (]: 34 of 59 PASS source_not_null_northwind_region_region_id ....................... [[32mPASS[0m in 1.92s]
[0m17:30:44.974188 [debug] [Thread-2 (]: Finished running node test.dbt_exercise.source_not_null_northwind_region_region_id.c95367d9e3
[0m17:30:44.974998 [debug] [Thread-2 (]: Began running node test.dbt_exercise.source_not_null_northwind_territories_territory_id.9b9655b8a9
[0m17:30:44.975836 [info ] [Thread-2 (]: 38 of 59 START test source_not_null_northwind_territories_territory_id ......... [RUN]
[0m17:30:44.976801 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_exercise.source_not_null_northwind_region_region_id.c95367d9e3, now test.dbt_exercise.source_not_null_northwind_territories_territory_id.9b9655b8a9)
[0m17:30:44.977495 [debug] [Thread-2 (]: Began compiling node test.dbt_exercise.source_not_null_northwind_territories_territory_id.9b9655b8a9
[0m17:30:44.986156 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_exercise.source_not_null_northwind_territories_territory_id.9b9655b8a9"
[0m17:30:44.987846 [debug] [Thread-2 (]: Began executing node test.dbt_exercise.source_not_null_northwind_territories_territory_id.9b9655b8a9
[0m17:30:44.993628 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_exercise.source_not_null_northwind_territories_territory_id.9b9655b8a9"
[0m17:30:44.997174 [debug] [Thread-2 (]: On test.dbt_exercise.source_not_null_northwind_territories_territory_id.9b9655b8a9: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "test.dbt_exercise.source_not_null_northwind_territories_territory_id.9b9655b8a9"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select territory_id
from `corded-sunlight-464012-e2`.`dbt_dw_raw`.`territories`
where territory_id is null



  
  
      
    ) dbt_internal_test
[0m17:30:44.998815 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:30:45.110861 [info ] [Thread-3 (]: 36 of 59 PASS source_not_null_northwind_suppliers_supplier_id .................. [[32mPASS[0m in 1.92s]
[0m17:30:45.112260 [debug] [Thread-3 (]: Finished running node test.dbt_exercise.source_not_null_northwind_suppliers_supplier_id.de5c4d0062
[0m17:30:45.113114 [debug] [Thread-3 (]: Began running node test.dbt_exercise.source_not_null_northwind_us_states_state_id.2e33a23d78
[0m17:30:45.114032 [info ] [Thread-3 (]: 39 of 59 START test source_not_null_northwind_us_states_state_id ............... [RUN]
[0m17:30:45.114949 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_exercise.source_not_null_northwind_suppliers_supplier_id.de5c4d0062, now test.dbt_exercise.source_not_null_northwind_us_states_state_id.2e33a23d78)
[0m17:30:45.115726 [debug] [Thread-3 (]: Began compiling node test.dbt_exercise.source_not_null_northwind_us_states_state_id.2e33a23d78
[0m17:30:45.123475 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_exercise.source_not_null_northwind_us_states_state_id.2e33a23d78"
[0m17:30:45.124992 [debug] [Thread-3 (]: Began executing node test.dbt_exercise.source_not_null_northwind_us_states_state_id.2e33a23d78
[0m17:30:45.132691 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_exercise.source_not_null_northwind_us_states_state_id.2e33a23d78"
[0m17:30:45.134141 [debug] [Thread-3 (]: On test.dbt_exercise.source_not_null_northwind_us_states_state_id.2e33a23d78: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "test.dbt_exercise.source_not_null_northwind_us_states_state_id.2e33a23d78"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select state_id
from `corded-sunlight-464012-e2`.`dbt_dw_raw`.`us_states`
where state_id is null



  
  
      
    ) dbt_internal_test
[0m17:30:45.135123 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m17:30:45.186747 [info ] [Thread-1 (]: 35 of 59 PASS source_not_null_northwind_shippers_shipper_id .................... [[32mPASS[0m in 2.04s]
[0m17:30:45.188264 [debug] [Thread-1 (]: Finished running node test.dbt_exercise.source_not_null_northwind_shippers_shipper_id.45221752ca
[0m17:30:45.189798 [debug] [Thread-1 (]: Began running node test.dbt_exercise.source_unique_northwind_categories_category_id.17d9baa2e0
[0m17:30:45.191580 [info ] [Thread-1 (]: 40 of 59 START test source_unique_northwind_categories_category_id ............. [RUN]
[0m17:30:45.194054 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_exercise.source_not_null_northwind_shippers_shipper_id.45221752ca, now test.dbt_exercise.source_unique_northwind_categories_category_id.17d9baa2e0)
[0m17:30:45.195436 [debug] [Thread-1 (]: Began compiling node test.dbt_exercise.source_unique_northwind_categories_category_id.17d9baa2e0
[0m17:30:45.207589 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_exercise.source_unique_northwind_categories_category_id.17d9baa2e0"
[0m17:30:45.211789 [debug] [Thread-1 (]: Began executing node test.dbt_exercise.source_unique_northwind_categories_category_id.17d9baa2e0
[0m17:30:45.218441 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_exercise.source_unique_northwind_categories_category_id.17d9baa2e0"
[0m17:30:45.220043 [debug] [Thread-1 (]: On test.dbt_exercise.source_unique_northwind_categories_category_id.17d9baa2e0: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "test.dbt_exercise.source_unique_northwind_categories_category_id.17d9baa2e0"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with dbt_test__target as (

  select category_id as unique_field
  from `corded-sunlight-464012-e2`.`dbt_dw_raw`.`categories`
  where category_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m17:30:45.221287 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:30:45.314501 [info ] [Thread-4 (]: 37 of 59 PASS source_not_null_northwind_territories_region_id .................. [[32mPASS[0m in 1.84s]
[0m17:30:45.315789 [debug] [Thread-4 (]: Finished running node test.dbt_exercise.source_not_null_northwind_territories_region_id.5df71bcf81
[0m17:30:45.317233 [debug] [Thread-4 (]: Began running node test.dbt_exercise.source_unique_northwind_country_codes_country_code.cf83d0431e
[0m17:30:45.318848 [info ] [Thread-4 (]: 41 of 59 START test source_unique_northwind_country_codes_country_code ......... [RUN]
[0m17:30:45.320143 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_exercise.source_not_null_northwind_territories_region_id.5df71bcf81, now test.dbt_exercise.source_unique_northwind_country_codes_country_code.cf83d0431e)
[0m17:30:45.320912 [debug] [Thread-4 (]: Began compiling node test.dbt_exercise.source_unique_northwind_country_codes_country_code.cf83d0431e
[0m17:30:45.329080 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_exercise.source_unique_northwind_country_codes_country_code.cf83d0431e"
[0m17:30:45.330479 [debug] [Thread-4 (]: Began executing node test.dbt_exercise.source_unique_northwind_country_codes_country_code.cf83d0431e
[0m17:30:45.336351 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_exercise.source_unique_northwind_country_codes_country_code.cf83d0431e"
[0m17:30:45.338288 [debug] [Thread-4 (]: On test.dbt_exercise.source_unique_northwind_country_codes_country_code.cf83d0431e: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "test.dbt_exercise.source_unique_northwind_country_codes_country_code.cf83d0431e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with dbt_test__target as (

  select country_code as unique_field
  from `corded-sunlight-464012-e2`.`dbt_dw_raw`.`country_codes`
  where country_code is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m17:30:45.339197 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m17:30:46.029850 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:fe223b6c-ff1e-45fb-a630-82dfbe871f79&page=queryresults
[0m17:30:46.157174 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:cbb5c6a8-414d-4c9b-8407-1181ec2ae80f&page=queryresults
[0m17:30:46.266996 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:99e68016-458c-4067-8ff8-9e3a35d95fd8&page=queryresults
[0m17:30:46.292673 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:876cf196-d491-430b-ad4b-1d18cf3d4e3a&page=queryresults
[0m17:30:46.876382 [info ] [Thread-2 (]: 38 of 59 PASS source_not_null_northwind_territories_territory_id ............... [[32mPASS[0m in 1.90s]
[0m17:30:46.877702 [debug] [Thread-2 (]: Finished running node test.dbt_exercise.source_not_null_northwind_territories_territory_id.9b9655b8a9
[0m17:30:46.878648 [debug] [Thread-2 (]: Began running node test.dbt_exercise.source_unique_northwind_customers_customer_id.ff818c137b
[0m17:30:46.879579 [info ] [Thread-2 (]: 42 of 59 START test source_unique_northwind_customers_customer_id .............. [RUN]
[0m17:30:46.881169 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_exercise.source_not_null_northwind_territories_territory_id.9b9655b8a9, now test.dbt_exercise.source_unique_northwind_customers_customer_id.ff818c137b)
[0m17:30:46.886522 [debug] [Thread-2 (]: Began compiling node test.dbt_exercise.source_unique_northwind_customers_customer_id.ff818c137b
[0m17:30:46.896103 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_exercise.source_unique_northwind_customers_customer_id.ff818c137b"
[0m17:30:46.898494 [debug] [Thread-2 (]: Began executing node test.dbt_exercise.source_unique_northwind_customers_customer_id.ff818c137b
[0m17:30:46.906711 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_exercise.source_unique_northwind_customers_customer_id.ff818c137b"
[0m17:30:46.908713 [debug] [Thread-2 (]: On test.dbt_exercise.source_unique_northwind_customers_customer_id.ff818c137b: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "test.dbt_exercise.source_unique_northwind_customers_customer_id.ff818c137b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with dbt_test__target as (

  select customer_id as unique_field
  from `corded-sunlight-464012-e2`.`dbt_dw_raw`.`customers`
  where customer_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m17:30:46.909988 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:30:46.971154 [info ] [Thread-3 (]: 39 of 59 PASS source_not_null_northwind_us_states_state_id ..................... [[32mPASS[0m in 1.86s]
[0m17:30:46.972839 [debug] [Thread-3 (]: Finished running node test.dbt_exercise.source_not_null_northwind_us_states_state_id.2e33a23d78
[0m17:30:46.974055 [debug] [Thread-3 (]: Began running node test.dbt_exercise.source_unique_northwind_employees_employee_id.e63c624594
[0m17:30:46.975537 [info ] [Thread-3 (]: 43 of 59 START test source_unique_northwind_employees_employee_id .............. [RUN]
[0m17:30:46.977896 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_exercise.source_not_null_northwind_us_states_state_id.2e33a23d78, now test.dbt_exercise.source_unique_northwind_employees_employee_id.e63c624594)
[0m17:30:46.988235 [debug] [Thread-3 (]: Began compiling node test.dbt_exercise.source_unique_northwind_employees_employee_id.e63c624594
[0m17:30:47.003235 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_exercise.source_unique_northwind_employees_employee_id.e63c624594"
[0m17:30:47.006001 [debug] [Thread-3 (]: Began executing node test.dbt_exercise.source_unique_northwind_employees_employee_id.e63c624594
[0m17:30:47.014785 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_exercise.source_unique_northwind_employees_employee_id.e63c624594"
[0m17:30:47.018068 [debug] [Thread-3 (]: On test.dbt_exercise.source_unique_northwind_employees_employee_id.e63c624594: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "test.dbt_exercise.source_unique_northwind_employees_employee_id.e63c624594"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with dbt_test__target as (

  select employee_id as unique_field
  from `corded-sunlight-464012-e2`.`dbt_dw_raw`.`employees`
  where employee_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m17:30:47.021109 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m17:30:47.089616 [info ] [Thread-1 (]: 40 of 59 PASS source_unique_northwind_categories_category_id ................... [[32mPASS[0m in 1.90s]
[0m17:30:47.091481 [debug] [Thread-1 (]: Finished running node test.dbt_exercise.source_unique_northwind_categories_category_id.17d9baa2e0
[0m17:30:47.093396 [debug] [Thread-1 (]: Began running node test.dbt_exercise.source_unique_northwind_orders_order_id.4a8a4df128
[0m17:30:47.095691 [info ] [Thread-1 (]: 44 of 59 START test source_unique_northwind_orders_order_id .................... [RUN]
[0m17:30:47.098086 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_exercise.source_unique_northwind_categories_category_id.17d9baa2e0, now test.dbt_exercise.source_unique_northwind_orders_order_id.4a8a4df128)
[0m17:30:47.100332 [debug] [Thread-1 (]: Began compiling node test.dbt_exercise.source_unique_northwind_orders_order_id.4a8a4df128
[0m17:30:47.116994 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_exercise.source_unique_northwind_orders_order_id.4a8a4df128"
[0m17:30:47.118886 [debug] [Thread-1 (]: Began executing node test.dbt_exercise.source_unique_northwind_orders_order_id.4a8a4df128
[0m17:30:47.124636 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_exercise.source_unique_northwind_orders_order_id.4a8a4df128"
[0m17:30:47.126921 [debug] [Thread-1 (]: On test.dbt_exercise.source_unique_northwind_orders_order_id.4a8a4df128: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "test.dbt_exercise.source_unique_northwind_orders_order_id.4a8a4df128"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with dbt_test__target as (

  select order_id as unique_field
  from `corded-sunlight-464012-e2`.`dbt_dw_raw`.`orders`
  where order_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m17:30:47.128389 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:30:47.183710 [info ] [Thread-4 (]: 41 of 59 PASS source_unique_northwind_country_codes_country_code ............... [[32mPASS[0m in 1.86s]
[0m17:30:47.185200 [debug] [Thread-4 (]: Finished running node test.dbt_exercise.source_unique_northwind_country_codes_country_code.cf83d0431e
[0m17:30:47.185849 [debug] [Thread-4 (]: Began running node test.dbt_exercise.source_unique_northwind_products_product_id.740bf6f9a5
[0m17:30:47.186829 [info ] [Thread-4 (]: 45 of 59 START test source_unique_northwind_products_product_id ................ [RUN]
[0m17:30:47.188286 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_exercise.source_unique_northwind_country_codes_country_code.cf83d0431e, now test.dbt_exercise.source_unique_northwind_products_product_id.740bf6f9a5)
[0m17:30:47.189041 [debug] [Thread-4 (]: Began compiling node test.dbt_exercise.source_unique_northwind_products_product_id.740bf6f9a5
[0m17:30:47.196997 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_exercise.source_unique_northwind_products_product_id.740bf6f9a5"
[0m17:30:47.200452 [debug] [Thread-4 (]: Began executing node test.dbt_exercise.source_unique_northwind_products_product_id.740bf6f9a5
[0m17:30:47.206015 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_exercise.source_unique_northwind_products_product_id.740bf6f9a5"
[0m17:30:47.208622 [debug] [Thread-4 (]: On test.dbt_exercise.source_unique_northwind_products_product_id.740bf6f9a5: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "test.dbt_exercise.source_unique_northwind_products_product_id.740bf6f9a5"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with dbt_test__target as (

  select product_id as unique_field
  from `corded-sunlight-464012-e2`.`dbt_dw_raw`.`products`
  where product_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m17:30:47.209805 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m17:30:47.993155 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:754d987b-02f8-4f49-a69a-d79dc8c03f64&page=queryresults
[0m17:30:48.016343 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:45bd71ea-c354-4c1c-9702-aaa18b05b5a5&page=queryresults
[0m17:30:48.121653 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:05dbf91d-a30c-4eeb-b912-98b02c3f84b8&page=queryresults
[0m17:30:48.157738 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:00f450fa-b4e1-4126-90a6-7cc0dd46fcc3&page=queryresults
[0m17:30:48.866489 [info ] [Thread-2 (]: 42 of 59 PASS source_unique_northwind_customers_customer_id .................... [[32mPASS[0m in 1.99s]
[0m17:30:48.868214 [debug] [Thread-2 (]: Finished running node test.dbt_exercise.source_unique_northwind_customers_customer_id.ff818c137b
[0m17:30:48.869250 [debug] [Thread-2 (]: Began running node test.dbt_exercise.source_unique_northwind_region_region_id.9688f1f5fd
[0m17:30:48.870251 [info ] [Thread-2 (]: 46 of 59 START test source_unique_northwind_region_region_id ................... [RUN]
[0m17:30:48.871760 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_exercise.source_unique_northwind_customers_customer_id.ff818c137b, now test.dbt_exercise.source_unique_northwind_region_region_id.9688f1f5fd)
[0m17:30:48.872680 [debug] [Thread-2 (]: Began compiling node test.dbt_exercise.source_unique_northwind_region_region_id.9688f1f5fd
[0m17:30:48.882705 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_exercise.source_unique_northwind_region_region_id.9688f1f5fd"
[0m17:30:48.884702 [debug] [Thread-2 (]: Began executing node test.dbt_exercise.source_unique_northwind_region_region_id.9688f1f5fd
[0m17:30:48.891148 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_exercise.source_unique_northwind_region_region_id.9688f1f5fd"
[0m17:30:48.897035 [info ] [Thread-3 (]: 43 of 59 PASS source_unique_northwind_employees_employee_id .................... [[32mPASS[0m in 1.92s]
[0m17:30:48.898710 [debug] [Thread-3 (]: Finished running node test.dbt_exercise.source_unique_northwind_employees_employee_id.e63c624594
[0m17:30:48.899639 [debug] [Thread-3 (]: Began running node test.dbt_exercise.source_unique_northwind_shippers_shipper_id.61edb3f736
[0m17:30:48.900879 [debug] [Thread-2 (]: On test.dbt_exercise.source_unique_northwind_region_region_id.9688f1f5fd: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "test.dbt_exercise.source_unique_northwind_region_region_id.9688f1f5fd"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with dbt_test__target as (

  select region_id as unique_field
  from `corded-sunlight-464012-e2`.`dbt_dw_raw`.`region`
  where region_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m17:30:48.903112 [info ] [Thread-3 (]: 47 of 59 START test source_unique_northwind_shippers_shipper_id ................ [RUN]
[0m17:30:48.905015 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:30:48.906707 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_exercise.source_unique_northwind_employees_employee_id.e63c624594, now test.dbt_exercise.source_unique_northwind_shippers_shipper_id.61edb3f736)
[0m17:30:48.908502 [debug] [Thread-3 (]: Began compiling node test.dbt_exercise.source_unique_northwind_shippers_shipper_id.61edb3f736
[0m17:30:48.921775 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_exercise.source_unique_northwind_shippers_shipper_id.61edb3f736"
[0m17:30:48.926201 [debug] [Thread-3 (]: Began executing node test.dbt_exercise.source_unique_northwind_shippers_shipper_id.61edb3f736
[0m17:30:48.931911 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_exercise.source_unique_northwind_shippers_shipper_id.61edb3f736"
[0m17:30:48.936370 [debug] [Thread-3 (]: On test.dbt_exercise.source_unique_northwind_shippers_shipper_id.61edb3f736: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "test.dbt_exercise.source_unique_northwind_shippers_shipper_id.61edb3f736"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with dbt_test__target as (

  select shipper_id as unique_field
  from `corded-sunlight-464012-e2`.`dbt_dw_raw`.`shippers`
  where shipper_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m17:30:48.984382 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m17:30:48.994239 [info ] [Thread-4 (]: 45 of 59 PASS source_unique_northwind_products_product_id ...................... [[32mPASS[0m in 1.81s]
[0m17:30:48.997201 [debug] [Thread-4 (]: Finished running node test.dbt_exercise.source_unique_northwind_products_product_id.740bf6f9a5
[0m17:30:49.006697 [debug] [Thread-4 (]: Began running node test.dbt_exercise.source_unique_northwind_suppliers_supplier_id.aa7461739b
[0m17:30:49.012612 [info ] [Thread-4 (]: 48 of 59 START test source_unique_northwind_suppliers_supplier_id .............. [RUN]
[0m17:30:49.061630 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_exercise.source_unique_northwind_products_product_id.740bf6f9a5, now test.dbt_exercise.source_unique_northwind_suppliers_supplier_id.aa7461739b)
[0m17:30:49.063100 [debug] [Thread-4 (]: Began compiling node test.dbt_exercise.source_unique_northwind_suppliers_supplier_id.aa7461739b
[0m17:30:49.071189 [info ] [Thread-1 (]: 44 of 59 PASS source_unique_northwind_orders_order_id .......................... [[32mPASS[0m in 1.97s]
[0m17:30:49.076464 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_exercise.source_unique_northwind_suppliers_supplier_id.aa7461739b"
[0m17:30:49.078505 [debug] [Thread-1 (]: Finished running node test.dbt_exercise.source_unique_northwind_orders_order_id.4a8a4df128
[0m17:30:49.080513 [debug] [Thread-1 (]: Began running node test.dbt_exercise.source_unique_northwind_territories_territory_id.08bc548860
[0m17:30:49.082262 [info ] [Thread-1 (]: 49 of 59 START test source_unique_northwind_territories_territory_id ........... [RUN]
[0m17:30:49.084809 [debug] [Thread-4 (]: Began executing node test.dbt_exercise.source_unique_northwind_suppliers_supplier_id.aa7461739b
[0m17:30:49.086282 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_exercise.source_unique_northwind_orders_order_id.4a8a4df128, now test.dbt_exercise.source_unique_northwind_territories_territory_id.08bc548860)
[0m17:30:49.099813 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_exercise.source_unique_northwind_suppliers_supplier_id.aa7461739b"
[0m17:30:49.101519 [debug] [Thread-1 (]: Began compiling node test.dbt_exercise.source_unique_northwind_territories_territory_id.08bc548860
[0m17:30:49.111068 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_exercise.source_unique_northwind_territories_territory_id.08bc548860"
[0m17:30:49.113187 [debug] [Thread-4 (]: On test.dbt_exercise.source_unique_northwind_suppliers_supplier_id.aa7461739b: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "test.dbt_exercise.source_unique_northwind_suppliers_supplier_id.aa7461739b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with dbt_test__target as (

  select supplier_id as unique_field
  from `corded-sunlight-464012-e2`.`dbt_dw_raw`.`suppliers`
  where supplier_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m17:30:49.115204 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m17:30:49.116912 [debug] [Thread-1 (]: Began executing node test.dbt_exercise.source_unique_northwind_territories_territory_id.08bc548860
[0m17:30:49.122618 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_exercise.source_unique_northwind_territories_territory_id.08bc548860"
[0m17:30:49.124312 [debug] [Thread-1 (]: On test.dbt_exercise.source_unique_northwind_territories_territory_id.08bc548860: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "test.dbt_exercise.source_unique_northwind_territories_territory_id.08bc548860"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with dbt_test__target as (

  select territory_id as unique_field
  from `corded-sunlight-464012-e2`.`dbt_dw_raw`.`territories`
  where territory_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m17:30:49.125361 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:30:51.550484 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:bef8cfa6-7ad5-4036-99db-6b8a137efe39&page=queryresults
[0m17:30:51.638253 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:37025719-5445-4495-af25-ad52dbf00fdc&page=queryresults
[0m17:30:51.647760 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:d26481fc-9ba5-4f83-9930-573447b1c366&page=queryresults
[0m17:30:52.357261 [info ] [Thread-3 (]: 47 of 59 PASS source_unique_northwind_shippers_shipper_id ...................... [[32mPASS[0m in 3.45s]
[0m17:30:52.359770 [debug] [Thread-3 (]: Finished running node test.dbt_exercise.source_unique_northwind_shippers_shipper_id.61edb3f736
[0m17:30:52.361115 [debug] [Thread-3 (]: Began running node test.dbt_exercise.source_unique_northwind_us_states_state_id.c374c85cda
[0m17:30:52.362228 [info ] [Thread-3 (]: 50 of 59 START test source_unique_northwind_us_states_state_id ................. [RUN]
[0m17:30:52.363350 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_exercise.source_unique_northwind_shippers_shipper_id.61edb3f736, now test.dbt_exercise.source_unique_northwind_us_states_state_id.c374c85cda)
[0m17:30:52.364242 [debug] [Thread-3 (]: Began compiling node test.dbt_exercise.source_unique_northwind_us_states_state_id.c374c85cda
[0m17:30:52.374735 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_exercise.source_unique_northwind_us_states_state_id.c374c85cda"
[0m17:30:52.376818 [debug] [Thread-3 (]: Began executing node test.dbt_exercise.source_unique_northwind_us_states_state_id.c374c85cda
[0m17:30:52.389763 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_exercise.source_unique_northwind_us_states_state_id.c374c85cda"
[0m17:30:52.391910 [debug] [Thread-3 (]: On test.dbt_exercise.source_unique_northwind_us_states_state_id.c374c85cda: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "test.dbt_exercise.source_unique_northwind_us_states_state_id.c374c85cda"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with dbt_test__target as (

  select state_id as unique_field
  from `corded-sunlight-464012-e2`.`dbt_dw_raw`.`us_states`
  where state_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m17:30:52.393766 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m17:30:52.447635 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:c3062648-3283-4e72-ad53-40f2e106065b&page=queryresults
[0m17:30:52.464201 [info ] [Thread-1 (]: 49 of 59 PASS source_unique_northwind_territories_territory_id ................. [[32mPASS[0m in 3.38s]
[0m17:30:52.465672 [debug] [Thread-1 (]: Finished running node test.dbt_exercise.source_unique_northwind_territories_territory_id.08bc548860
[0m17:30:52.466503 [debug] [Thread-1 (]: Began running node test.dbt_exercise.unique_dim_customers_customer_id.15c9f1e2fd
[0m17:30:52.467448 [info ] [Thread-1 (]: 51 of 59 START test unique_dim_customers_customer_id ........................... [RUN]
[0m17:30:52.468435 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_exercise.source_unique_northwind_territories_territory_id.08bc548860, now test.dbt_exercise.unique_dim_customers_customer_id.15c9f1e2fd)
[0m17:30:52.469240 [debug] [Thread-1 (]: Began compiling node test.dbt_exercise.unique_dim_customers_customer_id.15c9f1e2fd
[0m17:30:52.477044 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_exercise.unique_dim_customers_customer_id.15c9f1e2fd"
[0m17:30:52.478661 [debug] [Thread-1 (]: Began executing node test.dbt_exercise.unique_dim_customers_customer_id.15c9f1e2fd
[0m17:30:52.483144 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_exercise.unique_dim_customers_customer_id.15c9f1e2fd"
[0m17:30:52.484977 [debug] [Thread-1 (]: On test.dbt_exercise.unique_dim_customers_customer_id.15c9f1e2fd: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "test.dbt_exercise.unique_dim_customers_customer_id.15c9f1e2fd"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with dbt_test__target as (

  select customer_id as unique_field
  from `corded-sunlight-464012-e2`.`dbt_dw_marts`.`dim_customers`
  where customer_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m17:30:52.486252 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:30:52.491371 [info ] [Thread-4 (]: 48 of 59 PASS source_unique_northwind_suppliers_supplier_id .................... [[32mPASS[0m in 3.43s]
[0m17:30:52.493282 [debug] [Thread-4 (]: Finished running node test.dbt_exercise.source_unique_northwind_suppliers_supplier_id.aa7461739b
[0m17:30:52.495023 [debug] [Thread-4 (]: Began running node test.dbt_exercise.unique_dim_customers_sk_customer.54188da6fb
[0m17:30:52.497290 [info ] [Thread-4 (]: 52 of 59 START test unique_dim_customers_sk_customer ........................... [RUN]
[0m17:30:52.499514 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_exercise.source_unique_northwind_suppliers_supplier_id.aa7461739b, now test.dbt_exercise.unique_dim_customers_sk_customer.54188da6fb)
[0m17:30:52.503276 [debug] [Thread-4 (]: Began compiling node test.dbt_exercise.unique_dim_customers_sk_customer.54188da6fb
[0m17:30:52.555622 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_exercise.unique_dim_customers_sk_customer.54188da6fb"
[0m17:30:52.558939 [debug] [Thread-4 (]: Began executing node test.dbt_exercise.unique_dim_customers_sk_customer.54188da6fb
[0m17:30:52.564721 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_exercise.unique_dim_customers_sk_customer.54188da6fb"
[0m17:30:52.566630 [debug] [Thread-4 (]: On test.dbt_exercise.unique_dim_customers_sk_customer.54188da6fb: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "test.dbt_exercise.unique_dim_customers_sk_customer.54188da6fb"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with dbt_test__target as (

  select sk_customer as unique_field
  from `corded-sunlight-464012-e2`.`dbt_dw_marts`.`dim_customers`
  where sk_customer is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m17:30:52.567507 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m17:30:53.227556 [info ] [Thread-2 (]: 46 of 59 PASS source_unique_northwind_region_region_id ......................... [[32mPASS[0m in 4.36s]
[0m17:30:53.229221 [debug] [Thread-2 (]: Finished running node test.dbt_exercise.source_unique_northwind_region_region_id.9688f1f5fd
[0m17:30:53.230196 [debug] [Thread-2 (]: Began running node test.dbt_exercise.unique_dim_employees_employee_id.79828c8f30
[0m17:30:53.231098 [info ] [Thread-2 (]: 53 of 59 START test unique_dim_employees_employee_id ........................... [RUN]
[0m17:30:53.232004 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_exercise.source_unique_northwind_region_region_id.9688f1f5fd, now test.dbt_exercise.unique_dim_employees_employee_id.79828c8f30)
[0m17:30:53.232808 [debug] [Thread-2 (]: Began compiling node test.dbt_exercise.unique_dim_employees_employee_id.79828c8f30
[0m17:30:53.241331 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_exercise.unique_dim_employees_employee_id.79828c8f30"
[0m17:30:53.243158 [debug] [Thread-2 (]: Began executing node test.dbt_exercise.unique_dim_employees_employee_id.79828c8f30
[0m17:30:53.249485 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_exercise.unique_dim_employees_employee_id.79828c8f30"
[0m17:30:53.252878 [debug] [Thread-2 (]: On test.dbt_exercise.unique_dim_employees_employee_id.79828c8f30: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "test.dbt_exercise.unique_dim_employees_employee_id.79828c8f30"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with dbt_test__target as (

  select employee_id as unique_field
  from `corded-sunlight-464012-e2`.`dbt_dw_marts`.`dim_employees`
  where employee_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m17:30:53.254382 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:30:53.466773 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:b7275e08-cdbb-4c0c-8763-41046313064e&page=queryresults
[0m17:30:53.571893 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:040e2b0e-7742-431c-9d28-d07f56877b60&page=queryresults
[0m17:30:53.749515 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:7c1d2171-272f-4517-b2e1-ecd8abd97243&page=queryresults
[0m17:30:54.265524 [info ] [Thread-3 (]: 50 of 59 PASS source_unique_northwind_us_states_state_id ....................... [[32mPASS[0m in 1.90s]
[0m17:30:54.268417 [debug] [Thread-3 (]: Finished running node test.dbt_exercise.source_unique_northwind_us_states_state_id.c374c85cda
[0m17:30:54.270065 [debug] [Thread-3 (]: Began running node test.dbt_exercise.unique_dim_employees_sk_employee.2c4a61e188
[0m17:30:54.281054 [info ] [Thread-3 (]: 54 of 59 START test unique_dim_employees_sk_employee ........................... [RUN]
[0m17:30:54.283280 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_exercise.source_unique_northwind_us_states_state_id.c374c85cda, now test.dbt_exercise.unique_dim_employees_sk_employee.2c4a61e188)
[0m17:30:54.284868 [debug] [Thread-3 (]: Began compiling node test.dbt_exercise.unique_dim_employees_sk_employee.2c4a61e188
[0m17:30:54.314131 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_exercise.unique_dim_employees_sk_employee.2c4a61e188"
[0m17:30:54.318701 [debug] [Thread-3 (]: Began executing node test.dbt_exercise.unique_dim_employees_sk_employee.2c4a61e188
[0m17:30:54.337028 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_exercise.unique_dim_employees_sk_employee.2c4a61e188"
[0m17:30:54.338791 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:51c87e27-0d1a-4817-a794-db702a40d666&page=queryresults
[0m17:30:54.347795 [debug] [Thread-3 (]: On test.dbt_exercise.unique_dim_employees_sk_employee.2c4a61e188: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "test.dbt_exercise.unique_dim_employees_sk_employee.2c4a61e188"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with dbt_test__target as (

  select sk_employee as unique_field
  from `corded-sunlight-464012-e2`.`dbt_dw_marts`.`dim_employees`
  where sk_employee is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m17:30:54.351219 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m17:30:54.505009 [info ] [Thread-1 (]: 51 of 59 PASS unique_dim_customers_customer_id ................................. [[32mPASS[0m in 2.04s]
[0m17:30:54.506644 [debug] [Thread-1 (]: Finished running node test.dbt_exercise.unique_dim_customers_customer_id.15c9f1e2fd
[0m17:30:54.507626 [debug] [Thread-1 (]: Began running node test.dbt_exercise.unique_dim_products_product_id.ef7b2a9985
[0m17:30:54.508746 [info ] [Thread-1 (]: 55 of 59 START test unique_dim_products_product_id ............................. [RUN]
[0m17:30:54.510558 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_exercise.unique_dim_customers_customer_id.15c9f1e2fd, now test.dbt_exercise.unique_dim_products_product_id.ef7b2a9985)
[0m17:30:54.512060 [debug] [Thread-1 (]: Began compiling node test.dbt_exercise.unique_dim_products_product_id.ef7b2a9985
[0m17:30:54.526179 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_exercise.unique_dim_products_product_id.ef7b2a9985"
[0m17:30:54.528491 [debug] [Thread-1 (]: Began executing node test.dbt_exercise.unique_dim_products_product_id.ef7b2a9985
[0m17:30:54.535701 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_exercise.unique_dim_products_product_id.ef7b2a9985"
[0m17:30:54.539848 [debug] [Thread-1 (]: On test.dbt_exercise.unique_dim_products_product_id.ef7b2a9985: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "test.dbt_exercise.unique_dim_products_product_id.ef7b2a9985"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with dbt_test__target as (

  select product_id as unique_field
  from `corded-sunlight-464012-e2`.`dbt_dw_marts`.`dim_products`
  where product_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m17:30:54.541843 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:30:54.624915 [info ] [Thread-4 (]: 52 of 59 PASS unique_dim_customers_sk_customer ................................. [[32mPASS[0m in 2.13s]
[0m17:30:54.631859 [debug] [Thread-4 (]: Finished running node test.dbt_exercise.unique_dim_customers_sk_customer.54188da6fb
[0m17:30:54.634401 [debug] [Thread-4 (]: Began running node test.dbt_exercise.unique_dim_products_sk_product.1658453ef4
[0m17:30:54.636203 [info ] [Thread-4 (]: 56 of 59 START test unique_dim_products_sk_product ............................. [RUN]
[0m17:30:54.637840 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_exercise.unique_dim_customers_sk_customer.54188da6fb, now test.dbt_exercise.unique_dim_products_sk_product.1658453ef4)
[0m17:30:54.638637 [debug] [Thread-4 (]: Began compiling node test.dbt_exercise.unique_dim_products_sk_product.1658453ef4
[0m17:30:54.647509 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_exercise.unique_dim_products_sk_product.1658453ef4"
[0m17:30:54.649867 [debug] [Thread-4 (]: Began executing node test.dbt_exercise.unique_dim_products_sk_product.1658453ef4
[0m17:30:54.656650 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_exercise.unique_dim_products_sk_product.1658453ef4"
[0m17:30:54.658875 [debug] [Thread-4 (]: On test.dbt_exercise.unique_dim_products_sk_product.1658453ef4: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "test.dbt_exercise.unique_dim_products_sk_product.1658453ef4"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with dbt_test__target as (

  select sk_product as unique_field
  from `corded-sunlight-464012-e2`.`dbt_dw_marts`.`dim_products`
  where sk_product is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m17:30:54.660058 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m17:30:55.165799 [info ] [Thread-2 (]: 53 of 59 PASS unique_dim_employees_employee_id ................................. [[32mPASS[0m in 1.93s]
[0m17:30:55.167258 [debug] [Thread-2 (]: Finished running node test.dbt_exercise.unique_dim_employees_employee_id.79828c8f30
[0m17:30:55.168092 [debug] [Thread-2 (]: Began running node test.dbt_exercise.unique_dim_ship_ship_id.8825a91f8e
[0m17:30:55.169087 [info ] [Thread-2 (]: 57 of 59 START test unique_dim_ship_ship_id .................................... [RUN]
[0m17:30:55.170188 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_exercise.unique_dim_employees_employee_id.79828c8f30, now test.dbt_exercise.unique_dim_ship_ship_id.8825a91f8e)
[0m17:30:55.170990 [debug] [Thread-2 (]: Began compiling node test.dbt_exercise.unique_dim_ship_ship_id.8825a91f8e
[0m17:30:55.182447 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_exercise.unique_dim_ship_ship_id.8825a91f8e"
[0m17:30:55.183930 [debug] [Thread-2 (]: Began executing node test.dbt_exercise.unique_dim_ship_ship_id.8825a91f8e
[0m17:30:55.188818 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_exercise.unique_dim_ship_ship_id.8825a91f8e"
[0m17:30:55.191145 [debug] [Thread-2 (]: On test.dbt_exercise.unique_dim_ship_ship_id.8825a91f8e: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "test.dbt_exercise.unique_dim_ship_ship_id.8825a91f8e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with dbt_test__target as (

  select ship_id as unique_field
  from `corded-sunlight-464012-e2`.`dbt_dw_marts`.`dim_ship`
  where ship_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m17:30:55.192900 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:30:55.357390 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:7f623e92-b0ba-44e3-836b-6a2b9fbd8ce6&page=queryresults
[0m17:30:55.610076 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:47cb20c8-2aae-48f8-8652-c50d8d3b3623&page=queryresults
[0m17:30:55.683517 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:01f4bfd3-1464-425c-97b2-70858e82def9&page=queryresults
[0m17:30:56.126014 [info ] [Thread-3 (]: 54 of 59 PASS unique_dim_employees_sk_employee ................................. [[32mPASS[0m in 1.84s]
[0m17:30:56.127300 [debug] [Thread-3 (]: Finished running node test.dbt_exercise.unique_dim_employees_sk_employee.2c4a61e188
[0m17:30:56.128058 [debug] [Thread-3 (]: Began running node test.dbt_exercise.unique_dim_ship_sk_ship.14db8b5f73
[0m17:30:56.128972 [info ] [Thread-3 (]: 58 of 59 START test unique_dim_ship_sk_ship .................................... [RUN]
[0m17:30:56.129892 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_exercise.unique_dim_employees_sk_employee.2c4a61e188, now test.dbt_exercise.unique_dim_ship_sk_ship.14db8b5f73)
[0m17:30:56.130621 [debug] [Thread-3 (]: Began compiling node test.dbt_exercise.unique_dim_ship_sk_ship.14db8b5f73
[0m17:30:56.137530 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_exercise.unique_dim_ship_sk_ship.14db8b5f73"
[0m17:30:56.139391 [debug] [Thread-3 (]: Began executing node test.dbt_exercise.unique_dim_ship_sk_ship.14db8b5f73
[0m17:30:56.146457 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_exercise.unique_dim_ship_sk_ship.14db8b5f73"
[0m17:30:56.148313 [debug] [Thread-3 (]: On test.dbt_exercise.unique_dim_ship_sk_ship.14db8b5f73: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "test.dbt_exercise.unique_dim_ship_sk_ship.14db8b5f73"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with dbt_test__target as (

  select sk_ship as unique_field
  from `corded-sunlight-464012-e2`.`dbt_dw_marts`.`dim_ship`
  where sk_ship is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m17:30:56.152116 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m17:30:56.395135 [info ] [Thread-1 (]: 55 of 59 PASS unique_dim_products_product_id ................................... [[32mPASS[0m in 1.88s]
[0m17:30:56.396772 [debug] [Thread-1 (]: Finished running node test.dbt_exercise.unique_dim_products_product_id.ef7b2a9985
[0m17:30:56.397637 [debug] [Thread-1 (]: Began running node test.dbt_exercise.unique_fact_orders_sk_orders.072a29dba8
[0m17:30:56.398522 [info ] [Thread-1 (]: 59 of 59 START test unique_fact_orders_sk_orders ............................... [RUN]
[0m17:30:56.400076 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_exercise.unique_dim_products_product_id.ef7b2a9985, now test.dbt_exercise.unique_fact_orders_sk_orders.072a29dba8)
[0m17:30:56.401115 [debug] [Thread-1 (]: Began compiling node test.dbt_exercise.unique_fact_orders_sk_orders.072a29dba8
[0m17:30:56.411130 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_exercise.unique_fact_orders_sk_orders.072a29dba8"
[0m17:30:56.412782 [debug] [Thread-1 (]: Began executing node test.dbt_exercise.unique_fact_orders_sk_orders.072a29dba8
[0m17:30:56.419786 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_exercise.unique_fact_orders_sk_orders.072a29dba8"
[0m17:30:56.422471 [debug] [Thread-1 (]: On test.dbt_exercise.unique_fact_orders_sk_orders.072a29dba8: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "test.dbt_exercise.unique_fact_orders_sk_orders.072a29dba8"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with dbt_test__target as (

  select sk_orders as unique_field
  from `corded-sunlight-464012-e2`.`dbt_dw_marts`.`fact_orders`
  where sk_orders is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m17:30:56.424263 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:30:56.481343 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:ea3d65bf-23a9-4b0b-a34b-f0814b823f32&page=queryresults
[0m17:30:56.589746 [info ] [Thread-4 (]: 56 of 59 PASS unique_dim_products_sk_product ................................... [[32mPASS[0m in 1.95s]
[0m17:30:56.591019 [debug] [Thread-4 (]: Finished running node test.dbt_exercise.unique_dim_products_sk_product.1658453ef4
[0m17:30:57.188851 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:c496a2fe-7e36-4146-93a0-8fe0e1a58ef5&page=queryresults
[0m17:30:57.333136 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:7aca0d54-5d9b-46ef-af87-b611f9fc5e79&page=queryresults
[0m17:30:57.378500 [info ] [Thread-2 (]: 57 of 59 PASS unique_dim_ship_ship_id .......................................... [[32mPASS[0m in 2.21s]
[0m17:30:57.379944 [debug] [Thread-2 (]: Finished running node test.dbt_exercise.unique_dim_ship_ship_id.8825a91f8e
[0m17:30:57.971791 [info ] [Thread-3 (]: 58 of 59 PASS unique_dim_ship_sk_ship .......................................... [[32mPASS[0m in 1.84s]
[0m17:30:57.973482 [debug] [Thread-3 (]: Finished running node test.dbt_exercise.unique_dim_ship_sk_ship.14db8b5f73
[0m17:30:58.179608 [info ] [Thread-1 (]: 59 of 59 PASS unique_fact_orders_sk_orders ..................................... [[32mPASS[0m in 1.78s]
[0m17:30:58.181822 [debug] [Thread-1 (]: Finished running node test.dbt_exercise.unique_fact_orders_sk_orders.072a29dba8
[0m17:30:58.187145 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:30:58.196950 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:30:58.197874 [debug] [MainThread]: Connection 'test.dbt_exercise.unique_dim_ship_ship_id.8825a91f8e' was properly closed.
[0m17:30:58.198842 [debug] [MainThread]: Connection 'test.dbt_exercise.unique_fact_orders_sk_orders.072a29dba8' was properly closed.
[0m17:30:58.201488 [debug] [MainThread]: Connection 'test.dbt_exercise.unique_dim_products_sk_product.1658453ef4' was properly closed.
[0m17:30:58.204237 [debug] [MainThread]: Connection 'test.dbt_exercise.unique_dim_ship_sk_ship.14db8b5f73' was properly closed.
[0m17:30:58.205986 [info ] [MainThread]: 
[0m17:30:58.207183 [info ] [MainThread]: Finished running 59 data tests in 0 hours 0 minutes and 37.23 seconds (37.23s).
[0m17:30:58.222898 [debug] [MainThread]: Command end result
[0m17:30:58.312203 [debug] [MainThread]: Wrote artifact WritableManifest to /home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/target/manifest.json
[0m17:30:58.327782 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/target/semantic_manifest.json
[0m17:30:58.343508 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/target/run_results.json
[0m17:30:58.344130 [info ] [MainThread]: 
[0m17:30:58.344888 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m17:30:58.345846 [info ] [MainThread]: 
[0m17:30:58.348523 [error] [MainThread]: [31mFailure in test accepted_values_dim_products_is_discontinued__true__false (models/marts/dim_products.yml)[0m
[0m17:30:58.350037 [error] [MainThread]:   Database Error in test accepted_values_dim_products_is_discontinued__true__false (models/marts/dim_products.yml)
  No matching signature for operator IN for argument types BOOL and {STRING} at [27:23]
  compiled code at target/run/dbt_exercise/models/marts/dim_products.yml/accepted_values_dim_products_is_discontinued__true__false.sql
[0m17:30:58.351058 [info ] [MainThread]: 
[0m17:30:58.351975 [info ] [MainThread]:   compiled code at target/compiled/dbt_exercise/models/marts/dim_products.yml/accepted_values_dim_products_is_discontinued__true__false.sql
[0m17:30:58.353238 [info ] [MainThread]: 
[0m17:30:58.354297 [info ] [MainThread]: Done. PASS=58 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=59
[0m17:30:58.355910 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- DuplicateYAMLKeysDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m17:30:58.361537 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": false, "command_wall_clock_time": 153.99774, "process_in_blocks": "122920", "process_kernel_time": 17.480602, "process_mem_max_rss": "375300", "process_out_blocks": "5240", "process_user_time": 19.073086}
[0m17:30:58.363931 [debug] [MainThread]: Command `dbt test` failed at 17:30:58.363011 after 154.00 seconds
[0m17:30:58.365810 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e21c2578050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e2184183fb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e2163fd2330>]}
[0m17:30:58.366532 [debug] [MainThread]: Flushing usage events
[0m17:30:58.680840 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:32:05.976246 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f047b4eac60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f047af6d040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f047bbca120>]}


============================== 17:32:05.998077 | 58fc1512-2adb-4778-b100-8ec4404fb9a0 ==============================
[0m17:32:05.998077 [info ] [MainThread]: Running with dbt=1.10.2
[0m17:32:05.999074 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise', 'log_path': '/home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt test -s dim_products', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:33:07.544767 [warn ] [MainThread]: [[33mWARNING[0m][DuplicateYAMLKeysDeprecation]: Deprecated functionality
Duplicate key 'version' in "<unicode string>", line 4, column 1 in file
`/home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/dbt_project.yml`
[0m17:33:07.545728 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '58fc1512-2adb-4778-b100-8ec4404fb9a0', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f047ab59430>]}
[0m17:33:08.302456 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '58fc1512-2adb-4778-b100-8ec4404fb9a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f043dca1cd0>]}
[0m17:33:08.419411 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '58fc1512-2adb-4778-b100-8ec4404fb9a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f047af4d8e0>]}
[0m17:33:08.424017 [info ] [MainThread]: Registered adapter: bigquery=1.9.2
[0m17:34:18.297366 [debug] [MainThread]: checksum: 1adc40777973ef30f45f80b3b6d04d5013c1edd53d96363881b3b199e612468b, vars: {}, profile: , target: , version: 1.10.2
[0m17:34:23.673542 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:34:23.674235 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:34:23.976895 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '58fc1512-2adb-4778-b100-8ec4404fb9a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f043d815760>]}
[0m17:34:24.112392 [debug] [MainThread]: Wrote artifact WritableManifest to /home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/target/manifest.json
[0m17:34:24.122498 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/target/semantic_manifest.json
[0m17:34:24.525217 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '58fc1512-2adb-4778-b100-8ec4404fb9a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f043d3aeae0>]}
[0m17:34:24.526247 [info ] [MainThread]: Found 19 models, 14 seeds, 59 data tests, 14 sources, 609 macros
[0m17:34:24.527106 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '58fc1512-2adb-4778-b100-8ec4404fb9a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f047b54c710>]}
[0m17:34:24.531105 [info ] [MainThread]: 
[0m17:34:24.531680 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m17:34:24.532125 [info ] [MainThread]: 
[0m17:34:24.532826 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m17:34:24.541376 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_corded-sunlight-464012-e2_dbt_dw_staging'
[0m17:34:24.543057 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_corded-sunlight-464012-e2_dbt_dw_marts'
[0m17:34:24.543807 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:34:24.545467 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_corded-sunlight-464012-e2_dbt_dw_intermediate'
[0m17:34:24.546518 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:34:24.547844 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_corded-sunlight-464012-e2_dbt_dw_raw'
[0m17:34:24.548978 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:34:24.550259 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:34:25.423162 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '58fc1512-2adb-4778-b100-8ec4404fb9a0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f043d9dd370>]}
[0m17:34:25.423920 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:34:25.435406 [debug] [Thread-1 (]: Began running node test.dbt_exercise.accepted_values_dim_products_is_discontinued__True__False.b53ac91bb6
[0m17:34:25.436286 [debug] [Thread-2 (]: Began running node test.dbt_exercise.not_null_dim_products_product_id.c8aba288d1
[0m17:34:25.437396 [debug] [Thread-3 (]: Began running node test.dbt_exercise.not_null_dim_products_sk_product.7ce7792ece
[0m17:34:25.436893 [info ] [Thread-1 (]: 1 of 5 START test accepted_values_dim_products_is_discontinued__True__False .... [RUN]
[0m17:34:25.438377 [debug] [Thread-4 (]: Began running node test.dbt_exercise.unique_dim_products_product_id.ef7b2a9985
[0m17:34:25.439188 [info ] [Thread-2 (]: 2 of 5 START test not_null_dim_products_product_id ............................. [RUN]
[0m17:34:25.440140 [info ] [Thread-3 (]: 3 of 5 START test not_null_dim_products_sk_product ............................. [RUN]
[0m17:34:25.441128 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_corded-sunlight-464012-e2_dbt_dw_staging, now test.dbt_exercise.accepted_values_dim_products_is_discontinued__True__False.b53ac91bb6)
[0m17:34:25.442194 [info ] [Thread-4 (]: 4 of 5 START test unique_dim_products_product_id ............................... [RUN]
[0m17:34:25.443363 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_corded-sunlight-464012-e2_dbt_dw_intermediate, now test.dbt_exercise.not_null_dim_products_product_id.c8aba288d1)
[0m17:34:25.444386 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_corded-sunlight-464012-e2_dbt_dw_marts, now test.dbt_exercise.not_null_dim_products_sk_product.7ce7792ece)
[0m17:34:25.445744 [debug] [Thread-1 (]: Began compiling node test.dbt_exercise.accepted_values_dim_products_is_discontinued__True__False.b53ac91bb6
[0m17:34:25.447194 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly list_corded-sunlight-464012-e2_dbt_dw_raw, now test.dbt_exercise.unique_dim_products_product_id.ef7b2a9985)
[0m17:34:25.448124 [debug] [Thread-2 (]: Began compiling node test.dbt_exercise.not_null_dim_products_product_id.c8aba288d1
[0m17:34:25.449143 [debug] [Thread-3 (]: Began compiling node test.dbt_exercise.not_null_dim_products_sk_product.7ce7792ece
[0m17:34:25.472339 [debug] [Thread-4 (]: Began compiling node test.dbt_exercise.unique_dim_products_product_id.ef7b2a9985
[0m17:34:25.485057 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_exercise.accepted_values_dim_products_is_discontinued__True__False.b53ac91bb6"
[0m17:34:25.500685 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_exercise.not_null_dim_products_product_id.c8aba288d1"
[0m17:34:25.508172 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_exercise.not_null_dim_products_sk_product.7ce7792ece"
[0m17:34:25.519839 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_exercise.unique_dim_products_product_id.ef7b2a9985"
[0m17:34:25.523181 [debug] [Thread-2 (]: Began executing node test.dbt_exercise.not_null_dim_products_product_id.c8aba288d1
[0m17:34:25.523893 [debug] [Thread-1 (]: Began executing node test.dbt_exercise.accepted_values_dim_products_is_discontinued__True__False.b53ac91bb6
[0m17:34:25.524935 [debug] [Thread-3 (]: Began executing node test.dbt_exercise.not_null_dim_products_sk_product.7ce7792ece
[0m17:34:25.542104 [debug] [Thread-4 (]: Began executing node test.dbt_exercise.unique_dim_products_product_id.ef7b2a9985
[0m17:34:25.599414 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_exercise.accepted_values_dim_products_is_discontinued__True__False.b53ac91bb6"
[0m17:34:25.600380 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_exercise.not_null_dim_products_product_id.c8aba288d1"
[0m17:34:25.604829 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_exercise.not_null_dim_products_sk_product.7ce7792ece"
[0m17:34:25.608943 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_exercise.unique_dim_products_product_id.ef7b2a9985"
[0m17:34:25.611439 [debug] [Thread-1 (]: On test.dbt_exercise.accepted_values_dim_products_is_discontinued__True__False.b53ac91bb6: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "test.dbt_exercise.accepted_values_dim_products_is_discontinued__True__False.b53ac91bb6"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        is_discontinued as value_field,
        count(*) as n_records

    from `corded-sunlight-464012-e2`.`dbt_dw_marts`.`dim_products`
    group by is_discontinued

)

select *
from all_values
where value_field not in (
    'True','False'
)



  
  
      
    ) dbt_internal_test
[0m17:34:25.613781 [debug] [Thread-2 (]: On test.dbt_exercise.not_null_dim_products_product_id.c8aba288d1: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "test.dbt_exercise.not_null_dim_products_product_id.c8aba288d1"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select product_id
from `corded-sunlight-464012-e2`.`dbt_dw_marts`.`dim_products`
where product_id is null



  
  
      
    ) dbt_internal_test
[0m17:34:25.615054 [debug] [Thread-3 (]: On test.dbt_exercise.not_null_dim_products_sk_product.7ce7792ece: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "test.dbt_exercise.not_null_dim_products_sk_product.7ce7792ece"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select sk_product
from `corded-sunlight-464012-e2`.`dbt_dw_marts`.`dim_products`
where sk_product is null



  
  
      
    ) dbt_internal_test
[0m17:34:25.616040 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:34:25.617003 [debug] [Thread-4 (]: On test.dbt_exercise.unique_dim_products_product_id.ef7b2a9985: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "test.dbt_exercise.unique_dim_products_product_id.ef7b2a9985"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with dbt_test__target as (

  select product_id as unique_field
  from `corded-sunlight-464012-e2`.`dbt_dw_marts`.`dim_products`
  where product_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m17:34:25.617733 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:34:25.618602 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m17:34:25.619800 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m17:34:26.819475 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:c1c4f751-4928-4c03-8029-6fd66b29325c&page=queryresults
[0m17:34:26.823046 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:9d70f181-7adb-41eb-99ff-e95a35d3f324&page=queryresults
[0m17:34:26.825455 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:adf52d6d-4cc6-489d-bd44-e1dd7b190bba&page=queryresults
[0m17:34:26.824134 [error] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:c1c4f751-4928-4c03-8029-6fd66b29325c&page=queryresults
[0m17:34:26.827524 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:b1c2f3bb-e602-4a58-a13b-151f1229abea&page=queryresults
[0m17:34:26.959163 [debug] [Thread-1 (]: Database Error in test accepted_values_dim_products_is_discontinued__True__False (models/marts/dim_products.yml)
  No matching signature for operator IN for argument types BOOL and {STRING} at [27:23]
  compiled code at target/run/dbt_exercise/models/marts/dim_products.yml/accepted_values_dim_products_is_discontinued__True__False.sql
[0m17:34:26.960357 [error] [Thread-1 (]: 1 of 5 ERROR accepted_values_dim_products_is_discontinued__True__False ......... [[31mERROR[0m in 1.52s]
[0m17:34:26.961510 [debug] [Thread-1 (]: Finished running node test.dbt_exercise.accepted_values_dim_products_is_discontinued__True__False.b53ac91bb6
[0m17:34:26.962663 [debug] [Thread-1 (]: Began running node test.dbt_exercise.unique_dim_products_sk_product.1658453ef4
[0m17:34:26.963898 [debug] [Thread-7 (]: Marking all children of 'test.dbt_exercise.accepted_values_dim_products_is_discontinued__True__False.b53ac91bb6' to be skipped because of status 'error'.  Reason: Database Error in test accepted_values_dim_products_is_discontinued__True__False (models/marts/dim_products.yml)
  No matching signature for operator IN for argument types BOOL and {STRING} at [27:23]
  compiled code at target/run/dbt_exercise/models/marts/dim_products.yml/accepted_values_dim_products_is_discontinued__True__False.sql.
[0m17:34:26.964801 [info ] [Thread-1 (]: 5 of 5 START test unique_dim_products_sk_product ............................... [RUN]
[0m17:34:26.967547 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_exercise.accepted_values_dim_products_is_discontinued__True__False.b53ac91bb6, now test.dbt_exercise.unique_dim_products_sk_product.1658453ef4)
[0m17:34:26.968715 [debug] [Thread-1 (]: Began compiling node test.dbt_exercise.unique_dim_products_sk_product.1658453ef4
[0m17:34:26.977363 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_exercise.unique_dim_products_sk_product.1658453ef4"
[0m17:34:26.979437 [debug] [Thread-1 (]: Began executing node test.dbt_exercise.unique_dim_products_sk_product.1658453ef4
[0m17:34:26.984575 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_exercise.unique_dim_products_sk_product.1658453ef4"
[0m17:34:26.986388 [debug] [Thread-1 (]: On test.dbt_exercise.unique_dim_products_sk_product.1658453ef4: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "test.dbt_exercise.unique_dim_products_sk_product.1658453ef4"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with dbt_test__target as (

  select sk_product as unique_field
  from `corded-sunlight-464012-e2`.`dbt_dw_marts`.`dim_products`
  where sk_product is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m17:34:26.987309 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:34:27.956358 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:b47332fa-0313-4c08-bfc8-f21c148dfe9a&page=queryresults
[0m17:34:33.211238 [info ] [Thread-3 (]: 3 of 5 PASS not_null_dim_products_sk_product ................................... [[32mPASS[0m in 7.76s]
[0m17:34:33.223036 [info ] [Thread-4 (]: 4 of 5 PASS unique_dim_products_product_id ..................................... [[32mPASS[0m in 7.78s]
[0m17:34:33.233744 [info ] [Thread-2 (]: 2 of 5 PASS not_null_dim_products_product_id ................................... [[32mPASS[0m in 7.79s]
[0m17:34:33.236722 [info ] [Thread-1 (]: 5 of 5 PASS unique_dim_products_sk_product ..................................... [[32mPASS[0m in 6.27s]
[0m17:34:33.239801 [debug] [Thread-3 (]: Finished running node test.dbt_exercise.not_null_dim_products_sk_product.7ce7792ece
[0m17:34:33.241860 [debug] [Thread-4 (]: Finished running node test.dbt_exercise.unique_dim_products_product_id.ef7b2a9985
[0m17:34:33.244209 [debug] [Thread-2 (]: Finished running node test.dbt_exercise.not_null_dim_products_product_id.c8aba288d1
[0m17:34:33.246101 [debug] [Thread-1 (]: Finished running node test.dbt_exercise.unique_dim_products_sk_product.1658453ef4
[0m17:34:33.254429 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:34:33.292287 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:34:33.293498 [debug] [MainThread]: Connection 'test.dbt_exercise.unique_dim_products_sk_product.1658453ef4' was properly closed.
[0m17:34:33.294622 [debug] [MainThread]: Connection 'test.dbt_exercise.not_null_dim_products_sk_product.7ce7792ece' was properly closed.
[0m17:34:33.295909 [debug] [MainThread]: Connection 'test.dbt_exercise.not_null_dim_products_product_id.c8aba288d1' was properly closed.
[0m17:34:33.296943 [debug] [MainThread]: Connection 'test.dbt_exercise.unique_dim_products_product_id.ef7b2a9985' was properly closed.
[0m17:34:33.298308 [info ] [MainThread]: 
[0m17:34:33.309778 [info ] [MainThread]: Finished running 5 data tests in 0 hours 0 minutes and 8.77 seconds (8.77s).
[0m17:34:33.313944 [debug] [MainThread]: Command end result
[0m17:34:33.462102 [debug] [MainThread]: Wrote artifact WritableManifest to /home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/target/manifest.json
[0m17:34:33.481037 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/target/semantic_manifest.json
[0m17:34:33.491046 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/target/run_results.json
[0m17:34:33.493216 [info ] [MainThread]: 
[0m17:34:33.493996 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m17:34:33.494688 [info ] [MainThread]: 
[0m17:34:33.495366 [error] [MainThread]: [31mFailure in test accepted_values_dim_products_is_discontinued__True__False (models/marts/dim_products.yml)[0m
[0m17:34:33.496026 [error] [MainThread]:   Database Error in test accepted_values_dim_products_is_discontinued__True__False (models/marts/dim_products.yml)
  No matching signature for operator IN for argument types BOOL and {STRING} at [27:23]
  compiled code at target/run/dbt_exercise/models/marts/dim_products.yml/accepted_values_dim_products_is_discontinued__True__False.sql
[0m17:34:33.496564 [info ] [MainThread]: 
[0m17:34:33.497266 [info ] [MainThread]:   compiled code at target/compiled/dbt_exercise/models/marts/dim_products.yml/accepted_values_dim_products_is_discontinued__True__False.sql
[0m17:34:33.497825 [info ] [MainThread]: 
[0m17:34:33.498680 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=5
[0m17:34:33.499731 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- DuplicateYAMLKeysDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m17:34:33.506233 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": false, "command_wall_clock_time": 141.92015, "process_in_blocks": "122920", "process_kernel_time": 19.029196, "process_mem_max_rss": "370740", "process_out_blocks": "3952", "process_user_time": 14.905563}
[0m17:34:33.507477 [debug] [MainThread]: Command `dbt test` failed at 17:34:33.507186 after 141.92 seconds
[0m17:34:33.508370 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f047ab103e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f047b3251f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f047bbcbfe0>]}
[0m17:34:33.509165 [debug] [MainThread]: Flushing usage events
[0m17:34:33.855519 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:36:06.210011 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e48611dfd10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e4860dd6ba0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e4861249370>]}


============================== 17:36:06.233780 | 6bf142af-76b3-4795-aaa9-78aa81ab67da ==============================
[0m17:36:06.233780 [info ] [MainThread]: Running with dbt=1.10.2
[0m17:36:06.234719 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/logs', 'debug': 'False', 'profiles_dir': '/home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt test -s dim_products', 'send_anonymous_usage_stats': 'True'}
[0m17:37:10.720643 [warn ] [MainThread]: [[33mWARNING[0m][DuplicateYAMLKeysDeprecation]: Deprecated functionality
Duplicate key 'version' in "<unicode string>", line 4, column 1 in file
`/home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/dbt_project.yml`
[0m17:37:10.721586 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '6bf142af-76b3-4795-aaa9-78aa81ab67da', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e48238d85c0>]}
[0m17:37:11.539847 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6bf142af-76b3-4795-aaa9-78aa81ab67da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e4823328b60>]}
[0m17:37:11.611075 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6bf142af-76b3-4795-aaa9-78aa81ab67da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e486116c830>]}
[0m17:37:11.614724 [info ] [MainThread]: Registered adapter: bigquery=1.9.2
[0m17:38:11.568101 [debug] [MainThread]: checksum: 1adc40777973ef30f45f80b3b6d04d5013c1edd53d96363881b3b199e612468b, vars: {}, profile: , target: , version: 1.10.2
[0m17:38:17.938709 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:38:17.939378 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:38:18.227673 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6bf142af-76b3-4795-aaa9-78aa81ab67da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e4823015760>]}
[0m17:38:18.410893 [debug] [MainThread]: Wrote artifact WritableManifest to /home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/target/manifest.json
[0m17:38:18.426293 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/target/semantic_manifest.json
[0m17:38:18.985912 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6bf142af-76b3-4795-aaa9-78aa81ab67da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e4822da3a40>]}
[0m17:38:18.986806 [info ] [MainThread]: Found 19 models, 14 seeds, 59 data tests, 14 sources, 609 macros
[0m17:38:18.987624 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6bf142af-76b3-4795-aaa9-78aa81ab67da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e4823273800>]}
[0m17:38:18.991201 [info ] [MainThread]: 
[0m17:38:18.992022 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m17:38:18.992611 [info ] [MainThread]: 
[0m17:38:18.993754 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m17:38:19.010773 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_corded-sunlight-464012-e2_dbt_dw_intermediate'
[0m17:38:19.012385 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_corded-sunlight-464012-e2_dbt_dw_raw'
[0m17:38:19.013186 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:38:19.014819 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_corded-sunlight-464012-e2_dbt_dw_marts'
[0m17:38:19.016367 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:38:19.017831 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_corded-sunlight-464012-e2_dbt_dw_staging'
[0m17:38:19.019055 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:38:19.020343 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:38:20.133514 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6bf142af-76b3-4795-aaa9-78aa81ab67da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e482337a1e0>]}
[0m17:38:20.135216 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:38:20.152932 [debug] [Thread-1 (]: Began running node test.dbt_exercise.accepted_values_dim_products_is_discontinued__False__True__False.4507b1e7d2
[0m17:38:20.154191 [debug] [Thread-2 (]: Began running node test.dbt_exercise.not_null_dim_products_product_id.c8aba288d1
[0m17:38:20.155387 [debug] [Thread-3 (]: Began running node test.dbt_exercise.not_null_dim_products_sk_product.7ce7792ece
[0m17:38:20.156306 [info ] [Thread-1 (]: 1 of 5 START test accepted_values_dim_products_is_discontinued__False__True__False  [RUN]
[0m17:38:20.157734 [debug] [Thread-4 (]: Began running node test.dbt_exercise.unique_dim_products_product_id.ef7b2a9985
[0m17:38:20.158757 [info ] [Thread-2 (]: 2 of 5 START test not_null_dim_products_product_id ............................. [RUN]
[0m17:38:20.160227 [info ] [Thread-3 (]: 3 of 5 START test not_null_dim_products_sk_product ............................. [RUN]
[0m17:38:20.161445 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_corded-sunlight-464012-e2_dbt_dw_staging, now test.dbt_exercise.accepted_values_dim_products_is_discontinued__False__True__False.4507b1e7d2)
[0m17:38:20.162404 [info ] [Thread-4 (]: 4 of 5 START test unique_dim_products_product_id ............................... [RUN]
[0m17:38:20.163638 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_corded-sunlight-464012-e2_dbt_dw_raw, now test.dbt_exercise.not_null_dim_products_product_id.c8aba288d1)
[0m17:38:20.164708 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_corded-sunlight-464012-e2_dbt_dw_intermediate, now test.dbt_exercise.not_null_dim_products_sk_product.7ce7792ece)
[0m17:38:20.165946 [debug] [Thread-1 (]: Began compiling node test.dbt_exercise.accepted_values_dim_products_is_discontinued__False__True__False.4507b1e7d2
[0m17:38:20.167273 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly list_corded-sunlight-464012-e2_dbt_dw_marts, now test.dbt_exercise.unique_dim_products_product_id.ef7b2a9985)
[0m17:38:20.168293 [debug] [Thread-2 (]: Began compiling node test.dbt_exercise.not_null_dim_products_product_id.c8aba288d1
[0m17:38:20.169426 [debug] [Thread-3 (]: Began compiling node test.dbt_exercise.not_null_dim_products_sk_product.7ce7792ece
[0m17:38:20.194469 [debug] [Thread-4 (]: Began compiling node test.dbt_exercise.unique_dim_products_product_id.ef7b2a9985
[0m17:38:20.207182 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_exercise.accepted_values_dim_products_is_discontinued__False__True__False.4507b1e7d2"
[0m17:38:20.223130 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_exercise.not_null_dim_products_product_id.c8aba288d1"
[0m17:38:20.230083 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_exercise.not_null_dim_products_sk_product.7ce7792ece"
[0m17:38:20.240911 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_exercise.unique_dim_products_product_id.ef7b2a9985"
[0m17:38:20.243747 [debug] [Thread-1 (]: Began executing node test.dbt_exercise.accepted_values_dim_products_is_discontinued__False__True__False.4507b1e7d2
[0m17:38:20.245062 [debug] [Thread-2 (]: Began executing node test.dbt_exercise.not_null_dim_products_product_id.c8aba288d1
[0m17:38:20.246354 [debug] [Thread-3 (]: Began executing node test.dbt_exercise.not_null_dim_products_sk_product.7ce7792ece
[0m17:38:20.264632 [debug] [Thread-4 (]: Began executing node test.dbt_exercise.unique_dim_products_product_id.ef7b2a9985
[0m17:38:20.286946 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_exercise.accepted_values_dim_products_is_discontinued__False__True__False.4507b1e7d2"
[0m17:38:20.295286 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_exercise.not_null_dim_products_product_id.c8aba288d1"
[0m17:38:20.299428 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_exercise.not_null_dim_products_sk_product.7ce7792ece"
[0m17:38:20.304069 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_exercise.unique_dim_products_product_id.ef7b2a9985"
[0m17:38:20.307281 [debug] [Thread-1 (]: On test.dbt_exercise.accepted_values_dim_products_is_discontinued__False__True__False.4507b1e7d2: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "test.dbt_exercise.accepted_values_dim_products_is_discontinued__False__True__False.4507b1e7d2"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        is_discontinued as value_field,
        count(*) as n_records

    from `corded-sunlight-464012-e2`.`dbt_dw_marts`.`dim_products`
    group by is_discontinued

)

select *
from all_values
where value_field not in (
    True,False
)



  
  
      
    ) dbt_internal_test
[0m17:38:20.310044 [debug] [Thread-2 (]: On test.dbt_exercise.not_null_dim_products_product_id.c8aba288d1: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "test.dbt_exercise.not_null_dim_products_product_id.c8aba288d1"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select product_id
from `corded-sunlight-464012-e2`.`dbt_dw_marts`.`dim_products`
where product_id is null



  
  
      
    ) dbt_internal_test
[0m17:38:20.311524 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:38:20.312816 [debug] [Thread-3 (]: On test.dbt_exercise.not_null_dim_products_sk_product.7ce7792ece: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "test.dbt_exercise.not_null_dim_products_sk_product.7ce7792ece"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select sk_product
from `corded-sunlight-464012-e2`.`dbt_dw_marts`.`dim_products`
where sk_product is null



  
  
      
    ) dbt_internal_test
[0m17:38:20.314599 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:38:20.315806 [debug] [Thread-4 (]: On test.dbt_exercise.unique_dim_products_product_id.ef7b2a9985: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "test.dbt_exercise.unique_dim_products_product_id.ef7b2a9985"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with dbt_test__target as (

  select product_id as unique_field
  from `corded-sunlight-464012-e2`.`dbt_dw_marts`.`dim_products`
  where product_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m17:38:20.318091 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m17:38:20.320030 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m17:38:21.465752 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:870cd5b4-fb1e-417b-89e1-9a0c2ef00258&page=queryresults
[0m17:38:21.513902 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:e074c41f-2015-40c7-956c-49817e9990f2&page=queryresults
[0m17:38:21.539751 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:d65a8a4f-8dff-48a5-a580-3252f3b98004&page=queryresults
[0m17:38:21.627090 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:13069b6a-d4fa-471b-bbd1-9e071f7cefcd&page=queryresults
[0m17:38:27.183862 [info ] [Thread-1 (]: 1 of 5 PASS accepted_values_dim_products_is_discontinued__False__True__False ... [[32mPASS[0m in 7.02s]
[0m17:38:27.185455 [debug] [Thread-1 (]: Finished running node test.dbt_exercise.accepted_values_dim_products_is_discontinued__False__True__False.4507b1e7d2
[0m17:38:27.186218 [debug] [Thread-1 (]: Began running node test.dbt_exercise.unique_dim_products_sk_product.1658453ef4
[0m17:38:27.187363 [info ] [Thread-1 (]: 5 of 5 START test unique_dim_products_sk_product ............................... [RUN]
[0m17:38:27.190393 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_exercise.accepted_values_dim_products_is_discontinued__False__True__False.4507b1e7d2, now test.dbt_exercise.unique_dim_products_sk_product.1658453ef4)
[0m17:38:27.192416 [debug] [Thread-1 (]: Began compiling node test.dbt_exercise.unique_dim_products_sk_product.1658453ef4
[0m17:38:27.195287 [info ] [Thread-4 (]: 4 of 5 PASS unique_dim_products_product_id ..................................... [[32mPASS[0m in 7.03s]
[0m17:38:27.204683 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_exercise.unique_dim_products_sk_product.1658453ef4"
[0m17:38:27.206629 [debug] [Thread-4 (]: Finished running node test.dbt_exercise.unique_dim_products_product_id.ef7b2a9985
[0m17:38:27.209990 [info ] [Thread-2 (]: 2 of 5 PASS not_null_dim_products_product_id ................................... [[32mPASS[0m in 7.05s]
[0m17:38:27.211111 [debug] [Thread-2 (]: Finished running node test.dbt_exercise.not_null_dim_products_product_id.c8aba288d1
[0m17:38:27.212530 [debug] [Thread-1 (]: Began executing node test.dbt_exercise.unique_dim_products_sk_product.1658453ef4
[0m17:38:27.219217 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_exercise.unique_dim_products_sk_product.1658453ef4"
[0m17:38:27.222137 [debug] [Thread-1 (]: On test.dbt_exercise.unique_dim_products_sk_product.1658453ef4: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "test.dbt_exercise.unique_dim_products_sk_product.1658453ef4"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with dbt_test__target as (

  select sk_product as unique_field
  from `corded-sunlight-464012-e2`.`dbt_dw_marts`.`dim_products`
  where sk_product is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m17:38:27.223151 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:38:27.276495 [info ] [Thread-3 (]: 3 of 5 PASS not_null_dim_products_sk_product ................................... [[32mPASS[0m in 7.11s]
[0m17:38:27.278824 [debug] [Thread-3 (]: Finished running node test.dbt_exercise.not_null_dim_products_sk_product.7ce7792ece
[0m17:38:28.285611 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:5c747a70-0308-4aff-8e08-f871321a459c&page=queryresults
[0m17:38:29.220537 [info ] [Thread-1 (]: 5 of 5 PASS unique_dim_products_sk_product ..................................... [[32mPASS[0m in 2.03s]
[0m17:38:29.222317 [debug] [Thread-1 (]: Finished running node test.dbt_exercise.unique_dim_products_sk_product.1658453ef4
[0m17:38:29.226247 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:38:29.236037 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:38:29.237496 [debug] [MainThread]: Connection 'test.dbt_exercise.not_null_dim_products_sk_product.7ce7792ece' was properly closed.
[0m17:38:29.238383 [debug] [MainThread]: Connection 'test.dbt_exercise.not_null_dim_products_product_id.c8aba288d1' was properly closed.
[0m17:38:29.239050 [debug] [MainThread]: Connection 'test.dbt_exercise.unique_dim_products_product_id.ef7b2a9985' was properly closed.
[0m17:38:29.239685 [debug] [MainThread]: Connection 'test.dbt_exercise.unique_dim_products_sk_product.1658453ef4' was properly closed.
[0m17:38:29.240532 [info ] [MainThread]: 
[0m17:38:29.242029 [info ] [MainThread]: Finished running 5 data tests in 0 hours 0 minutes and 10.25 seconds (10.25s).
[0m17:38:29.244294 [debug] [MainThread]: Command end result
[0m17:38:29.398290 [debug] [MainThread]: Wrote artifact WritableManifest to /home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/target/manifest.json
[0m17:38:29.440082 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/target/semantic_manifest.json
[0m17:38:29.449930 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/target/run_results.json
[0m17:38:29.450647 [info ] [MainThread]: 
[0m17:38:29.451241 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:38:29.451745 [info ] [MainThread]: 
[0m17:38:29.452551 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=5
[0m17:38:29.453517 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- DuplicateYAMLKeysDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m17:38:29.458971 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 137.8803, "process_in_blocks": "122920", "process_kernel_time": 18.377169, "process_mem_max_rss": "369608", "process_out_blocks": "3960", "process_user_time": 14.207639}
[0m17:38:29.466161 [debug] [MainThread]: Command `dbt test` succeeded at 17:38:29.464971 after 137.89 seconds
[0m17:38:29.469053 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e4860c763f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e48234c7f80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e482348c140>]}
[0m17:38:29.472617 [debug] [MainThread]: Flushing usage events
[0m17:38:29.809704 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:41:29.805285 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x727fad4f37d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x727fae376ba0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x727face48ef0>]}


============================== 17:41:29.825405 | 0932c725-693a-4269-ad2c-3e498579bcb5 ==============================
[0m17:41:29.825405 [info ] [MainThread]: Running with dbt=1.10.2
[0m17:41:29.826559 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt test', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:42:38.807545 [warn ] [MainThread]: [[33mWARNING[0m][DuplicateYAMLKeysDeprecation]: Deprecated functionality
Duplicate key 'version' in "<unicode string>", line 4, column 1 in file
`/home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/dbt_project.yml`
[0m17:42:38.808480 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '0932c725-693a-4269-ad2c-3e498579bcb5', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x727f6f820680>]}
[0m17:42:39.754420 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0932c725-693a-4269-ad2c-3e498579bcb5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x727f781cd970>]}
[0m17:42:39.858936 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0932c725-693a-4269-ad2c-3e498579bcb5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x727f6f714170>]}
[0m17:42:39.863625 [info ] [MainThread]: Registered adapter: bigquery=1.9.2
[0m17:43:50.611448 [debug] [MainThread]: checksum: 1adc40777973ef30f45f80b3b6d04d5013c1edd53d96363881b3b199e612468b, vars: {}, profile: , target: , version: 1.10.2
[0m17:43:56.931154 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:43:56.932215 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:43:57.350345 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0932c725-693a-4269-ad2c-3e498579bcb5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x727f6f5e3e90>]}
[0m17:43:57.546910 [debug] [MainThread]: Wrote artifact WritableManifest to /home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/target/manifest.json
[0m17:43:57.567160 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/target/semantic_manifest.json
[0m17:43:58.336576 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0932c725-693a-4269-ad2c-3e498579bcb5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x727f6ef28050>]}
[0m17:43:58.337915 [info ] [MainThread]: Found 19 models, 14 seeds, 59 data tests, 14 sources, 609 macros
[0m17:43:58.339546 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0932c725-693a-4269-ad2c-3e498579bcb5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x727f6f57fef0>]}
[0m17:43:58.348870 [info ] [MainThread]: 
[0m17:43:58.349812 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m17:43:58.350443 [info ] [MainThread]: 
[0m17:43:58.351661 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m17:43:58.363680 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_corded-sunlight-464012-e2_dbt_dw_marts'
[0m17:43:58.365445 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_corded-sunlight-464012-e2_dbt_dw_intermediate'
[0m17:43:58.366203 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:43:58.367717 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_corded-sunlight-464012-e2_dbt_dw_raw'
[0m17:43:58.370174 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_corded-sunlight-464012-e2_dbt_dw_staging'
[0m17:43:58.371641 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:43:58.374455 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:43:58.375825 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:43:59.401712 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0932c725-693a-4269-ad2c-3e498579bcb5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x727faef1bfe0>]}
[0m17:43:59.402990 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:43:59.419394 [debug] [Thread-1 (]: Began running node test.dbt_exercise.accepted_values_dim_products_is_discontinued__False__True__False.4507b1e7d2
[0m17:43:59.420227 [debug] [Thread-2 (]: Began running node test.dbt_exercise.not_null_dim_customers_customer_id.dd91cd1c8d
[0m17:43:59.421557 [debug] [Thread-3 (]: Began running node test.dbt_exercise.not_null_dim_customers_sk_customer.2dc07dc070
[0m17:43:59.422869 [debug] [Thread-4 (]: Began running node test.dbt_exercise.not_null_dim_employees_employee_id.ef83a0c291
[0m17:43:59.422330 [info ] [Thread-1 (]: 1 of 59 START test accepted_values_dim_products_is_discontinued__False__True__False  [RUN]
[0m17:43:59.423988 [info ] [Thread-2 (]: 2 of 59 START test not_null_dim_customers_customer_id .......................... [RUN]
[0m17:43:59.424970 [info ] [Thread-3 (]: 3 of 59 START test not_null_dim_customers_sk_customer .......................... [RUN]
[0m17:43:59.426420 [info ] [Thread-4 (]: 4 of 59 START test not_null_dim_employees_employee_id .......................... [RUN]
[0m17:43:59.427429 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_corded-sunlight-464012-e2_dbt_dw_staging, now test.dbt_exercise.accepted_values_dim_products_is_discontinued__False__True__False.4507b1e7d2)
[0m17:43:59.428308 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_corded-sunlight-464012-e2_dbt_dw_raw, now test.dbt_exercise.not_null_dim_customers_customer_id.dd91cd1c8d)
[0m17:43:59.429526 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_corded-sunlight-464012-e2_dbt_dw_marts, now test.dbt_exercise.not_null_dim_customers_sk_customer.2dc07dc070)
[0m17:43:59.430582 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly list_corded-sunlight-464012-e2_dbt_dw_intermediate, now test.dbt_exercise.not_null_dim_employees_employee_id.ef83a0c291)
[0m17:43:59.431599 [debug] [Thread-1 (]: Began compiling node test.dbt_exercise.accepted_values_dim_products_is_discontinued__False__True__False.4507b1e7d2
[0m17:43:59.432527 [debug] [Thread-2 (]: Began compiling node test.dbt_exercise.not_null_dim_customers_customer_id.dd91cd1c8d
[0m17:43:59.433653 [debug] [Thread-3 (]: Began compiling node test.dbt_exercise.not_null_dim_customers_sk_customer.2dc07dc070
[0m17:43:59.434565 [debug] [Thread-4 (]: Began compiling node test.dbt_exercise.not_null_dim_employees_employee_id.ef83a0c291
[0m17:43:59.470354 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_exercise.accepted_values_dim_products_is_discontinued__False__True__False.4507b1e7d2"
[0m17:43:59.482818 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_exercise.not_null_dim_customers_customer_id.dd91cd1c8d"
[0m17:43:59.491365 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_exercise.not_null_dim_customers_sk_customer.2dc07dc070"
[0m17:43:59.501557 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_exercise.not_null_dim_employees_employee_id.ef83a0c291"
[0m17:43:59.503362 [debug] [Thread-1 (]: Began executing node test.dbt_exercise.accepted_values_dim_products_is_discontinued__False__True__False.4507b1e7d2
[0m17:43:59.515539 [debug] [Thread-2 (]: Began executing node test.dbt_exercise.not_null_dim_customers_customer_id.dd91cd1c8d
[0m17:43:59.516681 [debug] [Thread-3 (]: Began executing node test.dbt_exercise.not_null_dim_customers_sk_customer.2dc07dc070
[0m17:43:59.550514 [debug] [Thread-4 (]: Began executing node test.dbt_exercise.not_null_dim_employees_employee_id.ef83a0c291
[0m17:43:59.551609 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_exercise.accepted_values_dim_products_is_discontinued__False__True__False.4507b1e7d2"
[0m17:43:59.552912 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_exercise.not_null_dim_customers_customer_id.dd91cd1c8d"
[0m17:43:59.556858 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_exercise.not_null_dim_customers_sk_customer.2dc07dc070"
[0m17:43:59.564239 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_exercise.not_null_dim_employees_employee_id.ef83a0c291"
[0m17:43:59.567326 [debug] [Thread-1 (]: On test.dbt_exercise.accepted_values_dim_products_is_discontinued__False__True__False.4507b1e7d2: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "test.dbt_exercise.accepted_values_dim_products_is_discontinued__False__True__False.4507b1e7d2"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        is_discontinued as value_field,
        count(*) as n_records

    from `corded-sunlight-464012-e2`.`dbt_dw_marts`.`dim_products`
    group by is_discontinued

)

select *
from all_values
where value_field not in (
    True,False
)



  
  
      
    ) dbt_internal_test
[0m17:43:59.568578 [debug] [Thread-2 (]: On test.dbt_exercise.not_null_dim_customers_customer_id.dd91cd1c8d: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "test.dbt_exercise.not_null_dim_customers_customer_id.dd91cd1c8d"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select customer_id
from `corded-sunlight-464012-e2`.`dbt_dw_marts`.`dim_customers`
where customer_id is null



  
  
      
    ) dbt_internal_test
[0m17:43:59.570980 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:43:59.572319 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:43:59.573551 [debug] [Thread-4 (]: On test.dbt_exercise.not_null_dim_employees_employee_id.ef83a0c291: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "test.dbt_exercise.not_null_dim_employees_employee_id.ef83a0c291"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select employee_id
from `corded-sunlight-464012-e2`.`dbt_dw_marts`.`dim_employees`
where employee_id is null



  
  
      
    ) dbt_internal_test
[0m17:43:59.575008 [debug] [Thread-3 (]: On test.dbt_exercise.not_null_dim_customers_sk_customer.2dc07dc070: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "test.dbt_exercise.not_null_dim_customers_sk_customer.2dc07dc070"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select sk_customer
from `corded-sunlight-464012-e2`.`dbt_dw_marts`.`dim_customers`
where sk_customer is null



  
  
      
    ) dbt_internal_test
[0m17:43:59.577782 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m17:43:59.578858 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m17:44:00.724150 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:25b15c7f-9e52-49d1-acbc-1e456afb4382&page=queryresults
[0m17:44:00.727545 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:c1e1deb8-ffe8-4160-bb7a-8e83dde275f4&page=queryresults
[0m17:44:00.738267 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:9e069ee4-ac7d-47d1-bb57-392914edb5d2&page=queryresults
[0m17:44:00.762974 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:3016b04d-8e8c-4e73-ab72-020ed0e7e0cb&page=queryresults
[0m17:44:08.210186 [info ] [Thread-4 (]: 4 of 59 PASS not_null_dim_employees_employee_id ................................ [[32mPASS[0m in 8.78s]
[0m17:44:08.217201 [debug] [Thread-4 (]: Finished running node test.dbt_exercise.not_null_dim_employees_employee_id.ef83a0c291
[0m17:44:08.221983 [debug] [Thread-4 (]: Began running node test.dbt_exercise.not_null_dim_employees_sk_employee.92381e9313
[0m17:44:08.224199 [info ] [Thread-2 (]: 2 of 59 PASS not_null_dim_customers_customer_id ................................ [[32mPASS[0m in 8.80s]
[0m17:44:08.225832 [info ] [Thread-3 (]: 3 of 59 PASS not_null_dim_customers_sk_customer ................................ [[32mPASS[0m in 8.80s]
[0m17:44:08.231708 [debug] [Thread-2 (]: Finished running node test.dbt_exercise.not_null_dim_customers_customer_id.dd91cd1c8d
[0m17:44:08.227568 [info ] [Thread-4 (]: 5 of 59 START test not_null_dim_employees_sk_employee .......................... [RUN]
[0m17:44:08.234269 [info ] [Thread-1 (]: 1 of 59 PASS accepted_values_dim_products_is_discontinued__False__True__False .. [[32mPASS[0m in 8.81s]
[0m17:44:08.236479 [debug] [Thread-3 (]: Finished running node test.dbt_exercise.not_null_dim_customers_sk_customer.2dc07dc070
[0m17:44:08.238293 [debug] [Thread-2 (]: Began running node test.dbt_exercise.not_null_dim_products_product_id.c8aba288d1
[0m17:44:08.240279 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_exercise.not_null_dim_employees_employee_id.ef83a0c291, now test.dbt_exercise.not_null_dim_employees_sk_employee.92381e9313)
[0m17:44:08.242254 [debug] [Thread-1 (]: Finished running node test.dbt_exercise.accepted_values_dim_products_is_discontinued__False__True__False.4507b1e7d2
[0m17:44:08.244094 [debug] [Thread-3 (]: Began running node test.dbt_exercise.not_null_dim_products_sk_product.7ce7792ece
[0m17:44:08.246240 [info ] [Thread-2 (]: 6 of 59 START test not_null_dim_products_product_id ............................ [RUN]
[0m17:44:08.248449 [debug] [Thread-4 (]: Began compiling node test.dbt_exercise.not_null_dim_employees_sk_employee.92381e9313
[0m17:44:08.250507 [debug] [Thread-1 (]: Began running node test.dbt_exercise.not_null_dim_ship_ship_id.0e7926966a
[0m17:44:08.252788 [info ] [Thread-3 (]: 7 of 59 START test not_null_dim_products_sk_product ............................ [RUN]
[0m17:44:08.255036 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_exercise.not_null_dim_customers_customer_id.dd91cd1c8d, now test.dbt_exercise.not_null_dim_products_product_id.c8aba288d1)
[0m17:44:08.265312 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_exercise.not_null_dim_employees_sk_employee.92381e9313"
[0m17:44:08.266849 [info ] [Thread-1 (]: 8 of 59 START test not_null_dim_ship_ship_id ................................... [RUN]
[0m17:44:08.268159 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_exercise.not_null_dim_customers_sk_customer.2dc07dc070, now test.dbt_exercise.not_null_dim_products_sk_product.7ce7792ece)
[0m17:44:08.269521 [debug] [Thread-2 (]: Began compiling node test.dbt_exercise.not_null_dim_products_product_id.c8aba288d1
[0m17:44:08.271006 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_exercise.accepted_values_dim_products_is_discontinued__False__True__False.4507b1e7d2, now test.dbt_exercise.not_null_dim_ship_ship_id.0e7926966a)
[0m17:44:08.271997 [debug] [Thread-3 (]: Began compiling node test.dbt_exercise.not_null_dim_products_sk_product.7ce7792ece
[0m17:44:08.272711 [debug] [Thread-4 (]: Began executing node test.dbt_exercise.not_null_dim_employees_sk_employee.92381e9313
[0m17:44:08.285586 [debug] [Thread-1 (]: Began compiling node test.dbt_exercise.not_null_dim_ship_ship_id.0e7926966a
[0m17:44:08.284483 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_exercise.not_null_dim_products_product_id.c8aba288d1"
[0m17:44:08.295238 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_exercise.not_null_dim_products_sk_product.7ce7792ece"
[0m17:44:08.303504 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_exercise.not_null_dim_employees_sk_employee.92381e9313"
[0m17:44:08.312230 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_exercise.not_null_dim_ship_ship_id.0e7926966a"
[0m17:44:08.316141 [debug] [Thread-2 (]: Began executing node test.dbt_exercise.not_null_dim_products_product_id.c8aba288d1
[0m17:44:08.317678 [debug] [Thread-3 (]: Began executing node test.dbt_exercise.not_null_dim_products_sk_product.7ce7792ece
[0m17:44:08.321594 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_exercise.not_null_dim_products_product_id.c8aba288d1"
[0m17:44:08.322733 [debug] [Thread-4 (]: On test.dbt_exercise.not_null_dim_employees_sk_employee.92381e9313: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "test.dbt_exercise.not_null_dim_employees_sk_employee.92381e9313"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select sk_employee
from `corded-sunlight-464012-e2`.`dbt_dw_marts`.`dim_employees`
where sk_employee is null



  
  
      
    ) dbt_internal_test
[0m17:44:08.328982 [debug] [Thread-1 (]: Began executing node test.dbt_exercise.not_null_dim_ship_ship_id.0e7926966a
[0m17:44:08.328530 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_exercise.not_null_dim_products_sk_product.7ce7792ece"
[0m17:44:08.331390 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m17:44:08.336640 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_exercise.not_null_dim_ship_ship_id.0e7926966a"
[0m17:44:08.337868 [debug] [Thread-2 (]: On test.dbt_exercise.not_null_dim_products_product_id.c8aba288d1: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "test.dbt_exercise.not_null_dim_products_product_id.c8aba288d1"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select product_id
from `corded-sunlight-464012-e2`.`dbt_dw_marts`.`dim_products`
where product_id is null



  
  
      
    ) dbt_internal_test
[0m17:44:08.340150 [debug] [Thread-3 (]: On test.dbt_exercise.not_null_dim_products_sk_product.7ce7792ece: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "test.dbt_exercise.not_null_dim_products_sk_product.7ce7792ece"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select sk_product
from `corded-sunlight-464012-e2`.`dbt_dw_marts`.`dim_products`
where sk_product is null



  
  
      
    ) dbt_internal_test
[0m17:44:08.341659 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:44:08.343720 [debug] [Thread-1 (]: On test.dbt_exercise.not_null_dim_ship_ship_id.0e7926966a: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "test.dbt_exercise.not_null_dim_ship_ship_id.0e7926966a"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select ship_id
from `corded-sunlight-464012-e2`.`dbt_dw_marts`.`dim_ship`
where ship_id is null



  
  
      
    ) dbt_internal_test
[0m17:44:08.344928 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m17:44:08.347627 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:44:09.462208 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:ca765203-a83c-4bd1-9de8-d82997943df8&page=queryresults
[0m17:44:09.468895 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:e2c03261-8817-42bd-aa5b-a1c32236e3e3&page=queryresults
[0m17:44:09.470726 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:9f8394e5-9b6d-41fe-9d44-718945e491ec&page=queryresults
[0m17:44:09.472473 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:b5f6bbed-0995-499c-8f06-57a3d5aedec6&page=queryresults
[0m17:44:10.318259 [info ] [Thread-1 (]: 8 of 59 PASS not_null_dim_ship_ship_id ......................................... [[32mPASS[0m in 2.05s]
[0m17:44:10.321686 [debug] [Thread-1 (]: Finished running node test.dbt_exercise.not_null_dim_ship_ship_id.0e7926966a
[0m17:44:10.324227 [debug] [Thread-1 (]: Began running node test.dbt_exercise.not_null_dim_ship_shipper_id.78acf0f3d3
[0m17:44:10.326827 [info ] [Thread-1 (]: 9 of 59 START test not_null_dim_ship_shipper_id ................................ [RUN]
[0m17:44:10.329498 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_exercise.not_null_dim_ship_ship_id.0e7926966a, now test.dbt_exercise.not_null_dim_ship_shipper_id.78acf0f3d3)
[0m17:44:10.333015 [debug] [Thread-1 (]: Began compiling node test.dbt_exercise.not_null_dim_ship_shipper_id.78acf0f3d3
[0m17:44:10.331732 [info ] [Thread-2 (]: 6 of 59 PASS not_null_dim_products_product_id .................................. [[32mPASS[0m in 2.08s]
[0m17:44:10.344970 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_exercise.not_null_dim_ship_shipper_id.78acf0f3d3"
[0m17:44:10.349256 [info ] [Thread-3 (]: 7 of 59 PASS not_null_dim_products_sk_product .................................. [[32mPASS[0m in 2.08s]
[0m17:44:10.352035 [debug] [Thread-2 (]: Finished running node test.dbt_exercise.not_null_dim_products_product_id.c8aba288d1
[0m17:44:10.355941 [info ] [Thread-4 (]: 5 of 59 PASS not_null_dim_employees_sk_employee ................................ [[32mPASS[0m in 2.12s]
[0m17:44:10.358769 [debug] [Thread-3 (]: Finished running node test.dbt_exercise.not_null_dim_products_sk_product.7ce7792ece
[0m17:44:10.359933 [debug] [Thread-2 (]: Began running node test.dbt_exercise.not_null_dim_ship_sk_ship.3ae993afec
[0m17:44:10.361035 [debug] [Thread-1 (]: Began executing node test.dbt_exercise.not_null_dim_ship_shipper_id.78acf0f3d3
[0m17:44:10.364076 [debug] [Thread-4 (]: Finished running node test.dbt_exercise.not_null_dim_employees_sk_employee.92381e9313
[0m17:44:10.366014 [debug] [Thread-3 (]: Began running node test.dbt_exercise.not_null_fact_orders_customer_id.9c2270d0dc
[0m17:44:10.367939 [info ] [Thread-2 (]: 10 of 59 START test not_null_dim_ship_sk_ship .................................. [RUN]
[0m17:44:10.373140 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_exercise.not_null_dim_ship_shipper_id.78acf0f3d3"
[0m17:44:10.374981 [debug] [Thread-4 (]: Began running node test.dbt_exercise.not_null_fact_orders_employee_id.4d01f9cb32
[0m17:44:10.376971 [info ] [Thread-3 (]: 11 of 59 START test not_null_fact_orders_customer_id ........................... [RUN]
[0m17:44:10.379715 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_exercise.not_null_dim_products_product_id.c8aba288d1, now test.dbt_exercise.not_null_dim_ship_sk_ship.3ae993afec)
[0m17:44:10.382467 [info ] [Thread-4 (]: 12 of 59 START test not_null_fact_orders_employee_id ........................... [RUN]
[0m17:44:10.385927 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_exercise.not_null_dim_products_sk_product.7ce7792ece, now test.dbt_exercise.not_null_fact_orders_customer_id.9c2270d0dc)
[0m17:44:10.387828 [debug] [Thread-1 (]: On test.dbt_exercise.not_null_dim_ship_shipper_id.78acf0f3d3: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "test.dbt_exercise.not_null_dim_ship_shipper_id.78acf0f3d3"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select shipper_id
from `corded-sunlight-464012-e2`.`dbt_dw_marts`.`dim_ship`
where shipper_id is null



  
  
      
    ) dbt_internal_test
[0m17:44:10.390023 [debug] [Thread-2 (]: Began compiling node test.dbt_exercise.not_null_dim_ship_sk_ship.3ae993afec
[0m17:44:10.391718 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_exercise.not_null_dim_employees_sk_employee.92381e9313, now test.dbt_exercise.not_null_fact_orders_employee_id.4d01f9cb32)
[0m17:44:10.393544 [debug] [Thread-3 (]: Began compiling node test.dbt_exercise.not_null_fact_orders_customer_id.9c2270d0dc
[0m17:44:10.395342 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:44:10.407994 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_exercise.not_null_dim_ship_sk_ship.3ae993afec"
[0m17:44:10.409205 [debug] [Thread-4 (]: Began compiling node test.dbt_exercise.not_null_fact_orders_employee_id.4d01f9cb32
[0m17:44:10.428760 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_exercise.not_null_fact_orders_customer_id.9c2270d0dc"
[0m17:44:10.440416 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_exercise.not_null_fact_orders_employee_id.4d01f9cb32"
[0m17:44:10.442222 [debug] [Thread-2 (]: Began executing node test.dbt_exercise.not_null_dim_ship_sk_ship.3ae993afec
[0m17:44:10.450361 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_exercise.not_null_dim_ship_sk_ship.3ae993afec"
[0m17:44:10.454053 [debug] [Thread-3 (]: Began executing node test.dbt_exercise.not_null_fact_orders_customer_id.9c2270d0dc
[0m17:44:10.496434 [debug] [Thread-4 (]: Began executing node test.dbt_exercise.not_null_fact_orders_employee_id.4d01f9cb32
[0m17:44:10.501863 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_exercise.not_null_fact_orders_customer_id.9c2270d0dc"
[0m17:44:10.502586 [debug] [Thread-2 (]: On test.dbt_exercise.not_null_dim_ship_sk_ship.3ae993afec: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "test.dbt_exercise.not_null_dim_ship_sk_ship.3ae993afec"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select sk_ship
from `corded-sunlight-464012-e2`.`dbt_dw_marts`.`dim_ship`
where sk_ship is null



  
  
      
    ) dbt_internal_test
[0m17:44:10.507295 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_exercise.not_null_fact_orders_employee_id.4d01f9cb32"
[0m17:44:10.509255 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:44:10.511957 [debug] [Thread-3 (]: On test.dbt_exercise.not_null_fact_orders_customer_id.9c2270d0dc: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "test.dbt_exercise.not_null_fact_orders_customer_id.9c2270d0dc"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select customer_id
from `corded-sunlight-464012-e2`.`dbt_dw_marts`.`fact_orders`
where customer_id is null



  
  
      
    ) dbt_internal_test
[0m17:44:10.513528 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m17:44:10.514402 [debug] [Thread-4 (]: On test.dbt_exercise.not_null_fact_orders_employee_id.4d01f9cb32: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "test.dbt_exercise.not_null_fact_orders_employee_id.4d01f9cb32"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select employee_id
from `corded-sunlight-464012-e2`.`dbt_dw_marts`.`fact_orders`
where employee_id is null



  
  
      
    ) dbt_internal_test
[0m17:44:10.515477 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m17:44:11.525999 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:45056e33-3272-4e54-89f3-30580a4ff131&page=queryresults
[0m17:44:11.565163 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:d8f286a9-2751-4773-bf42-e0e0e1708d9f&page=queryresults
[0m17:44:11.569041 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:184dfaef-334c-4fa7-a6a0-707305788aca&page=queryresults
[0m17:44:11.606558 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:ce49af4c-1e02-4e2f-9a10-5ef7ae2bce49&page=queryresults
[0m17:44:12.365035 [info ] [Thread-1 (]: 9 of 59 PASS not_null_dim_ship_shipper_id ...................................... [[32mPASS[0m in 2.04s]
[0m17:44:12.366454 [debug] [Thread-1 (]: Finished running node test.dbt_exercise.not_null_dim_ship_shipper_id.78acf0f3d3
[0m17:44:12.367230 [debug] [Thread-1 (]: Began running node test.dbt_exercise.not_null_fact_orders_order_id.6ba6d3f0a0
[0m17:44:12.367912 [info ] [Thread-1 (]: 13 of 59 START test not_null_fact_orders_order_id .............................. [RUN]
[0m17:44:12.369958 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_exercise.not_null_dim_ship_shipper_id.78acf0f3d3, now test.dbt_exercise.not_null_fact_orders_order_id.6ba6d3f0a0)
[0m17:44:12.371440 [debug] [Thread-1 (]: Began compiling node test.dbt_exercise.not_null_fact_orders_order_id.6ba6d3f0a0
[0m17:44:12.379164 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_exercise.not_null_fact_orders_order_id.6ba6d3f0a0"
[0m17:44:12.380393 [debug] [Thread-1 (]: Began executing node test.dbt_exercise.not_null_fact_orders_order_id.6ba6d3f0a0
[0m17:44:12.386686 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_exercise.not_null_fact_orders_order_id.6ba6d3f0a0"
[0m17:44:12.389784 [debug] [Thread-1 (]: On test.dbt_exercise.not_null_fact_orders_order_id.6ba6d3f0a0: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "test.dbt_exercise.not_null_fact_orders_order_id.6ba6d3f0a0"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select order_id
from `corded-sunlight-464012-e2`.`dbt_dw_marts`.`fact_orders`
where order_id is null



  
  
      
    ) dbt_internal_test
[0m17:44:12.391305 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:44:12.444702 [info ] [Thread-4 (]: 12 of 59 PASS not_null_fact_orders_employee_id ................................. [[32mPASS[0m in 2.05s]
[0m17:44:12.447002 [info ] [Thread-3 (]: 11 of 59 PASS not_null_fact_orders_customer_id ................................. [[32mPASS[0m in 2.06s]
[0m17:44:12.449165 [debug] [Thread-4 (]: Finished running node test.dbt_exercise.not_null_fact_orders_employee_id.4d01f9cb32
[0m17:44:12.451702 [debug] [Thread-3 (]: Finished running node test.dbt_exercise.not_null_fact_orders_customer_id.9c2270d0dc
[0m17:44:12.453435 [debug] [Thread-4 (]: Began running node test.dbt_exercise.not_null_fact_orders_product_id.346126b727
[0m17:44:12.455274 [debug] [Thread-3 (]: Began running node test.dbt_exercise.not_null_fact_orders_sk_customer.6134ecd4cd
[0m17:44:12.456535 [info ] [Thread-4 (]: 14 of 59 START test not_null_fact_orders_product_id ............................ [RUN]
[0m17:44:12.457861 [info ] [Thread-3 (]: 15 of 59 START test not_null_fact_orders_sk_customer ........................... [RUN]
[0m17:44:12.459130 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_exercise.not_null_fact_orders_employee_id.4d01f9cb32, now test.dbt_exercise.not_null_fact_orders_product_id.346126b727)
[0m17:44:12.460089 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_exercise.not_null_fact_orders_customer_id.9c2270d0dc, now test.dbt_exercise.not_null_fact_orders_sk_customer.6134ecd4cd)
[0m17:44:12.461854 [debug] [Thread-4 (]: Began compiling node test.dbt_exercise.not_null_fact_orders_product_id.346126b727
[0m17:44:12.464932 [debug] [Thread-3 (]: Began compiling node test.dbt_exercise.not_null_fact_orders_sk_customer.6134ecd4cd
[0m17:44:12.467843 [info ] [Thread-2 (]: 10 of 59 PASS not_null_dim_ship_sk_ship ........................................ [[32mPASS[0m in 2.09s]
[0m17:44:12.476922 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_exercise.not_null_fact_orders_product_id.346126b727"
[0m17:44:12.487340 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_exercise.not_null_fact_orders_sk_customer.6134ecd4cd"
[0m17:44:12.488697 [debug] [Thread-2 (]: Finished running node test.dbt_exercise.not_null_dim_ship_sk_ship.3ae993afec
[0m17:44:12.490829 [debug] [Thread-2 (]: Began running node test.dbt_exercise.not_null_fact_orders_sk_employee.cf36d136ff
[0m17:44:12.492166 [info ] [Thread-2 (]: 16 of 59 START test not_null_fact_orders_sk_employee ........................... [RUN]
[0m17:44:12.493267 [debug] [Thread-4 (]: Began executing node test.dbt_exercise.not_null_fact_orders_product_id.346126b727
[0m17:44:12.494388 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_exercise.not_null_dim_ship_sk_ship.3ae993afec, now test.dbt_exercise.not_null_fact_orders_sk_employee.cf36d136ff)
[0m17:44:12.495010 [debug] [Thread-3 (]: Began executing node test.dbt_exercise.not_null_fact_orders_sk_customer.6134ecd4cd
[0m17:44:12.502010 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_exercise.not_null_fact_orders_product_id.346126b727"
[0m17:44:12.503115 [debug] [Thread-2 (]: Began compiling node test.dbt_exercise.not_null_fact_orders_sk_employee.cf36d136ff
[0m17:44:12.507269 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_exercise.not_null_fact_orders_sk_customer.6134ecd4cd"
[0m17:44:12.514615 [debug] [Thread-4 (]: On test.dbt_exercise.not_null_fact_orders_product_id.346126b727: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "test.dbt_exercise.not_null_fact_orders_product_id.346126b727"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select product_id
from `corded-sunlight-464012-e2`.`dbt_dw_marts`.`fact_orders`
where product_id is null



  
  
      
    ) dbt_internal_test
[0m17:44:12.516883 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_exercise.not_null_fact_orders_sk_employee.cf36d136ff"
[0m17:44:12.519525 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m17:44:12.521212 [debug] [Thread-3 (]: On test.dbt_exercise.not_null_fact_orders_sk_customer.6134ecd4cd: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "test.dbt_exercise.not_null_fact_orders_sk_customer.6134ecd4cd"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select sk_customer
from `corded-sunlight-464012-e2`.`dbt_dw_marts`.`fact_orders`
where sk_customer is null



  
  
      
    ) dbt_internal_test
[0m17:44:12.523107 [debug] [Thread-2 (]: Began executing node test.dbt_exercise.not_null_fact_orders_sk_employee.cf36d136ff
[0m17:44:12.524158 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m17:44:12.527880 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_exercise.not_null_fact_orders_sk_employee.cf36d136ff"
[0m17:44:12.531300 [debug] [Thread-2 (]: On test.dbt_exercise.not_null_fact_orders_sk_employee.cf36d136ff: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "test.dbt_exercise.not_null_fact_orders_sk_employee.cf36d136ff"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select sk_employee
from `corded-sunlight-464012-e2`.`dbt_dw_marts`.`fact_orders`
where sk_employee is null



  
  
      
    ) dbt_internal_test
[0m17:44:12.533375 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:44:13.355752 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:c8a31806-8a12-4bd7-85e8-d953a6176f3f&page=queryresults
[0m17:44:13.522745 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:e75faa20-cf7e-408c-be2c-c7991fe082e4&page=queryresults
[0m17:44:13.616173 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:2ac9f964-1d76-408e-8b39-9ff51dec0fe4&page=queryresults
[0m17:44:13.637466 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:ca72adf4-0d5c-407f-8151-ad3e61168945&page=queryresults
[0m17:44:14.179466 [info ] [Thread-1 (]: 13 of 59 PASS not_null_fact_orders_order_id .................................... [[32mPASS[0m in 1.81s]
[0m17:44:14.180598 [debug] [Thread-1 (]: Finished running node test.dbt_exercise.not_null_fact_orders_order_id.6ba6d3f0a0
[0m17:44:14.181410 [debug] [Thread-1 (]: Began running node test.dbt_exercise.not_null_fact_orders_sk_orders.c6a2fa98b5
[0m17:44:14.182455 [info ] [Thread-1 (]: 17 of 59 START test not_null_fact_orders_sk_orders ............................. [RUN]
[0m17:44:14.183248 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_exercise.not_null_fact_orders_order_id.6ba6d3f0a0, now test.dbt_exercise.not_null_fact_orders_sk_orders.c6a2fa98b5)
[0m17:44:14.183839 [debug] [Thread-1 (]: Began compiling node test.dbt_exercise.not_null_fact_orders_sk_orders.c6a2fa98b5
[0m17:44:14.191711 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_exercise.not_null_fact_orders_sk_orders.c6a2fa98b5"
[0m17:44:14.194025 [debug] [Thread-1 (]: Began executing node test.dbt_exercise.not_null_fact_orders_sk_orders.c6a2fa98b5
[0m17:44:14.198340 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_exercise.not_null_fact_orders_sk_orders.c6a2fa98b5"
[0m17:44:14.199813 [debug] [Thread-1 (]: On test.dbt_exercise.not_null_fact_orders_sk_orders.c6a2fa98b5: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "test.dbt_exercise.not_null_fact_orders_sk_orders.c6a2fa98b5"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select sk_orders
from `corded-sunlight-464012-e2`.`dbt_dw_marts`.`fact_orders`
where sk_orders is null



  
  
      
    ) dbt_internal_test
[0m17:44:14.200624 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:44:14.408250 [info ] [Thread-2 (]: 16 of 59 PASS not_null_fact_orders_sk_employee ................................. [[32mPASS[0m in 1.91s]
[0m17:44:14.409963 [debug] [Thread-2 (]: Finished running node test.dbt_exercise.not_null_fact_orders_sk_employee.cf36d136ff
[0m17:44:14.411262 [debug] [Thread-2 (]: Began running node test.dbt_exercise.not_null_fact_orders_sk_product.9e0a112d70
[0m17:44:14.412575 [info ] [Thread-2 (]: 18 of 59 START test not_null_fact_orders_sk_product ............................ [RUN]
[0m17:44:14.414320 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_exercise.not_null_fact_orders_sk_employee.cf36d136ff, now test.dbt_exercise.not_null_fact_orders_sk_product.9e0a112d70)
[0m17:44:14.415343 [debug] [Thread-2 (]: Began compiling node test.dbt_exercise.not_null_fact_orders_sk_product.9e0a112d70
[0m17:44:14.424248 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_exercise.not_null_fact_orders_sk_product.9e0a112d70"
[0m17:44:14.425937 [debug] [Thread-2 (]: Began executing node test.dbt_exercise.not_null_fact_orders_sk_product.9e0a112d70
[0m17:44:14.432781 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_exercise.not_null_fact_orders_sk_product.9e0a112d70"
[0m17:44:14.434176 [debug] [Thread-2 (]: On test.dbt_exercise.not_null_fact_orders_sk_product.9e0a112d70: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "test.dbt_exercise.not_null_fact_orders_sk_product.9e0a112d70"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select sk_product
from `corded-sunlight-464012-e2`.`dbt_dw_marts`.`fact_orders`
where sk_product is null



  
  
      
    ) dbt_internal_test
[0m17:44:14.435145 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:44:14.530118 [info ] [Thread-3 (]: 15 of 59 PASS not_null_fact_orders_sk_customer ................................. [[32mPASS[0m in 2.07s]
[0m17:44:14.531836 [info ] [Thread-4 (]: 14 of 59 PASS not_null_fact_orders_product_id .................................. [[32mPASS[0m in 2.07s]
[0m17:44:14.533112 [debug] [Thread-3 (]: Finished running node test.dbt_exercise.not_null_fact_orders_sk_customer.6134ecd4cd
[0m17:44:14.534197 [debug] [Thread-4 (]: Finished running node test.dbt_exercise.not_null_fact_orders_product_id.346126b727
[0m17:44:14.535043 [debug] [Thread-3 (]: Began running node test.dbt_exercise.not_null_fact_orders_sk_ship.c82a3b72ed
[0m17:44:14.536075 [debug] [Thread-4 (]: Began running node test.dbt_exercise.source_accepted_values_northwind_categories_category_name__Beverages__Condiments__Confections__Dairy_Products__Grains_Cereals__Meat_Poultry__Produce__Seafood.ea6d0ab2ae
[0m17:44:14.537176 [info ] [Thread-3 (]: 19 of 59 START test not_null_fact_orders_sk_ship ............................... [RUN]
[0m17:44:14.541057 [info ] [Thread-4 (]: 20 of 59 START test source_accepted_values_northwind_categories_category_name__Beverages__Condiments__Confections__Dairy_Products__Grains_Cereals__Meat_Poultry__Produce__Seafood  [RUN]
[0m17:44:14.543170 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_exercise.not_null_fact_orders_sk_customer.6134ecd4cd, now test.dbt_exercise.not_null_fact_orders_sk_ship.c82a3b72ed)
[0m17:44:14.544559 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_exercise.not_null_fact_orders_product_id.346126b727, now test.dbt_exercise.source_accepted_values_northwind_categories_category_name__Beverages__Condiments__Confections__Dairy_Products__Grains_Cereals__Meat_Poultry__Produce__Seafood.ea6d0ab2ae)
[0m17:44:14.545736 [debug] [Thread-3 (]: Began compiling node test.dbt_exercise.not_null_fact_orders_sk_ship.c82a3b72ed
[0m17:44:14.547311 [debug] [Thread-4 (]: Began compiling node test.dbt_exercise.source_accepted_values_northwind_categories_category_name__Beverages__Condiments__Confections__Dairy_Products__Grains_Cereals__Meat_Poultry__Produce__Seafood.ea6d0ab2ae
[0m17:44:14.557182 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_exercise.not_null_fact_orders_sk_ship.c82a3b72ed"
[0m17:44:14.579515 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_exercise.source_accepted_values_northwind_categories_category_name__Beverages__Condiments__Confections__Dairy_Products__Grains_Cereals__Meat_Poultry__Produce__Seafood.ea6d0ab2ae"
[0m17:44:14.581194 [debug] [Thread-3 (]: Began executing node test.dbt_exercise.not_null_fact_orders_sk_ship.c82a3b72ed
[0m17:44:14.586149 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_exercise.not_null_fact_orders_sk_ship.c82a3b72ed"
[0m17:44:14.587325 [debug] [Thread-4 (]: Began executing node test.dbt_exercise.source_accepted_values_northwind_categories_category_name__Beverages__Condiments__Confections__Dairy_Products__Grains_Cereals__Meat_Poultry__Produce__Seafood.ea6d0ab2ae
[0m17:44:14.593267 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_exercise.source_accepted_values_northwind_categories_category_name__Beverages__Condiments__Confections__Dairy_Products__Grains_Cereals__Meat_Poultry__Produce__Seafood.ea6d0ab2ae"
[0m17:44:14.595430 [debug] [Thread-3 (]: On test.dbt_exercise.not_null_fact_orders_sk_ship.c82a3b72ed: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "test.dbt_exercise.not_null_fact_orders_sk_ship.c82a3b72ed"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select sk_ship
from `corded-sunlight-464012-e2`.`dbt_dw_marts`.`fact_orders`
where sk_ship is null



  
  
      
    ) dbt_internal_test
[0m17:44:14.597279 [debug] [Thread-4 (]: On test.dbt_exercise.source_accepted_values_northwind_categories_category_name__Beverages__Condiments__Confections__Dairy_Products__Grains_Cereals__Meat_Poultry__Produce__Seafood.ea6d0ab2ae: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "test.dbt_exercise.source_accepted_values_northwind_categories_category_name__Beverages__Condiments__Confections__Dairy_Products__Grains_Cereals__Meat_Poultry__Produce__Seafood.ea6d0ab2ae"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with all_values as (

    select
        category_name as value_field,
        count(*) as n_records

    from `corded-sunlight-464012-e2`.`dbt_dw_raw`.`categories`
    group by category_name

)

select *
from all_values
where value_field not in (
    'Beverages','Condiments','Confections','Dairy Products','Grains/Cereals','Meat/Poultry','Produce','Seafood'
)



  
  
      
    ) dbt_internal_test
[0m17:44:14.599597 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m17:44:14.603038 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m17:44:15.260798 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:6fb4e19f-1c43-47db-a70f-416ee7c78d74&page=queryresults
[0m17:44:15.374764 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:1411cc0a-02e5-4ecc-93eb-9970a1cd1c68&page=queryresults
[0m17:44:15.618790 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:07a90738-1bb1-4c5c-a64e-fa3c2a95cb09&page=queryresults
[0m17:44:15.626591 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:4f672942-b743-45d9-b989-1830966d3ac7&page=queryresults
[0m17:44:16.094554 [info ] [Thread-1 (]: 17 of 59 PASS not_null_fact_orders_sk_orders ................................... [[32mPASS[0m in 1.91s]
[0m17:44:16.095592 [debug] [Thread-1 (]: Finished running node test.dbt_exercise.not_null_fact_orders_sk_orders.c6a2fa98b5
[0m17:44:16.096455 [debug] [Thread-1 (]: Began running node test.dbt_exercise.source_not_null_northwind_categories_category_id.9a6df29828
[0m17:44:16.097540 [info ] [Thread-1 (]: 21 of 59 START test source_not_null_northwind_categories_category_id ........... [RUN]
[0m17:44:16.098545 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_exercise.not_null_fact_orders_sk_orders.c6a2fa98b5, now test.dbt_exercise.source_not_null_northwind_categories_category_id.9a6df29828)
[0m17:44:16.099149 [debug] [Thread-1 (]: Began compiling node test.dbt_exercise.source_not_null_northwind_categories_category_id.9a6df29828
[0m17:44:16.107236 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_exercise.source_not_null_northwind_categories_category_id.9a6df29828"
[0m17:44:16.108553 [debug] [Thread-1 (]: Began executing node test.dbt_exercise.source_not_null_northwind_categories_category_id.9a6df29828
[0m17:44:16.112267 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_exercise.source_not_null_northwind_categories_category_id.9a6df29828"
[0m17:44:16.113732 [debug] [Thread-1 (]: On test.dbt_exercise.source_not_null_northwind_categories_category_id.9a6df29828: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "test.dbt_exercise.source_not_null_northwind_categories_category_id.9a6df29828"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select category_id
from `corded-sunlight-464012-e2`.`dbt_dw_raw`.`categories`
where category_id is null



  
  
      
    ) dbt_internal_test
[0m17:44:16.114778 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:44:16.208783 [info ] [Thread-2 (]: 18 of 59 PASS not_null_fact_orders_sk_product .................................. [[32mPASS[0m in 1.79s]
[0m17:44:16.210028 [debug] [Thread-2 (]: Finished running node test.dbt_exercise.not_null_fact_orders_sk_product.9e0a112d70
[0m17:44:16.210737 [debug] [Thread-2 (]: Began running node test.dbt_exercise.source_not_null_northwind_country_codes_country_code.c623b5676c
[0m17:44:16.211743 [info ] [Thread-2 (]: 22 of 59 START test source_not_null_northwind_country_codes_country_code ....... [RUN]
[0m17:44:16.213074 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_exercise.not_null_fact_orders_sk_product.9e0a112d70, now test.dbt_exercise.source_not_null_northwind_country_codes_country_code.c623b5676c)
[0m17:44:16.214490 [debug] [Thread-2 (]: Began compiling node test.dbt_exercise.source_not_null_northwind_country_codes_country_code.c623b5676c
[0m17:44:16.221398 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_exercise.source_not_null_northwind_country_codes_country_code.c623b5676c"
[0m17:44:16.222588 [debug] [Thread-2 (]: Began executing node test.dbt_exercise.source_not_null_northwind_country_codes_country_code.c623b5676c
[0m17:44:16.226676 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_exercise.source_not_null_northwind_country_codes_country_code.c623b5676c"
[0m17:44:16.229312 [debug] [Thread-2 (]: On test.dbt_exercise.source_not_null_northwind_country_codes_country_code.c623b5676c: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "test.dbt_exercise.source_not_null_northwind_country_codes_country_code.c623b5676c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select country_code
from `corded-sunlight-464012-e2`.`dbt_dw_raw`.`country_codes`
where country_code is null



  
  
      
    ) dbt_internal_test
[0m17:44:16.230640 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:44:16.442308 [info ] [Thread-3 (]: 19 of 59 PASS not_null_fact_orders_sk_ship ..................................... [[32mPASS[0m in 1.90s]
[0m17:44:16.443455 [debug] [Thread-3 (]: Finished running node test.dbt_exercise.not_null_fact_orders_sk_ship.c82a3b72ed
[0m17:44:16.444138 [debug] [Thread-3 (]: Began running node test.dbt_exercise.source_not_null_northwind_customers_customer_id.dba99593d2
[0m17:44:16.444898 [info ] [Thread-3 (]: 23 of 59 START test source_not_null_northwind_customers_customer_id ............ [RUN]
[0m17:44:16.445801 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_exercise.not_null_fact_orders_sk_ship.c82a3b72ed, now test.dbt_exercise.source_not_null_northwind_customers_customer_id.dba99593d2)
[0m17:44:16.446437 [debug] [Thread-3 (]: Began compiling node test.dbt_exercise.source_not_null_northwind_customers_customer_id.dba99593d2
[0m17:44:16.455308 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_exercise.source_not_null_northwind_customers_customer_id.dba99593d2"
[0m17:44:16.456777 [debug] [Thread-3 (]: Began executing node test.dbt_exercise.source_not_null_northwind_customers_customer_id.dba99593d2
[0m17:44:16.460304 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_exercise.source_not_null_northwind_customers_customer_id.dba99593d2"
[0m17:44:16.461691 [debug] [Thread-3 (]: On test.dbt_exercise.source_not_null_northwind_customers_customer_id.dba99593d2: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "test.dbt_exercise.source_not_null_northwind_customers_customer_id.dba99593d2"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select customer_id
from `corded-sunlight-464012-e2`.`dbt_dw_raw`.`customers`
where customer_id is null



  
  
      
    ) dbt_internal_test
[0m17:44:16.462553 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m17:44:16.604971 [info ] [Thread-4 (]: 20 of 59 PASS source_accepted_values_northwind_categories_category_name__Beverages__Condiments__Confections__Dairy_Products__Grains_Cereals__Meat_Poultry__Produce__Seafood  [[32mPASS[0m in 2.06s]
[0m17:44:16.606489 [debug] [Thread-4 (]: Finished running node test.dbt_exercise.source_accepted_values_northwind_categories_category_name__Beverages__Condiments__Confections__Dairy_Products__Grains_Cereals__Meat_Poultry__Produce__Seafood.ea6d0ab2ae
[0m17:44:16.607796 [debug] [Thread-4 (]: Began running node test.dbt_exercise.source_not_null_northwind_dados_financeiros_data.cdd6b46fe7
[0m17:44:16.609103 [info ] [Thread-4 (]: 24 of 59 START test source_not_null_northwind_dados_financeiros_data ........... [RUN]
[0m17:44:16.610901 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_exercise.source_accepted_values_northwind_categories_category_name__Beverages__Condiments__Confections__Dairy_Products__Grains_Cereals__Meat_Poultry__Produce__Seafood.ea6d0ab2ae, now test.dbt_exercise.source_not_null_northwind_dados_financeiros_data.cdd6b46fe7)
[0m17:44:16.612087 [debug] [Thread-4 (]: Began compiling node test.dbt_exercise.source_not_null_northwind_dados_financeiros_data.cdd6b46fe7
[0m17:44:16.621287 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_exercise.source_not_null_northwind_dados_financeiros_data.cdd6b46fe7"
[0m17:44:16.627124 [debug] [Thread-4 (]: Began executing node test.dbt_exercise.source_not_null_northwind_dados_financeiros_data.cdd6b46fe7
[0m17:44:16.634819 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_exercise.source_not_null_northwind_dados_financeiros_data.cdd6b46fe7"
[0m17:44:16.636619 [debug] [Thread-4 (]: On test.dbt_exercise.source_not_null_northwind_dados_financeiros_data.cdd6b46fe7: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "test.dbt_exercise.source_not_null_northwind_dados_financeiros_data.cdd6b46fe7"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select data
from `corded-sunlight-464012-e2`.`dbt_dw_raw`.`dados_financeiros`
where data is null



  
  
      
    ) dbt_internal_test
[0m17:44:16.637791 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m17:44:17.253900 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:ee3019b4-959e-4016-8472-d1ac29c66e42&page=queryresults
[0m17:44:17.258746 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:dc47093d-f71c-42af-80d2-ac3774ee630b&page=queryresults
[0m17:44:17.426756 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:e727e753-8d9e-4fef-86aa-8adc1fc29edd&page=queryresults
[0m17:44:17.575810 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:48028b01-c5b0-420f-ac67-c9aa339e9ed4&page=queryresults
[0m17:44:18.072501 [info ] [Thread-1 (]: 21 of 59 PASS source_not_null_northwind_categories_category_id ................. [[32mPASS[0m in 1.97s]
[0m17:44:18.074694 [debug] [Thread-1 (]: Finished running node test.dbt_exercise.source_not_null_northwind_categories_category_id.9a6df29828
[0m17:44:18.075529 [debug] [Thread-1 (]: Began running node test.dbt_exercise.source_not_null_northwind_employee_territories_employee_id.d7372217ec
[0m17:44:18.076299 [info ] [Thread-1 (]: 25 of 59 START test source_not_null_northwind_employee_territories_employee_id . [RUN]
[0m17:44:18.077493 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_exercise.source_not_null_northwind_categories_category_id.9a6df29828, now test.dbt_exercise.source_not_null_northwind_employee_territories_employee_id.d7372217ec)
[0m17:44:18.079525 [debug] [Thread-1 (]: Began compiling node test.dbt_exercise.source_not_null_northwind_employee_territories_employee_id.d7372217ec
[0m17:44:18.092533 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_exercise.source_not_null_northwind_employee_territories_employee_id.d7372217ec"
[0m17:44:18.098560 [info ] [Thread-2 (]: 22 of 59 PASS source_not_null_northwind_country_codes_country_code ............. [[32mPASS[0m in 1.88s]
[0m17:44:18.101125 [debug] [Thread-2 (]: Finished running node test.dbt_exercise.source_not_null_northwind_country_codes_country_code.c623b5676c
[0m17:44:18.102651 [debug] [Thread-2 (]: Began running node test.dbt_exercise.source_not_null_northwind_employee_territories_territory_id.ae648a0b88
[0m17:44:18.105563 [debug] [Thread-1 (]: Began executing node test.dbt_exercise.source_not_null_northwind_employee_territories_employee_id.d7372217ec
[0m17:44:18.104275 [info ] [Thread-2 (]: 26 of 59 START test source_not_null_northwind_employee_territories_territory_id  [RUN]
[0m17:44:18.123965 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_exercise.source_not_null_northwind_employee_territories_employee_id.d7372217ec"
[0m17:44:18.125250 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_exercise.source_not_null_northwind_country_codes_country_code.c623b5676c, now test.dbt_exercise.source_not_null_northwind_employee_territories_territory_id.ae648a0b88)
[0m17:44:18.127346 [debug] [Thread-2 (]: Began compiling node test.dbt_exercise.source_not_null_northwind_employee_territories_territory_id.ae648a0b88
[0m17:44:18.144049 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_exercise.source_not_null_northwind_employee_territories_territory_id.ae648a0b88"
[0m17:44:18.145884 [debug] [Thread-1 (]: On test.dbt_exercise.source_not_null_northwind_employee_territories_employee_id.d7372217ec: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "test.dbt_exercise.source_not_null_northwind_employee_territories_employee_id.d7372217ec"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select employee_id
from `corded-sunlight-464012-e2`.`dbt_dw_raw`.`employee_territories`
where employee_id is null



  
  
      
    ) dbt_internal_test
[0m17:44:18.147545 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:44:18.149571 [debug] [Thread-2 (]: Began executing node test.dbt_exercise.source_not_null_northwind_employee_territories_territory_id.ae648a0b88
[0m17:44:18.154532 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_exercise.source_not_null_northwind_employee_territories_territory_id.ae648a0b88"
[0m17:44:18.165517 [debug] [Thread-2 (]: On test.dbt_exercise.source_not_null_northwind_employee_territories_territory_id.ae648a0b88: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "test.dbt_exercise.source_not_null_northwind_employee_territories_territory_id.ae648a0b88"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select territory_id
from `corded-sunlight-464012-e2`.`dbt_dw_raw`.`employee_territories`
where territory_id is null



  
  
      
    ) dbt_internal_test
[0m17:44:18.166643 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:44:18.273093 [info ] [Thread-3 (]: 23 of 59 PASS source_not_null_northwind_customers_customer_id .................. [[32mPASS[0m in 1.83s]
[0m17:44:18.275400 [debug] [Thread-3 (]: Finished running node test.dbt_exercise.source_not_null_northwind_customers_customer_id.dba99593d2
[0m17:44:18.276585 [debug] [Thread-3 (]: Began running node test.dbt_exercise.source_not_null_northwind_employees_employee_id.829479a08c
[0m17:44:18.277806 [info ] [Thread-3 (]: 27 of 59 START test source_not_null_northwind_employees_employee_id ............ [RUN]
[0m17:44:18.278969 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_exercise.source_not_null_northwind_customers_customer_id.dba99593d2, now test.dbt_exercise.source_not_null_northwind_employees_employee_id.829479a08c)
[0m17:44:18.280045 [debug] [Thread-3 (]: Began compiling node test.dbt_exercise.source_not_null_northwind_employees_employee_id.829479a08c
[0m17:44:18.293129 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_exercise.source_not_null_northwind_employees_employee_id.829479a08c"
[0m17:44:18.294907 [debug] [Thread-3 (]: Began executing node test.dbt_exercise.source_not_null_northwind_employees_employee_id.829479a08c
[0m17:44:18.299252 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_exercise.source_not_null_northwind_employees_employee_id.829479a08c"
[0m17:44:18.304863 [debug] [Thread-3 (]: On test.dbt_exercise.source_not_null_northwind_employees_employee_id.829479a08c: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "test.dbt_exercise.source_not_null_northwind_employees_employee_id.829479a08c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select employee_id
from `corded-sunlight-464012-e2`.`dbt_dw_raw`.`employees`
where employee_id is null



  
  
      
    ) dbt_internal_test
[0m17:44:18.307519 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m17:44:18.423510 [info ] [Thread-4 (]: 24 of 59 PASS source_not_null_northwind_dados_financeiros_data ................. [[32mPASS[0m in 1.81s]
[0m17:44:18.424538 [debug] [Thread-4 (]: Finished running node test.dbt_exercise.source_not_null_northwind_dados_financeiros_data.cdd6b46fe7
[0m17:44:18.425510 [debug] [Thread-4 (]: Began running node test.dbt_exercise.source_not_null_northwind_order_details_order_id.8acd43693e
[0m17:44:18.426408 [info ] [Thread-4 (]: 28 of 59 START test source_not_null_northwind_order_details_order_id ........... [RUN]
[0m17:44:18.427459 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_exercise.source_not_null_northwind_dados_financeiros_data.cdd6b46fe7, now test.dbt_exercise.source_not_null_northwind_order_details_order_id.8acd43693e)
[0m17:44:18.428819 [debug] [Thread-4 (]: Began compiling node test.dbt_exercise.source_not_null_northwind_order_details_order_id.8acd43693e
[0m17:44:18.436888 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_exercise.source_not_null_northwind_order_details_order_id.8acd43693e"
[0m17:44:18.438503 [debug] [Thread-4 (]: Began executing node test.dbt_exercise.source_not_null_northwind_order_details_order_id.8acd43693e
[0m17:44:18.444304 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_exercise.source_not_null_northwind_order_details_order_id.8acd43693e"
[0m17:44:18.447174 [debug] [Thread-4 (]: On test.dbt_exercise.source_not_null_northwind_order_details_order_id.8acd43693e: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "test.dbt_exercise.source_not_null_northwind_order_details_order_id.8acd43693e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select order_id
from `corded-sunlight-464012-e2`.`dbt_dw_raw`.`order_details`
where order_id is null



  
  
      
    ) dbt_internal_test
[0m17:44:18.448527 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m17:44:19.170917 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:55db854d-d272-460c-bfd9-da20027aec8d&page=queryresults
[0m17:44:19.181942 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:db111d86-14c1-440e-95fc-a04cbcab4dd1&page=queryresults
[0m17:44:20.939083 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:6ec5043b-76aa-4f1a-8016-c004134ffb19&page=queryresults
[0m17:44:21.008208 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:37dbd237-14bb-40c1-a3bc-f4650ecc17af&page=queryresults
[0m17:44:21.580915 [info ] [Thread-1 (]: 25 of 59 PASS source_not_null_northwind_employee_territories_employee_id ....... [[32mPASS[0m in 3.50s]
[0m17:44:21.582230 [debug] [Thread-1 (]: Finished running node test.dbt_exercise.source_not_null_northwind_employee_territories_employee_id.d7372217ec
[0m17:44:21.583524 [debug] [Thread-1 (]: Began running node test.dbt_exercise.source_not_null_northwind_order_details_product_id.c084f7ad12
[0m17:44:21.585269 [info ] [Thread-1 (]: 29 of 59 START test source_not_null_northwind_order_details_product_id ......... [RUN]
[0m17:44:21.587240 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_exercise.source_not_null_northwind_employee_territories_employee_id.d7372217ec, now test.dbt_exercise.source_not_null_northwind_order_details_product_id.c084f7ad12)
[0m17:44:21.588736 [debug] [Thread-1 (]: Began compiling node test.dbt_exercise.source_not_null_northwind_order_details_product_id.c084f7ad12
[0m17:44:21.600841 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_exercise.source_not_null_northwind_order_details_product_id.c084f7ad12"
[0m17:44:21.605238 [debug] [Thread-1 (]: Began executing node test.dbt_exercise.source_not_null_northwind_order_details_product_id.c084f7ad12
[0m17:44:21.611876 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_exercise.source_not_null_northwind_order_details_product_id.c084f7ad12"
[0m17:44:21.613104 [debug] [Thread-1 (]: On test.dbt_exercise.source_not_null_northwind_order_details_product_id.c084f7ad12: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "test.dbt_exercise.source_not_null_northwind_order_details_product_id.c084f7ad12"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select product_id
from `corded-sunlight-464012-e2`.`dbt_dw_raw`.`order_details`
where product_id is null



  
  
      
    ) dbt_internal_test
[0m17:44:21.613976 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:44:21.626221 [info ] [Thread-2 (]: 26 of 59 PASS source_not_null_northwind_employee_territories_territory_id ...... [[32mPASS[0m in 3.50s]
[0m17:44:21.673357 [debug] [Thread-2 (]: Finished running node test.dbt_exercise.source_not_null_northwind_employee_territories_territory_id.ae648a0b88
[0m17:44:21.674582 [debug] [Thread-2 (]: Began running node test.dbt_exercise.source_not_null_northwind_orders_customer_id.3e09955b24
[0m17:44:21.676033 [info ] [Thread-2 (]: 30 of 59 START test source_not_null_northwind_orders_customer_id ............... [RUN]
[0m17:44:21.677455 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_exercise.source_not_null_northwind_employee_territories_territory_id.ae648a0b88, now test.dbt_exercise.source_not_null_northwind_orders_customer_id.3e09955b24)
[0m17:44:21.678585 [debug] [Thread-2 (]: Began compiling node test.dbt_exercise.source_not_null_northwind_orders_customer_id.3e09955b24
[0m17:44:21.688780 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_exercise.source_not_null_northwind_orders_customer_id.3e09955b24"
[0m17:44:21.690331 [debug] [Thread-2 (]: Began executing node test.dbt_exercise.source_not_null_northwind_orders_customer_id.3e09955b24
[0m17:44:21.695768 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_exercise.source_not_null_northwind_orders_customer_id.3e09955b24"
[0m17:44:21.698455 [debug] [Thread-2 (]: On test.dbt_exercise.source_not_null_northwind_orders_customer_id.3e09955b24: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "test.dbt_exercise.source_not_null_northwind_orders_customer_id.3e09955b24"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select customer_id
from `corded-sunlight-464012-e2`.`dbt_dw_raw`.`orders`
where customer_id is null



  
  
      
    ) dbt_internal_test
[0m17:44:21.699788 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:44:21.771498 [info ] [Thread-3 (]: 27 of 59 PASS source_not_null_northwind_employees_employee_id .................. [[32mPASS[0m in 3.49s]
[0m17:44:21.772605 [debug] [Thread-3 (]: Finished running node test.dbt_exercise.source_not_null_northwind_employees_employee_id.829479a08c
[0m17:44:21.773287 [debug] [Thread-3 (]: Began running node test.dbt_exercise.source_not_null_northwind_orders_employee_id.a8f4bf5ca3
[0m17:44:21.774115 [info ] [Thread-3 (]: 31 of 59 START test source_not_null_northwind_orders_employee_id ............... [RUN]
[0m17:44:21.775314 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_exercise.source_not_null_northwind_employees_employee_id.829479a08c, now test.dbt_exercise.source_not_null_northwind_orders_employee_id.a8f4bf5ca3)
[0m17:44:21.776654 [debug] [Thread-3 (]: Began compiling node test.dbt_exercise.source_not_null_northwind_orders_employee_id.a8f4bf5ca3
[0m17:44:21.786990 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_exercise.source_not_null_northwind_orders_employee_id.a8f4bf5ca3"
[0m17:44:21.789021 [debug] [Thread-3 (]: Began executing node test.dbt_exercise.source_not_null_northwind_orders_employee_id.a8f4bf5ca3
[0m17:44:21.803442 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_exercise.source_not_null_northwind_orders_employee_id.a8f4bf5ca3"
[0m17:44:21.804854 [debug] [Thread-3 (]: On test.dbt_exercise.source_not_null_northwind_orders_employee_id.a8f4bf5ca3: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "test.dbt_exercise.source_not_null_northwind_orders_employee_id.a8f4bf5ca3"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select employee_id
from `corded-sunlight-464012-e2`.`dbt_dw_raw`.`orders`
where employee_id is null



  
  
      
    ) dbt_internal_test
[0m17:44:21.805876 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m17:44:21.859396 [info ] [Thread-4 (]: 28 of 59 PASS source_not_null_northwind_order_details_order_id ................. [[32mPASS[0m in 3.43s]
[0m17:44:21.860462 [debug] [Thread-4 (]: Finished running node test.dbt_exercise.source_not_null_northwind_order_details_order_id.8acd43693e
[0m17:44:21.861203 [debug] [Thread-4 (]: Began running node test.dbt_exercise.source_not_null_northwind_orders_order_id.5a7c008c6e
[0m17:44:21.862465 [info ] [Thread-4 (]: 32 of 59 START test source_not_null_northwind_orders_order_id .................. [RUN]
[0m17:44:21.864643 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_exercise.source_not_null_northwind_order_details_order_id.8acd43693e, now test.dbt_exercise.source_not_null_northwind_orders_order_id.5a7c008c6e)
[0m17:44:21.865743 [debug] [Thread-4 (]: Began compiling node test.dbt_exercise.source_not_null_northwind_orders_order_id.5a7c008c6e
[0m17:44:21.874128 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_exercise.source_not_null_northwind_orders_order_id.5a7c008c6e"
[0m17:44:21.875835 [debug] [Thread-4 (]: Began executing node test.dbt_exercise.source_not_null_northwind_orders_order_id.5a7c008c6e
[0m17:44:21.880746 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_exercise.source_not_null_northwind_orders_order_id.5a7c008c6e"
[0m17:44:21.882625 [debug] [Thread-4 (]: On test.dbt_exercise.source_not_null_northwind_orders_order_id.5a7c008c6e: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "test.dbt_exercise.source_not_null_northwind_orders_order_id.5a7c008c6e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select order_id
from `corded-sunlight-464012-e2`.`dbt_dw_raw`.`orders`
where order_id is null



  
  
      
    ) dbt_internal_test
[0m17:44:21.883589 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m17:44:22.618694 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:3bfe13ce-630d-459e-a458-58ed3c3c879a&page=queryresults
[0m17:44:22.621977 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:ea08ad02-ee34-4eec-8a38-b08e1a79539f&page=queryresults
[0m17:44:22.828265 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:94466134-9a15-41b8-8ac4-fb911bf56753&page=queryresults
[0m17:44:22.839551 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:c7f3c18c-8065-4e9f-ada8-e400988d0916&page=queryresults
[0m17:44:23.431696 [info ] [Thread-1 (]: 29 of 59 PASS source_not_null_northwind_order_details_product_id ............... [[32mPASS[0m in 1.84s]
[0m17:44:23.433067 [debug] [Thread-1 (]: Finished running node test.dbt_exercise.source_not_null_northwind_order_details_product_id.c084f7ad12
[0m17:44:23.434100 [debug] [Thread-1 (]: Began running node test.dbt_exercise.source_not_null_northwind_products_product_id.1bc1aa1d1c
[0m17:44:23.435326 [info ] [Thread-1 (]: 33 of 59 START test source_not_null_northwind_products_product_id .............. [RUN]
[0m17:44:23.436210 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_exercise.source_not_null_northwind_order_details_product_id.c084f7ad12, now test.dbt_exercise.source_not_null_northwind_products_product_id.1bc1aa1d1c)
[0m17:44:23.436785 [debug] [Thread-1 (]: Began compiling node test.dbt_exercise.source_not_null_northwind_products_product_id.1bc1aa1d1c
[0m17:44:23.447690 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_exercise.source_not_null_northwind_products_product_id.1bc1aa1d1c"
[0m17:44:23.449289 [debug] [Thread-1 (]: Began executing node test.dbt_exercise.source_not_null_northwind_products_product_id.1bc1aa1d1c
[0m17:44:23.454821 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_exercise.source_not_null_northwind_products_product_id.1bc1aa1d1c"
[0m17:44:23.457056 [debug] [Thread-1 (]: On test.dbt_exercise.source_not_null_northwind_products_product_id.1bc1aa1d1c: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "test.dbt_exercise.source_not_null_northwind_products_product_id.1bc1aa1d1c"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select product_id
from `corded-sunlight-464012-e2`.`dbt_dw_raw`.`products`
where product_id is null



  
  
      
    ) dbt_internal_test
[0m17:44:23.460695 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:44:23.554399 [info ] [Thread-2 (]: 30 of 59 PASS source_not_null_northwind_orders_customer_id ..................... [[32mPASS[0m in 1.88s]
[0m17:44:23.555972 [debug] [Thread-2 (]: Finished running node test.dbt_exercise.source_not_null_northwind_orders_customer_id.3e09955b24
[0m17:44:23.557299 [debug] [Thread-2 (]: Began running node test.dbt_exercise.source_not_null_northwind_region_region_id.c95367d9e3
[0m17:44:23.558451 [info ] [Thread-2 (]: 34 of 59 START test source_not_null_northwind_region_region_id ................. [RUN]
[0m17:44:23.559567 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_exercise.source_not_null_northwind_orders_customer_id.3e09955b24, now test.dbt_exercise.source_not_null_northwind_region_region_id.c95367d9e3)
[0m17:44:23.560564 [debug] [Thread-2 (]: Began compiling node test.dbt_exercise.source_not_null_northwind_region_region_id.c95367d9e3
[0m17:44:23.567599 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_exercise.source_not_null_northwind_region_region_id.c95367d9e3"
[0m17:44:23.569334 [debug] [Thread-2 (]: Began executing node test.dbt_exercise.source_not_null_northwind_region_region_id.c95367d9e3
[0m17:44:23.575004 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_exercise.source_not_null_northwind_region_region_id.c95367d9e3"
[0m17:44:23.577291 [debug] [Thread-2 (]: On test.dbt_exercise.source_not_null_northwind_region_region_id.c95367d9e3: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "test.dbt_exercise.source_not_null_northwind_region_region_id.c95367d9e3"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select region_id
from `corded-sunlight-464012-e2`.`dbt_dw_raw`.`region`
where region_id is null



  
  
      
    ) dbt_internal_test
[0m17:44:23.578841 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:44:23.647828 [info ] [Thread-4 (]: 32 of 59 PASS source_not_null_northwind_orders_order_id ........................ [[32mPASS[0m in 1.78s]
[0m17:44:23.648978 [debug] [Thread-4 (]: Finished running node test.dbt_exercise.source_not_null_northwind_orders_order_id.5a7c008c6e
[0m17:44:23.649716 [debug] [Thread-4 (]: Began running node test.dbt_exercise.source_not_null_northwind_shippers_shipper_id.45221752ca
[0m17:44:23.651768 [info ] [Thread-4 (]: 35 of 59 START test source_not_null_northwind_shippers_shipper_id .............. [RUN]
[0m17:44:23.655297 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_exercise.source_not_null_northwind_orders_order_id.5a7c008c6e, now test.dbt_exercise.source_not_null_northwind_shippers_shipper_id.45221752ca)
[0m17:44:23.657348 [info ] [Thread-3 (]: 31 of 59 PASS source_not_null_northwind_orders_employee_id ..................... [[32mPASS[0m in 1.88s]
[0m17:44:23.658395 [debug] [Thread-4 (]: Began compiling node test.dbt_exercise.source_not_null_northwind_shippers_shipper_id.45221752ca
[0m17:44:23.659742 [debug] [Thread-3 (]: Finished running node test.dbt_exercise.source_not_null_northwind_orders_employee_id.a8f4bf5ca3
[0m17:44:23.668407 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_exercise.source_not_null_northwind_shippers_shipper_id.45221752ca"
[0m17:44:23.670421 [debug] [Thread-3 (]: Began running node test.dbt_exercise.source_not_null_northwind_suppliers_supplier_id.de5c4d0062
[0m17:44:23.672342 [info ] [Thread-3 (]: 36 of 59 START test source_not_null_northwind_suppliers_supplier_id ............ [RUN]
[0m17:44:23.673877 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_exercise.source_not_null_northwind_orders_employee_id.a8f4bf5ca3, now test.dbt_exercise.source_not_null_northwind_suppliers_supplier_id.de5c4d0062)
[0m17:44:23.675245 [debug] [Thread-3 (]: Began compiling node test.dbt_exercise.source_not_null_northwind_suppliers_supplier_id.de5c4d0062
[0m17:44:23.676289 [debug] [Thread-4 (]: Began executing node test.dbt_exercise.source_not_null_northwind_shippers_shipper_id.45221752ca
[0m17:44:23.685255 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_exercise.source_not_null_northwind_suppliers_supplier_id.de5c4d0062"
[0m17:44:23.693704 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_exercise.source_not_null_northwind_shippers_shipper_id.45221752ca"
[0m17:44:23.695745 [debug] [Thread-3 (]: Began executing node test.dbt_exercise.source_not_null_northwind_suppliers_supplier_id.de5c4d0062
[0m17:44:23.696876 [debug] [Thread-4 (]: On test.dbt_exercise.source_not_null_northwind_shippers_shipper_id.45221752ca: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "test.dbt_exercise.source_not_null_northwind_shippers_shipper_id.45221752ca"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select shipper_id
from `corded-sunlight-464012-e2`.`dbt_dw_raw`.`shippers`
where shipper_id is null



  
  
      
    ) dbt_internal_test
[0m17:44:23.700850 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_exercise.source_not_null_northwind_suppliers_supplier_id.de5c4d0062"
[0m17:44:23.702435 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m17:44:23.704449 [debug] [Thread-3 (]: On test.dbt_exercise.source_not_null_northwind_suppliers_supplier_id.de5c4d0062: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "test.dbt_exercise.source_not_null_northwind_suppliers_supplier_id.de5c4d0062"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select supplier_id
from `corded-sunlight-464012-e2`.`dbt_dw_raw`.`suppliers`
where supplier_id is null



  
  
      
    ) dbt_internal_test
[0m17:44:23.705300 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m17:44:24.517090 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:7167a532-ee5c-41c4-afd3-f40d1ead6163&page=queryresults
[0m17:44:24.589192 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:935a1bea-7faf-4340-b759-01d873b8b885&page=queryresults
[0m17:44:24.764622 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:ce33712a-62a3-4825-a2a8-db3116ec3b21&page=queryresults
[0m17:44:24.767854 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:59c36ead-1ef7-40eb-9849-6008db2c74f6&page=queryresults
[0m17:44:25.335323 [info ] [Thread-1 (]: 33 of 59 PASS source_not_null_northwind_products_product_id .................... [[32mPASS[0m in 1.90s]
[0m17:44:25.336389 [debug] [Thread-1 (]: Finished running node test.dbt_exercise.source_not_null_northwind_products_product_id.1bc1aa1d1c
[0m17:44:25.337297 [debug] [Thread-1 (]: Began running node test.dbt_exercise.source_not_null_northwind_territories_region_id.5df71bcf81
[0m17:44:25.338739 [info ] [Thread-1 (]: 37 of 59 START test source_not_null_northwind_territories_region_id ............ [RUN]
[0m17:44:25.340466 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_exercise.source_not_null_northwind_products_product_id.1bc1aa1d1c, now test.dbt_exercise.source_not_null_northwind_territories_region_id.5df71bcf81)
[0m17:44:25.341170 [debug] [Thread-1 (]: Began compiling node test.dbt_exercise.source_not_null_northwind_territories_region_id.5df71bcf81
[0m17:44:25.350206 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_exercise.source_not_null_northwind_territories_region_id.5df71bcf81"
[0m17:44:25.351532 [debug] [Thread-1 (]: Began executing node test.dbt_exercise.source_not_null_northwind_territories_region_id.5df71bcf81
[0m17:44:25.357758 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_exercise.source_not_null_northwind_territories_region_id.5df71bcf81"
[0m17:44:25.359803 [debug] [Thread-1 (]: On test.dbt_exercise.source_not_null_northwind_territories_region_id.5df71bcf81: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "test.dbt_exercise.source_not_null_northwind_territories_region_id.5df71bcf81"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select region_id
from `corded-sunlight-464012-e2`.`dbt_dw_raw`.`territories`
where region_id is null



  
  
      
    ) dbt_internal_test
[0m17:44:25.361118 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:44:25.416408 [info ] [Thread-2 (]: 34 of 59 PASS source_not_null_northwind_region_region_id ....................... [[32mPASS[0m in 1.86s]
[0m17:44:25.418485 [debug] [Thread-2 (]: Finished running node test.dbt_exercise.source_not_null_northwind_region_region_id.c95367d9e3
[0m17:44:25.420289 [debug] [Thread-2 (]: Began running node test.dbt_exercise.source_not_null_northwind_territories_territory_id.9b9655b8a9
[0m17:44:25.421895 [info ] [Thread-2 (]: 38 of 59 START test source_not_null_northwind_territories_territory_id ......... [RUN]
[0m17:44:25.425616 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_exercise.source_not_null_northwind_region_region_id.c95367d9e3, now test.dbt_exercise.source_not_null_northwind_territories_territory_id.9b9655b8a9)
[0m17:44:25.427992 [debug] [Thread-2 (]: Began compiling node test.dbt_exercise.source_not_null_northwind_territories_territory_id.9b9655b8a9
[0m17:44:25.436814 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_exercise.source_not_null_northwind_territories_territory_id.9b9655b8a9"
[0m17:44:25.439594 [debug] [Thread-2 (]: Began executing node test.dbt_exercise.source_not_null_northwind_territories_territory_id.9b9655b8a9
[0m17:44:25.445235 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_exercise.source_not_null_northwind_territories_territory_id.9b9655b8a9"
[0m17:44:25.446611 [debug] [Thread-2 (]: On test.dbt_exercise.source_not_null_northwind_territories_territory_id.9b9655b8a9: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "test.dbt_exercise.source_not_null_northwind_territories_territory_id.9b9655b8a9"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select territory_id
from `corded-sunlight-464012-e2`.`dbt_dw_raw`.`territories`
where territory_id is null



  
  
      
    ) dbt_internal_test
[0m17:44:25.447392 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:44:25.549598 [info ] [Thread-4 (]: 35 of 59 PASS source_not_null_northwind_shippers_shipper_id .................... [[32mPASS[0m in 1.89s]
[0m17:44:25.550888 [debug] [Thread-4 (]: Finished running node test.dbt_exercise.source_not_null_northwind_shippers_shipper_id.45221752ca
[0m17:44:25.551991 [debug] [Thread-4 (]: Began running node test.dbt_exercise.source_not_null_northwind_us_states_state_id.2e33a23d78
[0m17:44:25.553153 [info ] [Thread-4 (]: 39 of 59 START test source_not_null_northwind_us_states_state_id ............... [RUN]
[0m17:44:25.554122 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_exercise.source_not_null_northwind_shippers_shipper_id.45221752ca, now test.dbt_exercise.source_not_null_northwind_us_states_state_id.2e33a23d78)
[0m17:44:25.554883 [debug] [Thread-4 (]: Began compiling node test.dbt_exercise.source_not_null_northwind_us_states_state_id.2e33a23d78
[0m17:44:25.561302 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_exercise.source_not_null_northwind_us_states_state_id.2e33a23d78"
[0m17:44:25.563116 [debug] [Thread-4 (]: Began executing node test.dbt_exercise.source_not_null_northwind_us_states_state_id.2e33a23d78
[0m17:44:25.569825 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_exercise.source_not_null_northwind_us_states_state_id.2e33a23d78"
[0m17:44:25.572135 [debug] [Thread-4 (]: On test.dbt_exercise.source_not_null_northwind_us_states_state_id.2e33a23d78: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "test.dbt_exercise.source_not_null_northwind_us_states_state_id.2e33a23d78"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    



select state_id
from `corded-sunlight-464012-e2`.`dbt_dw_raw`.`us_states`
where state_id is null



  
  
      
    ) dbt_internal_test
[0m17:44:25.573613 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m17:44:25.579412 [info ] [Thread-3 (]: 36 of 59 PASS source_not_null_northwind_suppliers_supplier_id .................. [[32mPASS[0m in 1.90s]
[0m17:44:25.581666 [debug] [Thread-3 (]: Finished running node test.dbt_exercise.source_not_null_northwind_suppliers_supplier_id.de5c4d0062
[0m17:44:25.583623 [debug] [Thread-3 (]: Began running node test.dbt_exercise.source_unique_northwind_categories_category_id.17d9baa2e0
[0m17:44:25.585335 [info ] [Thread-3 (]: 40 of 59 START test source_unique_northwind_categories_category_id ............. [RUN]
[0m17:44:25.586776 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_exercise.source_not_null_northwind_suppliers_supplier_id.de5c4d0062, now test.dbt_exercise.source_unique_northwind_categories_category_id.17d9baa2e0)
[0m17:44:25.588600 [debug] [Thread-3 (]: Began compiling node test.dbt_exercise.source_unique_northwind_categories_category_id.17d9baa2e0
[0m17:44:25.649976 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_exercise.source_unique_northwind_categories_category_id.17d9baa2e0"
[0m17:44:25.653603 [debug] [Thread-3 (]: Began executing node test.dbt_exercise.source_unique_northwind_categories_category_id.17d9baa2e0
[0m17:44:25.657440 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_exercise.source_unique_northwind_categories_category_id.17d9baa2e0"
[0m17:44:25.660172 [debug] [Thread-3 (]: On test.dbt_exercise.source_unique_northwind_categories_category_id.17d9baa2e0: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "test.dbt_exercise.source_unique_northwind_categories_category_id.17d9baa2e0"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with dbt_test__target as (

  select category_id as unique_field
  from `corded-sunlight-464012-e2`.`dbt_dw_raw`.`categories`
  where category_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m17:44:25.660944 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m17:44:26.315866 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:20048cfc-0f88-4df4-8c07-026733afca2a&page=queryresults
[0m17:44:26.543734 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:8428e56a-d3c5-49d0-b9bb-19bbcae15018&page=queryresults
[0m17:44:26.621529 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:988ed1bf-8ca3-4bbe-8f9d-2560d7230b3d&page=queryresults
[0m17:44:26.636179 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:50220a2b-e54d-47b2-b3f9-860f793f48d5&page=queryresults
[0m17:44:27.162764 [info ] [Thread-1 (]: 37 of 59 PASS source_not_null_northwind_territories_region_id .................. [[32mPASS[0m in 1.82s]
[0m17:44:27.164264 [debug] [Thread-1 (]: Finished running node test.dbt_exercise.source_not_null_northwind_territories_region_id.5df71bcf81
[0m17:44:27.164951 [debug] [Thread-1 (]: Began running node test.dbt_exercise.source_unique_northwind_country_codes_country_code.cf83d0431e
[0m17:44:27.165636 [info ] [Thread-1 (]: 41 of 59 START test source_unique_northwind_country_codes_country_code ......... [RUN]
[0m17:44:27.166576 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_exercise.source_not_null_northwind_territories_region_id.5df71bcf81, now test.dbt_exercise.source_unique_northwind_country_codes_country_code.cf83d0431e)
[0m17:44:27.167770 [debug] [Thread-1 (]: Began compiling node test.dbt_exercise.source_unique_northwind_country_codes_country_code.cf83d0431e
[0m17:44:27.177430 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_exercise.source_unique_northwind_country_codes_country_code.cf83d0431e"
[0m17:44:27.179130 [debug] [Thread-1 (]: Began executing node test.dbt_exercise.source_unique_northwind_country_codes_country_code.cf83d0431e
[0m17:44:27.184000 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_exercise.source_unique_northwind_country_codes_country_code.cf83d0431e"
[0m17:44:27.188828 [debug] [Thread-1 (]: On test.dbt_exercise.source_unique_northwind_country_codes_country_code.cf83d0431e: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "test.dbt_exercise.source_unique_northwind_country_codes_country_code.cf83d0431e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with dbt_test__target as (

  select country_code as unique_field
  from `corded-sunlight-464012-e2`.`dbt_dw_raw`.`country_codes`
  where country_code is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m17:44:27.189845 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:44:27.353435 [info ] [Thread-2 (]: 38 of 59 PASS source_not_null_northwind_territories_territory_id ............... [[32mPASS[0m in 1.93s]
[0m17:44:27.354556 [debug] [Thread-2 (]: Finished running node test.dbt_exercise.source_not_null_northwind_territories_territory_id.9b9655b8a9
[0m17:44:27.355346 [debug] [Thread-2 (]: Began running node test.dbt_exercise.source_unique_northwind_customers_customer_id.ff818c137b
[0m17:44:27.356401 [info ] [Thread-2 (]: 42 of 59 START test source_unique_northwind_customers_customer_id .............. [RUN]
[0m17:44:27.357305 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_exercise.source_not_null_northwind_territories_territory_id.9b9655b8a9, now test.dbt_exercise.source_unique_northwind_customers_customer_id.ff818c137b)
[0m17:44:27.357889 [debug] [Thread-2 (]: Began compiling node test.dbt_exercise.source_unique_northwind_customers_customer_id.ff818c137b
[0m17:44:27.366473 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_exercise.source_unique_northwind_customers_customer_id.ff818c137b"
[0m17:44:27.368438 [debug] [Thread-2 (]: Began executing node test.dbt_exercise.source_unique_northwind_customers_customer_id.ff818c137b
[0m17:44:27.372750 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_exercise.source_unique_northwind_customers_customer_id.ff818c137b"
[0m17:44:27.374292 [debug] [Thread-2 (]: On test.dbt_exercise.source_unique_northwind_customers_customer_id.ff818c137b: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "test.dbt_exercise.source_unique_northwind_customers_customer_id.ff818c137b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with dbt_test__target as (

  select customer_id as unique_field
  from `corded-sunlight-464012-e2`.`dbt_dw_raw`.`customers`
  where customer_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m17:44:27.375798 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:44:27.474523 [info ] [Thread-3 (]: 40 of 59 PASS source_unique_northwind_categories_category_id ................... [[32mPASS[0m in 1.89s]
[0m17:44:27.475879 [debug] [Thread-3 (]: Finished running node test.dbt_exercise.source_unique_northwind_categories_category_id.17d9baa2e0
[0m17:44:27.476889 [debug] [Thread-3 (]: Began running node test.dbt_exercise.source_unique_northwind_employees_employee_id.e63c624594
[0m17:44:27.478155 [info ] [Thread-3 (]: 43 of 59 START test source_unique_northwind_employees_employee_id .............. [RUN]
[0m17:44:27.479267 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_exercise.source_unique_northwind_categories_category_id.17d9baa2e0, now test.dbt_exercise.source_unique_northwind_employees_employee_id.e63c624594)
[0m17:44:27.480023 [debug] [Thread-3 (]: Began compiling node test.dbt_exercise.source_unique_northwind_employees_employee_id.e63c624594
[0m17:44:27.487277 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_exercise.source_unique_northwind_employees_employee_id.e63c624594"
[0m17:44:27.492278 [info ] [Thread-4 (]: 39 of 59 PASS source_not_null_northwind_us_states_state_id ..................... [[32mPASS[0m in 1.94s]
[0m17:44:27.493451 [debug] [Thread-3 (]: Began executing node test.dbt_exercise.source_unique_northwind_employees_employee_id.e63c624594
[0m17:44:27.495343 [debug] [Thread-4 (]: Finished running node test.dbt_exercise.source_not_null_northwind_us_states_state_id.2e33a23d78
[0m17:44:27.501166 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_exercise.source_unique_northwind_employees_employee_id.e63c624594"
[0m17:44:27.502649 [debug] [Thread-4 (]: Began running node test.dbt_exercise.source_unique_northwind_orders_order_id.4a8a4df128
[0m17:44:27.505579 [info ] [Thread-4 (]: 44 of 59 START test source_unique_northwind_orders_order_id .................... [RUN]
[0m17:44:27.507197 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_exercise.source_not_null_northwind_us_states_state_id.2e33a23d78, now test.dbt_exercise.source_unique_northwind_orders_order_id.4a8a4df128)
[0m17:44:27.508171 [debug] [Thread-4 (]: Began compiling node test.dbt_exercise.source_unique_northwind_orders_order_id.4a8a4df128
[0m17:44:27.509000 [debug] [Thread-3 (]: On test.dbt_exercise.source_unique_northwind_employees_employee_id.e63c624594: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "test.dbt_exercise.source_unique_northwind_employees_employee_id.e63c624594"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with dbt_test__target as (

  select employee_id as unique_field
  from `corded-sunlight-464012-e2`.`dbt_dw_raw`.`employees`
  where employee_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m17:44:27.518512 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_exercise.source_unique_northwind_orders_order_id.4a8a4df128"
[0m17:44:27.519611 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m17:44:27.523025 [debug] [Thread-4 (]: Began executing node test.dbt_exercise.source_unique_northwind_orders_order_id.4a8a4df128
[0m17:44:27.540322 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_exercise.source_unique_northwind_orders_order_id.4a8a4df128"
[0m17:44:27.543856 [debug] [Thread-4 (]: On test.dbt_exercise.source_unique_northwind_orders_order_id.4a8a4df128: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "test.dbt_exercise.source_unique_northwind_orders_order_id.4a8a4df128"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with dbt_test__target as (

  select order_id as unique_field
  from `corded-sunlight-464012-e2`.`dbt_dw_raw`.`orders`
  where order_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m17:44:27.545376 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m17:44:28.272948 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:442a40f2-966c-499c-9b28-e8b89976cdd0&page=queryresults
[0m17:44:28.325422 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:c332b558-43c6-4a77-82ba-087d43722ff8&page=queryresults
[0m17:44:28.527299 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:66264253-b079-49bf-8a22-8605a9fbc471&page=queryresults
[0m17:44:28.578736 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:ec865143-a5d8-42ff-92ad-e5c1213eb5a5&page=queryresults
[0m17:44:29.105535 [info ] [Thread-1 (]: 41 of 59 PASS source_unique_northwind_country_codes_country_code ............... [[32mPASS[0m in 1.94s]
[0m17:44:29.106760 [debug] [Thread-1 (]: Finished running node test.dbt_exercise.source_unique_northwind_country_codes_country_code.cf83d0431e
[0m17:44:29.107917 [debug] [Thread-1 (]: Began running node test.dbt_exercise.source_unique_northwind_products_product_id.740bf6f9a5
[0m17:44:29.109413 [info ] [Thread-1 (]: 45 of 59 START test source_unique_northwind_products_product_id ................ [RUN]
[0m17:44:29.110621 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_exercise.source_unique_northwind_country_codes_country_code.cf83d0431e, now test.dbt_exercise.source_unique_northwind_products_product_id.740bf6f9a5)
[0m17:44:29.111448 [debug] [Thread-1 (]: Began compiling node test.dbt_exercise.source_unique_northwind_products_product_id.740bf6f9a5
[0m17:44:29.121270 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_exercise.source_unique_northwind_products_product_id.740bf6f9a5"
[0m17:44:29.128530 [debug] [Thread-1 (]: Began executing node test.dbt_exercise.source_unique_northwind_products_product_id.740bf6f9a5
[0m17:44:29.133357 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_exercise.source_unique_northwind_products_product_id.740bf6f9a5"
[0m17:44:29.134885 [debug] [Thread-1 (]: On test.dbt_exercise.source_unique_northwind_products_product_id.740bf6f9a5: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "test.dbt_exercise.source_unique_northwind_products_product_id.740bf6f9a5"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with dbt_test__target as (

  select product_id as unique_field
  from `corded-sunlight-464012-e2`.`dbt_dw_raw`.`products`
  where product_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m17:44:29.135709 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:44:29.189095 [info ] [Thread-2 (]: 42 of 59 PASS source_unique_northwind_customers_customer_id .................... [[32mPASS[0m in 1.83s]
[0m17:44:29.191235 [debug] [Thread-2 (]: Finished running node test.dbt_exercise.source_unique_northwind_customers_customer_id.ff818c137b
[0m17:44:29.192445 [debug] [Thread-2 (]: Began running node test.dbt_exercise.source_unique_northwind_region_region_id.9688f1f5fd
[0m17:44:29.193463 [info ] [Thread-2 (]: 46 of 59 START test source_unique_northwind_region_region_id ................... [RUN]
[0m17:44:29.194620 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_exercise.source_unique_northwind_customers_customer_id.ff818c137b, now test.dbt_exercise.source_unique_northwind_region_region_id.9688f1f5fd)
[0m17:44:29.196081 [debug] [Thread-2 (]: Began compiling node test.dbt_exercise.source_unique_northwind_region_region_id.9688f1f5fd
[0m17:44:29.203797 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_exercise.source_unique_northwind_region_region_id.9688f1f5fd"
[0m17:44:29.206187 [debug] [Thread-2 (]: Began executing node test.dbt_exercise.source_unique_northwind_region_region_id.9688f1f5fd
[0m17:44:29.211849 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_exercise.source_unique_northwind_region_region_id.9688f1f5fd"
[0m17:44:29.214235 [debug] [Thread-2 (]: On test.dbt_exercise.source_unique_northwind_region_region_id.9688f1f5fd: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "test.dbt_exercise.source_unique_northwind_region_region_id.9688f1f5fd"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with dbt_test__target as (

  select region_id as unique_field
  from `corded-sunlight-464012-e2`.`dbt_dw_raw`.`region`
  where region_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m17:44:29.215458 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:44:29.344834 [info ] [Thread-3 (]: 43 of 59 PASS source_unique_northwind_employees_employee_id .................... [[32mPASS[0m in 1.87s]
[0m17:44:29.346171 [debug] [Thread-3 (]: Finished running node test.dbt_exercise.source_unique_northwind_employees_employee_id.e63c624594
[0m17:44:29.347193 [debug] [Thread-3 (]: Began running node test.dbt_exercise.source_unique_northwind_shippers_shipper_id.61edb3f736
[0m17:44:29.348107 [info ] [Thread-3 (]: 47 of 59 START test source_unique_northwind_shippers_shipper_id ................ [RUN]
[0m17:44:29.349810 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_exercise.source_unique_northwind_employees_employee_id.e63c624594, now test.dbt_exercise.source_unique_northwind_shippers_shipper_id.61edb3f736)
[0m17:44:29.351222 [debug] [Thread-3 (]: Began compiling node test.dbt_exercise.source_unique_northwind_shippers_shipper_id.61edb3f736
[0m17:44:29.359647 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_exercise.source_unique_northwind_shippers_shipper_id.61edb3f736"
[0m17:44:29.360686 [debug] [Thread-3 (]: Began executing node test.dbt_exercise.source_unique_northwind_shippers_shipper_id.61edb3f736
[0m17:44:29.365351 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_exercise.source_unique_northwind_shippers_shipper_id.61edb3f736"
[0m17:44:29.368216 [debug] [Thread-3 (]: On test.dbt_exercise.source_unique_northwind_shippers_shipper_id.61edb3f736: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "test.dbt_exercise.source_unique_northwind_shippers_shipper_id.61edb3f736"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with dbt_test__target as (

  select shipper_id as unique_field
  from `corded-sunlight-464012-e2`.`dbt_dw_raw`.`shippers`
  where shipper_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m17:44:29.369498 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m17:44:29.421593 [info ] [Thread-4 (]: 44 of 59 PASS source_unique_northwind_orders_order_id .......................... [[32mPASS[0m in 1.91s]
[0m17:44:29.423591 [debug] [Thread-4 (]: Finished running node test.dbt_exercise.source_unique_northwind_orders_order_id.4a8a4df128
[0m17:44:29.424822 [debug] [Thread-4 (]: Began running node test.dbt_exercise.source_unique_northwind_suppliers_supplier_id.aa7461739b
[0m17:44:29.425708 [info ] [Thread-4 (]: 48 of 59 START test source_unique_northwind_suppliers_supplier_id .............. [RUN]
[0m17:44:29.426759 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_exercise.source_unique_northwind_orders_order_id.4a8a4df128, now test.dbt_exercise.source_unique_northwind_suppliers_supplier_id.aa7461739b)
[0m17:44:29.427829 [debug] [Thread-4 (]: Began compiling node test.dbt_exercise.source_unique_northwind_suppliers_supplier_id.aa7461739b
[0m17:44:29.437501 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_exercise.source_unique_northwind_suppliers_supplier_id.aa7461739b"
[0m17:44:29.439142 [debug] [Thread-4 (]: Began executing node test.dbt_exercise.source_unique_northwind_suppliers_supplier_id.aa7461739b
[0m17:44:29.443874 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_exercise.source_unique_northwind_suppliers_supplier_id.aa7461739b"
[0m17:44:29.445734 [debug] [Thread-4 (]: On test.dbt_exercise.source_unique_northwind_suppliers_supplier_id.aa7461739b: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "test.dbt_exercise.source_unique_northwind_suppliers_supplier_id.aa7461739b"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with dbt_test__target as (

  select supplier_id as unique_field
  from `corded-sunlight-464012-e2`.`dbt_dw_raw`.`suppliers`
  where supplier_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m17:44:29.447176 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m17:44:30.038053 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:bf5d4489-0131-43cb-b0bf-2ecd22f0b783&page=queryresults
[0m17:44:30.158186 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:57e31ff4-19f2-4de6-8768-4c316d4f4994&page=queryresults
[0m17:44:30.309444 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:83d98b32-6557-428a-86e9-f60cb54c32ec&page=queryresults
[0m17:44:30.860770 [info ] [Thread-1 (]: 45 of 59 PASS source_unique_northwind_products_product_id ...................... [[32mPASS[0m in 1.75s]
[0m17:44:30.861886 [debug] [Thread-1 (]: Finished running node test.dbt_exercise.source_unique_northwind_products_product_id.740bf6f9a5
[0m17:44:30.862579 [debug] [Thread-1 (]: Began running node test.dbt_exercise.source_unique_northwind_territories_territory_id.08bc548860
[0m17:44:30.863673 [info ] [Thread-1 (]: 49 of 59 START test source_unique_northwind_territories_territory_id ........... [RUN]
[0m17:44:30.864907 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_exercise.source_unique_northwind_products_product_id.740bf6f9a5, now test.dbt_exercise.source_unique_northwind_territories_territory_id.08bc548860)
[0m17:44:30.865749 [debug] [Thread-1 (]: Began compiling node test.dbt_exercise.source_unique_northwind_territories_territory_id.08bc548860
[0m17:44:30.873468 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_exercise.source_unique_northwind_territories_territory_id.08bc548860"
[0m17:44:30.875583 [debug] [Thread-1 (]: Began executing node test.dbt_exercise.source_unique_northwind_territories_territory_id.08bc548860
[0m17:44:30.880207 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_exercise.source_unique_northwind_territories_territory_id.08bc548860"
[0m17:44:30.881783 [debug] [Thread-1 (]: On test.dbt_exercise.source_unique_northwind_territories_territory_id.08bc548860: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "test.dbt_exercise.source_unique_northwind_territories_territory_id.08bc548860"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with dbt_test__target as (

  select territory_id as unique_field
  from `corded-sunlight-464012-e2`.`dbt_dw_raw`.`territories`
  where territory_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m17:44:30.882878 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:44:30.931957 [info ] [Thread-2 (]: 46 of 59 PASS source_unique_northwind_region_region_id ......................... [[32mPASS[0m in 1.74s]
[0m17:44:30.934197 [debug] [Thread-2 (]: Finished running node test.dbt_exercise.source_unique_northwind_region_region_id.9688f1f5fd
[0m17:44:30.935953 [debug] [Thread-2 (]: Began running node test.dbt_exercise.source_unique_northwind_us_states_state_id.c374c85cda
[0m17:44:30.937400 [info ] [Thread-2 (]: 50 of 59 START test source_unique_northwind_us_states_state_id ................. [RUN]
[0m17:44:30.939110 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_exercise.source_unique_northwind_region_region_id.9688f1f5fd, now test.dbt_exercise.source_unique_northwind_us_states_state_id.c374c85cda)
[0m17:44:30.940489 [debug] [Thread-2 (]: Began compiling node test.dbt_exercise.source_unique_northwind_us_states_state_id.c374c85cda
[0m17:44:30.949860 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_exercise.source_unique_northwind_us_states_state_id.c374c85cda"
[0m17:44:30.951661 [debug] [Thread-2 (]: Began executing node test.dbt_exercise.source_unique_northwind_us_states_state_id.c374c85cda
[0m17:44:30.956960 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_exercise.source_unique_northwind_us_states_state_id.c374c85cda"
[0m17:44:30.958184 [debug] [Thread-2 (]: On test.dbt_exercise.source_unique_northwind_us_states_state_id.c374c85cda: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "test.dbt_exercise.source_unique_northwind_us_states_state_id.c374c85cda"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with dbt_test__target as (

  select state_id as unique_field
  from `corded-sunlight-464012-e2`.`dbt_dw_raw`.`us_states`
  where state_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m17:44:30.958940 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:44:31.044594 [info ] [Thread-3 (]: 47 of 59 PASS source_unique_northwind_shippers_shipper_id ...................... [[32mPASS[0m in 1.69s]
[0m17:44:31.045586 [debug] [Thread-3 (]: Finished running node test.dbt_exercise.source_unique_northwind_shippers_shipper_id.61edb3f736
[0m17:44:31.046136 [debug] [Thread-3 (]: Began running node test.dbt_exercise.unique_dim_customers_customer_id.15c9f1e2fd
[0m17:44:31.046771 [info ] [Thread-3 (]: 51 of 59 START test unique_dim_customers_customer_id ........................... [RUN]
[0m17:44:31.047618 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_exercise.source_unique_northwind_shippers_shipper_id.61edb3f736, now test.dbt_exercise.unique_dim_customers_customer_id.15c9f1e2fd)
[0m17:44:31.048240 [debug] [Thread-3 (]: Began compiling node test.dbt_exercise.unique_dim_customers_customer_id.15c9f1e2fd
[0m17:44:31.054502 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_exercise.unique_dim_customers_customer_id.15c9f1e2fd"
[0m17:44:31.056503 [debug] [Thread-3 (]: Began executing node test.dbt_exercise.unique_dim_customers_customer_id.15c9f1e2fd
[0m17:44:31.060441 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_exercise.unique_dim_customers_customer_id.15c9f1e2fd"
[0m17:44:31.062387 [debug] [Thread-3 (]: On test.dbt_exercise.unique_dim_customers_customer_id.15c9f1e2fd: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "test.dbt_exercise.unique_dim_customers_customer_id.15c9f1e2fd"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with dbt_test__target as (

  select customer_id as unique_field
  from `corded-sunlight-464012-e2`.`dbt_dw_marts`.`dim_customers`
  where customer_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m17:44:31.063710 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m17:44:31.445454 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:3517122c-7ad5-4c7f-b8ba-8b3ee5ad1776&page=queryresults
[0m17:44:31.834706 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:c6647fea-b253-480b-af62-b3b622220603&page=queryresults
[0m17:44:31.841190 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:b3f17e86-a6e7-4bd5-82a8-a854b04d74b8&page=queryresults
[0m17:44:31.985909 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:ba6937e6-f166-49da-b90a-7401f9f3b6e1&page=queryresults
[0m17:44:32.215264 [info ] [Thread-4 (]: 48 of 59 PASS source_unique_northwind_suppliers_supplier_id .................... [[32mPASS[0m in 2.79s]
[0m17:44:32.217447 [debug] [Thread-4 (]: Finished running node test.dbt_exercise.source_unique_northwind_suppliers_supplier_id.aa7461739b
[0m17:44:32.219105 [debug] [Thread-4 (]: Began running node test.dbt_exercise.unique_dim_customers_sk_customer.54188da6fb
[0m17:44:32.221282 [info ] [Thread-4 (]: 52 of 59 START test unique_dim_customers_sk_customer ........................... [RUN]
[0m17:44:32.224041 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_exercise.source_unique_northwind_suppliers_supplier_id.aa7461739b, now test.dbt_exercise.unique_dim_customers_sk_customer.54188da6fb)
[0m17:44:32.232963 [debug] [Thread-4 (]: Began compiling node test.dbt_exercise.unique_dim_customers_sk_customer.54188da6fb
[0m17:44:32.261623 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_exercise.unique_dim_customers_sk_customer.54188da6fb"
[0m17:44:32.263510 [debug] [Thread-4 (]: Began executing node test.dbt_exercise.unique_dim_customers_sk_customer.54188da6fb
[0m17:44:32.273285 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_exercise.unique_dim_customers_sk_customer.54188da6fb"
[0m17:44:32.274879 [debug] [Thread-4 (]: On test.dbt_exercise.unique_dim_customers_sk_customer.54188da6fb: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "test.dbt_exercise.unique_dim_customers_sk_customer.54188da6fb"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with dbt_test__target as (

  select sk_customer as unique_field
  from `corded-sunlight-464012-e2`.`dbt_dw_marts`.`dim_customers`
  where sk_customer is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m17:44:32.275969 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m17:44:32.602130 [info ] [Thread-2 (]: 50 of 59 PASS source_unique_northwind_us_states_state_id ....................... [[32mPASS[0m in 1.66s]
[0m17:44:32.603747 [debug] [Thread-2 (]: Finished running node test.dbt_exercise.source_unique_northwind_us_states_state_id.c374c85cda
[0m17:44:32.604595 [debug] [Thread-2 (]: Began running node test.dbt_exercise.unique_dim_employees_employee_id.79828c8f30
[0m17:44:32.605384 [info ] [Thread-2 (]: 53 of 59 START test unique_dim_employees_employee_id ........................... [RUN]
[0m17:44:32.606231 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_exercise.source_unique_northwind_us_states_state_id.c374c85cda, now test.dbt_exercise.unique_dim_employees_employee_id.79828c8f30)
[0m17:44:32.607139 [debug] [Thread-2 (]: Began compiling node test.dbt_exercise.unique_dim_employees_employee_id.79828c8f30
[0m17:44:32.621258 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_exercise.unique_dim_employees_employee_id.79828c8f30"
[0m17:44:32.625710 [debug] [Thread-2 (]: Began executing node test.dbt_exercise.unique_dim_employees_employee_id.79828c8f30
[0m17:44:32.630609 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_exercise.unique_dim_employees_employee_id.79828c8f30"
[0m17:44:32.632755 [debug] [Thread-2 (]: On test.dbt_exercise.unique_dim_employees_employee_id.79828c8f30: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "test.dbt_exercise.unique_dim_employees_employee_id.79828c8f30"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with dbt_test__target as (

  select employee_id as unique_field
  from `corded-sunlight-464012-e2`.`dbt_dw_marts`.`dim_employees`
  where employee_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m17:44:32.633534 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:44:32.682312 [info ] [Thread-1 (]: 49 of 59 PASS source_unique_northwind_territories_territory_id ................. [[32mPASS[0m in 1.82s]
[0m17:44:32.683994 [debug] [Thread-1 (]: Finished running node test.dbt_exercise.source_unique_northwind_territories_territory_id.08bc548860
[0m17:44:32.685388 [debug] [Thread-1 (]: Began running node test.dbt_exercise.unique_dim_employees_sk_employee.2c4a61e188
[0m17:44:32.686787 [info ] [Thread-1 (]: 54 of 59 START test unique_dim_employees_sk_employee ........................... [RUN]
[0m17:44:32.689321 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_exercise.source_unique_northwind_territories_territory_id.08bc548860, now test.dbt_exercise.unique_dim_employees_sk_employee.2c4a61e188)
[0m17:44:32.692158 [debug] [Thread-1 (]: Began compiling node test.dbt_exercise.unique_dim_employees_sk_employee.2c4a61e188
[0m17:44:32.702105 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_exercise.unique_dim_employees_sk_employee.2c4a61e188"
[0m17:44:32.705060 [debug] [Thread-1 (]: Began executing node test.dbt_exercise.unique_dim_employees_sk_employee.2c4a61e188
[0m17:44:32.710130 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_exercise.unique_dim_employees_sk_employee.2c4a61e188"
[0m17:44:32.711293 [debug] [Thread-1 (]: On test.dbt_exercise.unique_dim_employees_sk_employee.2c4a61e188: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "test.dbt_exercise.unique_dim_employees_sk_employee.2c4a61e188"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with dbt_test__target as (

  select sk_employee as unique_field
  from `corded-sunlight-464012-e2`.`dbt_dw_marts`.`dim_employees`
  where sk_employee is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m17:44:32.712147 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:44:32.760467 [info ] [Thread-3 (]: 51 of 59 PASS unique_dim_customers_customer_id ................................. [[32mPASS[0m in 1.71s]
[0m17:44:32.761434 [debug] [Thread-3 (]: Finished running node test.dbt_exercise.unique_dim_customers_customer_id.15c9f1e2fd
[0m17:44:32.762311 [debug] [Thread-3 (]: Began running node test.dbt_exercise.unique_dim_products_product_id.ef7b2a9985
[0m17:44:32.763150 [info ] [Thread-3 (]: 55 of 59 START test unique_dim_products_product_id ............................. [RUN]
[0m17:44:32.763965 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_exercise.unique_dim_customers_customer_id.15c9f1e2fd, now test.dbt_exercise.unique_dim_products_product_id.ef7b2a9985)
[0m17:44:32.764692 [debug] [Thread-3 (]: Began compiling node test.dbt_exercise.unique_dim_products_product_id.ef7b2a9985
[0m17:44:32.770020 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_exercise.unique_dim_products_product_id.ef7b2a9985"
[0m17:44:32.772127 [debug] [Thread-3 (]: Began executing node test.dbt_exercise.unique_dim_products_product_id.ef7b2a9985
[0m17:44:32.777768 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_exercise.unique_dim_products_product_id.ef7b2a9985"
[0m17:44:32.781059 [debug] [Thread-3 (]: On test.dbt_exercise.unique_dim_products_product_id.ef7b2a9985: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "test.dbt_exercise.unique_dim_products_product_id.ef7b2a9985"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with dbt_test__target as (

  select product_id as unique_field
  from `corded-sunlight-464012-e2`.`dbt_dw_marts`.`dim_products`
  where product_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m17:44:32.782871 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m17:44:33.193005 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:ba36afee-4cce-423c-a145-e60cf236dc65&page=queryresults
[0m17:44:33.597951 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:061fc10b-5cd0-4e32-92c0-575144d1ee56&page=queryresults
[0m17:44:33.677819 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:c0b003fa-51b3-4b09-beb3-d0c4d7e94f1c&page=queryresults
[0m17:44:33.721197 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:3516ec40-e6f1-4a6a-aada-59d2d347ca35&page=queryresults
[0m17:44:33.955043 [info ] [Thread-4 (]: 52 of 59 PASS unique_dim_customers_sk_customer ................................. [[32mPASS[0m in 1.73s]
[0m17:44:33.956750 [debug] [Thread-4 (]: Finished running node test.dbt_exercise.unique_dim_customers_sk_customer.54188da6fb
[0m17:44:33.957793 [debug] [Thread-4 (]: Began running node test.dbt_exercise.unique_dim_products_sk_product.1658453ef4
[0m17:44:33.959287 [info ] [Thread-4 (]: 56 of 59 START test unique_dim_products_sk_product ............................. [RUN]
[0m17:44:33.960326 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_exercise.unique_dim_customers_sk_customer.54188da6fb, now test.dbt_exercise.unique_dim_products_sk_product.1658453ef4)
[0m17:44:33.960899 [debug] [Thread-4 (]: Began compiling node test.dbt_exercise.unique_dim_products_sk_product.1658453ef4
[0m17:44:33.972471 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_exercise.unique_dim_products_sk_product.1658453ef4"
[0m17:44:33.976949 [debug] [Thread-4 (]: Began executing node test.dbt_exercise.unique_dim_products_sk_product.1658453ef4
[0m17:44:33.986424 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_exercise.unique_dim_products_sk_product.1658453ef4"
[0m17:44:33.987840 [debug] [Thread-4 (]: On test.dbt_exercise.unique_dim_products_sk_product.1658453ef4: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "test.dbt_exercise.unique_dim_products_sk_product.1658453ef4"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with dbt_test__target as (

  select sk_product as unique_field
  from `corded-sunlight-464012-e2`.`dbt_dw_marts`.`dim_products`
  where sk_product is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m17:44:33.988497 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m17:44:34.319683 [info ] [Thread-2 (]: 53 of 59 PASS unique_dim_employees_employee_id ................................. [[32mPASS[0m in 1.71s]
[0m17:44:34.322363 [debug] [Thread-2 (]: Finished running node test.dbt_exercise.unique_dim_employees_employee_id.79828c8f30
[0m17:44:34.325447 [debug] [Thread-2 (]: Began running node test.dbt_exercise.unique_dim_ship_ship_id.8825a91f8e
[0m17:44:34.330486 [info ] [Thread-2 (]: 57 of 59 START test unique_dim_ship_ship_id .................................... [RUN]
[0m17:44:34.332547 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_exercise.unique_dim_employees_employee_id.79828c8f30, now test.dbt_exercise.unique_dim_ship_ship_id.8825a91f8e)
[0m17:44:34.333659 [debug] [Thread-2 (]: Began compiling node test.dbt_exercise.unique_dim_ship_ship_id.8825a91f8e
[0m17:44:34.343639 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_exercise.unique_dim_ship_ship_id.8825a91f8e"
[0m17:44:34.345084 [debug] [Thread-2 (]: Began executing node test.dbt_exercise.unique_dim_ship_ship_id.8825a91f8e
[0m17:44:34.353755 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_exercise.unique_dim_ship_ship_id.8825a91f8e"
[0m17:44:34.355839 [debug] [Thread-2 (]: On test.dbt_exercise.unique_dim_ship_ship_id.8825a91f8e: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "test.dbt_exercise.unique_dim_ship_ship_id.8825a91f8e"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with dbt_test__target as (

  select ship_id as unique_field
  from `corded-sunlight-464012-e2`.`dbt_dw_marts`.`dim_ship`
  where ship_id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m17:44:34.357190 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:44:34.407685 [info ] [Thread-3 (]: 55 of 59 PASS unique_dim_products_product_id ................................... [[32mPASS[0m in 1.64s]
[0m17:44:34.408593 [debug] [Thread-3 (]: Finished running node test.dbt_exercise.unique_dim_products_product_id.ef7b2a9985
[0m17:44:34.409148 [debug] [Thread-3 (]: Began running node test.dbt_exercise.unique_dim_ship_sk_ship.14db8b5f73
[0m17:44:34.409756 [info ] [Thread-3 (]: 58 of 59 START test unique_dim_ship_sk_ship .................................... [RUN]
[0m17:44:34.410395 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_exercise.unique_dim_products_product_id.ef7b2a9985, now test.dbt_exercise.unique_dim_ship_sk_ship.14db8b5f73)
[0m17:44:34.411220 [debug] [Thread-3 (]: Began compiling node test.dbt_exercise.unique_dim_ship_sk_ship.14db8b5f73
[0m17:44:34.417014 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_exercise.unique_dim_ship_sk_ship.14db8b5f73"
[0m17:44:34.418090 [debug] [Thread-3 (]: Began executing node test.dbt_exercise.unique_dim_ship_sk_ship.14db8b5f73
[0m17:44:34.421200 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_exercise.unique_dim_ship_sk_ship.14db8b5f73"
[0m17:44:34.422229 [debug] [Thread-3 (]: On test.dbt_exercise.unique_dim_ship_sk_ship.14db8b5f73: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "test.dbt_exercise.unique_dim_ship_sk_ship.14db8b5f73"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with dbt_test__target as (

  select sk_ship as unique_field
  from `corded-sunlight-464012-e2`.`dbt_dw_marts`.`dim_ship`
  where sk_ship is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m17:44:34.422785 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m17:44:34.488942 [info ] [Thread-1 (]: 54 of 59 PASS unique_dim_employees_sk_employee ................................. [[32mPASS[0m in 1.80s]
[0m17:44:34.490068 [debug] [Thread-1 (]: Finished running node test.dbt_exercise.unique_dim_employees_sk_employee.2c4a61e188
[0m17:44:34.490683 [debug] [Thread-1 (]: Began running node test.dbt_exercise.unique_fact_orders_sk_orders.072a29dba8
[0m17:44:34.491570 [info ] [Thread-1 (]: 59 of 59 START test unique_fact_orders_sk_orders ............................... [RUN]
[0m17:44:34.492373 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_exercise.unique_dim_employees_sk_employee.2c4a61e188, now test.dbt_exercise.unique_fact_orders_sk_orders.072a29dba8)
[0m17:44:34.492915 [debug] [Thread-1 (]: Began compiling node test.dbt_exercise.unique_fact_orders_sk_orders.072a29dba8
[0m17:44:34.498554 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_exercise.unique_fact_orders_sk_orders.072a29dba8"
[0m17:44:34.499950 [debug] [Thread-1 (]: Began executing node test.dbt_exercise.unique_fact_orders_sk_orders.072a29dba8
[0m17:44:34.503522 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_exercise.unique_fact_orders_sk_orders.072a29dba8"
[0m17:44:34.506053 [debug] [Thread-1 (]: On test.dbt_exercise.unique_fact_orders_sk_orders.072a29dba8: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "test.dbt_exercise.unique_fact_orders_sk_orders.072a29dba8"} */

    select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
  
    
    

with dbt_test__target as (

  select sk_orders as unique_field
  from `corded-sunlight-464012-e2`.`dbt_dw_marts`.`fact_orders`
  where sk_orders is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



  
  
      
    ) dbt_internal_test
[0m17:44:34.507243 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:44:34.883555 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:db514cdf-31e2-4d9c-bc87-f39d768f3154&page=queryresults
[0m17:44:35.214472 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:940fb667-ff52-47cc-9e53-056b8e050b14&page=queryresults
[0m17:44:35.349310 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:18121a6b-5604-4f67-9a93-17be1cb5c510&page=queryresults
[0m17:44:35.413386 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:81926895-3f34-4875-87f0-249324c0ef89&page=queryresults
[0m17:44:35.678876 [info ] [Thread-4 (]: 56 of 59 PASS unique_dim_products_sk_product ................................... [[32mPASS[0m in 1.72s]
[0m17:44:35.680137 [debug] [Thread-4 (]: Finished running node test.dbt_exercise.unique_dim_products_sk_product.1658453ef4
[0m17:44:35.977625 [info ] [Thread-2 (]: 57 of 59 PASS unique_dim_ship_ship_id .......................................... [[32mPASS[0m in 1.65s]
[0m17:44:35.979612 [debug] [Thread-2 (]: Finished running node test.dbt_exercise.unique_dim_ship_ship_id.8825a91f8e
[0m17:44:36.077987 [info ] [Thread-3 (]: 58 of 59 PASS unique_dim_ship_sk_ship .......................................... [[32mPASS[0m in 1.67s]
[0m17:44:36.080056 [debug] [Thread-3 (]: Finished running node test.dbt_exercise.unique_dim_ship_sk_ship.14db8b5f73
[0m17:44:36.131420 [info ] [Thread-1 (]: 59 of 59 PASS unique_fact_orders_sk_orders ..................................... [[32mPASS[0m in 1.64s]
[0m17:44:36.132441 [debug] [Thread-1 (]: Finished running node test.dbt_exercise.unique_fact_orders_sk_orders.072a29dba8
[0m17:44:36.136589 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:44:36.145980 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:44:36.146739 [debug] [MainThread]: Connection 'test.dbt_exercise.unique_dim_ship_sk_ship.14db8b5f73' was properly closed.
[0m17:44:36.147299 [debug] [MainThread]: Connection 'test.dbt_exercise.unique_dim_products_sk_product.1658453ef4' was properly closed.
[0m17:44:36.147742 [debug] [MainThread]: Connection 'test.dbt_exercise.unique_dim_ship_ship_id.8825a91f8e' was properly closed.
[0m17:44:36.148149 [debug] [MainThread]: Connection 'test.dbt_exercise.unique_fact_orders_sk_orders.072a29dba8' was properly closed.
[0m17:44:36.148947 [info ] [MainThread]: 
[0m17:44:36.150105 [info ] [MainThread]: Finished running 59 data tests in 0 hours 0 minutes and 37.80 seconds (37.80s).
[0m17:44:36.166523 [debug] [MainThread]: Command end result
[0m17:44:36.273053 [debug] [MainThread]: Wrote artifact WritableManifest to /home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/target/manifest.json
[0m17:44:36.289635 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/target/semantic_manifest.json
[0m17:44:36.303362 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/target/run_results.json
[0m17:44:36.304334 [info ] [MainThread]: 
[0m17:44:36.305170 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:44:36.305786 [info ] [MainThread]: 
[0m17:44:36.306362 [info ] [MainThread]: Done. PASS=59 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=59
[0m17:44:36.307295 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- DuplicateYAMLKeysDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m17:44:36.312589 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 177.36615, "process_in_blocks": "122920", "process_kernel_time": 19.654379, "process_mem_max_rss": "374036", "process_out_blocks": "5240", "process_user_time": 20.69567}
[0m17:44:36.313658 [debug] [MainThread]: Command `dbt test` succeeded at 17:44:36.313403 after 177.37 seconds
[0m17:44:36.314335 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x727faf0b5c40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x727fad51cad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x727fad51c170>]}
[0m17:44:36.315071 [debug] [MainThread]: Flushing usage events
[0m17:44:36.624731 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:45:56.550842 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76db6e855370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76db6ce11280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76db6c85b590>]}


============================== 17:45:56.571354 | 8e2e433c-2250-42a8-860b-5773f361f987 ==============================
[0m17:45:56.571354 [info ] [MainThread]: Running with dbt=1.10.2
[0m17:45:56.572571 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/logs', 'debug': 'False', 'profiles_dir': '/home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m17:47:02.862569 [warn ] [MainThread]: [[33mWARNING[0m][DuplicateYAMLKeysDeprecation]: Deprecated functionality
Duplicate key 'version' in "<unicode string>", line 4, column 1 in file
`/home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/dbt_project.yml`
[0m17:47:02.863966 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '8e2e433c-2250-42a8-860b-5773f361f987', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76db2f096a80>]}
[0m17:47:03.855320 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8e2e433c-2250-42a8-860b-5773f361f987', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76db33a1d490>]}
[0m17:47:03.974792 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8e2e433c-2250-42a8-860b-5773f361f987', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76db2f015fa0>]}
[0m17:47:03.981140 [info ] [MainThread]: Registered adapter: bigquery=1.9.2
[0m17:48:14.979477 [debug] [MainThread]: checksum: 1adc40777973ef30f45f80b3b6d04d5013c1edd53d96363881b3b199e612468b, vars: {}, profile: , target: , version: 1.10.2
[0m17:48:22.690001 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:48:22.690633 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:48:22.982485 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8e2e433c-2250-42a8-860b-5773f361f987', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76db2ef6af60>]}
[0m17:48:23.159359 [debug] [MainThread]: Wrote artifact WritableManifest to /home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/target/manifest.json
[0m17:48:23.174368 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/target/semantic_manifest.json
[0m17:48:23.679695 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8e2e433c-2250-42a8-860b-5773f361f987', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76db2ef3eae0>]}
[0m17:48:23.680604 [info ] [MainThread]: Found 19 models, 14 seeds, 59 data tests, 14 sources, 609 macros
[0m17:48:23.681637 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8e2e433c-2250-42a8-860b-5773f361f987', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76db6bef1a00>]}
[0m17:48:23.686047 [info ] [MainThread]: 
[0m17:48:23.686731 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m17:48:23.687310 [info ] [MainThread]: 
[0m17:48:23.688262 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m17:48:23.696039 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_corded-sunlight-464012-e2'
[0m17:48:23.697182 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:48:23.698068 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_corded-sunlight-464012-e2'
[0m17:48:23.700161 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_corded-sunlight-464012-e2'
[0m17:48:23.701257 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:48:23.702395 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:48:25.023372 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_corded-sunlight-464012-e2, now list_corded-sunlight-464012-e2_dbt_dw_staging)
[0m17:48:25.024376 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:48:25.025584 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_corded-sunlight-464012-e2, now list_corded-sunlight-464012-e2_dbt_dw_raw)
[0m17:48:25.026917 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_corded-sunlight-464012-e2, now list_corded-sunlight-464012-e2_dbt_dw_marts)
[0m17:48:25.028172 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_corded-sunlight-464012-e2_dbt_dw_intermediate'
[0m17:48:25.028891 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:48:25.030499 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:48:25.031935 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:48:25.956054 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8e2e433c-2250-42a8-860b-5773f361f987', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76db2ef3e300>]}
[0m17:48:25.957516 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:48:25.968457 [debug] [Thread-1 (]: Began running node model.dbt_exercise.stg_categories_northwind
[0m17:48:25.969578 [debug] [Thread-2 (]: Began running node model.dbt_exercise.stg_customers_northwind
[0m17:48:25.970668 [debug] [Thread-3 (]: Began running node model.dbt_exercise.stg_employee_territories
[0m17:48:25.972239 [debug] [Thread-4 (]: Began running node model.dbt_exercise.stg_employees_northwind
[0m17:48:25.973598 [info ] [Thread-1 (]: 1 of 19 START sql view model dbt_dw_staging.stg_categories_northwind ........... [RUN]
[0m17:48:25.975039 [info ] [Thread-2 (]: 2 of 19 START sql view model dbt_dw_staging.stg_customers_northwind ............ [RUN]
[0m17:48:25.976846 [info ] [Thread-3 (]: 3 of 19 START sql view model dbt_dw_staging.stg_employee_territories ........... [RUN]
[0m17:48:25.978303 [info ] [Thread-4 (]: 4 of 19 START sql view model dbt_dw_staging.stg_employees_northwind ............ [RUN]
[0m17:48:25.979972 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_corded-sunlight-464012-e2_dbt_dw_staging, now model.dbt_exercise.stg_categories_northwind)
[0m17:48:25.981278 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_corded-sunlight-464012-e2_dbt_dw_intermediate, now model.dbt_exercise.stg_customers_northwind)
[0m17:48:25.982638 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_corded-sunlight-464012-e2_dbt_dw_marts, now model.dbt_exercise.stg_employee_territories)
[0m17:48:25.983636 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly list_corded-sunlight-464012-e2_dbt_dw_raw, now model.dbt_exercise.stg_employees_northwind)
[0m17:48:25.984552 [debug] [Thread-1 (]: Began compiling node model.dbt_exercise.stg_categories_northwind
[0m17:48:25.985605 [debug] [Thread-2 (]: Began compiling node model.dbt_exercise.stg_customers_northwind
[0m17:48:25.986448 [debug] [Thread-3 (]: Began compiling node model.dbt_exercise.stg_employee_territories
[0m17:48:25.987452 [debug] [Thread-4 (]: Began compiling node model.dbt_exercise.stg_employees_northwind
[0m17:48:25.999795 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_exercise.stg_categories_northwind"
[0m17:48:26.006486 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_exercise.stg_customers_northwind"
[0m17:48:26.013584 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_exercise.stg_employee_territories"
[0m17:48:26.017936 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_exercise.stg_employees_northwind"
[0m17:48:26.021515 [debug] [Thread-2 (]: Began executing node model.dbt_exercise.stg_customers_northwind
[0m17:48:26.023942 [debug] [Thread-3 (]: Began executing node model.dbt_exercise.stg_employee_territories
[0m17:48:26.024607 [debug] [Thread-1 (]: Began executing node model.dbt_exercise.stg_categories_northwind
[0m17:48:26.039851 [debug] [Thread-4 (]: Began executing node model.dbt_exercise.stg_employees_northwind
[0m17:48:26.104466 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_exercise.stg_employee_territories"
[0m17:48:26.105694 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_exercise.stg_customers_northwind"
[0m17:48:26.108665 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_exercise.stg_categories_northwind"
[0m17:48:26.111981 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_exercise.stg_employees_northwind"
[0m17:48:26.114552 [debug] [Thread-3 (]: On model.dbt_exercise.stg_employee_territories: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "model.dbt_exercise.stg_employee_territories"} */


  create or replace view `corded-sunlight-464012-e2`.`dbt_dw_staging`.`stg_employee_territories`
  OPTIONS()
  as with raw_employee_territories as (
    select *
    from `corded-sunlight-464012-e2`.`dbt_dw_raw`.`employee_territories`
)

, stg_employee_territories as (
    select
        cast(employee_id as string) as employee_id
        , cast(territory_id as string) as territory_id
    from raw_employee_territories
)

select *
from stg_employee_territories;


[0m17:48:26.115931 [debug] [Thread-2 (]: On model.dbt_exercise.stg_customers_northwind: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "model.dbt_exercise.stg_customers_northwind"} */


  create or replace view `corded-sunlight-464012-e2`.`dbt_dw_staging`.`stg_customers_northwind`
  OPTIONS()
  as with raw_customers as (
    select *
    from `corded-sunlight-464012-e2`.`dbt_dw_raw`.`customers`
)

, stg_customers_northwind as (
    select
        cast(customer_id as string) as customer_id
        , cast(company_name as string) as company_name
        , cast(contact_name as string) as contact_name
        , cast(contact_title as string) as contact_title
        , cast(address as string) as address
        , cast(city as string) as city
        , cast(region as string) as region
        , cast(postal_code as string) as postal_code
        , cast(country as string) as country
        , cast(phone as string) as phone
        , cast(fax as string) as fax
    from raw_customers
)

select *
from stg_customers_northwind;


[0m17:48:26.117379 [debug] [Thread-1 (]: On model.dbt_exercise.stg_categories_northwind: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "model.dbt_exercise.stg_categories_northwind"} */


  create or replace view `corded-sunlight-464012-e2`.`dbt_dw_staging`.`stg_categories_northwind`
  OPTIONS()
  as with raw_categories as (
    select *
    from `corded-sunlight-464012-e2`.`dbt_dw_raw`.`categories`
)

/* Ao construir a staging não vamos trazer a coluna picture, pois ela não traz informação relevante */
, stg_categories_northwind as (
    select
        cast(category_id as string) as category_id
        , cast(category_name as string) as category_name
        , cast(description as string) as description
    from raw_categories
)

select *
from stg_categories_northwind;


[0m17:48:26.118341 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m17:48:26.119592 [debug] [Thread-4 (]: On model.dbt_exercise.stg_employees_northwind: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "model.dbt_exercise.stg_employees_northwind"} */


  create or replace view `corded-sunlight-464012-e2`.`dbt_dw_staging`.`stg_employees_northwind`
  OPTIONS()
  as with raw_employees as (
    select *
    from `corded-sunlight-464012-e2`.`dbt_dw_raw`.`employees`
)

/* Os campos photo, notes e reports_to e photo_path não são carregadas na staging */

, stg_employees_northwind as (
    select
        cast(employee_id as string) as employee_id
        , cast(first_name as string) as first_name
        , cast(last_name as string) as last_name
        , cast(title as string) as title
        , cast(title_of_courtesy as string) as title_of_courtesy
        , cast(birth_date as date) as birth_date
        , cast(hire_date as date) as hire_date
        , cast(address as string) as address
        , cast(city as string) as city
        , cast(region as string) as region
        , cast(postal_code as string) as postal_code
        , cast(country as string) as country
        , cast(home_phone as string) as home_phone
        , cast(extension as string) as extension
    from raw_employees
)

select *
from stg_employees_northwind;


[0m17:48:26.120428 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:48:26.121263 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:48:26.122524 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m17:48:27.184502 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:1ad4f523-af3a-4619-bfe0-583eb5889822&page=queryresults
[0m17:48:27.220096 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:1542718b-0e42-4014-b8af-35094fb952fb&page=queryresults
[0m17:48:27.226231 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:8a2e04ae-8b44-489c-91e6-bfc7adcce589&page=queryresults
[0m17:48:27.297080 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:4db1bd69-2bab-4094-9aa4-1431daeb78c9&page=queryresults
[0m17:48:32.945439 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8e2e433c-2250-42a8-860b-5773f361f987', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76db6bf1ce30>]}
[0m17:48:32.946272 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8e2e433c-2250-42a8-860b-5773f361f987', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76db33a1e6f0>]}
[0m17:48:32.948049 [info ] [Thread-1 (]: 1 of 19 OK created sql view model dbt_dw_staging.stg_categories_northwind ...... [[32mCREATE VIEW (0 processed)[0m in 6.94s]
[0m17:48:32.949862 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8e2e433c-2250-42a8-860b-5773f361f987', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76db2c5553a0>]}
[0m17:48:32.951449 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8e2e433c-2250-42a8-860b-5773f361f987', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76db2c63da00>]}
[0m17:48:32.953066 [info ] [Thread-3 (]: 3 of 19 OK created sql view model dbt_dw_staging.stg_employee_territories ...... [[32mCREATE VIEW (0 processed)[0m in 6.94s]
[0m17:48:32.954671 [debug] [Thread-1 (]: Finished running node model.dbt_exercise.stg_categories_northwind
[0m17:48:32.955986 [info ] [Thread-4 (]: 4 of 19 OK created sql view model dbt_dw_staging.stg_employees_northwind ....... [[32mCREATE VIEW (0 processed)[0m in 6.94s]
[0m17:48:32.958275 [info ] [Thread-2 (]: 2 of 19 OK created sql view model dbt_dw_staging.stg_customers_northwind ....... [[32mCREATE VIEW (0 processed)[0m in 6.95s]
[0m17:48:32.960023 [debug] [Thread-3 (]: Finished running node model.dbt_exercise.stg_employee_territories
[0m17:48:32.961240 [debug] [Thread-1 (]: Began running node model.dbt_exercise.stg_order_details_northwind
[0m17:48:32.963399 [debug] [Thread-4 (]: Finished running node model.dbt_exercise.stg_employees_northwind
[0m17:48:32.965635 [debug] [Thread-2 (]: Finished running node model.dbt_exercise.stg_customers_northwind
[0m17:48:32.966893 [debug] [Thread-3 (]: Began running node model.dbt_exercise.stg_orders_northwind
[0m17:48:32.968265 [info ] [Thread-1 (]: 5 of 19 START sql view model dbt_dw_staging.stg_order_details_northwind ........ [RUN]
[0m17:48:32.969761 [debug] [Thread-4 (]: Began running node model.dbt_exercise.stg_products_northwind
[0m17:48:32.970856 [debug] [Thread-2 (]: Began running node model.dbt_exercise.stg_shippers_northwind
[0m17:48:32.971958 [info ] [Thread-3 (]: 6 of 19 START sql view model dbt_dw_staging.stg_orders_northwind ............... [RUN]
[0m17:48:32.973520 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_exercise.stg_categories_northwind, now model.dbt_exercise.stg_order_details_northwind)
[0m17:48:32.975376 [info ] [Thread-4 (]: 7 of 19 START sql view model dbt_dw_staging.stg_products_northwind ............. [RUN]
[0m17:48:32.977515 [info ] [Thread-2 (]: 8 of 19 START sql view model dbt_dw_staging.stg_shippers_northwind ............. [RUN]
[0m17:48:32.979359 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_exercise.stg_employee_territories, now model.dbt_exercise.stg_orders_northwind)
[0m17:48:32.980479 [debug] [Thread-1 (]: Began compiling node model.dbt_exercise.stg_order_details_northwind
[0m17:48:32.981910 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.dbt_exercise.stg_employees_northwind, now model.dbt_exercise.stg_products_northwind)
[0m17:48:32.983062 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_exercise.stg_customers_northwind, now model.dbt_exercise.stg_shippers_northwind)
[0m17:48:32.984119 [debug] [Thread-3 (]: Began compiling node model.dbt_exercise.stg_orders_northwind
[0m17:48:32.989216 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_exercise.stg_order_details_northwind"
[0m17:48:32.990554 [debug] [Thread-4 (]: Began compiling node model.dbt_exercise.stg_products_northwind
[0m17:48:32.991834 [debug] [Thread-2 (]: Began compiling node model.dbt_exercise.stg_shippers_northwind
[0m17:48:32.998038 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_exercise.stg_orders_northwind"
[0m17:48:33.003692 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_exercise.stg_products_northwind"
[0m17:48:33.010986 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_exercise.stg_shippers_northwind"
[0m17:48:33.012779 [debug] [Thread-1 (]: Began executing node model.dbt_exercise.stg_order_details_northwind
[0m17:48:33.014920 [debug] [Thread-3 (]: Began executing node model.dbt_exercise.stg_orders_northwind
[0m17:48:33.019727 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_exercise.stg_order_details_northwind"
[0m17:48:33.020572 [debug] [Thread-4 (]: Began executing node model.dbt_exercise.stg_products_northwind
[0m17:48:33.021616 [debug] [Thread-2 (]: Began executing node model.dbt_exercise.stg_shippers_northwind
[0m17:48:33.030287 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_exercise.stg_orders_northwind"
[0m17:48:33.041292 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_exercise.stg_products_northwind"
[0m17:48:33.045217 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_exercise.stg_shippers_northwind"
[0m17:48:33.047210 [debug] [Thread-1 (]: On model.dbt_exercise.stg_order_details_northwind: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "model.dbt_exercise.stg_order_details_northwind"} */


  create or replace view `corded-sunlight-464012-e2`.`dbt_dw_staging`.`stg_order_details_northwind`
  OPTIONS()
  as with raw_order_details as (
    select *
    from `corded-sunlight-464012-e2`.`dbt_dw_raw`.`order_details`
)

, stg_order_details_northwind as (
    select
        cast(order_id as string) as order_id
        , cast(product_id as string) as product_id
        , cast(unit_price as numeric) as unit_price
        , cast(quantity as integer) as quantity
        , cast(discount as numeric) as discount
    from raw_order_details
)

select *
from stg_order_details_northwind;


[0m17:48:33.048495 [debug] [Thread-3 (]: On model.dbt_exercise.stg_orders_northwind: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "model.dbt_exercise.stg_orders_northwind"} */


  create or replace view `corded-sunlight-464012-e2`.`dbt_dw_staging`.`stg_orders_northwind`
  OPTIONS()
  as with raw_orders as (
    select *
    from `corded-sunlight-464012-e2`.`dbt_dw_raw`.`orders`
)

, stg_orders_northwind as (
    select
        cast(order_id as string) as order_id
        , cast(customer_id as string) as customer_id
        , cast(employee_id as string) as employee_id
        , cast(order_date as timestamp) as order_date
        , cast(required_date as timestamp) as required_date
        , cast(shipped_date as timestamp) as shipped_date
        , cast(ship_via as string) as ship_via
        , cast(freight as numeric) as freight
        , cast(ship_name as string) as ship_name
        , cast(ship_address as string) as ship_address
        , cast(ship_city as string) as ship_city
        , cast(ship_region as string) as ship_region
        , cast(ship_postal_code as string) as ship_postal_code
        , cast(ship_country as string) as ship_country
    from raw_orders
)

select *
from stg_orders_northwind;


[0m17:48:33.049631 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:48:33.050390 [debug] [Thread-4 (]: On model.dbt_exercise.stg_products_northwind: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "model.dbt_exercise.stg_products_northwind"} */


  create or replace view `corded-sunlight-464012-e2`.`dbt_dw_staging`.`stg_products_northwind`
  OPTIONS()
  as with raw_products as (
    select *
    from `corded-sunlight-464012-e2`.`dbt_dw_raw`.`products`
)

, stg_products_northwind as (
    select
        cast(product_id as string) as product_id
        , cast(product_name as string) as product_name
        , cast(supplier_id as string) as supplier_id
        , cast(category_id as string) as category_id
        , cast(quantity_per_unit as string) as quantity_per_unit
        , cast(unit_price as numeric) as unit_price
        , cast(units_in_stock as numeric) as units_in_stock
        , cast(units_on_order as numeric) as units_on_order
        , cast(reorder_level as numeric) as reorder_level
        , cast(discontinued as integer) as discontinued
    from raw_products
)

select *
from stg_products_northwind;


[0m17:48:33.051148 [debug] [Thread-2 (]: On model.dbt_exercise.stg_shippers_northwind: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "model.dbt_exercise.stg_shippers_northwind"} */


  create or replace view `corded-sunlight-464012-e2`.`dbt_dw_staging`.`stg_shippers_northwind`
  OPTIONS()
  as with raw_shippers as (
    select *
    from `corded-sunlight-464012-e2`.`dbt_dw_raw`.`shippers`
)

, stg_shippers_northwind as (
    select
        cast(shipper_id as string) as shipper_id
        , cast(company_name as string) as company_name
        , cast(phone as string) as phone
    from raw_shippers
)

select *
from stg_shippers_northwind;


[0m17:48:33.052145 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m17:48:33.054102 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m17:48:33.055672 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:48:33.953306 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:a68e0cc6-f845-4021-bf09-d814fba46cbc&page=queryresults
[0m17:48:33.983456 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:34b43419-f1ef-4a3f-8ac4-7954c1f0aa1c&page=queryresults
[0m17:48:34.043760 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:36d65001-cd5a-435e-a15d-e6c840bd8376&page=queryresults
[0m17:48:34.060843 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:423ca4ca-52ce-42a6-ba75-7b62277a8f77&page=queryresults
[0m17:48:34.438922 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8e2e433c-2250-42a8-860b-5773f361f987', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76db2e802180>]}
[0m17:48:34.440096 [info ] [Thread-3 (]: 6 of 19 OK created sql view model dbt_dw_staging.stg_orders_northwind .......... [[32mCREATE VIEW (0 processed)[0m in 1.46s]
[0m17:48:34.441470 [debug] [Thread-3 (]: Finished running node model.dbt_exercise.stg_orders_northwind
[0m17:48:34.442672 [debug] [Thread-3 (]: Began running node model.dbt_exercise.stg_suppliers_northwind
[0m17:48:34.444085 [info ] [Thread-3 (]: 9 of 19 START sql view model dbt_dw_staging.stg_suppliers_northwind ............ [RUN]
[0m17:48:34.445616 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_exercise.stg_orders_northwind, now model.dbt_exercise.stg_suppliers_northwind)
[0m17:48:34.447132 [debug] [Thread-3 (]: Began compiling node model.dbt_exercise.stg_suppliers_northwind
[0m17:48:34.454616 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_exercise.stg_suppliers_northwind"
[0m17:48:34.456054 [debug] [Thread-3 (]: Began executing node model.dbt_exercise.stg_suppliers_northwind
[0m17:48:34.461364 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_exercise.stg_suppliers_northwind"
[0m17:48:34.463831 [debug] [Thread-3 (]: On model.dbt_exercise.stg_suppliers_northwind: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "model.dbt_exercise.stg_suppliers_northwind"} */


  create or replace view `corded-sunlight-464012-e2`.`dbt_dw_staging`.`stg_suppliers_northwind`
  OPTIONS()
  as with raw_suppliers as (
    select *
    from `corded-sunlight-464012-e2`.`dbt_dw_raw`.`suppliers`
)

, stg_suppliers_northwind as (
    select
        cast(supplier_id as string) as supplier_id
        , cast(company_name as string) as company_name
        , cast(contact_name as string) as contact_name
        , cast(contact_title as string) as contact_title
        , cast(address as string) as address
        , cast(city as string) as city
        , cast(region as string) as region
        , cast(postal_code as string) as postal_code
        , cast(country as string) as country
        , cast(phone as string) as phone
        , cast(fax as string) as fax
        , cast(homepage as string) as home_page
    from raw_suppliers
)

select *
from stg_suppliers_northwind;


[0m17:48:34.471680 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m17:48:34.474395 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8e2e433c-2250-42a8-860b-5773f361f987', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76db2c43b6e0>]}
[0m17:48:34.476039 [info ] [Thread-4 (]: 7 of 19 OK created sql view model dbt_dw_staging.stg_products_northwind ........ [[32mCREATE VIEW (0 processed)[0m in 1.49s]
[0m17:48:34.478108 [debug] [Thread-4 (]: Finished running node model.dbt_exercise.stg_products_northwind
[0m17:48:34.480080 [debug] [Thread-4 (]: Began running node model.dbt_exercise.int_customers_northwind
[0m17:48:34.481924 [info ] [Thread-4 (]: 10 of 19 START sql view model dbt_dw_intermediate.int_customers_northwind ...... [RUN]
[0m17:48:34.483077 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.dbt_exercise.stg_products_northwind, now model.dbt_exercise.int_customers_northwind)
[0m17:48:34.485768 [debug] [Thread-4 (]: Began compiling node model.dbt_exercise.int_customers_northwind
[0m17:48:34.529115 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_exercise.int_customers_northwind"
[0m17:48:34.531690 [debug] [Thread-4 (]: Began executing node model.dbt_exercise.int_customers_northwind
[0m17:48:34.537382 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_exercise.int_customers_northwind"
[0m17:48:34.542169 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8e2e433c-2250-42a8-860b-5773f361f987', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76db2e847860>]}
[0m17:48:34.543268 [info ] [Thread-1 (]: 5 of 19 OK created sql view model dbt_dw_staging.stg_order_details_northwind ... [[32mCREATE VIEW (0 processed)[0m in 1.57s]
[0m17:48:34.544616 [debug] [Thread-1 (]: Finished running node model.dbt_exercise.stg_order_details_northwind
[0m17:48:34.545511 [debug] [Thread-4 (]: On model.dbt_exercise.int_customers_northwind: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "model.dbt_exercise.int_customers_northwind"} */


  create or replace view `corded-sunlight-464012-e2`.`dbt_dw_intermediate`.`int_customers_northwind`
  OPTIONS()
  as with stg_customers_northwind as (
    select *
    from `corded-sunlight-464012-e2`.`dbt_dw_staging`.`stg_customers_northwind`
)

, int_customers_northwind as (
    select 
        customer_id
        , company_name
        , contact_name
        , contact_title
        , address
        , city
        , region
        , country
        , case 
            when country in ('USA', 'Canada', 'Mexico') then 'North America'
            when country in ('UK', 'France', 'Germany', 'Austria', 'Belgium', 'Denmark', 'Ireland'
            , 'Finland', 'Italy', 'Norway', 'Poland', 'Portugal', 'Spain', 'Sweden', 'Switzerland') then 'Europe'
            when country in ('Brazil', 'Argentina', 'Venezuela') then 'South America'
            else 'Other'
        end as continent
    from stg_customers_northwind
)

select *
from int_customers_northwind;


[0m17:48:34.546430 [debug] [Thread-1 (]: Began running node model.dbt_exercise.int_employees_northwind
[0m17:48:34.547592 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m17:48:34.548983 [info ] [Thread-1 (]: 11 of 19 START sql view model dbt_dw_intermediate.int_employees_northwind ...... [RUN]
[0m17:48:34.550403 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_exercise.stg_order_details_northwind, now model.dbt_exercise.int_employees_northwind)
[0m17:48:34.551298 [debug] [Thread-1 (]: Began compiling node model.dbt_exercise.int_employees_northwind
[0m17:48:34.557595 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_exercise.int_employees_northwind"
[0m17:48:34.559246 [debug] [Thread-1 (]: Began executing node model.dbt_exercise.int_employees_northwind
[0m17:48:34.565136 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_exercise.int_employees_northwind"
[0m17:48:34.567882 [debug] [Thread-1 (]: On model.dbt_exercise.int_employees_northwind: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "model.dbt_exercise.int_employees_northwind"} */


  create or replace view `corded-sunlight-464012-e2`.`dbt_dw_intermediate`.`int_employees_northwind`
  OPTIONS()
  as with raw_employees as (
    select *
    from `corded-sunlight-464012-e2`.`dbt_dw_staging`.`stg_employees_northwind`
)

, max_fact_date as (
    select 
        cast(
            case 
                when max(order_date) >= max(shipped_date) then max(order_date)
                else max(shipped_date)
            end 
        as date) as max_date
    from `corded-sunlight-464012-e2`.`dbt_dw_staging`.`stg_orders_northwind`
)

, int_employees_northwind as (
    select
        employee_id
        , concat(first_name, ' ', last_name) as employee_name
        , title
        , birth_date
        , date_diff((select * from max_fact_date), birth_date, year) as age
        , hire_date
        , date_diff((select * from max_fact_date), hire_date, year) as years_hired
        , address
        , city
        , region
        , country
    from raw_employees
)

select *
from int_employees_northwind;


[0m17:48:34.603601 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:48:34.608522 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8e2e433c-2250-42a8-860b-5773f361f987', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76db2e8401d0>]}
[0m17:48:34.611426 [info ] [Thread-2 (]: 8 of 19 OK created sql view model dbt_dw_staging.stg_shippers_northwind ........ [[32mCREATE VIEW (0 processed)[0m in 1.63s]
[0m17:48:34.613735 [debug] [Thread-2 (]: Finished running node model.dbt_exercise.stg_shippers_northwind
[0m17:48:34.615684 [debug] [Thread-2 (]: Began running node model.dbt_exercise.int_orders_northwind
[0m17:48:34.617225 [info ] [Thread-2 (]: 12 of 19 START sql view model dbt_dw_intermediate.int_orders_northwind ......... [RUN]
[0m17:48:34.618719 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_exercise.stg_shippers_northwind, now model.dbt_exercise.int_orders_northwind)
[0m17:48:34.621233 [debug] [Thread-2 (]: Began compiling node model.dbt_exercise.int_orders_northwind
[0m17:48:34.630088 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_exercise.int_orders_northwind"
[0m17:48:34.668480 [debug] [Thread-2 (]: Began executing node model.dbt_exercise.int_orders_northwind
[0m17:48:34.672877 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_exercise.int_orders_northwind"
[0m17:48:34.674535 [debug] [Thread-2 (]: On model.dbt_exercise.int_orders_northwind: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "model.dbt_exercise.int_orders_northwind"} */


  create or replace view `corded-sunlight-464012-e2`.`dbt_dw_intermediate`.`int_orders_northwind`
  OPTIONS()
  as with stg_orders_northwind as (
    select *
    from `corded-sunlight-464012-e2`.`dbt_dw_staging`.`stg_orders_northwind`
)

, stg_order_details_northwind as (
    select *
    from `corded-sunlight-464012-e2`.`dbt_dw_staging`.`stg_order_details_northwind`
)

, stg_shippers_northwind as (
    select *
    from `corded-sunlight-464012-e2`.`dbt_dw_staging`.`stg_shippers_northwind`
)

, transformed_table as (    
    select
        stg_orders_northwind.order_id 
        , stg_orders_northwind.customer_id
        , stg_orders_northwind.employee_id
        , stg_orders_northwind.order_date
        , stg_orders_northwind.required_date
        , stg_orders_northwind.shipped_date
        , date_diff(stg_orders_northwind.shipped_date, stg_orders_northwind.order_date, day) as days_to_ship
        , concat(
            coalesce(stg_orders_northwind.ship_via, '')
            , '-'
            , coalesce(stg_shippers_northwind.company_name, '')
            , '-'
            , coalesce(stg_orders_northwind.ship_address, '')
        ) as ship_id
        , stg_orders_northwind.ship_via      
        , stg_shippers_northwind.company_name as shipper_name
        , stg_order_details_northwind.product_id
        , sum(stg_order_details_northwind.unit_price * stg_order_details_northwind.quantity * (1 - stg_order_details_northwind.discount)) as amount
        /* O frete na stg_orders_northwind corresponde ao valor total do pedido, no entanto, como o grão da tabela é o produto no pedido
        , o valor do frete é racionado, sendo o total a soma do valor racionado por order_id */
        , (stg_orders_northwind.freight) / count(stg_order_details_northwind.product_id) over (partition by stg_orders_northwind.order_id) as rationed_shipping        
        , stg_orders_northwind.ship_name
        , stg_orders_northwind.ship_address
        , stg_orders_northwind.ship_city
        , stg_orders_northwind.ship_region
        , stg_orders_northwind.ship_country
        , case
            when stg_orders_northwind.ship_country in ('USA', 'Canada', 'Mexico') then 'North America'
            when stg_orders_northwind.ship_country in ('UK', 'France', 'Germany', 'Austria', 'Belgium', 
            'Denmark', 'Ireland', 'Finland', 'Italy', 'Norway', 'Poland', 'Portugal', 'Spain', 'Sweden', 'Switzerland') then 'Europe'
            when stg_orders_northwind.ship_country in ('Brazil', 'Argentina', 'Venezuela') then 'South America'
            else 'Other'
        end as ship_continent
    from stg_orders_northwind
    left join stg_order_details_northwind
        on stg_orders_northwind.order_id = stg_order_details_northwind.order_id
    left join stg_shippers_northwind
        on stg_orders_northwind.ship_via = stg_shippers_northwind.shipper_id
    group by 
        stg_orders_northwind.order_id
        , stg_orders_northwind.customer_id
        , stg_orders_northwind.employee_id
        , stg_orders_northwind.order_date
        , stg_orders_northwind.required_date
        , stg_orders_northwind.shipped_date
        , stg_orders_northwind.ship_via
        , stg_shippers_northwind.company_name
        , stg_order_details_northwind.product_id
        , stg_orders_northwind.freight
        , stg_orders_northwind.ship_name
        , stg_orders_northwind.ship_address
        , stg_orders_northwind.ship_city
        , stg_orders_northwind.ship_region
        , stg_orders_northwind.ship_country
)

, int_orders_northwind as (
    select
        transformed_table.order_id
        , transformed_table.customer_id
        , transformed_table.employee_id
        , transformed_table.order_date
        , transformed_table.required_date
        , transformed_table.shipped_date
        , transformed_table.days_to_ship
        , transformed_table.ship_id
        , transformed_table.ship_via
        , transformed_table.shipper_name
        , transformed_table.product_id
        , transformed_table.amount
        , round(transformed_table.rationed_shipping, 2) as rationed_shipping
        , transformed_table.ship_name
        , transformed_table.ship_address
        , transformed_table.ship_city
        , transformed_table.ship_region
        , transformed_table.ship_country
        , transformed_table.ship_continent
        , case 
            when transformed_table.days_to_ship is null then False
            else True
          end as is_shipped
    from transformed_table
)

select *
from int_orders_northwind;


[0m17:48:34.675696 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:48:35.438372 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:b6f9805a-7819-490a-91aa-c527fc2da52b&page=queryresults
[0m17:48:35.609075 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:729b7224-92f9-4b83-8bff-9bfd1dc2f6f3&page=queryresults
[0m17:48:35.899842 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:70c62ec4-4bda-427e-84ca-cfdf3e06cefa&page=queryresults
[0m17:48:35.946521 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8e2e433c-2250-42a8-860b-5773f361f987', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76db2c4a47a0>]}
[0m17:48:35.948002 [info ] [Thread-3 (]: 9 of 19 OK created sql view model dbt_dw_staging.stg_suppliers_northwind ....... [[32mCREATE VIEW (0 processed)[0m in 1.50s]
[0m17:48:35.950350 [debug] [Thread-3 (]: Finished running node model.dbt_exercise.stg_suppliers_northwind
[0m17:48:35.951550 [debug] [Thread-3 (]: Began running node model.dbt_exercise.int_shippers_northwind
[0m17:48:35.953674 [info ] [Thread-3 (]: 13 of 19 START sql view model dbt_dw_intermediate.int_shippers_northwind ....... [RUN]
[0m17:48:35.955513 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_exercise.stg_suppliers_northwind, now model.dbt_exercise.int_shippers_northwind)
[0m17:48:35.956845 [debug] [Thread-3 (]: Began compiling node model.dbt_exercise.int_shippers_northwind
[0m17:48:35.970006 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_exercise.int_shippers_northwind"
[0m17:48:35.973034 [debug] [Thread-3 (]: Began executing node model.dbt_exercise.int_shippers_northwind
[0m17:48:35.983377 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_exercise.int_shippers_northwind"
[0m17:48:35.987730 [debug] [Thread-3 (]: On model.dbt_exercise.int_shippers_northwind: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "model.dbt_exercise.int_shippers_northwind"} */


  create or replace view `corded-sunlight-464012-e2`.`dbt_dw_intermediate`.`int_shippers_northwind`
  OPTIONS()
  as with stg_shippers_northwind as (
    select *
    from `corded-sunlight-464012-e2`.`dbt_dw_staging`.`stg_shippers_northwind`
)

, stg_orders_northwind as (
    select *
    from `corded-sunlight-464012-e2`.`dbt_dw_staging`.`stg_orders_northwind`
)

, transformed_table as (
    select
        concat(
            coalesce(stg_shippers_northwind.shipper_id, '')
            , '-'
            , coalesce(stg_shippers_northwind.company_name, '')
            , '-'
            , coalesce(stg_orders_northwind.ship_address, '')
        ) as ship_id
        , stg_shippers_northwind.shipper_id
        , stg_shippers_northwind.company_name
        , stg_orders_northwind.ship_address
        , stg_orders_northwind.ship_city
        , stg_orders_northwind.ship_region
        , stg_orders_northwind.ship_country
    from stg_shippers_northwind
    left join stg_orders_northwind
        on stg_shippers_northwind.shipper_id = stg_orders_northwind.ship_via
)

/* Aqui é feita a deduplicação da transformed_table */
, dedup_table as (
    select distinct *
    from transformed_table
)

, int_shippers_northwind as (
    select 
        *
        , case
            when dedup_table.ship_country in ('USA', 'Canada', 'Mexico') then 'North America'
            when dedup_table.ship_country in ('UK', 'France', 'Germany', 'Austria', 'Belgium', 
            'Denmark', 'Ireland', 'Finland', 'Italy', 'Norway', 'Poland', 'Portugal', 'Spain', 'Sweden', 'Switzerland') then 'Europe'
            when dedup_table.ship_country in ('Brazil', 'Argentina', 'Venezuela') then 'South America'
            else 'Other'
        end as ship_continent
    from dedup_table
)

select *
from int_shippers_northwind;


[0m17:48:35.989929 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m17:48:36.091151 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8e2e433c-2250-42a8-860b-5773f361f987', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76db2c477500>]}
[0m17:48:36.092497 [info ] [Thread-1 (]: 11 of 19 OK created sql view model dbt_dw_intermediate.int_employees_northwind . [[32mCREATE VIEW (0 processed)[0m in 1.54s]
[0m17:48:36.093641 [debug] [Thread-1 (]: Finished running node model.dbt_exercise.int_employees_northwind
[0m17:48:36.094396 [debug] [Thread-1 (]: Began running node model.dbt_exercise.int_products_northwind
[0m17:48:36.095797 [info ] [Thread-1 (]: 14 of 19 START sql view model dbt_dw_intermediate.int_products_northwind ....... [RUN]
[0m17:48:36.097336 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_exercise.int_employees_northwind, now model.dbt_exercise.int_products_northwind)
[0m17:48:36.098848 [debug] [Thread-1 (]: Began compiling node model.dbt_exercise.int_products_northwind
[0m17:48:36.105996 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_exercise.int_products_northwind"
[0m17:48:36.107810 [debug] [Thread-1 (]: Began executing node model.dbt_exercise.int_products_northwind
[0m17:48:36.116319 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_exercise.int_products_northwind"
[0m17:48:36.118495 [debug] [Thread-1 (]: On model.dbt_exercise.int_products_northwind: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "model.dbt_exercise.int_products_northwind"} */


  create or replace view `corded-sunlight-464012-e2`.`dbt_dw_intermediate`.`int_products_northwind`
  OPTIONS()
  as with stg_products_northwind as (
    select *
    from `corded-sunlight-464012-e2`.`dbt_dw_staging`.`stg_products_northwind`
)

, stg_categories_northwind as (
    select *
    from `corded-sunlight-464012-e2`.`dbt_dw_staging`.`stg_categories_northwind`
)

, stg_suppliers_northwind as (
    select *
    from `corded-sunlight-464012-e2`.`dbt_dw_staging`.`stg_suppliers_northwind`
)

, int_products_northwind as (
    select
        stg_products_northwind.product_id
        , stg_products_northwind.product_name
        , stg_products_northwind.quantity_per_unit
        , stg_categories_northwind.category_name
        , stg_suppliers_northwind.company_name as supplier_name
        , stg_suppliers_northwind.city as supplier_city
        , stg_suppliers_northwind.region as supplier_region
        , stg_suppliers_northwind.country as supplier_country
        , case
            when stg_suppliers_northwind.country in ('USA', 'Canada') then 'North America'
            when stg_suppliers_northwind.country in ('Brazil') then 'South America'
            when stg_suppliers_northwind.country in ('UK', 'Germany', 'Netherlands', 'Spain', 'France', 'Norway', 'Italy', 'Denmark', 'Sweden', 'Finland') then 'Europe'
            when stg_suppliers_northwind.country in ('Singapore', 'Japan') then 'Asia'
            when stg_suppliers_northwind.country in ('Australia') then 'Oceania'
            else 'Other'
          end as supplier_continent
        , case 
            when stg_products_northwind.discontinued = 1 then True
            else False
        end as is_discontinued
    from stg_products_northwind
    left join stg_categories_northwind
        on stg_products_northwind.category_id = stg_categories_northwind.category_id
    left join stg_suppliers_northwind
        on stg_products_northwind.supplier_id = stg_suppliers_northwind.supplier_id
)

select *
from int_products_northwind;


[0m17:48:36.120171 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:48:36.205683 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:33f56384-ddb1-4851-8a58-3e672362c64d&page=queryresults
[0m17:48:36.412829 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8e2e433c-2250-42a8-860b-5773f361f987', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76db2c591400>]}
[0m17:48:36.414309 [info ] [Thread-4 (]: 10 of 19 OK created sql view model dbt_dw_intermediate.int_customers_northwind . [[32mCREATE VIEW (0 processed)[0m in 1.93s]
[0m17:48:36.416046 [debug] [Thread-4 (]: Finished running node model.dbt_exercise.int_customers_northwind
[0m17:48:36.417137 [debug] [Thread-4 (]: Began running node model.dbt_exercise.dim_employees
[0m17:48:36.418197 [info ] [Thread-4 (]: 15 of 19 START sql table model dbt_dw_marts.dim_employees ...................... [RUN]
[0m17:48:36.419446 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.dbt_exercise.int_customers_northwind, now model.dbt_exercise.dim_employees)
[0m17:48:36.420123 [debug] [Thread-4 (]: Began compiling node model.dbt_exercise.dim_employees
[0m17:48:36.461156 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_exercise.dim_employees"
[0m17:48:36.468152 [debug] [Thread-4 (]: Began executing node model.dbt_exercise.dim_employees
[0m17:48:36.490067 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m17:48:36.738338 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8e2e433c-2250-42a8-860b-5773f361f987', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76db2c4d7860>]}
[0m17:48:36.739668 [info ] [Thread-2 (]: 12 of 19 OK created sql view model dbt_dw_intermediate.int_orders_northwind .... [[32mCREATE VIEW (0 processed)[0m in 2.12s]
[0m17:48:36.740995 [debug] [Thread-2 (]: Finished running node model.dbt_exercise.int_orders_northwind
[0m17:48:36.741693 [debug] [Thread-2 (]: Began running node model.dbt_exercise.dim_customers
[0m17:48:36.742668 [info ] [Thread-2 (]: 16 of 19 START sql table model dbt_dw_marts.dim_customers ...................... [RUN]
[0m17:48:36.743509 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_exercise.int_orders_northwind, now model.dbt_exercise.dim_customers)
[0m17:48:36.744120 [debug] [Thread-2 (]: Began compiling node model.dbt_exercise.dim_customers
[0m17:48:36.750527 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_exercise.dim_customers"
[0m17:48:36.752125 [debug] [Thread-2 (]: Began executing node model.dbt_exercise.dim_customers
[0m17:48:36.756575 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:48:37.160421 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:d6590cf1-783f-41fd-a8f9-8f8af6b3dccc&page=queryresults
[0m17:48:37.212258 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:65175bb0-750c-459b-9541-25b54d721ca8&page=queryresults
[0m17:48:37.435020 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_exercise.dim_employees"
[0m17:48:37.441055 [debug] [Thread-4 (]: On model.dbt_exercise.dim_employees: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "model.dbt_exercise.dim_employees"} */

  
    

    create or replace table `corded-sunlight-464012-e2`.`dbt_dw_marts`.`dim_employees`
      
    
    

    OPTIONS()
    as (
      with int_employees_northwind as (
    select *
    from `corded-sunlight-464012-e2`.`dbt_dw_intermediate`.`int_employees_northwind`
)

, dim_employees as (
    select
        to_hex(md5(cast(coalesce(cast(employee_id as string), '_dbt_utils_surrogate_key_null_') as string))) as sk_employee
        , employee_id
        , employee_name
        , title
        , birth_date
        , age
        , hire_date
        , years_hired
        , address
        , city
        , region
        , country
    from int_employees_northwind
)
select *
from dim_employees
    );
  
[0m17:48:37.540517 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_exercise.dim_customers"
[0m17:48:37.541785 [debug] [Thread-2 (]: On model.dbt_exercise.dim_customers: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "model.dbt_exercise.dim_customers"} */

  
    

    create or replace table `corded-sunlight-464012-e2`.`dbt_dw_marts`.`dim_customers`
      
    
    

    OPTIONS()
    as (
      with int_customers_northwind as (
    select *
    from `corded-sunlight-464012-e2`.`dbt_dw_intermediate`.`int_customers_northwind`
)

, dim_customers as (
    select
        to_hex(md5(cast(coalesce(cast(customer_id as string), '_dbt_utils_surrogate_key_null_') as string))) as sk_customer
        , customer_id
        , company_name
        , contact_name
        , contact_title
        , address
        , city
        , region
        , country
        , continent
    from int_customers_northwind
)

select *
from dim_customers
    );
  
[0m17:48:37.685441 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8e2e433c-2250-42a8-860b-5773f361f987', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76db2c4d2120>]}
[0m17:48:37.686645 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8e2e433c-2250-42a8-860b-5773f361f987', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76db2c4d4890>]}
[0m17:48:37.687881 [info ] [Thread-1 (]: 14 of 19 OK created sql view model dbt_dw_intermediate.int_products_northwind .. [[32mCREATE VIEW (0 processed)[0m in 1.59s]
[0m17:48:37.689906 [info ] [Thread-3 (]: 13 of 19 OK created sql view model dbt_dw_intermediate.int_shippers_northwind .. [[32mCREATE VIEW (0 processed)[0m in 1.73s]
[0m17:48:37.692286 [debug] [Thread-1 (]: Finished running node model.dbt_exercise.int_products_northwind
[0m17:48:37.694059 [debug] [Thread-3 (]: Finished running node model.dbt_exercise.int_shippers_northwind
[0m17:48:37.695686 [debug] [Thread-1 (]: Began running node model.dbt_exercise.dim_products
[0m17:48:37.697872 [info ] [Thread-1 (]: 17 of 19 START sql table model dbt_dw_marts.dim_products ....................... [RUN]
[0m17:48:37.699550 [debug] [Thread-3 (]: Began running node model.dbt_exercise.dim_ship
[0m17:48:37.700814 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_exercise.int_products_northwind, now model.dbt_exercise.dim_products)
[0m17:48:37.702234 [info ] [Thread-3 (]: 18 of 19 START sql table model dbt_dw_marts.dim_ship ........................... [RUN]
[0m17:48:37.704084 [debug] [Thread-1 (]: Began compiling node model.dbt_exercise.dim_products
[0m17:48:37.708510 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.dbt_exercise.int_shippers_northwind, now model.dbt_exercise.dim_ship)
[0m17:48:37.721290 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_exercise.dim_products"
[0m17:48:37.724066 [debug] [Thread-3 (]: Began compiling node model.dbt_exercise.dim_ship
[0m17:48:37.733142 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_exercise.dim_ship"
[0m17:48:37.734978 [debug] [Thread-1 (]: Began executing node model.dbt_exercise.dim_products
[0m17:48:37.736625 [debug] [Thread-3 (]: Began executing node model.dbt_exercise.dim_ship
[0m17:48:37.743283 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:48:37.748498 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m17:48:37.987453 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:7643bac3-7f22-4f39-9b54-712421ac97eb&page=queryresults
[0m17:48:38.212172 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:7deecece-b91c-49ee-99c6-885771bf0cd1&page=queryresults
[0m17:48:38.550319 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_exercise.dim_ship"
[0m17:48:38.552445 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_exercise.dim_products"
[0m17:48:38.554191 [debug] [Thread-3 (]: On model.dbt_exercise.dim_ship: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "model.dbt_exercise.dim_ship"} */

  
    

    create or replace table `corded-sunlight-464012-e2`.`dbt_dw_marts`.`dim_ship`
      
    
    

    OPTIONS()
    as (
      with int_shippers_northwind as (
    select *
    from `corded-sunlight-464012-e2`.`dbt_dw_intermediate`.`int_shippers_northwind`
)

, dim_ship as (
    select
        to_hex(md5(cast(coalesce(cast(ship_id as string), '_dbt_utils_surrogate_key_null_') as string))) as sk_ship
        , ship_id
        , shipper_id
        , company_name
        , ship_address
        , ship_city
        , ship_region
        , ship_country
        , ship_continent
    from int_shippers_northwind
)

select *
from dim_ship
    );
  
[0m17:48:38.555599 [debug] [Thread-1 (]: On model.dbt_exercise.dim_products: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "model.dbt_exercise.dim_products"} */

  
    

    create or replace table `corded-sunlight-464012-e2`.`dbt_dw_marts`.`dim_products`
      
    
    

    OPTIONS()
    as (
      with int_products_northwind as (
    select *
    from `corded-sunlight-464012-e2`.`dbt_dw_intermediate`.`int_products_northwind`
)

, dim_products as (
    select
        to_hex(md5(cast(coalesce(cast(product_id as string), '_dbt_utils_surrogate_key_null_') as string))) as sk_product
        , product_id
        , product_name
        , quantity_per_unit
        , category_name
        , supplier_name
        , supplier_city
        , supplier_region
        , supplier_country
        , supplier_continent
        , is_discontinued
    from int_products_northwind
)

select *
from dim_products
    );
  
[0m17:48:39.183701 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:df9abbd1-5556-4c9a-ae64-d8c3a31c4116&page=queryresults
[0m17:48:39.258508 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:ccd38336-3ba0-457c-bbfc-21af305e623a&page=queryresults
[0m17:48:40.145791 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8e2e433c-2250-42a8-860b-5773f361f987', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76db2c314bf0>]}
[0m17:48:40.147415 [info ] [Thread-2 (]: 16 of 19 OK created sql table model dbt_dw_marts.dim_customers ................. [[32mCREATE TABLE (91.0 rows, 9.1 KiB processed)[0m in 3.40s]
[0m17:48:40.149418 [debug] [Thread-2 (]: Finished running node model.dbt_exercise.dim_customers
[0m17:48:40.766370 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8e2e433c-2250-42a8-860b-5773f361f987', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76db2c349ca0>]}
[0m17:48:40.767748 [info ] [Thread-4 (]: 15 of 19 OK created sql table model dbt_dw_marts.dim_employees ................. [[32mCREATE TABLE (9.0 rows, 13.7 KiB processed)[0m in 4.35s]
[0m17:48:40.769333 [debug] [Thread-4 (]: Finished running node model.dbt_exercise.dim_employees
[0m17:48:41.168607 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8e2e433c-2250-42a8-860b-5773f361f987', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76db2c37bf20>]}
[0m17:48:41.171604 [info ] [Thread-3 (]: 18 of 19 OK created sql table model dbt_dw_marts.dim_ship ...................... [[32mCREATE TABLE (242.0 rows, 39.9 KiB processed)[0m in 3.46s]
[0m17:48:41.173431 [debug] [Thread-3 (]: Finished running node model.dbt_exercise.dim_ship
[0m17:48:41.979843 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8e2e433c-2250-42a8-860b-5773f361f987', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76db2c37bbf0>]}
[0m17:48:41.980900 [info ] [Thread-1 (]: 17 of 19 OK created sql table model dbt_dw_marts.dim_products .................. [[32mCREATE TABLE (77.0 rows, 6.6 KiB processed)[0m in 4.28s]
[0m17:48:41.982194 [debug] [Thread-1 (]: Finished running node model.dbt_exercise.dim_products
[0m17:48:41.983493 [debug] [Thread-2 (]: Began running node model.dbt_exercise.fact_orders
[0m17:48:41.985360 [info ] [Thread-2 (]: 19 of 19 START sql table model dbt_dw_marts.fact_orders ........................ [RUN]
[0m17:48:41.986430 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.dbt_exercise.dim_customers, now model.dbt_exercise.fact_orders)
[0m17:48:41.987165 [debug] [Thread-2 (]: Began compiling node model.dbt_exercise.fact_orders
[0m17:48:41.994709 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_exercise.fact_orders"
[0m17:48:41.996049 [debug] [Thread-2 (]: Began executing node model.dbt_exercise.fact_orders
[0m17:48:42.001475 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:48:42.751158 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_exercise.fact_orders"
[0m17:48:42.752988 [debug] [Thread-2 (]: On model.dbt_exercise.fact_orders: /* {"app": "dbt", "dbt_version": "1.10.2", "profile_name": "dbt_exercise", "target_name": "dev", "node_id": "model.dbt_exercise.fact_orders"} */

  
    

    create or replace table `corded-sunlight-464012-e2`.`dbt_dw_marts`.`fact_orders`
      
    
    

    OPTIONS()
    as (
      with int_orders_northwind as (
    select *
    from `corded-sunlight-464012-e2`.`dbt_dw_intermediate`.`int_orders_northwind`
)

, dim_products as (
    select *
    from `corded-sunlight-464012-e2`.`dbt_dw_marts`.`dim_products`
)

, dim_customers as (
    select *
    from `corded-sunlight-464012-e2`.`dbt_dw_marts`.`dim_customers`
)

, dim_ship as (
    select *
    from `corded-sunlight-464012-e2`.`dbt_dw_marts`.`dim_ship`
)

, dim_employees as (
    select *
    from `corded-sunlight-464012-e2`.`dbt_dw_marts`.`dim_employees`
)

, fact_orders as (
    select 
        to_hex(md5(cast(coalesce(cast(int_orders_northwind.order_id as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(dim_customers.customer_id as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(dim_employees.employee_id as string), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(dim_products.product_id as string), '_dbt_utils_surrogate_key_null_') as string))) as sk_orders
        , int_orders_northwind.order_id
        , dim_customers.sk_customer
        , int_orders_northwind.customer_id
        , dim_employees.sk_employee
        , int_orders_northwind.employee_id
        , int_orders_northwind.order_date
        , int_orders_northwind.required_date
        , dim_ship.sk_ship
        , int_orders_northwind.ship_id
        , int_orders_northwind.shipped_date
        , int_orders_northwind.days_to_ship
        , dim_products.sk_product
        , int_orders_northwind.product_id
        , int_orders_northwind.amount
        , int_orders_northwind.rationed_shipping
        , int_orders_northwind.is_shipped
    from int_orders_northwind
    left join dim_products
        on int_orders_northwind.product_id = dim_products.product_id
    left join dim_customers
        on int_orders_northwind.customer_id = dim_customers.customer_id
    left join dim_employees
        on int_orders_northwind.employee_id = dim_employees.employee_id
    left join dim_ship
        on int_orders_northwind.ship_id = dim_ship.ship_id
)

select *
from fact_orders
    );
  
[0m17:48:43.302399 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=corded-sunlight-464012-e2&j=bq:US:1813b8f4-4721-4983-8437-8d432419d32b&page=queryresults
[0m17:48:45.938399 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8e2e433c-2250-42a8-860b-5773f361f987', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76db6ee9eea0>]}
[0m17:48:45.941137 [info ] [Thread-2 (]: 19 of 19 OK created sql table model dbt_dw_marts.fact_orders ................... [[32mCREATE TABLE (2.2k rows, 208.5 KiB processed)[0m in 3.95s]
[0m17:48:45.943251 [debug] [Thread-2 (]: Finished running node model.dbt_exercise.fact_orders
[0m17:48:45.948247 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:48:45.962158 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:48:45.964134 [debug] [MainThread]: Connection 'model.dbt_exercise.dim_ship' was properly closed.
[0m17:48:45.965731 [debug] [MainThread]: Connection 'model.dbt_exercise.dim_products' was properly closed.
[0m17:48:45.966849 [debug] [MainThread]: Connection 'model.dbt_exercise.dim_employees' was properly closed.
[0m17:48:45.967858 [debug] [MainThread]: Connection 'model.dbt_exercise.fact_orders' was properly closed.
[0m17:48:45.976278 [info ] [MainThread]: 
[0m17:48:45.978265 [info ] [MainThread]: Finished running 5 table models, 14 view models in 0 hours 0 minutes and 22.28 seconds (22.28s).
[0m17:48:45.988637 [debug] [MainThread]: Command end result
[0m17:48:46.112858 [debug] [MainThread]: Wrote artifact WritableManifest to /home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/target/manifest.json
[0m17:48:46.135497 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/target/semantic_manifest.json
[0m17:48:46.148389 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/damodara_barbosa/projetos/dbt_exercise/dbt_exercise/target/run_results.json
[0m17:48:46.149284 [info ] [MainThread]: 
[0m17:48:46.149978 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:48:46.150582 [info ] [MainThread]: 
[0m17:48:46.151309 [info ] [MainThread]: Done. PASS=19 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=19
[0m17:48:46.152412 [warn ] [MainThread]: [[33mWARNING[0m][DeprecationsSummary]: Deprecated functionality
Summary of encountered deprecations:
- DuplicateYAMLKeysDeprecation: 1 occurrence
To see all deprecation instances instead of just the first occurrence of each,
run command again with the `--show-all-deprecations` flag. You may also need to
run with `--no-partial-parse` as some deprecations are only encountered during
parsing.
[0m17:48:46.161540 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 159.39764, "process_in_blocks": "122920", "process_kernel_time": 20.001574, "process_mem_max_rss": "370108", "process_out_blocks": "4400", "process_user_time": 16.234234}
[0m17:48:46.163170 [debug] [MainThread]: Command `dbt run` succeeded at 17:48:46.162629 after 159.40 seconds
[0m17:48:46.164283 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76db6c85b590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76db2ee8f200>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76db2c425a60>]}
[0m17:48:46.165424 [debug] [MainThread]: Flushing usage events
[0m17:48:46.614488 [debug] [MainThread]: An error was encountered while trying to flush usage events
